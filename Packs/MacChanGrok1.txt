--- FILE: MacChan.xcodeproj/xcuserdata/sircornealious.xcuserdatad/xcschemes/xcschememanagement.plist ---
BASE64: PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHBsaXN0IFBVQkxJQyAiLS8vQXBwbGUvL0RURCBQTElTVCAxLjAvL0VOIiAiaHR0cDovL3d3dy5hcHBsZS5jb20vRFREcy9Qcm9wZXJ0eUxpc3QtMS4wLmR0ZCI+CjxwbGlzdCB2ZXJzaW9uPSIxLjAiPgo8ZGljdD4KCTxrZXk+U2NoZW1lVXNlclN0YXRlPC9rZXk+Cgk8ZGljdD4KCQk8a2V5Pk1hY0NoYW4ueGNzY2hlbWVfXiNzaGFyZWQjXl88L2tleT4KCQk8ZGljdD4KCQkJPGtleT5vcmRlckhpbnQ8L2tleT4KCQkJPGludGVnZXI+MDwvaW50ZWdlcj4KCQk8L2RpY3Q+Cgk8L2RpY3Q+CjwvZGljdD4KPC9wbGlzdD4K
--- END ---

--- FILE: MacChan/Persistence.swift ---
BASE64: Ly8KLy8gIFBlcnNpc3RlbmNlLnN3aWZ0Ci8vICBNYWNDaGFuCi8vCi8vICBDcmVhdGVkIGJ5IEphcmVkIE1heHdlbGwgb24gOS8zLzI1LgovLwoKaW1wb3J0IENvcmVEYXRhCgpzdHJ1Y3QgUGVyc2lzdGVuY2VDb250cm9sbGVyIHsKICAgIHN0YXRpYyBsZXQgc2hhcmVkID0gUGVyc2lzdGVuY2VDb250cm9sbGVyKCkKCiAgICBATWFpbkFjdG9yCiAgICBzdGF0aWMgbGV0IHByZXZpZXc6IFBlcnNpc3RlbmNlQ29udHJvbGxlciA9IHsKICAgICAgICBsZXQgcmVzdWx0ID0gUGVyc2lzdGVuY2VDb250cm9sbGVyKGluTWVtb3J5OiB0cnVlKQogICAgICAgIGxldCB2aWV3Q29udGV4dCA9IHJlc3VsdC5jb250YWluZXIudmlld0NvbnRleHQKICAgICAgICBmb3IgXyBpbiAwLi48MTAgewogICAgICAgICAgICBsZXQgbmV3SXRlbSA9IEl0ZW0oY29udGV4dDogdmlld0NvbnRleHQpCiAgICAgICAgICAgIG5ld0l0ZW0udGltZXN0YW1wID0gRGF0ZSgpCiAgICAgICAgfQogICAgICAgIGRvIHsKICAgICAgICAgICAgdHJ5IHZpZXdDb250ZXh0LnNhdmUoKQogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAvLyBSZXBsYWNlIHRoaXMgaW1wbGVtZW50YXRpb24gd2l0aCBjb2RlIHRvIGhhbmRsZSB0aGUgZXJyb3IgYXBwcm9wcmlhdGVseS4KICAgICAgICAgICAgLy8gZmF0YWxFcnJvcigpIGNhdXNlcyB0aGUgYXBwbGljYXRpb24gdG8gZ2VuZXJhdGUgYSBjcmFzaCBsb2cgYW5kIHRlcm1pbmF0ZS4gWW91IHNob3VsZCBub3QgdXNlIHRoaXMgZnVuY3Rpb24gaW4gYSBzaGlwcGluZyBhcHBsaWNhdGlvbiwgYWx0aG91Z2ggaXQgbWF5IGJlIHVzZWZ1bCBkdXJpbmcgZGV2ZWxvcG1lbnQuCiAgICAgICAgICAgIGxldCBuc0Vycm9yID0gZXJyb3IgYXMgTlNFcnJvcgogICAgICAgICAgICBmYXRhbEVycm9yKCJVbnJlc29sdmVkIGVycm9yIFwobnNFcnJvciksIFwobnNFcnJvci51c2VySW5mbykiKQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0CiAgICB9KCkKCiAgICBsZXQgY29udGFpbmVyOiBOU1BlcnNpc3RlbnRDb250YWluZXIKCiAgICBpbml0KGluTWVtb3J5OiBCb29sID0gZmFsc2UpIHsKICAgICAgICBjb250YWluZXIgPSBOU1BlcnNpc3RlbnRDb250YWluZXIobmFtZTogIk1hY0NoYW4iKQogICAgICAgIGlmIGluTWVtb3J5IHsKICAgICAgICAgICAgY29udGFpbmVyLnBlcnNpc3RlbnRTdG9yZURlc2NyaXB0aW9ucy5maXJzdCEudXJsID0gVVJMKGZpbGVVUkxXaXRoUGF0aDogIi9kZXYvbnVsbCIpCiAgICAgICAgfQogICAgICAgIGNvbnRhaW5lci5sb2FkUGVyc2lzdGVudFN0b3Jlcyhjb21wbGV0aW9uSGFuZGxlcjogeyAoc3RvcmVEZXNjcmlwdGlvbiwgZXJyb3IpIGluCiAgICAgICAgICAgIGlmIGxldCBlcnJvciA9IGVycm9yIGFzIE5TRXJyb3I/IHsKICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgdGhpcyBpbXBsZW1lbnRhdGlvbiB3aXRoIGNvZGUgdG8gaGFuZGxlIHRoZSBlcnJvciBhcHByb3ByaWF0ZWx5LgogICAgICAgICAgICAgICAgLy8gZmF0YWxFcnJvcigpIGNhdXNlcyB0aGUgYXBwbGljYXRpb24gdG8gZ2VuZXJhdGUgYSBjcmFzaCBsb2cgYW5kIHRlcm1pbmF0ZS4gWW91IHNob3VsZCBub3QgdXNlIHRoaXMgZnVuY3Rpb24gaW4gYSBzaGlwcGluZyBhcHBsaWNhdGlvbiwgYWx0aG91Z2ggaXQgbWF5IGJlIHVzZWZ1bCBkdXJpbmcgZGV2ZWxvcG1lbnQuCgogICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgICBUeXBpY2FsIHJlYXNvbnMgZm9yIGFuIGVycm9yIGhlcmUgaW5jbHVkZToKICAgICAgICAgICAgICAgICAqIFRoZSBwYXJlbnQgZGlyZWN0b3J5IGRvZXMgbm90IGV4aXN0LCBjYW5ub3QgYmUgY3JlYXRlZCwgb3IgZGlzYWxsb3dzIHdyaXRpbmcuCiAgICAgICAgICAgICAgICAgKiBUaGUgcGVyc2lzdGVudCBzdG9yZSBpcyBub3QgYWNjZXNzaWJsZSwgZHVlIHRvIHBlcm1pc3Npb25zIG9yIGRhdGEgcHJvdGVjdGlvbiB3aGVuIHRoZSBkZXZpY2UgaXMgbG9ja2VkLgogICAgICAgICAgICAgICAgICogVGhlIGRldmljZSBpcyBvdXQgb2Ygc3BhY2UuCiAgICAgICAgICAgICAgICAgKiBUaGUgc3RvcmUgY291bGQgbm90IGJlIG1pZ3JhdGVkIHRvIHRoZSBjdXJyZW50IG1vZGVsIHZlcnNpb24uCiAgICAgICAgICAgICAgICAgQ2hlY2sgdGhlIGVycm9yIG1lc3NhZ2UgdG8gZGV0ZXJtaW5lIHdoYXQgdGhlIGFjdHVhbCBwcm9ibGVtIHdhcy4KICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgZmF0YWxFcnJvcigiVW5yZXNvbHZlZCBlcnJvciBcKGVycm9yKSwgXChlcnJvci51c2VySW5mbykiKQogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICBjb250YWluZXIudmlld0NvbnRleHQuYXV0b21hdGljYWxseU1lcmdlc0NoYW5nZXNGcm9tUGFyZW50ID0gdHJ1ZQogICAgfQp9Cg==
--- END ---

--- FILE: MacChan/MacChanApp.swift ---
BASE64: Ly8KLy8gIE1hY0NoYW5BcHAuc3dpZnQKLy8gIE1hY0NoYW4KLy8KLy8gIENyZWF0ZWQgYnkgSmFyZWQgTWF4d2VsbCBvbiA5LzMvMjUuCi8vCgppbXBvcnQgU3dpZnRVSQppbXBvcnQgQ2xvdWRLaXQKCkBtYWluCnN0cnVjdCBNYWNDaGFuQXBwOiBBcHAgewogICAgQFN0YXRlT2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlciA9IENsb3VkS2l0TWFuYWdlci5zaGFyZWQKICAgIEBTdGF0ZU9iamVjdCBwcml2YXRlIHZhciBhdXRoTWFuYWdlciA9IEF1dGhlbnRpY2F0aW9uTWFuYWdlci5zaGFyZWQKICAgIEBTdGF0ZU9iamVjdCBwcml2YXRlIHZhciBub3RpZmljYXRpb25NYW5hZ2VyID0gTm90aWZpY2F0aW9uTWFuYWdlci5zaGFyZWQKICAgIEBTdGF0ZU9iamVjdCBwcml2YXRlIHZhciBtZXNzYWdlTWFuYWdlciA9IE1lc3NhZ2VNYW5hZ2VyLnNoYXJlZAogICAgCiAgICBsZXQgcGVyc2lzdGVuY2VDb250cm9sbGVyID0gUGVyc2lzdGVuY2VDb250cm9sbGVyLnNoYXJlZAoKICAgIHZhciBib2R5OiBzb21lIFNjZW5lIHsKICAgICAgICBXaW5kb3dHcm91cCB7CiAgICAgICAgICAgIENvbnRlbnRWaWV3KCkKICAgICAgICAgICAgICAgIC5lbnZpcm9ubWVudChcLm1hbmFnZWRPYmplY3RDb250ZXh0LCBwZXJzaXN0ZW5jZUNvbnRyb2xsZXIuY29udGFpbmVyLnZpZXdDb250ZXh0KQogICAgICAgICAgICAgICAgLmVudmlyb25tZW50T2JqZWN0KGNsb3VkS2l0TWFuYWdlcikKICAgICAgICAgICAgICAgIC5lbnZpcm9ubWVudE9iamVjdChhdXRoTWFuYWdlcikKICAgICAgICAgICAgICAgIC5lbnZpcm9ubWVudE9iamVjdChub3RpZmljYXRpb25NYW5hZ2VyKQogICAgICAgICAgICAgICAgLmVudmlyb25tZW50T2JqZWN0KG1lc3NhZ2VNYW5hZ2VyKQogICAgICAgICAgICAgICAgLm9uQXBwZWFyIHsKICAgICAgICAgICAgICAgICAgICBUYXNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2V0dXBBcHAoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBzZXR1cEFwcCgpIGFzeW5jIHsKICAgICAgICAvLyBSZXF1ZXN0IG5vdGlmaWNhdGlvbiBwZXJtaXNzaW9ucwogICAgICAgIF8gPSBhd2FpdCBub3RpZmljYXRpb25NYW5hZ2VyLnJlcXVlc3ROb3RpZmljYXRpb25QZXJtaXNzaW9uKCkKICAgICAgICAKICAgICAgICAvLyBSZWdpc3RlciBmb3IgcmVtb3RlIG5vdGlmaWNhdGlvbnMKICAgICAgICBub3RpZmljYXRpb25NYW5hZ2VyLnJlZ2lzdGVyRm9yUmVtb3RlTm90aWZpY2F0aW9ucygpCiAgICAgICAgCiAgICAgICAgLy8gU2V0dXAgQ2xvdWRLaXQgc3Vic2NyaXB0aW9ucwogICAgICAgIGF3YWl0IG5vdGlmaWNhdGlvbk1hbmFnZXIuc2V0dXBDbG91ZEtpdFN1YnNjcmlwdGlvbnMoKQogICAgICAgIAogICAgICAgIC8vIENoZWNrIGF1dGhlbnRpY2F0aW9uIHN0YXR1cwogICAgICAgIGF1dGhNYW5hZ2VyLmNoZWNrQXV0aGVudGljYXRpb25TdGF0dXMoKQogICAgfQp9Cg==
--- END ---

--- FILE: MacChan/MacChan.entitlements ---
BASE64: PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHBsaXN0IFBVQkxJQyAiLS8vQXBwbGUvL0RURCBQTElTVCAxLjAvL0VOIiAiaHR0cDovL3d3dy5hcHBsZS5jb20vRFREcy9Qcm9wZXJ0eUxpc3QtMS4wLmR0ZCI+CjxwbGlzdCB2ZXJzaW9uPSIxLjAiPgo8ZGljdD4KCTxrZXk+YXBzLWVudmlyb25tZW50PC9rZXk+Cgk8c3RyaW5nPmRldmVsb3BtZW50PC9zdHJpbmc+Cgk8a2V5PmNvbS5hcHBsZS5kZXZlbG9wZXIuYXBwbGVzaWduaW48L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPkRlZmF1bHQ8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PmNvbS5hcHBsZS5kZXZlbG9wZXIuYXBzLWVudmlyb25tZW50PC9rZXk+Cgk8c3RyaW5nPmRldmVsb3BtZW50PC9zdHJpbmc+Cgk8a2V5PmNvbS5hcHBsZS5kZXZlbG9wZXIuaWNsb3VkLWNvbnRhaW5lci1pZGVudGlmaWVyczwva2V5PgoJPGFycmF5PgoJCTxzdHJpbmc+aUNsb3VkLm1hY2NoYW50ZXN0MTwvc3RyaW5nPgoJPC9hcnJheT4KCTxrZXk+Y29tLmFwcGxlLmRldmVsb3Blci5pY2xvdWQtc2VydmljZXM8L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPkNsb3VkS2l0PC9zdHJpbmc+Cgk8L2FycmF5PgoJPGtleT5jb20uYXBwbGUuc2VjdXJpdHkuYXBwLXNhbmRib3g8L2tleT4KCTx0cnVlLz4KCTxrZXk+Y29tLmFwcGxlLnNlY3VyaXR5LmFzc2V0cy5tb3ZpZXMucmVhZC13cml0ZTwva2V5PgoJPHRydWUvPgoJPGtleT5jb20uYXBwbGUuc2VjdXJpdHkuYXNzZXRzLm11c2ljLnJlYWQtd3JpdGU8L2tleT4KCTx0cnVlLz4KCTxrZXk+Y29tLmFwcGxlLnNlY3VyaXR5LmFzc2V0cy5waWN0dXJlcy5yZWFkLXdyaXRlPC9rZXk+Cgk8dHJ1ZS8+Cgk8a2V5PmNvbS5hcHBsZS5zZWN1cml0eS5hdXRvbWF0aW9uLmFwcGxlLWV2ZW50czwva2V5PgoJPHRydWUvPgoJPGtleT5jb20uYXBwbGUuc2VjdXJpdHkuZGV2aWNlLmF1ZGlvLWlucHV0PC9rZXk+Cgk8dHJ1ZS8+Cgk8a2V5PmNvbS5hcHBsZS5zZWN1cml0eS5kZXZpY2UuYmx1ZXRvb3RoPC9rZXk+Cgk8dHJ1ZS8+Cgk8a2V5PmNvbS5hcHBsZS5zZWN1cml0eS5kZXZpY2UuY2FtZXJhPC9rZXk+Cgk8dHJ1ZS8+Cgk8a2V5PmNvbS5hcHBsZS5zZWN1cml0eS5maWxlcy5kb3dubG9hZHMucmVhZC13cml0ZTwva2V5PgoJPHRydWUvPgoJPGtleT5jb20uYXBwbGUuc2VjdXJpdHkuZmlsZXMudXNlci1zZWxlY3RlZC5yZWFkLXdyaXRlPC9rZXk+Cgk8dHJ1ZS8+Cgk8a2V5PmNvbS5hcHBsZS5zZWN1cml0eS5uZXR3b3JrLmNsaWVudDwva2V5PgoJPHRydWUvPgoJPGtleT5jb20uYXBwbGUuc2VjdXJpdHkubmV0d29yay5zZXJ2ZXI8L2tleT4KCTx0cnVlLz4KCTxrZXk+Y29tLmFwcGxlLnNlY3VyaXR5LnBlcnNvbmFsLWluZm9ybWF0aW9uLmFkZHJlc3Nib29rPC9rZXk+Cgk8dHJ1ZS8+Cgk8a2V5PmNvbS5hcHBsZS5zZWN1cml0eS5wZXJzb25hbC1pbmZvcm1hdGlvbi5jYWxlbmRhcnM8L2tleT4KCTx0cnVlLz4KCTxrZXk+Y29tLmFwcGxlLnNlY3VyaXR5LnBlcnNvbmFsLWluZm9ybWF0aW9uLmxvY2F0aW9uPC9rZXk+Cgk8dHJ1ZS8+Cgk8a2V5PmNvbS5hcHBsZS5zZWN1cml0eS5wZXJzb25hbC1pbmZvcm1hdGlvbi5waG90b3MtbGlicmFyeTwva2V5PgoJPHRydWUvPgoJPGtleT5jb20uYXBwbGUuc2VjdXJpdHkucHJpbnQ8L2tleT4KCTx0cnVlLz4KPC9kaWN0Pgo8L3BsaXN0Pgo=
--- END ---

--- FILE: MacChan/ContentView.swift ---
BASE64: aW1wb3J0IFN3aWZ0VUkKI2lmIG9zKGlPUykKaW1wb3J0IEF1dGhlbnRpY2F0aW9uU2VydmljZXMKI2VuZGlmCgpzdHJ1Y3QgQ29udGVudFZpZXc6IFZpZXcgewogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGF1dGhNYW5hZ2VyOiBBdXRoZW50aWNhdGlvbk1hbmFnZXIKICAgIEBFbnZpcm9ubWVudE9iamVjdCBwcml2YXRlIHZhciBjbG91ZEtpdE1hbmFnZXI6IENsb3VkS2l0TWFuYWdlcgoKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIEdyb3VwIHsKICAgICAgICAgICAgaWYgYXV0aE1hbmFnZXIuaXNBdXRoZW50aWNhdGVkIHsKICAgICAgICAgICAgICAgIC8vIFVzZXIgaXMgYXV0aGVudGljYXRlZCwgc2hvdyBtYWluIHZpZXcKICAgICAgICAgICAgICAgIE1haW5Gb3J1bVZpZXcoKQogICAgICAgICAgICAgICAgICAgIC5hbGVydChjbG91ZEtpdE1hbmFnZXIubG9naW5FcnJvclRpdGxlLCBpc1ByZXNlbnRlZDogJGNsb3VkS2l0TWFuYWdlci5zaG93TG9naW5FcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlRyeSBBZ2FpbiIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3VkS2l0TWFuYWdlci5kaXNtaXNzTG9naW5FcnJvcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXRyeSB0aGUgQ2xvdWRLaXQgYXV0aGVudGljYXRpb24gcHJvY2VzcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFzayB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNoZWNrQWNjb3VudFN0YXR1cygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDb250aW51ZSBPZmZsaW5lIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvdWRLaXRNYW5hZ2VyLmRpc21pc3NMb2dpbkVycm9yKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFsbG93IHVzZXIgdG8gY29udGludWUgd2l0aG91dCBDbG91ZEtpdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvdWRLaXRNYW5hZ2VyLmlzU2lnbmVkSW4gPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJTaWduIE91dCIsIHJvbGU6IC5kZXN0cnVjdGl2ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvdWRLaXRNYW5hZ2VyLmRpc21pc3NMb2dpbkVycm9yKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhNYW5hZ2VyLnNpZ25PdXQoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBtZXNzYWdlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoY2xvdWRLaXRNYW5hZ2VyLmxvZ2luRXJyb3JNZXNzYWdlKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIFNob3cgYXV0aGVudGljYXRpb24gdmlldyB3aXRoIGVycm9yIGhhbmRsaW5nCiAgICAgICAgICAgICAgICBBdXRoZW50aWNhdGlvblZpZXcoKQogICAgICAgICAgICAgICAgICAgIC5hbGVydCgiQXV0aGVudGljYXRpb24gRXJyb3IiLCBpc1ByZXNlbnRlZDogLmNvbnN0YW50KGF1dGhNYW5hZ2VyLmVycm9yTWVzc2FnZSAhPSBuaWwpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiVHJ5IEFnYWluIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aE1hbmFnZXIuZXJyb3JNZXNzYWdlID0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBhdXRvbWF0aWNhbGx5IHJldHJ5IC0gbGV0IHVzZXIgbWFudWFsbHkgdHJ5IGFnYWluCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDYW5jZWwiLCByb2xlOiAuY2FuY2VsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoTWFuYWdlci5lcnJvck1lc3NhZ2UgPSBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gbWVzc2FnZTogewogICAgICAgICAgICAgICAgICAgICAgICBpZiBsZXQgZXJyb3JNZXNzYWdlID0gYXV0aE1hbmFnZXIuZXJyb3JNZXNzYWdlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoZXJyb3JNZXNzYWdlKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC5vbkFwcGVhciB7CiAgICAgICAgICAgIHNldHVwQXBwKCkKICAgICAgICB9CiAgICAgICAgLm92ZXJsYXkgewogICAgICAgICAgICBpZiBhdXRoTWFuYWdlci5pc0xvYWRpbmcgewogICAgICAgICAgICAgICAgUHJvZ3Jlc3NWaWV3KCJBdXRoZW50aWNhdGluZy4uLiIpCiAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoKQojaWYgb3MoaU9TKQogICAgICAgICAgICAgICAgICAgIC5iYWNrZ3JvdW5kKENvbG9yKC5zeXN0ZW1CYWNrZ3JvdW5kKS5vcGFjaXR5KDAuOSkpCiNlbHNlCiAgICAgICAgICAgICAgICAgICAgLmJhY2tncm91bmQoQ29sb3IoLndpbmRvd0JhY2tncm91bmRDb2xvcikub3BhY2l0eSgwLjkpKQojZW5kaWYKICAgICAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDEwKQogICAgICAgICAgICAgICAgICAgIC5zaGFkb3cocmFkaXVzOiAxMCkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGZ1bmMgc2V0dXBBcHAoKSB7CiNpZiBvcyhpT1MpCiAgICAgICAgVUlBcHBsaWNhdGlvbi5zaGFyZWQucmVnaXN0ZXJGb3JSZW1vdGVOb3RpZmljYXRpb25zKCkKI2Vsc2UKICAgICAgICBOU0FwcGxpY2F0aW9uLnNoYXJlZC5yZWdpc3RlckZvclJlbW90ZU5vdGlmaWNhdGlvbnMoKQojZW5kaWYKICAgIH0KfQoKc3RydWN0IEF1dGhlbnRpY2F0aW9uVmlldzogVmlldyB7CiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgYXV0aE1hbmFnZXI6IEF1dGhlbnRpY2F0aW9uTWFuYWdlcgoKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIFZTdGFjayhzcGFjaW5nOiAyMCkgewogICAgICAgICAgICBUZXh0KCJXZWxjb21lIHRvIE1hY0NoYW4iKQogICAgICAgICAgICAgICAgLmZvbnQoLmxhcmdlVGl0bGUpCiAgICAgICAgICAgICAgICAuZm9udFdlaWdodCguYm9sZCkKCiAgICAgICAgICAgIFRleHQoIlNpZ24gaW4gd2l0aCBBcHBsZSB0byBjb250aW51ZSIpCiAgICAgICAgICAgICAgICAuZm9udCguaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCgojaWYgb3MoaU9TKQogICAgICAgICAgICBTaWduSW5XaXRoQXBwbGVCdXR0b24oLnNpZ25JbikgeyByZXF1ZXN0IGluCiAgICAgICAgICAgICAgICByZXF1ZXN0LnJlcXVlc3RlZFNjb3BlcyA9IFsuZnVsbE5hbWUsIC5lbWFpbF0KICAgICAgICAgICAgfSBvbkNvbXBsZXRpb246IHsgcmVzdWx0IGluCiAgICAgICAgICAgICAgICBzd2l0Y2ggcmVzdWx0IHsKICAgICAgICAgICAgICAgIGNhc2UgLnN1Y2Nlc3MobGV0IGF1dGhvcml6YXRpb24pOgogICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBzdWNjZXNzZnVsIHNpZ24gaW4KICAgICAgICAgICAgICAgICAgICBpZiBsZXQgY3JlZGVudGlhbCA9IGF1dGhvcml6YXRpb24uY3JlZGVudGlhbCBhcz8gQVNBdXRob3JpemF0aW9uQXBwbGVJRENyZWRlbnRpYWwgewogICAgICAgICAgICAgICAgICAgICAgICBhdXRoTWFuYWdlci5oYW5kbGVTdWNjZXNzZnVsU2lnbkluKGNyZWRlbnRpYWw6IGNyZWRlbnRpYWwpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2FzZSAuZmFpbHVyZShsZXQgZXJyb3IpOgogICAgICAgICAgICAgICAgICAgIHByaW50KCJTaWduIGluIGZhaWxlZDogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5zaWduSW5XaXRoQXBwbGVCdXR0b25TdHlsZSguYmxhY2spCiAgICAgICAgICAgIC5mcmFtZShoZWlnaHQ6IDUwKQogICAgICAgICAgICAucGFkZGluZyguaG9yaXpvbnRhbCkKI2Vsc2UKICAgICAgICAgICAgQnV0dG9uKGFjdGlvbjogewogICAgICAgICAgICAgICAgYXV0aE1hbmFnZXIuc2lnbkluV2l0aEFwcGxlKCkKICAgICAgICAgICAgfSkgewogICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiAiYXBwbGUubG9nbyIpCiAgICAgICAgICAgICAgICAgICAgVGV4dCgiU2lnbiBpbiB3aXRoIEFwcGxlIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgICAgIC5iYWNrZ3JvdW5kKENvbG9yLmJsYWNrKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigud2hpdGUpCiAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLmJ1dHRvblN0eWxlKC5wbGFpbikKI2VuZGlmCiAgICAgICAgfQogICAgICAgIC5wYWRkaW5nKCkKI2lmIG9zKG1hY09TKQogICAgICAgIC5mcmFtZShtaW5XaWR0aDogMzAwLCBtaW5IZWlnaHQ6IDIwMCkKI2VuZGlmCiAgICB9Cn0K
--- END ---

--- FILE: MacChan/Info.plist ---
BASE64: PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHBsaXN0IFBVQkxJQyAiLS8vQXBwbGUvL0RURCBQTElTVCAxLjAvL0VOIiAiaHR0cDovL3d3dy5hcHBsZS5jb20vRFREcy9Qcm9wZXJ0eUxpc3QtMS4wLmR0ZCI+CjxwbGlzdCB2ZXJzaW9uPSIxLjAiPgo8ZGljdD4KCTxrZXk+Q0ZCdW5kbGVJZGVudGlmaWVyPC9rZXk+Cgk8c3RyaW5nPk1hYy5DaGFuLk1hY0NoYW48L3N0cmluZz4KCTxrZXk+Q0ZCdW5kbGVOYW1lPC9rZXk+Cgk8c3RyaW5nPk1hY0NoYW48L3N0cmluZz4KCTxrZXk+Q0ZCdW5kbGVEaXNwbGF5TmFtZTwva2V5PgoJPHN0cmluZz5NYWNDaGFuPC9zdHJpbmc+Cgk8a2V5PkNGQnVuZGxlVmVyc2lvbjwva2V5PgoJPHN0cmluZz4xPC9zdHJpbmc+Cgk8a2V5PkNGQnVuZGxlU2hvcnRWZXJzaW9uU3RyaW5nPC9rZXk+Cgk8c3RyaW5nPjEuMDwvc3RyaW5nPgoJPGtleT5DRkJ1bmRsZUV4ZWN1dGFibGU8L2tleT4KCTxzdHJpbmc+JChFWEVDVVRBQkxFX05BTUUpPC9zdHJpbmc+Cgk8a2V5PkNGQnVuZGxlSWNvbkZpbGU8L2tleT4KCTxzdHJpbmc+PC9zdHJpbmc+Cgk8a2V5PkNGQnVuZGxlUGFja2FnZVR5cGU8L2tleT4KCTxzdHJpbmc+QVBQTDwvc3RyaW5nPgoJPGtleT5DRkJ1bmRsZVN1cHBvcnRlZFBsYXRmb3Jtczwva2V5PgoJPGFycmF5PgoJCTxzdHJpbmc+TWFjT1NYPC9zdHJpbmc+Cgk8L2FycmF5PgoJPGtleT5DRkJ1bmRsZUluZm9EaWN0aW9uYXJ5VmVyc2lvbjwva2V5PgoJPHN0cmluZz42LjA8L3N0cmluZz4KCTxrZXk+Q0ZCdW5kbGVEZXZlbG9wbWVudFJlZ2lvbjwva2V5PgoJPHN0cmluZz5lbjwvc3RyaW5nPgoJPGtleT5OU0h1bWFuUmVhZGFibGVDb3B5cmlnaHQ8L2tleT4KCTxzdHJpbmc+Q29weXJpZ2h0IMKpIDIwMjUgSmFyZWQgTWF4d2VsbC4gQWxsIHJpZ2h0cyByZXNlcnZlZC48L3N0cmluZz4KCTxrZXk+TFNNaW5pbXVtU3lzdGVtVmVyc2lvbjwva2V5PgoJPHN0cmluZz4kKE1BQ09TWF9ERVBMT1lNRU5UX1RBUkdFVCk8L3N0cmluZz4KCTxrZXk+TlNBcHBUcmFuc3BvcnRTZWN1cml0eTwva2V5PgoJPGRpY3Q+CgkJPGtleT5OU0FsbG93c0FyYml0cmFyeUxvYWRzPC9rZXk+CgkJPHRydWUvPgoJPC9kaWN0PgoJPGtleT5OU1VzZXJOb3RpZmljYXRpb25BbGVydFN0eWxlPC9rZXk+Cgk8c3RyaW5nPmFsZXJ0PC9zdHJpbmc+CjwvZGljdD4KPC9wbGlzdD4K
--- END ---

--- FILE: MacChan/Managers/AttachmentManager.swift ---
BASE64: Ly8KLy8gIEF0dGFjaG1lbnRNYW5hZ2VyLnN3aWZ0Ci8vICBNYWNDaGFuCi8vCi8vICBOT1RFIFRPIERFVkVMT1BFUjogVGhpcyBmaWxlIGNvbnRhaW5zIGlPUy1zcGVjaWZpYyBjb2RlIChQaG90b3NVSSBmcmFtZXdvcmspLgovLyAgV2hlbiBhZGRpbmcgbmV3IGNvZGUsIGVuc3VyZSBpdCdzIGlPUy1jb21wYXRpYmxlIG9ubHkuIFVzZSBjb25kaXRpb25hbCBjb21waWxhdGlvbgovLyAgZm9yIG1hY09TIGFsdGVybmF0aXZlcyBpZiBuZWVkZWQuCi8vCi8vICBDcmVhdGVkIGJ5IEphcmVkIE1heHdlbGwgb24gOS8zLzI1LgovLwoKaW1wb3J0IEZvdW5kYXRpb24KaW1wb3J0IENsb3VkS2l0CmltcG9ydCBTd2lmdFVJCgpATWFpbkFjdG9yCmNsYXNzIEF0dGFjaG1lbnRNYW5hZ2VyOiBPYnNlcnZhYmxlT2JqZWN0IHsKICAgIHN0YXRpYyBsZXQgc2hhcmVkID0gQXR0YWNobWVudE1hbmFnZXIoKQogICAgCiAgICBAUHVibGlzaGVkIHZhciBpc1VwbG9hZGluZyA9IGZhbHNlCiAgICBAUHVibGlzaGVkIHZhciB1cGxvYWRQcm9ncmVzczogRG91YmxlID0gMC4wCiAgICBAUHVibGlzaGVkIHZhciBlcnJvck1lc3NhZ2U6IFN0cmluZz8KICAgIAogICAgcHJpdmF0ZSBsZXQgY2xvdWRLaXRNYW5hZ2VyID0gQ2xvdWRLaXRNYW5hZ2VyLnNoYXJlZAogICAgcHJpdmF0ZSBsZXQgbWF4RmlsZVNpemU6IEludDY0ID0gMTAgKiAxMDI0ICogMTAyNCAvLyAxME1CCiAgICBwcml2YXRlIGxldCBhbGxvd2VkSW1hZ2VUeXBlcyA9IFsiaW1hZ2UvanBlZyIsICJpbWFnZS9wbmciLCAiaW1hZ2UvZ2lmIiwgImltYWdlL3dlYnAiXQogICAgcHJpdmF0ZSBsZXQgYWxsb3dlZERvY3VtZW50VHlwZXMgPSBbImFwcGxpY2F0aW9uL3BkZiIsICJ0ZXh0L3BsYWluIiwgImFwcGxpY2F0aW9uL21zd29yZCIsICJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudCJdCiAgICAKICAgIHByaXZhdGUgaW5pdCgpIHt9CiAgICAKICAgIGZ1bmMgdXBsb2FkSW1hZ2VEYXRhKF8gaW1hZ2VEYXRhOiBEYXRhLCBmaWxlbmFtZTogU3RyaW5nKSBhc3luYyB0aHJvd3MgLT4gQXR0YWNobWVudCB7CiAgICAgICAgcmV0dXJuIHRyeSBhd2FpdCB1cGxvYWRGaWxlKGRhdGE6IGltYWdlRGF0YSwgZmlsZW5hbWU6IGZpbGVuYW1lLCBtaW1lVHlwZTogImltYWdlL2pwZWciKQogICAgfQogICAgCiAgICBmdW5jIHVwbG9hZEZpbGUoZGF0YTogRGF0YSwgZmlsZW5hbWU6IFN0cmluZywgbWltZVR5cGU6IFN0cmluZykgYXN5bmMgdGhyb3dzIC0+IEF0dGFjaG1lbnQgewogICAgICAgIGd1YXJkIGRhdGEuY291bnQgPD0gbWF4RmlsZVNpemUgZWxzZSB7CiAgICAgICAgICAgIHRocm93IEF0dGFjaG1lbnRFcnJvci5maWxlVG9vTGFyZ2UKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZ3VhcmQgaXNBbGxvd2VkRmlsZVR5cGUobWltZVR5cGUpIGVsc2UgewogICAgICAgICAgICB0aHJvdyBBdHRhY2htZW50RXJyb3IudW5zdXBwb3J0ZWRGaWxlVHlwZQogICAgICAgIH0KICAgICAgICAKICAgICAgICBpc1VwbG9hZGluZyA9IHRydWUKICAgICAgICB1cGxvYWRQcm9ncmVzcyA9IDAuMAogICAgICAgIAogICAgICAgIGRvIHsKICAgICAgICAgICAgbGV0IGF0dGFjaG1lbnQgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLnVwbG9hZEF0dGFjaG1lbnQoZGF0YSwgZmlsZW5hbWU6IGZpbGVuYW1lLCBtaW1lVHlwZTogbWltZVR5cGUpCiAgICAgICAgICAgIHVwbG9hZFByb2dyZXNzID0gMS4wCiAgICAgICAgICAgIGlzVXBsb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgcmV0dXJuIGF0dGFjaG1lbnQKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgaXNVcGxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAiVXBsb2FkIGZhaWxlZDogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiCiAgICAgICAgICAgIHRocm93IGVycm9yCiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jIGRvd25sb2FkQXR0YWNobWVudChfIGF0dGFjaG1lbnQ6IEF0dGFjaG1lbnQpIGFzeW5jIHRocm93cyAtPiBEYXRhIHsKICAgICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHlvdSdkIGRvd25sb2FkIGZyb20gQ2xvdWRLaXQKICAgICAgICAvLyBGb3Igbm93LCB3ZSdsbCByZXR1cm4gZW1wdHkgZGF0YQogICAgICAgIHJldHVybiBEYXRhKCkKICAgIH0KICAgIAogICAgZnVuYyBnZW5lcmF0ZVRodW1ibmFpbERhdGEoZnJvbSBpbWFnZURhdGE6IERhdGEsIHNpemU6IENHU2l6ZSA9IENHU2l6ZSh3aWR0aDogMTUwLCBoZWlnaHQ6IDE1MCkpIC0+IERhdGE/IHsKICAgICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHlvdSdkIHVzZSBJbWFnZUlPIG9yIENvcmUgR3JhcGhpY3MgdG8gY3JlYXRlIHRodW1ibmFpbHMKICAgICAgICAvLyBGb3Igbm93LCB3ZSdsbCByZXR1cm4gdGhlIG9yaWdpbmFsIGRhdGEKICAgICAgICByZXR1cm4gaW1hZ2VEYXRhCiAgICB9CiAgICAKICAgIGZ1bmMgZm9ybWF0RmlsZVNpemUoXyBieXRlczogSW50NjQpIC0+IFN0cmluZyB7CiAgICAgICAgbGV0IGZvcm1hdHRlciA9IEJ5dGVDb3VudEZvcm1hdHRlcigpCiAgICAgICAgZm9ybWF0dGVyLmFsbG93ZWRVbml0cyA9IFsudXNlS0IsIC51c2VNQiwgLnVzZUdCXQogICAgICAgIGZvcm1hdHRlci5jb3VudFN0eWxlID0gLmZpbGUKICAgICAgICByZXR1cm4gZm9ybWF0dGVyLnN0cmluZyhmcm9tQnl0ZUNvdW50OiBieXRlcykKICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGlzQWxsb3dlZEZpbGVUeXBlKF8gbWltZVR5cGU6IFN0cmluZykgLT4gQm9vbCB7CiAgICAgICAgcmV0dXJuIGFsbG93ZWRJbWFnZVR5cGVzLmNvbnRhaW5zKG1pbWVUeXBlKSB8fCBhbGxvd2VkRG9jdW1lbnRUeXBlcy5jb250YWlucyhtaW1lVHlwZSkKICAgIH0KfQoKZW51bSBBdHRhY2htZW50RXJyb3I6IExvY2FsaXplZEVycm9yIHsKICAgIGNhc2UgaW52YWxpZEltYWdlRGF0YQogICAgY2FzZSBmaWxlVG9vTGFyZ2UKICAgIGNhc2UgdW5zdXBwb3J0ZWRGaWxlVHlwZQogICAgY2FzZSB1cGxvYWRGYWlsZWQKICAgIAogICAgdmFyIGVycm9yRGVzY3JpcHRpb246IFN0cmluZz8gewogICAgICAgIHN3aXRjaCBzZWxmIHsKICAgICAgICBjYXNlIC5pbnZhbGlkSW1hZ2VEYXRhOgogICAgICAgICAgICByZXR1cm4gIkludmFsaWQgaW1hZ2UgZGF0YSIKICAgICAgICBjYXNlIC5maWxlVG9vTGFyZ2U6CiAgICAgICAgICAgIHJldHVybiAiRmlsZSBpcyB0b28gbGFyZ2UuIE1heGltdW0gc2l6ZSBpcyAxME1CLiIKICAgICAgICBjYXNlIC51bnN1cHBvcnRlZEZpbGVUeXBlOgogICAgICAgICAgICByZXR1cm4gIlVuc3VwcG9ydGVkIGZpbGUgdHlwZSIKICAgICAgICBjYXNlIC51cGxvYWRGYWlsZWQ6CiAgICAgICAgICAgIHJldHVybiAiVXBsb2FkIGZhaWxlZCIKICAgICAgICB9CiAgICB9Cn0KCi8vIE1BUks6IC0gSW1hZ2UgUGlja2VyIChpT1Mgb25seSkKCiNpZiBvcyhpT1MpCmltcG9ydCBQaG90b3NVSQoKc3RydWN0IEltYWdlUGlja2VyOiBWaWV3IHsKICAgIEBCaW5kaW5nIHZhciBzZWxlY3RlZEltYWdlRGF0YTogRGF0YT8KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzZWxlY3RlZEl0ZW06IFBob3Rvc1BpY2tlckl0ZW0/CiAgICBARW52aXJvbm1lbnQoXC5kaXNtaXNzKSBwcml2YXRlIHZhciBkaXNtaXNzCiAgICAKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIE5hdmlnYXRpb25WaWV3IHsKICAgICAgICAgICAgVlN0YWNrIHsKICAgICAgICAgICAgICAgIFBob3Rvc1BpY2tlcihzZWxlY3Rpb246ICRzZWxlY3RlZEl0ZW0sIG1hdGNoaW5nOiAuaW1hZ2VzKSB7CiAgICAgICAgICAgICAgICAgICAgTGFiZWwoIlNlbGVjdCBJbWFnZSIsIHN5c3RlbUltYWdlOiAicGhvdG8iKQogICAgICAgICAgICAgICAgICAgICAgICAuZnJhbWUobWF4V2lkdGg6IC5pbmZpbml0eSkKICAgICAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5ibHVlKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC53aGl0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmNvcm5lclJhZGl1cyg4KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLm9uQ2hhbmdlKG9mOiBzZWxlY3RlZEl0ZW0pIHsgbmV3SXRlbSBpbgogICAgICAgICAgICAgICAgICAgIFRhc2sgewogICAgICAgICAgICAgICAgICAgICAgICBpZiBsZXQgZGF0YSA9IHRyeT8gYXdhaXQgbmV3SXRlbT8ubG9hZFRyYW5zZmVyYWJsZSh0eXBlOiBEYXRhLnNlbGYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSW1hZ2VEYXRhID0gZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzbWlzcygpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJTZWxlY3QgSW1hZ2UiKQogICAgICAgICAgICAubmF2aWdhdGlvbkJhclRpdGxlRGlzcGxheU1vZGUoLmlubGluZSkKICAgICAgICAgICAgLnRvb2xiYXIgewogICAgICAgICAgICAgICAgVG9vbGJhckl0ZW0ocGxhY2VtZW50OiAubmF2aWdhdGlvbkJhclRyYWlsaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDYW5jZWwiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc21pc3MoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQojZW5kaWYKCi8vIE1BUks6IC0gRG9jdW1lbnQgUGlja2VyIChDcm9zcy1wbGF0Zm9ybSkKCmltcG9ydCBVbmlmb3JtVHlwZUlkZW50aWZpZXJzCgpzdHJ1Y3QgRG9jdW1lbnRQaWNrZXI6IFZpZXcgewogICAgQEJpbmRpbmcgdmFyIHNlbGVjdGVkVVJMOiBVUkw/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaXNQcmVzZW50ZWQgPSBmYWxzZQogICAgQEVudmlyb25tZW50KFwuZGlzbWlzcykgcHJpdmF0ZSB2YXIgZGlzbWlzcwogICAgCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBCdXR0b24oIlNlbGVjdCBEb2N1bWVudCIpIHsKICAgICAgICAgICAgaXNQcmVzZW50ZWQgPSB0cnVlCiAgICAgICAgfQogICAgICAgIC5maWxlSW1wb3J0ZXIoCiAgICAgICAgICAgIGlzUHJlc2VudGVkOiAkaXNQcmVzZW50ZWQsCiAgICAgICAgICAgIGFsbG93ZWRDb250ZW50VHlwZXM6IFsuaXRlbV0sCiAgICAgICAgICAgIGFsbG93c011bHRpcGxlU2VsZWN0aW9uOiBmYWxzZQogICAgICAgICkgeyByZXN1bHQgaW4KICAgICAgICAgICAgc3dpdGNoIHJlc3VsdCB7CiAgICAgICAgICAgIGNhc2UgLnN1Y2Nlc3MobGV0IHVybHMpOgogICAgICAgICAgICAgICAgc2VsZWN0ZWRVUkwgPSB1cmxzLmZpcnN0CiAgICAgICAgICAgICAgICBkaXNtaXNzKCkKICAgICAgICAgICAgY2FzZSAuZmFpbHVyZToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0=
--- END ---

--- FILE: MacChan/Managers/AuthenticationManager.swift ---
BASE64: Ly8KLy8gIEF1dGhlbnRpY2F0aW9uTWFuYWdlci5zd2lmdAovLyAgTWFjQ2hhbgovLwovLyAgTk9URSBUTyBERVZFTE9QRVI6IFRoaXMgZmlsZSBjb250YWlucyBpT1Mtc3BlY2lmaWMgY29kZSAoQXV0aGVudGljYXRpb25TZXJ2aWNlcyBmcmFtZXdvcmspLgovLyAgV2hlbiBhZGRpbmcgbmV3IGNvZGUsIGVuc3VyZSBpdCdzIGlPUy1jb21wYXRpYmxlIG9ubHkuIFVzZSBjb25kaXRpb25hbCBjb21waWxhdGlvbgovLyAgZm9yIG1hY09TIGFsdGVybmF0aXZlcyBpZiBuZWVkZWQuCi8vCi8vICBDcmVhdGVkIGJ5IEphcmVkIE1heHdlbGwgb24gOS8zLzI1LgovLwoKaW1wb3J0IEZvdW5kYXRpb24KaW1wb3J0IEF1dGhlbnRpY2F0aW9uU2VydmljZXMKaW1wb3J0IENsb3VkS2l0CmltcG9ydCBTd2lmdFVJCgpATWFpbkFjdG9yCmNsYXNzIEF1dGhlbnRpY2F0aW9uTWFuYWdlcjogTlNPYmplY3QsIE9ic2VydmFibGVPYmplY3QgewogICAgc3RhdGljIGxldCBzaGFyZWQgPSBBdXRoZW50aWNhdGlvbk1hbmFnZXIoKQogICAgCiAgICBAUHVibGlzaGVkIHZhciBpc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZQogICAgQFB1Ymxpc2hlZCB2YXIgY3VycmVudFVzZXI6IEZvcnVtVXNlcj8KICAgIEBQdWJsaXNoZWQgdmFyIGVycm9yTWVzc2FnZTogU3RyaW5nPwogICAgQFB1Ymxpc2hlZCB2YXIgaXNMb2FkaW5nID0gZmFsc2UKICAgIEBQdWJsaXNoZWQgdmFyIGF1dGhDaGVja2VkID0gZmFsc2UgLy8gVHJhY2sgaWYgd2UndmUgY2hlY2tlZCBhdXRoZW50aWNhdGlvbiBzdGF0dXMKCiAgICBwcml2YXRlIGxldCBjbG91ZEtpdE1hbmFnZXIgPSBDbG91ZEtpdE1hbmFnZXIuc2hhcmVkCgogICAgcHJpdmF0ZSBvdmVycmlkZSBpbml0KCkgewogICAgICAgIHN1cGVyLmluaXQoKQogICAgICAgIC8vIERvbid0IGF1dG9tYXRpY2FsbHkgY2hlY2sgYXV0aGVudGljYXRpb24gLSByZXF1aXJlIG1hbnVhbCBsb2dpbgogICAgfQogICAgCiAgICBmdW5jIGNoZWNrQXV0aGVudGljYXRpb25TdGF0dXMoKSB7CiAgICAgICAgVGFzayB7CiAgICAgICAgICAgIGF3YWl0IE1haW5BY3Rvci5ydW4gewogICAgICAgICAgICAgICAgc2VsZi5pc0xvYWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICBzZWxmLmVycm9yTWVzc2FnZSA9IG5pbAogICAgICAgICAgICB9CgogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGhhcyBhIENsb3VkS2l0IGFjY291bnQgKGluZGVwZW5kZW50IG9mIGF1dGhlbnRpY2F0aW9uKQogICAgICAgICAgICAgICAgbGV0IGFjY291bnRTdGF0dXMgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNvbnRhaW5lci5hY2NvdW50U3RhdHVzKCkKCiAgICAgICAgICAgICAgICBpZiBhY2NvdW50U3RhdHVzID09IC5hdmFpbGFibGUgewogICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBmZXRjaCBleGlzdGluZyB1c2VyIGZyb20gQ2xvdWRLaXQKICAgICAgICAgICAgICAgICAgICBsZXQgdXNlcklEID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5jb250YWluZXIudXNlclJlY29yZElEKCkKICAgICAgICAgICAgICAgICAgICBsZXQgdXNlciA9IHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuZmV0Y2hVc2VyKHVzZXJJRC5yZWNvcmROYW1lKQoKICAgICAgICAgICAgICAgICAgICBhd2FpdCBNYWluQWN0b3IucnVuIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50VXNlciA9IHVzZXIKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5pc0F1dGhlbnRpY2F0ZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXV0aENoZWNrZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaXNMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIE5vIENsb3VkS2l0IGFjY291bnQKICAgICAgICAgICAgICAgICAgICBhd2FpdCBNYWluQWN0b3IucnVuIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5pc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRVc2VyID0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYXV0aENoZWNrZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaXNMb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5lcnJvck1lc3NhZ2UgPSBnZXRBY2NvdW50U3RhdHVzRXJyb3JNZXNzYWdlKGFjY291bnRTdGF0dXMpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIGxldCBlcnJvciBhcyBDS0Vycm9yIHsKICAgICAgICAgICAgICAgIGF3YWl0IE1haW5BY3Rvci5ydW4gewogICAgICAgICAgICAgICAgICAgIHNlbGYuaXNBdXRoZW50aWNhdGVkID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRVc2VyID0gbmlsCiAgICAgICAgICAgICAgICAgICAgc2VsZi5hdXRoQ2hlY2tlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICBzZWxmLmlzTG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgc2VsZi5lcnJvck1lc3NhZ2UgPSBnZXRDbG91ZEtpdEVycm9yTWVzc2FnZShlcnJvcikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICBhd2FpdCBNYWluQWN0b3IucnVuIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLmlzQXV0aGVudGljYXRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50VXNlciA9IG5pbAogICAgICAgICAgICAgICAgICAgIHNlbGYuYXV0aENoZWNrZWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgc2VsZi5pc0xvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIHNlbGYuZXJyb3JNZXNzYWdlID0gIkF1dGhlbnRpY2F0aW9uIGZhaWxlZDogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBmdW5jIGdldEFjY291bnRTdGF0dXNFcnJvck1lc3NhZ2UoXyBzdGF0dXM6IENLQWNjb3VudFN0YXR1cykgLT4gU3RyaW5nIHsKICAgICAgICBzd2l0Y2ggc3RhdHVzIHsKICAgICAgICBjYXNlIC5ub0FjY291bnQ6CiAgICAgICAgICAgIHJldHVybiAiTm8gaUNsb3VkIGFjY291bnQgZm91bmQuIFBsZWFzZSBzaWduIGluIHRvIGlDbG91ZCBpbiBTeXN0ZW0gU2V0dGluZ3MgYW5kIHRyeSBhZ2Fpbi4iCiAgICAgICAgY2FzZSAucmVzdHJpY3RlZDoKICAgICAgICAgICAgcmV0dXJuICJZb3VyIGlDbG91ZCBhY2NvdW50IGhhcyByZXN0cmljdGlvbnMuIFBsZWFzZSBjaGVjayB5b3VyIGFjY291bnQgc2V0dGluZ3MuIgogICAgICAgIGNhc2UgLmNvdWxkTm90RGV0ZXJtaW5lOgogICAgICAgICAgICByZXR1cm4gIlVuYWJsZSB0byB2ZXJpZnkgeW91ciBpQ2xvdWQgYWNjb3VudCBzdGF0dXMuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24uIgogICAgICAgIGNhc2UgLnRlbXBvcmFyaWx5VW5hdmFpbGFibGU6CiAgICAgICAgICAgIHJldHVybiAiaUNsb3VkIHNlcnZpY2VzIGFyZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4iCiAgICAgICAgY2FzZSAuYXZhaWxhYmxlOgogICAgICAgICAgICByZXR1cm4gIiIgLy8gVGhpcyBzaG91bGRuJ3QgaGFwcGVuIGhlcmUKICAgICAgICBAdW5rbm93biBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm4gIlVua25vd24gaUNsb3VkIGFjY291bnQgc3RhdHVzLiBQbGVhc2UgdHJ5IGFnYWluLiIKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBmdW5jIGdldENsb3VkS2l0RXJyb3JNZXNzYWdlKF8gZXJyb3I6IENLRXJyb3IpIC0+IFN0cmluZyB7CiAgICAgICAgc3dpdGNoIGVycm9yLmNvZGUgewogICAgICAgIGNhc2UgLm5ldHdvcmtVbmF2YWlsYWJsZToKICAgICAgICAgICAgcmV0dXJuICJOZXR3b3JrIGNvbm5lY3Rpb24gdW5hdmFpbGFibGUuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4iCiAgICAgICAgY2FzZSAubm90QXV0aGVudGljYXRlZDoKICAgICAgICAgICAgcmV0dXJuICJpQ2xvdWQgYXV0aGVudGljYXRpb24gZmFpbGVkLiBQbGVhc2Ugc2lnbiBpbiB0byBpQ2xvdWQgYW5kIHRyeSBhZ2Fpbi4iCiAgICAgICAgY2FzZSAubmV0d29ya0ZhaWx1cmU6CiAgICAgICAgICAgIHJldHVybiAiTmV0d29yayBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIGNoZWNrIHlvdXIgY29ubmVjdGlvbiBhbmQgdHJ5IGFnYWluLiIKICAgICAgICBjYXNlIC5zZXJ2aWNlVW5hdmFpbGFibGU6CiAgICAgICAgICAgIHJldHVybiAiaUNsb3VkIHNlcnZpY2UgaXMgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuIgogICAgICAgIGNhc2UgLnJlcXVlc3RSYXRlTGltaXRlZDoKICAgICAgICAgICAgcmV0dXJuICJUb28gbWFueSByZXF1ZXN0cy4gUGxlYXNlIHdhaXQgYSBtb21lbnQgYW5kIHRyeSBhZ2Fpbi4iCiAgICAgICAgY2FzZSAuem9uZU5vdEZvdW5kOgogICAgICAgICAgICByZXR1cm4gImlDbG91ZCBkYXRhIHpvbmUgbm90IGZvdW5kLiBQbGVhc2UgdHJ5IHNpZ25pbmcgb3V0IGFuZCBiYWNrIGluLiIKICAgICAgICBjYXNlIC51c2VyRGVsZXRlZFpvbmU6CiAgICAgICAgICAgIHJldHVybiAiWW91ciBpQ2xvdWQgZGF0YSBoYXMgYmVlbiByZXNldC4gUGxlYXNlIHNpZ24gaW4gYWdhaW4gdG8gcmVjcmVhdGUgeW91ciBhY2NvdW50LiIKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm4gIkF1dGhlbnRpY2F0aW9uIGZhaWxlZDogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmMgc2lnbk91dCgpIHsKICAgICAgICBwcmludCgi8J+RpCBVc2VyIHNpZ25pbmcgb3V0Li4uIikKICAgICAgICBpc0F1dGhlbnRpY2F0ZWQgPSBmYWxzZQogICAgICAgIGN1cnJlbnRVc2VyID0gbmlsCiAgICAgICAgZXJyb3JNZXNzYWdlID0gbmlsCiAgICAgICAgYXV0aENoZWNrZWQgPSBmYWxzZQogICAgICAgIGNsb3VkS2l0TWFuYWdlci5zaWduT3V0KCkKICAgIH0KCiAgICBmdW5jIHNpZ25JbldpdGhBcHBsZSgpIHsKICAgICAgICBpc0xvYWRpbmcgPSB0cnVlCiAgICAgICAgZXJyb3JNZXNzYWdlID0gbmlsCiAgICAgICAgCiAgICAgICAgbGV0IHJlcXVlc3QgPSBBU0F1dGhvcml6YXRpb25BcHBsZUlEUHJvdmlkZXIoKS5jcmVhdGVSZXF1ZXN0KCkKICAgICAgICByZXF1ZXN0LnJlcXVlc3RlZFNjb3BlcyA9IFsuZnVsbE5hbWUsIC5lbWFpbF0KICAgICAgICAKICAgICAgICBsZXQgY29udHJvbGxlciA9IEFTQXV0aG9yaXphdGlvbkNvbnRyb2xsZXIoYXV0aG9yaXphdGlvblJlcXVlc3RzOiBbcmVxdWVzdF0pCiAgICAgICAgY29udHJvbGxlci5kZWxlZ2F0ZSA9IHNlbGYKICAgICAgICBjb250cm9sbGVyLnByZXNlbnRhdGlvbkNvbnRleHRQcm92aWRlciA9IHNlbGYKICAgICAgICAKICAgICAgICBjb250cm9sbGVyLnBlcmZvcm1SZXF1ZXN0cygpCiAgICB9CgogICAgZnVuYyBoYW5kbGVTdWNjZXNzZnVsU2lnbkluKGNyZWRlbnRpYWw6IEFTQXV0aG9yaXphdGlvbkFwcGxlSURDcmVkZW50aWFsKSB7CiAgICAgICAgVGFzayB7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIGxldCB1c2VyID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5jcmVhdGVPclVwZGF0ZVVzZXIoZnJvbTogY3JlZGVudGlhbCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50VXNlciA9IHVzZXIKICAgICAgICAgICAgICAgICAgICBzZWxmLmlzQXV0aGVudGljYXRlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICBzZWxmLmlzTG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5lcnJvck1lc3NhZ2UgPSAiRmFpbGVkIHRvIGNyZWF0ZSB1c2VyOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICAgICAgICAgICAgICBzZWxmLmlzTG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCi8vIE1BUks6IC0gQVNBdXRob3JpemF0aW9uQ29udHJvbGxlckRlbGVnYXRlCgpleHRlbnNpb24gQXV0aGVudGljYXRpb25NYW5hZ2VyOiBBU0F1dGhvcml6YXRpb25Db250cm9sbGVyRGVsZWdhdGUgewogICAgZnVuYyBhdXRob3JpemF0aW9uQ29udHJvbGxlcihjb250cm9sbGVyOiBBU0F1dGhvcml6YXRpb25Db250cm9sbGVyLCBkaWRDb21wbGV0ZVdpdGhBdXRob3JpemF0aW9uIGF1dGhvcml6YXRpb246IEFTQXV0aG9yaXphdGlvbikgewogICAgICAgIGlmIGxldCBhcHBsZUlEQ3JlZGVudGlhbCA9IGF1dGhvcml6YXRpb24uY3JlZGVudGlhbCBhcz8gQVNBdXRob3JpemF0aW9uQXBwbGVJRENyZWRlbnRpYWwgewogICAgICAgICAgICBoYW5kbGVTdWNjZXNzZnVsU2lnbkluKGNyZWRlbnRpYWw6IGFwcGxlSURDcmVkZW50aWFsKQogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuYyBhdXRob3JpemF0aW9uQ29udHJvbGxlcihjb250cm9sbGVyOiBBU0F1dGhvcml6YXRpb25Db250cm9sbGVyLCBkaWRDb21wbGV0ZVdpdGhFcnJvciBlcnJvcjogRXJyb3IpIHsKICAgICAgICBlcnJvck1lc3NhZ2UgPSAiU2lnbiBpbiBmYWlsZWQ6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIgogICAgICAgIGlzTG9hZGluZyA9IGZhbHNlCiAgICB9Cn0KCi8vIE1BUks6IC0gQVNBdXRob3JpemF0aW9uQ29udHJvbGxlclByZXNlbnRhdGlvbkNvbnRleHRQcm92aWRpbmcKCmV4dGVuc2lvbiBBdXRoZW50aWNhdGlvbk1hbmFnZXI6IEFTQXV0aG9yaXphdGlvbkNvbnRyb2xsZXJQcmVzZW50YXRpb25Db250ZXh0UHJvdmlkaW5nIHsKICAgIGZ1bmMgcHJlc2VudGF0aW9uQW5jaG9yKGZvciBjb250cm9sbGVyOiBBU0F1dGhvcml6YXRpb25Db250cm9sbGVyKSAtPiBBU1ByZXNlbnRhdGlvbkFuY2hvciB7CiAgICAgICAgI2lmIG9zKGlPUykKICAgICAgICBndWFyZCBsZXQgd2luZG93U2NlbmUgPSBVSUFwcGxpY2F0aW9uLnNoYXJlZC5jb25uZWN0ZWRTY2VuZXMuZmlyc3QgYXM/IFVJV2luZG93U2NlbmUsCiAgICAgICAgICAgICAgbGV0IHdpbmRvdyA9IHdpbmRvd1NjZW5lLndpbmRvd3MuZmlyc3QgZWxzZSB7CiAgICAgICAgICAgIGZhdGFsRXJyb3IoIk5vIHdpbmRvdyBhdmFpbGFibGUiKQogICAgICAgIH0KICAgICAgICByZXR1cm4gd2luZG93CiAgICAgICAgI2Vsc2VpZiBvcyhtYWNPUykKICAgICAgICBndWFyZCBsZXQgd2luZG93ID0gTlNBcHBsaWNhdGlvbi5zaGFyZWQua2V5V2luZG93IGVsc2UgewogICAgICAgICAgICBmYXRhbEVycm9yKCJObyB3aW5kb3cgYXZhaWxhYmxlIikKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHdpbmRvdwogICAgICAgICNlbHNlCiAgICAgICAgZmF0YWxFcnJvcigiVW5zdXBwb3J0ZWQgcGxhdGZvcm0iKQogICAgICAgICNlbmRpZgogICAgfQp9CgovLyBNQVJLOiAtIFVzZXIgTW9kZWwKLy8gTm90ZTogVXNlclByZWZlcmVuY2VzIGFuZCByZWxhdGVkIHN0cnVjdHMgYXJlIGRlZmluZWQgaW4gQ2xvdWRLaXRNb2RlbHMuc3dpZnQK
--- END ---

--- FILE: MacChan/Managers/NotificationManager.swift ---
BASE64: Ly8KLy8gIE5vdGlmaWNhdGlvbk1hbmFnZXIuc3dpZnQKLy8gIE1hY0NoYW4KLy8KLy8gIE5PVEUgVE8gREVWRUxPUEVSOiBUaGlzIGZpbGUgY29udGFpbnMgaU9TLXNwZWNpZmljIGNvZGUgKFVzZXJOb3RpZmljYXRpb25zIGZyYW1ld29yaykuCi8vICBXaGVuIGFkZGluZyBuZXcgY29kZSwgZW5zdXJlIGl0J3MgaU9TLWNvbXBhdGlibGUgb25seS4gVXNlIGNvbmRpdGlvbmFsIGNvbXBpbGF0aW9uCi8vICBmb3IgbWFjT1MgYWx0ZXJuYXRpdmVzIGlmIG5lZWRlZC4KLy8KLy8gIENyZWF0ZWQgYnkgSmFyZWQgTWF4d2VsbCBvbiA5LzMvMjUuCi8vCgppbXBvcnQgRm91bmRhdGlvbgppbXBvcnQgVXNlck5vdGlmaWNhdGlvbnMKaW1wb3J0IENsb3VkS2l0CmltcG9ydCBTd2lmdFVJCgpATWFpbkFjdG9yCmNsYXNzIE5vdGlmaWNhdGlvbk1hbmFnZXI6IE5TT2JqZWN0LCBPYnNlcnZhYmxlT2JqZWN0IHsKICAgIHN0YXRpYyBsZXQgc2hhcmVkID0gTm90aWZpY2F0aW9uTWFuYWdlcigpCiAgICAKICAgIEBQdWJsaXNoZWQgdmFyIGlzQXV0aG9yaXplZCA9IGZhbHNlCiAgICBAUHVibGlzaGVkIHZhciBhdXRob3JpemF0aW9uU3RhdHVzOiBVTkF1dGhvcml6YXRpb25TdGF0dXMgPSAubm90RGV0ZXJtaW5lZAogICAgCiAgICBwcml2YXRlIGxldCBjbG91ZEtpdE1hbmFnZXIgPSBDbG91ZEtpdE1hbmFnZXIuc2hhcmVkCiAgICAKICAgIHByaXZhdGUgb3ZlcnJpZGUgaW5pdCgpIHsKICAgICAgICBzdXBlci5pbml0KCkKICAgICAgICBVTlVzZXJOb3RpZmljYXRpb25DZW50ZXIuY3VycmVudCgpLmRlbGVnYXRlID0gc2VsZgogICAgICAgIFRhc2sgewogICAgICAgICAgICBhd2FpdCBjaGVja0F1dGhvcml6YXRpb25TdGF0dXMoKQogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuYyBjaGVja0F1dGhvcml6YXRpb25TdGF0dXMoKSBhc3luYyB7CiAgICAgICAgbGV0IHNldHRpbmdzID0gYXdhaXQgVU5Vc2VyTm90aWZpY2F0aW9uQ2VudGVyLmN1cnJlbnQoKS5ub3RpZmljYXRpb25TZXR0aW5ncygpCiAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgIHNlbGYuYXV0aG9yaXphdGlvblN0YXR1cyA9IHNldHRpbmdzLmF1dGhvcml6YXRpb25TdGF0dXMKICAgICAgICAgICAgc2VsZi5pc0F1dGhvcml6ZWQgPSBzZXR0aW5ncy5hdXRob3JpemF0aW9uU3RhdHVzID09IC5hdXRob3JpemVkCiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jIHJlcXVlc3ROb3RpZmljYXRpb25QZXJtaXNzaW9uKCkgYXN5bmMgLT4gQm9vbCB7CiAgICAgICAgZG8gewogICAgICAgICAgICBsZXQgZ3JhbnRlZCA9IHRyeSBhd2FpdCBVTlVzZXJOb3RpZmljYXRpb25DZW50ZXIuY3VycmVudCgpLnJlcXVlc3RBdXRob3JpemF0aW9uKG9wdGlvbnM6IFsuYWxlcnQsIC5iYWRnZSwgLnNvdW5kXSkKICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICBzZWxmLmlzQXV0aG9yaXplZCA9IGdyYW50ZWQKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZ3JhbnRlZAogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIHJlcXVlc3Qgbm90aWZpY2F0aW9uIHBlcm1pc3Npb246IFwoZXJyb3IpIikKICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jIHJlZ2lzdGVyRm9yUmVtb3RlTm90aWZpY2F0aW9ucygpIHsKICAgICAgICAjaWYgb3MoaU9TKQogICAgICAgIFVJQXBwbGljYXRpb24uc2hhcmVkLnJlZ2lzdGVyRm9yUmVtb3RlTm90aWZpY2F0aW9ucygpCiAgICAgICAgI2Vsc2VpZiBvcyhtYWNPUykKICAgICAgICBOU0FwcGxpY2F0aW9uLnNoYXJlZC5yZWdpc3RlckZvclJlbW90ZU5vdGlmaWNhdGlvbnMoKQogICAgICAgICNlbmRpZgogICAgfQogICAgCiAgICBmdW5jIHNldHVwQ2xvdWRLaXRTdWJzY3JpcHRpb25zKCkgYXN5bmMgewogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGNsb3VkS2l0TWFuYWdlci5jdXJyZW50VXNlciBlbHNlIHsgcmV0dXJuIH0KICAgICAgICAKICAgICAgICBkbyB7CiAgICAgICAgICAgIC8vIFN1YnNjcmliZSB0byBuZXcgcG9zdHMgaW4gdGhyZWFkcyB1c2VyIGlzIGZvbGxvd2luZwogICAgICAgICAgICBsZXQgcG9zdFN1YnNjcmlwdGlvbiA9IENLUXVlcnlTdWJzY3JpcHRpb24oCiAgICAgICAgICAgICAgICByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUucG9zdC5yYXdWYWx1ZSwKICAgICAgICAgICAgICAgIHByZWRpY2F0ZTogTlNQcmVkaWNhdGUoZm9ybWF0OiAidGhyZWFkSUQgSU4gJUAiLCBbXSksIC8vIFdpbGwgYmUgcG9wdWxhdGVkIHdpdGggdXNlcidzIGZvbGxvd2VkIHRocmVhZHMKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbklEOiAibmV3X3Bvc3RzX1woY3VycmVudFVzZXIuaWQpIiwKICAgICAgICAgICAgICAgIG9wdGlvbnM6IFsuZmlyZXNPblJlY29yZENyZWF0aW9uXQogICAgICAgICAgICApCiAgICAgICAgICAgIAogICAgICAgICAgICBsZXQgbm90aWZpY2F0aW9uSW5mbyA9IENLU3Vic2NyaXB0aW9uLk5vdGlmaWNhdGlvbkluZm8oKQogICAgICAgICAgICBub3RpZmljYXRpb25JbmZvLmFsZXJ0Qm9keSA9ICJOZXcgcG9zdCBpbiBhIHRocmVhZCB5b3UncmUgZm9sbG93aW5nIgogICAgICAgICAgICBub3RpZmljYXRpb25JbmZvLnNob3VsZEJhZGdlID0gdHJ1ZQogICAgICAgICAgICBub3RpZmljYXRpb25JbmZvLnNvdW5kTmFtZSA9ICJkZWZhdWx0IgogICAgICAgICAgICBwb3N0U3Vic2NyaXB0aW9uLm5vdGlmaWNhdGlvbkluZm8gPSBub3RpZmljYXRpb25JbmZvCiAgICAgICAgICAgIAogICAgICAgICAgICB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLnB1YmxpY0RhdGFiYXNlLnNhdmUocG9zdFN1YnNjcmlwdGlvbikKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFN1YnNjcmliZSB0byBwcml2YXRlIG1lc3NhZ2VzCiAgICAgICAgICAgIGxldCBtZXNzYWdlU3Vic2NyaXB0aW9uID0gQ0tRdWVyeVN1YnNjcmlwdGlvbigKICAgICAgICAgICAgICAgIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZS5wcml2YXRlTWVzc2FnZS5yYXdWYWx1ZSwKICAgICAgICAgICAgICAgIHByZWRpY2F0ZTogTlNQcmVkaWNhdGUoZm9ybWF0OiAicmVjaXBpZW50SUQgPT0gJUAiLCBjdXJyZW50VXNlci5pZCksCiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25JRDogInByaXZhdGVfbWVzc2FnZXNfXChjdXJyZW50VXNlci5pZCkiLAogICAgICAgICAgICAgICAgb3B0aW9uczogWy5maXJlc09uUmVjb3JkQ3JlYXRpb25dCiAgICAgICAgICAgICkKICAgICAgICAgICAgCiAgICAgICAgICAgIGxldCBtZXNzYWdlTm90aWZpY2F0aW9uSW5mbyA9IENLU3Vic2NyaXB0aW9uLk5vdGlmaWNhdGlvbkluZm8oKQogICAgICAgICAgICBtZXNzYWdlTm90aWZpY2F0aW9uSW5mby5hbGVydEJvZHkgPSAiWW91IGhhdmUgYSBuZXcgcHJpdmF0ZSBtZXNzYWdlIgogICAgICAgICAgICBtZXNzYWdlTm90aWZpY2F0aW9uSW5mby5zaG91bGRCYWRnZSA9IHRydWUKICAgICAgICAgICAgbWVzc2FnZU5vdGlmaWNhdGlvbkluZm8uc291bmROYW1lID0gImRlZmF1bHQiCiAgICAgICAgICAgIG1lc3NhZ2VTdWJzY3JpcHRpb24ubm90aWZpY2F0aW9uSW5mbyA9IG1lc3NhZ2VOb3RpZmljYXRpb25JbmZvCiAgICAgICAgICAgIAogICAgICAgICAgICB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLnByaXZhdGVEYXRhYmFzZS5zYXZlKG1lc3NhZ2VTdWJzY3JpcHRpb24pCiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBTdWJzY3JpYmUgdG8gbWVudGlvbnMKICAgICAgICAgICAgbGV0IG1lbnRpb25TdWJzY3JpcHRpb24gPSBDS1F1ZXJ5U3Vic2NyaXB0aW9uKAogICAgICAgICAgICAgICAgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLnBvc3QucmF3VmFsdWUsCiAgICAgICAgICAgICAgICBwcmVkaWNhdGU6IE5TUHJlZGljYXRlKGZvcm1hdDogImNvbnRlbnQgQ09OVEFJTlNbY2RdICVAIiwgIkBcKGN1cnJlbnRVc2VyLnVzZXJuYW1lKSIpLAogICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uSUQ6ICJtZW50aW9uc19cKGN1cnJlbnRVc2VyLmlkKSIsCiAgICAgICAgICAgICAgICBvcHRpb25zOiBbLmZpcmVzT25SZWNvcmRDcmVhdGlvbl0KICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IG1lbnRpb25Ob3RpZmljYXRpb25JbmZvID0gQ0tTdWJzY3JpcHRpb24uTm90aWZpY2F0aW9uSW5mbygpCiAgICAgICAgICAgIG1lbnRpb25Ob3RpZmljYXRpb25JbmZvLmFsZXJ0Qm9keSA9ICJZb3Ugd2VyZSBtZW50aW9uZWQgaW4gYSBwb3N0IgogICAgICAgICAgICBtZW50aW9uTm90aWZpY2F0aW9uSW5mby5zaG91bGRCYWRnZSA9IHRydWUKICAgICAgICAgICAgbWVudGlvbk5vdGlmaWNhdGlvbkluZm8uc291bmROYW1lID0gImRlZmF1bHQiCiAgICAgICAgICAgIG1lbnRpb25TdWJzY3JpcHRpb24ubm90aWZpY2F0aW9uSW5mbyA9IG1lbnRpb25Ob3RpZmljYXRpb25JbmZvCiAgICAgICAgICAgIAogICAgICAgICAgICB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLnB1YmxpY0RhdGFiYXNlLnNhdmUobWVudGlvblN1YnNjcmlwdGlvbikKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFN1YnNjcmliZSB0byB0aHJlYWQgdXBkYXRlcyAocmVwbGllcyB0byB1c2VyJ3MgdGhyZWFkcykKICAgICAgICAgICAgbGV0IHRocmVhZFN1YnNjcmlwdGlvbiA9IENLUXVlcnlTdWJzY3JpcHRpb24oCiAgICAgICAgICAgICAgICByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUucG9zdC5yYXdWYWx1ZSwKICAgICAgICAgICAgICAgIHByZWRpY2F0ZTogTlNQcmVkaWNhdGUoZm9ybWF0OiAidGhyZWFkSUQgSU4gJUAiLCBbXSksIC8vIFdpbGwgYmUgcG9wdWxhdGVkIHdpdGggdXNlcidzIGNyZWF0ZWQgdGhyZWFkcwogICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uSUQ6ICJ0aHJlYWRfcmVwbGllc19cKGN1cnJlbnRVc2VyLmlkKSIsCiAgICAgICAgICAgICAgICBvcHRpb25zOiBbLmZpcmVzT25SZWNvcmRDcmVhdGlvbl0KICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IHRocmVhZE5vdGlmaWNhdGlvbkluZm8gPSBDS1N1YnNjcmlwdGlvbi5Ob3RpZmljYXRpb25JbmZvKCkKICAgICAgICAgICAgdGhyZWFkTm90aWZpY2F0aW9uSW5mby5hbGVydEJvZHkgPSAiTmV3IHJlcGx5IHRvIHlvdXIgdGhyZWFkIgogICAgICAgICAgICB0aHJlYWROb3RpZmljYXRpb25JbmZvLnNob3VsZEJhZGdlID0gdHJ1ZQogICAgICAgICAgICB0aHJlYWROb3RpZmljYXRpb25JbmZvLnNvdW5kTmFtZSA9ICJkZWZhdWx0IgogICAgICAgICAgICB0aHJlYWRTdWJzY3JpcHRpb24ubm90aWZpY2F0aW9uSW5mbyA9IHRocmVhZE5vdGlmaWNhdGlvbkluZm8KICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIucHVibGljRGF0YWJhc2Uuc2F2ZSh0aHJlYWRTdWJzY3JpcHRpb24pCiAgICAgICAgICAgIAogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIHNldHVwIENsb3VkS2l0IHN1YnNjcmlwdGlvbnM6IFwoZXJyb3IpIikKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmMgc2VuZExvY2FsTm90aWZpY2F0aW9uKHRpdGxlOiBTdHJpbmcsIGJvZHk6IFN0cmluZywgdXNlckluZm86IFtTdHJpbmc6IEFueV0gPSBbOl0pIHsKICAgICAgICBsZXQgY29udGVudCA9IFVOTXV0YWJsZU5vdGlmaWNhdGlvbkNvbnRlbnQoKQogICAgICAgIGNvbnRlbnQudGl0bGUgPSB0aXRsZQogICAgICAgIGNvbnRlbnQuYm9keSA9IGJvZHkKICAgICAgICBjb250ZW50LnVzZXJJbmZvID0gdXNlckluZm8KICAgICAgICBjb250ZW50LnNvdW5kID0gLmRlZmF1bHQKICAgICAgICAKICAgICAgICBsZXQgcmVxdWVzdCA9IFVOTm90aWZpY2F0aW9uUmVxdWVzdCgKICAgICAgICAgICAgaWRlbnRpZmllcjogVVVJRCgpLnV1aWRTdHJpbmcsCiAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsCiAgICAgICAgICAgIHRyaWdnZXI6IG5pbAogICAgICAgICkKICAgICAgICAKICAgICAgICBVTlVzZXJOb3RpZmljYXRpb25DZW50ZXIuY3VycmVudCgpLmFkZChyZXF1ZXN0KSB7IGVycm9yIGluCiAgICAgICAgICAgIGlmIGxldCBlcnJvciA9IGVycm9yIHsKICAgICAgICAgICAgICAgIHByaW50KCJGYWlsZWQgdG8gc2VuZCBsb2NhbCBub3RpZmljYXRpb246IFwoZXJyb3IpIikKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuYyBzY2hlZHVsZU5vdGlmaWNhdGlvbih0aXRsZTogU3RyaW5nLCBib2R5OiBTdHJpbmcsIHRpbWVJbnRlcnZhbDogVGltZUludGVydmFsLCB1c2VySW5mbzogW1N0cmluZzogQW55XSA9IFs6XSkgewogICAgICAgIGxldCBjb250ZW50ID0gVU5NdXRhYmxlTm90aWZpY2F0aW9uQ29udGVudCgpCiAgICAgICAgY29udGVudC50aXRsZSA9IHRpdGxlCiAgICAgICAgY29udGVudC5ib2R5ID0gYm9keQogICAgICAgIGNvbnRlbnQudXNlckluZm8gPSB1c2VySW5mbwogICAgICAgIGNvbnRlbnQuc291bmQgPSAuZGVmYXVsdAogICAgICAgIAogICAgICAgIGxldCB0cmlnZ2VyID0gVU5UaW1lSW50ZXJ2YWxOb3RpZmljYXRpb25UcmlnZ2VyKHRpbWVJbnRlcnZhbDogdGltZUludGVydmFsLCByZXBlYXRzOiBmYWxzZSkKICAgICAgICBsZXQgcmVxdWVzdCA9IFVOTm90aWZpY2F0aW9uUmVxdWVzdCgKICAgICAgICAgICAgaWRlbnRpZmllcjogVVVJRCgpLnV1aWRTdHJpbmcsCiAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsCiAgICAgICAgICAgIHRyaWdnZXI6IHRyaWdnZXIKICAgICAgICApCiAgICAgICAgCiAgICAgICAgVU5Vc2VyTm90aWZpY2F0aW9uQ2VudGVyLmN1cnJlbnQoKS5hZGQocmVxdWVzdCkgeyBlcnJvciBpbgogICAgICAgICAgICBpZiBsZXQgZXJyb3IgPSBlcnJvciB7CiAgICAgICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIHNjaGVkdWxlIG5vdGlmaWNhdGlvbjogXChlcnJvcikiKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jIGNsZWFyQmFkZ2VDb3VudCgpIHsKICAgICAgICBVTlVzZXJOb3RpZmljYXRpb25DZW50ZXIuY3VycmVudCgpLnNldEJhZGdlQ291bnQoMCkKICAgIH0KICAgIAogICAgZnVuYyBjbGVhckFsbE5vdGlmaWNhdGlvbnMoKSB7CiAgICAgICAgVU5Vc2VyTm90aWZpY2F0aW9uQ2VudGVyLmN1cnJlbnQoKS5yZW1vdmVBbGxQZW5kaW5nTm90aWZpY2F0aW9uUmVxdWVzdHMoKQogICAgICAgIFVOVXNlck5vdGlmaWNhdGlvbkNlbnRlci5jdXJyZW50KCkucmVtb3ZlQWxsRGVsaXZlcmVkTm90aWZpY2F0aW9ucygpCiAgICB9CiAgICAKICAgIGZ1bmMgaGFuZGxlQ2xvdWRLaXROb3RpZmljYXRpb24oXyB1c2VySW5mbzogW1N0cmluZzogQW55XSkgYXN5bmMgewogICAgICAgIGd1YXJkIGxldCBub3RpZmljYXRpb24gPSBDS05vdGlmaWNhdGlvbihmcm9tUmVtb3RlTm90aWZpY2F0aW9uRGljdGlvbmFyeTogdXNlckluZm8pIGVsc2UgeyByZXR1cm4gfQogICAgICAgIAogICAgICAgIHN3aXRjaCBub3RpZmljYXRpb24ubm90aWZpY2F0aW9uVHlwZSB7CiAgICAgICAgY2FzZSAucXVlcnk6CiAgICAgICAgICAgIGlmIGxldCBxdWVyeU5vdGlmaWNhdGlvbiA9IG5vdGlmaWNhdGlvbiBhcz8gQ0tRdWVyeU5vdGlmaWNhdGlvbiB7CiAgICAgICAgICAgICAgICBhd2FpdCBoYW5kbGVRdWVyeU5vdGlmaWNhdGlvbihxdWVyeU5vdGlmaWNhdGlvbikKICAgICAgICAgICAgfQogICAgICAgIGNhc2UgLmRhdGFiYXNlOgogICAgICAgICAgICBpZiBsZXQgZGF0YWJhc2VOb3RpZmljYXRpb24gPSBub3RpZmljYXRpb24gYXM/IENLRGF0YWJhc2VOb3RpZmljYXRpb24gewogICAgICAgICAgICAgICAgYXdhaXQgaGFuZGxlRGF0YWJhc2VOb3RpZmljYXRpb24oZGF0YWJhc2VOb3RpZmljYXRpb24pCiAgICAgICAgICAgIH0KICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhawogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGhhbmRsZVF1ZXJ5Tm90aWZpY2F0aW9uKF8gbm90aWZpY2F0aW9uOiBDS1F1ZXJ5Tm90aWZpY2F0aW9uKSBhc3luYyB7CiAgICAgICAgZ3VhcmQgbGV0IHJlY29yZElEID0gbm90aWZpY2F0aW9uLnJlY29yZElEIGVsc2UgeyByZXR1cm4gfQogICAgICAgIAogICAgICAgIGRvIHsKICAgICAgICAgICAgbGV0IHJlY29yZCA9IHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIucHVibGljRGF0YWJhc2UucmVjb3JkKGZvcjogcmVjb3JkSUQpCiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBVcGRhdGUgVUkgYmFzZWQgb24gdGhlIHJlY29yZCB0eXBlCiAgICAgICAgICAgIHN3aXRjaCByZWNvcmQucmVjb3JkVHlwZSB7CiAgICAgICAgICAgIGNhc2UgQ2xvdWRLaXRSZWNvcmRUeXBlLnBvc3QucmF3VmFsdWU6CiAgICAgICAgICAgICAgICAvLyBSZWZyZXNoIHBvc3RzIGxpc3QKICAgICAgICAgICAgICAgIGF3YWl0IE1haW5BY3Rvci5ydW4gewogICAgICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgVUkgdXBkYXRlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgQ2xvdWRLaXRSZWNvcmRUeXBlLnByaXZhdGVNZXNzYWdlLnJhd1ZhbHVlOgogICAgICAgICAgICAgICAgLy8gUmVmcmVzaCBtZXNzYWdlcyBsaXN0CiAgICAgICAgICAgICAgICBhd2FpdCBNYWluQWN0b3IucnVuIHsKICAgICAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIFVJIHVwZGF0ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIGZldGNoIHJlY29yZCBmcm9tIG5vdGlmaWNhdGlvbjogXChlcnJvcikiKQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGhhbmRsZURhdGFiYXNlTm90aWZpY2F0aW9uKF8gbm90aWZpY2F0aW9uOiBDS0RhdGFiYXNlTm90aWZpY2F0aW9uKSBhc3luYyB7CiAgICAgICAgLy8gSGFuZGxlIGRhdGFiYXNlLWxldmVsIGNoYW5nZXMKICAgICAgICBwcmludCgiRGF0YWJhc2Ugbm90aWZpY2F0aW9uIHJlY2VpdmVkIikKICAgIH0KfQoKLy8gTUFSSzogLSBVTlVzZXJOb3RpZmljYXRpb25DZW50ZXJEZWxlZ2F0ZQoKZXh0ZW5zaW9uIE5vdGlmaWNhdGlvbk1hbmFnZXI6IFVOVXNlck5vdGlmaWNhdGlvbkNlbnRlckRlbGVnYXRlIHsKICAgIG5vbmlzb2xhdGVkIGZ1bmMgdXNlck5vdGlmaWNhdGlvbkNlbnRlcihfIGNlbnRlcjogVU5Vc2VyTm90aWZpY2F0aW9uQ2VudGVyLCB3aWxsUHJlc2VudCBub3RpZmljYXRpb246IFVOTm90aWZpY2F0aW9uLCB3aXRoQ29tcGxldGlvbkhhbmRsZXIgY29tcGxldGlvbkhhbmRsZXI6IEBlc2NhcGluZyAoVU5Ob3RpZmljYXRpb25QcmVzZW50YXRpb25PcHRpb25zKSAtPiBWb2lkKSB7CiAgICAgICAgLy8gU2hvdyBub3RpZmljYXRpb24gZXZlbiB3aGVuIGFwcCBpcyBpbiBmb3JlZ3JvdW5kCiAgICAgICAgY29tcGxldGlvbkhhbmRsZXIoWy5iYW5uZXIsIC5zb3VuZCwgLmJhZGdlXSkKICAgIH0KICAgIAogICAgbm9uaXNvbGF0ZWQgZnVuYyB1c2VyTm90aWZpY2F0aW9uQ2VudGVyKF8gY2VudGVyOiBVTlVzZXJOb3RpZmljYXRpb25DZW50ZXIsIGRpZFJlY2VpdmUgcmVzcG9uc2U6IFVOTm90aWZpY2F0aW9uUmVzcG9uc2UsIHdpdGhDb21wbGV0aW9uSGFuZGxlciBjb21wbGV0aW9uSGFuZGxlcjogQGVzY2FwaW5nICgpIC0+IFZvaWQpIHsKICAgICAgICBsZXQgdXNlckluZm8gPSByZXNwb25zZS5ub3RpZmljYXRpb24ucmVxdWVzdC5jb250ZW50LnVzZXJJbmZvCiAgICAgICAgCiAgICAgICAgLy8gSGFuZGxlIG5vdGlmaWNhdGlvbiB0YXAKICAgICAgICBpZiBsZXQgcmVjb3JkSUQgPSB1c2VySW5mb1siY2tSZWNvcmRJRCJdIGFzPyBTdHJpbmcgewogICAgICAgICAgICAvLyBOYXZpZ2F0ZSB0byBzcGVjaWZpYyByZWNvcmQKICAgICAgICAgICAgcHJpbnQoIk5hdmlnYXRlIHRvIHJlY29yZDogXChyZWNvcmRJRCkiKQogICAgICAgIH0KICAgICAgICAKICAgICAgICBjb21wbGV0aW9uSGFuZGxlcigpCiAgICB9Cn0=
--- END ---

--- FILE: MacChan/Managers/MessageManager.swift ---
BASE64: Ly8KLy8gIE1lc3NhZ2VNYW5hZ2VyLnN3aWZ0Ci8vICBNYWNDaGFuCi8vCi8vICBOT1RFIFRPIERFVkVMT1BFUjogVGhpcyBmaWxlIGNvbnRhaW5zIGlPUy1zcGVjaWZpYyBjb2RlIChNZXNzYWdlVUkgZnJhbWV3b3JrKS4KLy8gIFdoZW4gYWRkaW5nIG5ldyBjb2RlLCBlbnN1cmUgaXQncyBpT1MtY29tcGF0aWJsZSBvbmx5LiBVc2UgY29uZGl0aW9uYWwgY29tcGlsYXRpb24KLy8gIGZvciBtYWNPUyBhbHRlcm5hdGl2ZXMgaWYgbmVlZGVkLgovLwovLyAgQ3Jvc3PigJFwbGF0Zm9ybSBtZXNzYWdpbmcgZmFjYWRlOgovLyAgLSBpT1M6IE1lc3NhZ2VVSSAoTUZNZXNzYWdlQ29tcG9zZVZpZXdDb250cm9sbGVyKQovLyAgLSBtYWNPUzogTlNTaGFyaW5nU2VydmljZS5jb21wb3NlTWVzc2FnZSAoTWVzc2FnZXMgYXBwKQovLwoKaW1wb3J0IEZvdW5kYXRpb24KaW1wb3J0IFN3aWZ0VUkKCnByb3RvY29sIE1lc3NhZ2VTZW5kaW5nOiBBbnlPYmplY3QgewoJZnVuYyBjYW5TZW5kKCkgLT4gQm9vbAoJZnVuYyBzZW5kTWVzc2FnZShib2R5OiBTdHJpbmcsIHJlY2lwaWVudHM6IFtTdHJpbmddLCBmcm9tIHByZXNlbnRlcjogUHJlc2VudGVyKQp9CgovLyBQcmVzZW50ZXIgYWJzdHJhY3Rpb24gc28gd2UgY2FuIHByZXNlbnQgVUkgYXBwcm9wcmlhdGVseSBwZXIgcGxhdGZvcm0KZW51bSBQcmVzZW50ZXIgewoJY2FzZSBzd2lmdFVJKF8gZGlzbWlzczogKCgpIC0+IFZvaWQpPyA9IG5pbCkKCSNpZiBvcyhpT1MpCgljYXNlIHVpVmlld0NvbnRyb2xsZXIoXyB2YzogVUlWaWV3Q29udHJvbGxlcikKCSNlbmRpZgoJI2lmIG9zKG1hY09TKQoJY2FzZSBhcHBLaXRXaW5kb3coXyB3aW5kb3c6IE5TV2luZG93KQoJI2VuZGlmCgljYXNlIG5vbmUKfQoKQE1haW5BY3RvcgpmaW5hbCBjbGFzcyBNZXNzYWdlTWFuYWdlcjogT2JzZXJ2YWJsZU9iamVjdCB7CglzdGF0aWMgbGV0IHNoYXJlZCA9IE1lc3NhZ2VNYW5hZ2VyKCkKCglwcml2YXRlIGxldCBzZW5kZXI6IE1lc3NhZ2VTZW5kaW5nCgoJaW5pdCgpIHsKCQkjaWYgb3MoaU9TKQoJCXNlbGYuc2VuZGVyID0gSU9TTWVzc2FnZVNlbmRlcigpCgkJI2Vsc2VpZiBvcyhtYWNPUykKCQlzZWxmLnNlbmRlciA9IE1hY01lc3NhZ2VTZW5kZXIoKQoJCSNlbHNlCgkJc2VsZi5zZW5kZXIgPSBOb29wTWVzc2FnZVNlbmRlcigpCgkJI2VuZGlmCgl9CgoJZnVuYyBjYW5TZW5kKCkgLT4gQm9vbCB7CgkJc2VuZGVyLmNhblNlbmQoKQoJfQoKCS8vIEZvciBTd2lmdFVJIGNhbGxlcnM6IHBhc3MgYC5zd2lmdFVJKClgIGFuZCB3ZSdsbCBkaXNjb3ZlciBhIHByZXNlbnRlciBpZiBuZWVkZWQuCglmdW5jIHByZXNlbnRDb21wb3Nlcihib2R5OiBTdHJpbmcsIHJlY2lwaWVudHM6IFtTdHJpbmddLCBwcmVzZW50ZXI6IFByZXNlbnRlciA9IC5zd2lmdFVJKCkpIHsKCQlndWFyZCBzZW5kZXIuY2FuU2VuZCgpIGVsc2UgeyByZXR1cm4gfQoJCXNlbmRlci5zZW5kTWVzc2FnZShib2R5OiBib2R5LCByZWNpcGllbnRzOiByZWNpcGllbnRzLCBmcm9tOiBwcmVzZW50ZXIpCgl9CgkKCS8vIENvbnZlbmllbmNlIG1ldGhvZHMgZm9yIGNvbW1vbiB1c2UgY2FzZXMKCWZ1bmMgc2VuZFZlcmlmaWNhdGlvbkNvZGUodG8gcGhvbmVOdW1iZXI6IFN0cmluZywgY29kZTogU3RyaW5nKSB7CgkJbGV0IGJvZHkgPSAiWW91ciBNYWNDaGFuIHZlcmlmaWNhdGlvbiBjb2RlIGlzOiBcKGNvZGUpLiBUaGlzIGNvZGUgd2lsbCBleHBpcmUgaW4gMTAgbWludXRlcy4iCgkJcHJlc2VudENvbXBvc2VyKGJvZHk6IGJvZHksIHJlY2lwaWVudHM6IFtwaG9uZU51bWJlcl0pCgl9CgkKCWZ1bmMgc2VuZEludml0YXRpb24odG8gcGhvbmVOdW1iZXI6IFN0cmluZywgZm9ydW1OYW1lOiBTdHJpbmcsIGludml0YXRpb25Db2RlOiBTdHJpbmcpIHsKCQlsZXQgYm9keSA9ICJZb3UndmUgYmVlbiBpbnZpdGVkIHRvIGpvaW4gXChmb3J1bU5hbWUpIG9uIE1hY0NoYW4hIFVzZSBpbnZpdGF0aW9uIGNvZGU6IFwoaW52aXRhdGlvbkNvZGUpIHRvIHNpZ24gdXAuIgoJCXByZXNlbnRDb21wb3Nlcihib2R5OiBib2R5LCByZWNpcGllbnRzOiBbcGhvbmVOdW1iZXJdKQoJfQoJCglmdW5jIHNoYXJlVGhyZWFkKF8gdGhyZWFkOiBGb3J1bVRocmVhZCkgewoJCWxldCBib2R5ID0gIkNoZWNrIG91dCB0aGlzIHRocmVhZDogXCh0aHJlYWQudGl0bGUpIG9uIE1hY0NoYW4hIgoJCXByZXNlbnRDb21wb3Nlcihib2R5OiBib2R5LCByZWNpcGllbnRzOiBbXSkKCX0KCQoJZnVuYyBzaGFyZVBvc3QoXyBwb3N0OiBGb3J1bVBvc3QpIHsKCQlsZXQgYm9keSA9ICJDaGVjayBvdXQgdGhpcyBwb3N0IG9uIE1hY0NoYW46IFwocG9zdC5jb250ZW50LnByZWZpeCgxMDApKS4uLiIKCQlwcmVzZW50Q29tcG9zZXIoYm9keTogYm9keSwgcmVjaXBpZW50czogW10pCgl9CgkKCWZ1bmMgc2VuZFByaXZhdGVNZXNzYWdlVmlhSU1lc3NhZ2UodG8gcGhvbmVOdW1iZXI6IFN0cmluZywgc3ViamVjdDogU3RyaW5nLCBjb250ZW50OiBTdHJpbmcpIHsKCQlsZXQgYm9keSA9ICJcKHN1YmplY3QpXG5cblwoY29udGVudCkiCgkJcHJlc2VudENvbXBvc2VyKGJvZHk6IGJvZHksIHJlY2lwaWVudHM6IFtwaG9uZU51bWJlcl0pCgl9CgkKCWZ1bmMgZ2VuZXJhdGVWZXJpZmljYXRpb25Db2RlKCkgLT4gU3RyaW5nIHsKCQlyZXR1cm4gU3RyaW5nKEludC5yYW5kb20oaW46IDEwMDAwMC4uLjk5OTk5OSkpCgl9CgkKCWZ1bmMgZ2VuZXJhdGVJbnZpdGF0aW9uQ29kZSgpIC0+IFN0cmluZyB7CgkJbGV0IGNoYXJhY3RlcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IgoJCXJldHVybiBTdHJpbmcoKDAuLjw4KS5tYXAgeyBfIGluIGNoYXJhY3RlcnMucmFuZG9tRWxlbWVudCgpISB9KQoJfQp9CgojaWYgb3MoaU9TKQppbXBvcnQgTWVzc2FnZVVJCmltcG9ydCBVSUtpdAoKcHJpdmF0ZSBmaW5hbCBjbGFzcyBJT1NNZXNzYWdlU2VuZGVyOiBOU09iamVjdCwgTWVzc2FnZVNlbmRpbmcsIE1GTWVzc2FnZUNvbXBvc2VWaWV3Q29udHJvbGxlckRlbGVnYXRlIHsKCglmdW5jIGNhblNlbmQoKSAtPiBCb29sIHsKCQlNRk1lc3NhZ2VDb21wb3NlVmlld0NvbnRyb2xsZXIuY2FuU2VuZFRleHQoKQoJfQoKCWZ1bmMgc2VuZE1lc3NhZ2UoYm9keTogU3RyaW5nLCByZWNpcGllbnRzOiBbU3RyaW5nXSwgZnJvbSBwcmVzZW50ZXI6IFByZXNlbnRlcikgewoJCWd1YXJkIE1GTWVzc2FnZUNvbXBvc2VWaWV3Q29udHJvbGxlci5jYW5TZW5kVGV4dCgpIGVsc2UgeyByZXR1cm4gfQoKCQlsZXQgY29tcG9zZXIgPSBNRk1lc3NhZ2VDb21wb3NlVmlld0NvbnRyb2xsZXIoKQoJCWNvbXBvc2VyLmJvZHkgPSBib2R5CgkJY29tcG9zZXIucmVjaXBpZW50cyA9IHJlY2lwaWVudHMKCQljb21wb3Nlci5tZXNzYWdlQ29tcG9zZURlbGVnYXRlID0gc2VsZgoKCQkvLyBGaW5kIGEgcHJlc2VudGVyIFZDCgkJbGV0IHByZXNlbnRGcm9tVkM6IFVJVmlld0NvbnRyb2xsZXI/ID0gewoJCQlzd2l0Y2ggcHJlc2VudGVyIHsKCQkJY2FzZSAudWlWaWV3Q29udHJvbGxlcihsZXQgdmMpOiByZXR1cm4gdmMKCQkJZGVmYXVsdDoKCQkJCXJldHVybiBVSUFwcGxpY2F0aW9uLnNoYXJlZC5jb25uZWN0ZWRTY2VuZXMKCQkJCQkuY29tcGFjdE1hcCB7ICQwIGFzPyBVSVdpbmRvd1NjZW5lIH0KCQkJCQkuZmxhdE1hcCB7ICQwLndpbmRvd3MgfQoJCQkJCS5maXJzdCB7ICQwLmlzS2V5V2luZG93IH0/CgkJCQkJLnJvb3RWaWV3Q29udHJvbGxlcgoJCQl9CgkJfSgpCgoJCWd1YXJkIGxldCB2YyA9IHByZXNlbnRGcm9tVkMgZWxzZSB7IHJldHVybiB9CgkJdmMucHJlc2VudChjb21wb3NlciwgYW5pbWF0ZWQ6IHRydWUpCgl9CgoJbm9uaXNvbGF0ZWQgZnVuYyBtZXNzYWdlQ29tcG9zZVZpZXdDb250cm9sbGVyKF8gY29udHJvbGxlcjogTUZNZXNzYWdlQ29tcG9zZVZpZXdDb250cm9sbGVyLCBkaWRGaW5pc2hXaXRoIHJlc3VsdDogTWVzc2FnZUNvbXBvc2VSZXN1bHQpIHsKCQljb250cm9sbGVyLmRpc21pc3MoYW5pbWF0ZWQ6IHRydWUpCgl9Cn0KI2VuZGlmCgojaWYgb3MobWFjT1MpCmltcG9ydCBBcHBLaXQKCnByaXZhdGUgZmluYWwgY2xhc3MgTWFjTWVzc2FnZVNlbmRlcjogTlNPYmplY3QsIE1lc3NhZ2VTZW5kaW5nIHsKCglmdW5jIGNhblNlbmQoKSAtPiBCb29sIHsKCQlOU1NoYXJpbmdTZXJ2aWNlKG5hbWVkOiAuY29tcG9zZU1lc3NhZ2UpICE9IG5pbAoJfQoKCWZ1bmMgc2VuZE1lc3NhZ2UoYm9keTogU3RyaW5nLCByZWNpcGllbnRzOiBbU3RyaW5nXSwgZnJvbSBwcmVzZW50ZXI6IFByZXNlbnRlcikgewoJCWd1YXJkIGxldCBzZXJ2aWNlID0gTlNTaGFyaW5nU2VydmljZShuYW1lZDogLmNvbXBvc2VNZXNzYWdlKSBlbHNlIHsgcmV0dXJuIH0KCQlzZXJ2aWNlLnJlY2lwaWVudHMgPSByZWNpcGllbnRzCgkJc2VydmljZS5wZXJmb3JtKHdpdGhJdGVtczogW2JvZHldKQoJfQp9CiNlbmRpZgoKLy8gRmFsbGJhY2sgKHdhdGNoT1MvdHZPUy91bmtub3duKQpwcml2YXRlIGZpbmFsIGNsYXNzIE5vb3BNZXNzYWdlU2VuZGVyOiBNZXNzYWdlU2VuZGluZyB7CglmdW5jIGNhblNlbmQoKSAtPiBCb29sIHsgZmFsc2UgfQoJZnVuYyBzZW5kTWVzc2FnZShib2R5OiBTdHJpbmcsIHJlY2lwaWVudHM6IFtTdHJpbmddLCBmcm9tIHByZXNlbnRlcjogUHJlc2VudGVyKSB7IH0KfQoKLy8gTUFSSzogLSBTd2lmdFVJIEludGVncmF0aW9uIChpT1Mgb25seSkKCiNpZiBvcyhpT1MpCnN0cnVjdCBNZXNzYWdlQ29tcG9zZVZpZXc6IFVJVmlld0NvbnRyb2xsZXJSZXByZXNlbnRhYmxlIHsKICAgIGxldCByZWNpcGllbnRzOiBbU3RyaW5nXQogICAgbGV0IGJvZHk6IFN0cmluZwogICAgbGV0IG9uRGlzbWlzczogKCkgLT4gVm9pZAogICAgCiAgICBmdW5jIG1ha2VVSVZpZXdDb250cm9sbGVyKGNvbnRleHQ6IENvbnRleHQpIC0+IE1GTWVzc2FnZUNvbXBvc2VWaWV3Q29udHJvbGxlciB7CiAgICAgICAgbGV0IGNvbnRyb2xsZXIgPSBNRk1lc3NhZ2VDb21wb3NlVmlld0NvbnRyb2xsZXIoKQogICAgICAgIGNvbnRyb2xsZXIubWVzc2FnZUNvbXBvc2VEZWxlZ2F0ZSA9IGNvbnRleHQuY29vcmRpbmF0b3IKICAgICAgICBjb250cm9sbGVyLnJlY2lwaWVudHMgPSByZWNpcGllbnRzCiAgICAgICAgY29udHJvbGxlci5ib2R5ID0gYm9keQogICAgICAgIHJldHVybiBjb250cm9sbGVyCiAgICB9CiAgICAKICAgIGZ1bmMgdXBkYXRlVUlWaWV3Q29udHJvbGxlcihfIHVpVmlld0NvbnRyb2xsZXI6IE1GTWVzc2FnZUNvbXBvc2VWaWV3Q29udHJvbGxlciwgY29udGV4dDogQ29udGV4dCkge30KICAgIAogICAgZnVuYyBtYWtlQ29vcmRpbmF0b3IoKSAtPiBDb29yZGluYXRvciB7CiAgICAgICAgQ29vcmRpbmF0b3Ioc2VsZikKICAgIH0KICAgIAogICAgY2xhc3MgQ29vcmRpbmF0b3I6IE5TT2JqZWN0LCBNRk1lc3NhZ2VDb21wb3NlVmlld0NvbnRyb2xsZXJEZWxlZ2F0ZSB7CiAgICAgICAgbGV0IHBhcmVudDogTWVzc2FnZUNvbXBvc2VWaWV3CiAgICAgICAgCiAgICAgICAgaW5pdChfIHBhcmVudDogTWVzc2FnZUNvbXBvc2VWaWV3KSB7CiAgICAgICAgICAgIHNlbGYucGFyZW50ID0gcGFyZW50CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZ1bmMgbWVzc2FnZUNvbXBvc2VWaWV3Q29udHJvbGxlcihfIGNvbnRyb2xsZXI6IE1GTWVzc2FnZUNvbXBvc2VWaWV3Q29udHJvbGxlciwgZGlkRmluaXNoV2l0aCByZXN1bHQ6IE1lc3NhZ2VDb21wb3NlUmVzdWx0KSB7CiAgICAgICAgICAgIHBhcmVudC5vbkRpc21pc3MoKQogICAgICAgIH0KICAgIH0KfQoKLy8gTUFSSzogLSBNYWlsIEludGVncmF0aW9uIChpT1Mgb25seSkKCnN0cnVjdCBNYWlsQ29tcG9zZVZpZXc6IFVJVmlld0NvbnRyb2xsZXJSZXByZXNlbnRhYmxlIHsKICAgIGxldCByZWNpcGllbnRzOiBbU3RyaW5nXQogICAgbGV0IHN1YmplY3Q6IFN0cmluZwogICAgbGV0IGJvZHk6IFN0cmluZwogICAgbGV0IG9uRGlzbWlzczogKCkgLT4gVm9pZAogICAgCiAgICBmdW5jIG1ha2VVSVZpZXdDb250cm9sbGVyKGNvbnRleHQ6IENvbnRleHQpIC0+IE1GTWFpbENvbXBvc2VWaWV3Q29udHJvbGxlciB7CiAgICAgICAgbGV0IGNvbnRyb2xsZXIgPSBNRk1haWxDb21wb3NlVmlld0NvbnRyb2xsZXIoKQogICAgICAgIGNvbnRyb2xsZXIubWFpbENvbXBvc2VEZWxlZ2F0ZSA9IGNvbnRleHQuY29vcmRpbmF0b3IKICAgICAgICBjb250cm9sbGVyLnNldFRvUmVjaXBpZW50cyhyZWNpcGllbnRzKQogICAgICAgIGNvbnRyb2xsZXIuc2V0U3ViamVjdChzdWJqZWN0KQogICAgICAgIGNvbnRyb2xsZXIuc2V0TWVzc2FnZUJvZHkoYm9keSwgaXNIVE1MOiBmYWxzZSkKICAgICAgICByZXR1cm4gY29udHJvbGxlcgogICAgfQogICAgCiAgICBmdW5jIHVwZGF0ZVVJVmlld0NvbnRyb2xsZXIoXyB1aVZpZXdDb250cm9sbGVyOiBNRk1haWxDb21wb3NlVmlld0NvbnRyb2xsZXIsIGNvbnRleHQ6IENvbnRleHQpIHt9CiAgICAKICAgIGZ1bmMgbWFrZUNvb3JkaW5hdG9yKCkgLT4gQ29vcmRpbmF0b3IgewogICAgICAgIENvb3JkaW5hdG9yKHNlbGYpCiAgICB9CiAgICAKICAgIGNsYXNzIENvb3JkaW5hdG9yOiBOU09iamVjdCwgTUZNYWlsQ29tcG9zZVZpZXdDb250cm9sbGVyRGVsZWdhdGUgewogICAgICAgIGxldCBwYXJlbnQ6IE1haWxDb21wb3NlVmlldwogICAgICAgIAogICAgICAgIGluaXQoXyBwYXJlbnQ6IE1haWxDb21wb3NlVmlldykgewogICAgICAgICAgICBzZWxmLnBhcmVudCA9IHBhcmVudAogICAgICAgIH0KICAgICAgICAKICAgICAgICBmdW5jIG1haWxDb21wb3NlQ29udHJvbGxlcihfIGNvbnRyb2xsZXI6IE1GTWFpbENvbXBvc2VWaWV3Q29udHJvbGxlciwgZGlkRmluaXNoV2l0aCByZXN1bHQ6IE1GTWFpbENvbXBvc2VSZXN1bHQsIGVycm9yOiBFcnJvcj8pIHsKICAgICAgICAgICAgcGFyZW50Lm9uRGlzbWlzcygpCiAgICAgICAgfQogICAgfQp9CiNlbmRpZg==
--- END ---

--- FILE: MacChan/Managers/CloudKitManager.swift ---
BASE64: Ly8KLy8gIENsb3VkS2l0TWFuYWdlci5zd2lmdAovLyAgTWFjQ2hhbgovLwovLyAgQ3JlYXRlZCBieSBKYXJlZCBNYXh3ZWxsIG9uIDkvMy8yNS4KLy8KCmltcG9ydCBGb3VuZGF0aW9uCmltcG9ydCBDbG91ZEtpdAppbXBvcnQgU3dpZnRVSQppbXBvcnQgQXV0aGVudGljYXRpb25TZXJ2aWNlcwoKQE1haW5BY3RvcgpjbGFzcyBDbG91ZEtpdE1hbmFnZXI6IE9ic2VydmFibGVPYmplY3QgewogICAgc3RhdGljIGxldCBzaGFyZWQgPSBDbG91ZEtpdE1hbmFnZXIoKQogICAgCiAgICBpbnRlcm5hbCBsZXQgY29udGFpbmVyOiBDS0NvbnRhaW5lcgogICAgbGV0IHB1YmxpY0RhdGFiYXNlOiBDS0RhdGFiYXNlCiAgICBsZXQgcHJpdmF0ZURhdGFiYXNlOiBDS0RhdGFiYXNlCiAgICBsZXQgc2hhcmVkRGF0YWJhc2U6IENLRGF0YWJhc2UKICAgIAogICAgQFB1Ymxpc2hlZCB2YXIgaXNTaWduZWRJbiA9IGZhbHNlCiAgICBAUHVibGlzaGVkIHZhciBjdXJyZW50VXNlcjogRm9ydW1Vc2VyPwogICAgQFB1Ymxpc2hlZCB2YXIgZXJyb3JNZXNzYWdlOiBTdHJpbmc/CiAgICBAUHVibGlzaGVkIHZhciBpc0xvYWRpbmcgPSBmYWxzZQogICAgQFB1Ymxpc2hlZCB2YXIgc2hvd0xvZ2luRXJyb3IgPSBmYWxzZQogICAgQFB1Ymxpc2hlZCB2YXIgbG9naW5FcnJvclRpdGxlID0gIiIKICAgIEBQdWJsaXNoZWQgdmFyIGxvZ2luRXJyb3JNZXNzYWdlID0gIiIKCiAgICAvLyBNQVJLOiAtIERhdGFiYXNlIENvbnN0YW50cwogICAgZW51bSBDbG91ZEtpdERhdGFiYXNlIHsKICAgICAgICBjYXNlIHB1YmxpY0RCCiAgICAgICAgY2FzZSBwcml2YXRlREIKICAgIH0KICAgIAogICAgcHJpdmF0ZSBpbml0KCkgewogICAgICAgIGNvbnRhaW5lciA9IENLQ29udGFpbmVyKGlkZW50aWZpZXI6ICJpQ2xvdWQubWFjY2hhbnRlc3QxIikKICAgICAgICBwdWJsaWNEYXRhYmFzZSA9IGNvbnRhaW5lci5wdWJsaWNDbG91ZERhdGFiYXNlCiAgICAgICAgcHJpdmF0ZURhdGFiYXNlID0gY29udGFpbmVyLnByaXZhdGVDbG91ZERhdGFiYXNlCiAgICAgICAgc2hhcmVkRGF0YWJhc2UgPSBjb250YWluZXIuc2hhcmVkQ2xvdWREYXRhYmFzZQogICAgICAgIAogICAgICAgIC8vIFJlbW92ZWQgYXV0b21hdGljIGF1dGhlbnRpY2F0aW9uIGNoZWNrIC0gd2lsbCBiZSBjYWxsZWQgbWFudWFsbHkKICAgIH0KICAgIAogICAgLy8gTUFSSzogLSBBY2NvdW50IE1hbmFnZW1lbnQKICAgIAogICAgZnVuYyBjaGVja0FjY291bnRTdGF0dXMoKSBhc3luYyB7CiAgICAgICAgcHJpbnQoIkNoZWNraW5nIENsb3VkS2l0IGFjY291bnQgc3RhdHVzLi4uIikKICAgICAgICBkbyB7CiAgICAgICAgICAgIGxldCBzdGF0dXMgPSB0cnkgYXdhaXQgY29udGFpbmVyLmFjY291bnRTdGF0dXMoKQogICAgICAgICAgICBwcmludCgiQ2xvdWRLaXQgQWNjb3VudCBTdGF0dXM6IFwoc3RhdHVzKSIpCgogICAgICAgICAgICBzd2l0Y2ggc3RhdHVzIHsKICAgICAgICAgICAgY2FzZSAuYXZhaWxhYmxlOgogICAgICAgICAgICAgICAgcHJpbnQoIlByZXBhcmluZyBkYXRhYmFzZXMuLi4iKQogICAgICAgICAgICAgICAgdHJ5IGF3YWl0IGVuc3VyZURhdGFiYXNlc1JlYWR5KCkKCiAgICAgICAgICAgICAgICBpc1NpZ25lZEluID0gdHJ1ZQogICAgICAgICAgICAgICAgcHJpbnQoIlVzZXIgaXMgc2lnbmVkIGluLCBmZXRjaGluZyBjdXJyZW50IHVzZXIuLi4iKQogICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2hDdXJyZW50VXNlcigpCiAgICAgICAgICAgIGNhc2UgLm5vQWNjb3VudDoKICAgICAgICAgICAgICAgIHByaW50KCJObyBpQ2xvdWQgYWNjb3VudCBmb3VuZCIpCiAgICAgICAgICAgICAgICBzaG93TG9naW5FcnJvcih0aXRsZTogImlDbG91ZCBBY2NvdW50IFJlcXVpcmVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIlBsZWFzZSBzaWduIGluIHRvIGlDbG91ZCBpbiBTeXN0ZW0gU2V0dGluZ3MgdG8gdXNlIE1hY0NoYW4uIikKICAgICAgICAgICAgY2FzZSAucmVzdHJpY3RlZDoKICAgICAgICAgICAgICAgIHByaW50KCJpQ2xvdWQgYWNjb3VudCBpcyByZXN0cmljdGVkIikKICAgICAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiaUNsb3VkIEFjY2VzcyBSZXN0cmljdGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIllvdXIgaUNsb3VkIGFjY291bnQgaGFzIHJlc3RyaWN0aW9ucyB0aGF0IHByZXZlbnQgdXNpbmcgTWFjQ2hhbi4gUGxlYXNlIGNoZWNrIHlvdXIgYWNjb3VudCBzZXR0aW5ncy4iKQogICAgICAgICAgICBjYXNlIC5jb3VsZE5vdERldGVybWluZToKICAgICAgICAgICAgICAgIHByaW50KCJDb3VsZCBub3QgZGV0ZXJtaW5lIGlDbG91ZCBhY2NvdW50IHN0YXR1cyIpCiAgICAgICAgICAgICAgICBzaG93TG9naW5FcnJvcih0aXRsZTogIlVuYWJsZSB0byBWZXJpZnkgQWNjb3VudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVbmFibGUgdG8gdmVyaWZ5IHlvdXIgaUNsb3VkIGFjY291bnQgc3RhdHVzLiBQbGVhc2UgY2hlY2sgeW91ciBpbnRlcm5ldCBjb25uZWN0aW9uIGFuZCB0cnkgYWdhaW4uIikKICAgICAgICAgICAgY2FzZSAudGVtcG9yYXJpbHlVbmF2YWlsYWJsZToKICAgICAgICAgICAgICAgIHByaW50KCJpQ2xvdWQgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUiKQogICAgICAgICAgICAgICAgc2hvd0xvZ2luRXJyb3IodGl0bGU6ICJpQ2xvdWQgVW5hdmFpbGFibGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiaUNsb3VkIHNlcnZpY2VzIGFyZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4iKQogICAgICAgICAgICBAdW5rbm93biBkZWZhdWx0OgogICAgICAgICAgICAgICAgcHJpbnQoIlVua25vd24gaUNsb3VkIGFjY291bnQgc3RhdHVzIikKICAgICAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiQWNjb3VudCBTdGF0dXMgVW5rbm93biIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVbmFibGUgdG8gZGV0ZXJtaW5lIHlvdXIgaUNsb3VkIGFjY291bnQgc3RhdHVzLiBQbGVhc2UgdHJ5IGFnYWluLiIpCiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBjaGVjayBhY2NvdW50IHN0YXR1czogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgICAgICBzaG93TG9naW5FcnJvcih0aXRsZTogIkNvbm5lY3Rpb24gRXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVbmFibGUgdG8gY29ubmVjdCB0byBpQ2xvdWQuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4iKQogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuYyBmZXRjaEN1cnJlbnRVc2VyKCkgYXN5bmMgewogICAgICAgIHByaW50KCJGZXRjaGluZyBjdXJyZW50IHVzZXIuLi4iKQogICAgICAgIGRvIHsKICAgICAgICAgICAgbGV0IHVzZXJSZWNvcmRJRCA9IHRyeSBhd2FpdCBnZXRVc2VyUmVjb3JkSUQoKQoKICAgICAgICAgICAgcHJpbnQoIkZldGNoaW5nIHVzZXIgcmVjb3JkIElEOiBcKHVzZXJSZWNvcmRJRC5yZWNvcmROYW1lKSBpbiB6b25lIFwodXNlclJlY29yZElELnpvbmVJRC56b25lTmFtZSkiKQoKICAgICAgICAgICAgbGV0IHJlY29yZCA9IHRyeSBhd2FpdCBwcml2YXRlRGF0YWJhc2UucmVjb3JkKGZvcjogdXNlclJlY29yZElEKQogICAgICAgICAgICBwcmludCgiVXNlciByZWNvcmQgZmV0Y2hlZCBzdWNjZXNzZnVsbHkiKQoKICAgICAgICAgICAgaWYgbGV0IHVzZXIgPSBGb3J1bVVzZXIuZnJvbUNsb3VkS2l0UmVjb3JkKHJlY29yZCkgewogICAgICAgICAgICAgICAgcHJpbnQoIkV4aXN0aW5nIHVzZXIgZm91bmQ6IFwodXNlci5kaXNwbGF5TmFtZSkiKQogICAgICAgICAgICAgICAgY3VycmVudFVzZXIgPSB1c2VyCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwcmludCgiTm8gZXhpc3RpbmcgdXNlciBmb3VuZCwgY3JlYXRpbmcgbmV3IHVzZXIuLi4iKQogICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyB1c2VyIGlmIG5vdCBmb3VuZAogICAgICAgICAgICAgICAgYXdhaXQgY3JlYXRlQ3VycmVudFVzZXIoKQogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCBsZXQgZXJyb3IgYXMgQ0tFcnJvciB7CiAgICAgICAgICAgIHByaW50KCJDbG91ZEtpdCBlcnJvciBmZXRjaGluZyB1c2VyOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIpCgogICAgICAgICAgICBzd2l0Y2ggZXJyb3IuY29kZSB7CiAgICAgICAgICAgIGNhc2UgLnVua25vd25JdGVtOgogICAgICAgICAgICAgICAgLy8gVXNlciByZWNvcmQgZG9lc24ndCBleGlzdCwgY3JlYXRlIG5ldyB1c2VyCiAgICAgICAgICAgICAgICBwcmludCgiVXNlciByZWNvcmQgbm90IGZvdW5kLCBjcmVhdGluZyBuZXcgdXNlci4uLiIpCiAgICAgICAgICAgICAgICBhd2FpdCBjcmVhdGVDdXJyZW50VXNlcigpCiAgICAgICAgICAgIGNhc2UgLm5ldHdvcmtVbmF2YWlsYWJsZToKICAgICAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiQ29ubmVjdGlvbiBFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJVbmFibGUgdG8gY29ubmVjdCB0byBpQ2xvdWQuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4iKQogICAgICAgICAgICBjYXNlIC5ub3RBdXRoZW50aWNhdGVkOgogICAgICAgICAgICAgICAgc2hvd0xvZ2luRXJyb3IodGl0bGU6ICJBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJQbGVhc2Ugc2lnbiBpbiB0byBpQ2xvdWQgaW4gU3lzdGVtIFNldHRpbmdzIGFuZCB0cnkgYWdhaW4uIikKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiTG9naW4gRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIlVuYWJsZSB0byBsb2FkIHVzZXIgZGF0YS4gUGxlYXNlIHRyeSBhZ2FpbiBvciBjb250YWN0IHN1cHBvcnQuIikKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIGZldGNoIGN1cnJlbnQgdXNlcjogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgICAgICBzaG93TG9naW5FcnJvcih0aXRsZTogIkxvZ2luIEZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQgd2hpbGUgbG9hZGluZyB5b3VyIGFjY291bnQuIFBsZWFzZSB0cnkgYWdhaW4uIikKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmMgY3JlYXRlQ3VycmVudFVzZXIoKSBhc3luYyB7CiAgICAgICAgcHJpbnQoIkNyZWF0aW5nIG5ldyB1c2VyLi4uIikKICAgICAgICBkbyB7CiAgICAgICAgICAgIC8vIEVuc3VyZSBkYXRhYmFzZXMgYXJlIHJlYWR5CiAgICAgICAgICAgIHRyeSBhd2FpdCBlbnN1cmVEYXRhYmFzZXNSZWFkeSgpCgogICAgICAgICAgICBsZXQgdXNlclJlY29yZElEID0gdHJ5IGF3YWl0IGdldFVzZXJSZWNvcmRJRCgpCgogICAgICAgICAgICBwcmludCgiVXNlciBSZWNvcmQgSUQgZm9yIGNyZWF0aW9uOiBcKHVzZXJSZWNvcmRJRC5yZWNvcmROYW1lKSBpbiB6b25lIFwodXNlclJlY29yZElELnpvbmVJRC56b25lTmFtZSkiKQoKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyB0aGUgZmlyc3QgdXNlciAobm8gZXhpc3RpbmcgdXNlcnMpCiAgICAgICAgICAgIGxldCBleGlzdGluZ1VzZXJzID0gdHJ5IGF3YWl0IHF1ZXJ5KEZvcnVtVXNlci5zZWxmLCBwcmVkaWNhdGU6IE5TUHJlZGljYXRlKHZhbHVlOiB0cnVlKSwgZnJvbTogcHJpdmF0ZURhdGFiYXNlKQogICAgICAgICAgICBsZXQgaXNGaXJzdFVzZXIgPSBleGlzdGluZ1VzZXJzLmlzRW1wdHkKCiAgICAgICAgICAgIGxldCByZWNvcmQgPSBDS1JlY29yZChyZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUudXNlci5yYXdWYWx1ZSwgcmVjb3JkSUQ6IHVzZXJSZWNvcmRJRCkKCiAgICAgICAgICAgIC8vIEdldCB1c2VyIGluZm8gZnJvbSBTaWduIGluIHdpdGggQXBwbGUKICAgICAgICAgICAgLy8gTm90ZTogdXNlcklkZW50aXR5KGZvclVzZXJSZWNvcmRJRDopIGlzIGRlcHJlY2F0ZWQgaW4gaU9TIDE3LjAKICAgICAgICAgICAgLy8gRm9yIG5vdywgd2UnbGwgdXNlIGEgZGVmYXVsdCB1c2VybmFtZSBhbmQgbGV0IHRoZSB1c2VyIHNldCBpdCBsYXRlcgogICAgICAgICAgICBsZXQgdXNlcm5hbWUgPSAiVXNlciIKCiAgICAgICAgICAgIHJlY29yZFsidXNlcm5hbWUiXSA9IHVzZXJuYW1lCiAgICAgICAgICAgIHJlY29yZFsiZGlzcGxheU5hbWUiXSA9IHVzZXJuYW1lCiAgICAgICAgICAgIHJlY29yZFsiam9pbkRhdGUiXSA9IERhdGUoKQogICAgICAgICAgICByZWNvcmRbImxhc3RBY3RpdmUiXSA9IERhdGUoKQogICAgICAgICAgICByZWNvcmRbInBvc3RDb3VudCJdID0gMAogICAgICAgICAgICByZWNvcmRbInJlcHV0YXRpb24iXSA9IDAKICAgICAgICAgICAgcmVjb3JkWyJpc01vZGVyYXRvciJdID0gZmFsc2UKICAgICAgICAgICAgcmVjb3JkWyJpc0FkbWluIl0gPSBpc0ZpcnN0VXNlciAvLyBGaXJzdCB1c2VyIGF1dG9tYXRpY2FsbHkgYmVjb21lcyBhZG1pbgogICAgICAgICAgICByZWNvcmRbImlzQmFubmVkIl0gPSBmYWxzZQogICAgICAgICAgICByZWNvcmRbInVzZXJHcm91cHMiXSA9IFsicmVnaXN0ZXJlZCJdCiAgICAgICAgICAgIHJlY29yZFsicHJlZmVyZW5jZXMiXSA9IHRyeSBKU09ORW5jb2RlcigpLmVuY29kZShVc2VyUHJlZmVyZW5jZXMoKSkKCiAgICAgICAgICAgIHByaW50KCJTYXZpbmcgdXNlciByZWNvcmQuLi4iKQogICAgICAgICAgICBsZXQgc2F2ZWRSZWNvcmQgPSB0cnkgYXdhaXQgcHJpdmF0ZURhdGFiYXNlLnNhdmUocmVjb3JkKQogICAgICAgICAgICBwcmludCgiVXNlciByZWNvcmQgc2F2ZWQgc3VjY2Vzc2Z1bGx5IikKCiAgICAgICAgICAgIGlmIGxldCB1c2VyID0gRm9ydW1Vc2VyLmZyb21DbG91ZEtpdFJlY29yZChzYXZlZFJlY29yZCkgewogICAgICAgICAgICAgICAgaWYgaXNGaXJzdFVzZXIgewogICAgICAgICAgICAgICAgICAgIHByaW50KCJGaXJzdCB1c2VyIGNyZWF0ZWQgYW5kIGF1dG9tYXRpY2FsbHkgcHJvbW90ZWQgdG8gYWRtaW46IFwodXNlci5kaXNwbGF5TmFtZSkgKElEOiBcKHVzZXIuaWQpKSIpCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHByaW50KCJVc2VyIG9iamVjdCBjcmVhdGVkOiBcKHVzZXIuZGlzcGxheU5hbWUpIChJRDogXCh1c2VyLmlkKSkiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY3VycmVudFVzZXIgPSB1c2VyCgogICAgICAgICAgICAgICAgLy8gTm90ZTogRm9ydW1zIGFyZSBub3cgb25seSBjcmVhdGVkIG1hbnVhbGx5IGJ5IGFkbWlucyB2aWEgZGVidWcgbWVudQogICAgICAgICAgICAgICAgLy8gTm8gYXV0b21hdGljIGZvcnVtIHNlZWRpbmcgZHVyaW5nIHVzZXIgY3JlYXRpb24KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHByaW50KCJGYWlsZWQgdG8gY3JlYXRlIHVzZXIgb2JqZWN0IGZyb20gc2F2ZWQgcmVjb3JkIikKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggbGV0IGVycm9yIGFzIENLRXJyb3IgewogICAgICAgICAgICBwcmludCgiQ2xvdWRLaXQgZXJyb3IgY3JlYXRpbmcgdXNlcjogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQoKICAgICAgICAgICAgLy8gSGFuZGxlIHNwZWNpZmljIENsb3VkS2l0IGVycm9ycwogICAgICAgICAgICBzd2l0Y2ggZXJyb3IuY29kZSB7CiAgICAgICAgICAgIGNhc2UgLnNlcnZlclJlY29yZENoYW5nZWQsIC5iYXRjaFJlcXVlc3RGYWlsZWQ6CiAgICAgICAgICAgICAgICAvLyBUcnkgdG8gaGFuZGxlIHJlY29yZCB0eXBlIG1pc21hdGNoCiAgICAgICAgICAgICAgICBhd2FpdCBoYW5kbGVSZWNvcmRUeXBlTWlzbWF0Y2goKQogICAgICAgICAgICBjYXNlIC5zZXJ2ZXJSZWplY3RlZFJlcXVlc3Q6CiAgICAgICAgICAgICAgICAvLyBIYW5kbGUgImludmFsaWQgYXR0ZW1wdCB0byB1cGRhdGUgcmVjb3JkIGZyb20gdHlwZSAnVXNlcnMnIHRvICdVc2VyJyIKICAgICAgICAgICAgICAgIHByaW50KCLwn5qoIFNlcnZlciByZWplY3RlZCByZXF1ZXN0IC0gbGlrZWx5IHJlY29yZCB0eXBlIGNvbmZsaWN0IikKICAgICAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlY29yZFR5cGVNaXNtYXRjaCgpCiAgICAgICAgICAgIGNhc2UgLm5ldHdvcmtVbmF2YWlsYWJsZToKICAgICAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiQ29ubmVjdGlvbiBFcnJvciIsIG1lc3NhZ2U6ICJVbmFibGUgdG8gY29ubmVjdCB0byBpQ2xvdWQuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4iKQogICAgICAgICAgICBjYXNlIC5ub3RBdXRoZW50aWNhdGVkOgogICAgICAgICAgICAgICAgc2hvd0xvZ2luRXJyb3IodGl0bGU6ICJBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCIsIG1lc3NhZ2U6ICJQbGVhc2Ugc2lnbiBpbiB0byBpQ2xvdWQgaW4gU3lzdGVtIFNldHRpbmdzIGFuZCB0cnkgYWdhaW4uIikKICAgICAgICAgICAgY2FzZSAucXVvdGFFeGNlZWRlZDoKICAgICAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiU3RvcmFnZSBGdWxsIiwgbWVzc2FnZTogIllvdXIgaUNsb3VkIHN0b3JhZ2UgaXMgZnVsbC4gUGxlYXNlIGZyZWUgdXAgc3BhY2UgYW5kIHRyeSBhZ2Fpbi4iKQogICAgICAgICAgICBjYXNlIC5zZXJ2aWNlVW5hdmFpbGFibGU6CiAgICAgICAgICAgICAgICBzaG93TG9naW5FcnJvcih0aXRsZTogIlNlcnZpY2UgVW5hdmFpbGFibGUiLCBtZXNzYWdlOiAiaUNsb3VkIHNlcnZpY2VzIGFyZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4iKQogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhIHJlY29yZCB0eXBlIGNvbmZsaWN0IGVycm9yCiAgICAgICAgICAgICAgICBpZiBlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbi5jb250YWlucygiaW52YWxpZCBhdHRlbXB0IHRvIHVwZGF0ZSByZWNvcmQiKSB7CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIvCfmqggRGV0ZWN0ZWQgcmVjb3JkIHR5cGUgY29uZmxpY3QgaW4gZXJyb3IgZGVzY3JpcHRpb24iKQogICAgICAgICAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlY29yZFR5cGVNaXNtYXRjaCgpCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiTG9naW4gRmFpbGVkIiwgbWVzc2FnZTogIlVuYWJsZSB0byBjcmVhdGUgdXNlciBhY2NvdW50LiBQbGVhc2UgdHJ5IGFnYWluIG9yIGNvbnRhY3Qgc3VwcG9ydC4iKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHByaW50KCLinYwgRmFpbGVkIHRvIGNyZWF0ZSB1c2VyOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIpCiAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiTG9naW4gRmFpbGVkIiwgbWVzc2FnZTogIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGxvZ2luLiBQbGVhc2UgdHJ5IGFnYWluLiIpCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmMgaGFuZGxlUmVjb3JkVHlwZU1pc21hdGNoKCkgYXN5bmMgewogICAgICAgIHByaW50KCLwn5SEIEF0dGVtcHRpbmcgdG8gaGFuZGxlIHJlY29yZCB0eXBlIG1pc21hdGNoLi4uIikKICAgICAgICBkbyB7CiAgICAgICAgICAgIGxldCB1c2VyUmVjb3JkSUQgPSB0cnkgYXdhaXQgZ2V0VXNlclJlY29yZElEKCkKCiAgICAgICAgICAgIC8vIEZpcnN0LCBsZXQncyBkZWJ1ZyB3aGF0J3MgYWN0dWFsbHkgaW4gdGhlIGRhdGFiYXNlCiAgICAgICAgICAgIGF3YWl0IGRlYnVnSW5zcGVjdFVzZXJSZWNvcmRzKCkKCiAgICAgICAgICAgIC8vIFRyeSB0byBkZWxldGUgdGhlIHJlY29yZCBkaXJlY3RseSAtIHRoaXMgbWlnaHQgd29yayBpZiB0aGUgcmVjb3JkIGV4aXN0cwogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICB0cnkgYXdhaXQgcHJpdmF0ZURhdGFiYXNlLmRlbGV0ZVJlY29yZCh3aXRoSUQ6IHVzZXJSZWNvcmRJRCkKICAgICAgICAgICAgICAgIHByaW50KCLwn5eR77iPIFN1Y2Nlc3NmdWxseSBkZWxldGVkIGNvbmZsaWN0aW5nIHJlY29yZCIpCiAgICAgICAgICAgICAgICBwcmludCgi8J+UhCBSZXRyeWluZyB1c2VyIGNyZWF0aW9uLi4uIikKICAgICAgICAgICAgICAgIGF3YWl0IGNyZWF0ZUN1cnJlbnRVc2VyKCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9IGNhdGNoIGxldCBlcnJvciBhcyBDS0Vycm9yIHsKICAgICAgICAgICAgICAgIHByaW50KCLihLnvuI8gRGlyZWN0IGRlbGV0aW9uIGZhaWxlZDogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQoKICAgICAgICAgICAgICAgIC8vIElmIGRpcmVjdCBkZWxldGlvbiBmYWlscywgdHJ5IHRvIGZldGNoIGFuZCB0aGVuIGRlbGV0ZQogICAgICAgICAgICAgICAgaWYgZXJyb3IuY29kZSA9PSAudW5rbm93bkl0ZW0gewogICAgICAgICAgICAgICAgICAgIHByaW50KCLihLnvuI8gTm8gcmVjb3JkIGV4aXN0cyB3aXRoIHRoaXMgSUQgLSB0aGlzIGlzIHN0cmFuZ2UgZ2l2ZW4gdGhlIGVycm9yIikKICAgICAgICAgICAgICAgICAgICAvLyBJZiBubyByZWNvcmQgZXhpc3RzLCB3ZSBzaG91bGQgYmUgYWJsZSB0byBjcmVhdGUgdGhlIG5ldyBvbmUKICAgICAgICAgICAgICAgICAgICBwcmludCgi8J+UhCBSZXRyeWluZyB1c2VyIGNyZWF0aW9uLi4uIikKICAgICAgICAgICAgICAgICAgICBhd2FpdCBjcmVhdGVDdXJyZW50VXNlcigpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIElmIHdlIGdldCBoZXJlLCB0aGVyZSBtaWdodCBiZSBhIHpvbmUgaXNzdWUgb3Igb3RoZXIgcHJvYmxlbQogICAgICAgICAgICBwcmludCgi4p2MIFVuYWJsZSB0byByZXNvbHZlIHJlY29yZCBjb25mbGljdCBhdXRvbWF0aWNhbGx5IikKICAgICAgICAgICAgc2hvd0xvZ2luRXJyb3IodGl0bGU6ICJBY2NvdW50IENvbmZsaWN0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiVGhlcmUncyBhIGNvbmZsaWN0IHdpdGggeW91ciBhY2NvdW50IGRhdGEuIFBsZWFzZSB1c2UgdGhlIGRlYnVnIG1lbnUgdG8gY2xlYXIgdXNlciBkYXRhIGFuZCB0cnkgYWdhaW4uIikKCiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHByaW50KCLinYwgRmFpbGVkIHRvIGhhbmRsZSByZWNvcmQgdHlwZSBtaXNtYXRjaDogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgICAgICBzaG93TG9naW5FcnJvcih0aXRsZTogIkxvZ2luIEZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIlVuYWJsZSB0byByZXNvbHZlIGFjY291bnQgZGF0YSBjb25mbGljdC4gUGxlYXNlIHRyeSBhZ2FpbiBvciBjb250YWN0IHN1cHBvcnQuIikKICAgICAgICB9CiAgICB9CgogICAgZnVuYyBkZWJ1Z0luc3BlY3RVc2VyUmVjb3JkcygpIGFzeW5jIHsKICAgICAgICBwcmludCgi8J+UjSBJbnNwZWN0aW5nIHVzZXIgcmVjb3JkcyBpbiBkYXRhYmFzZS4uLiIpCiAgICAgICAgZG8gewogICAgICAgICAgICBsZXQgdXNlcklEID0gdHJ5IGF3YWl0IGNvbnRhaW5lci51c2VyUmVjb3JkSUQoKQoKICAgICAgICAgICAgLy8gVHJ5IHRvIGZldGNoIHJlY29yZHMgb2YgZGlmZmVyZW50IHR5cGVzCiAgICAgICAgICAgIGxldCBwb3NzaWJsZVR5cGVzID0gWyJVc2VyIiwgIlVzZXJzIiwgIkZvcnVtVXNlciIsICJVc2VyUHJvZmlsZSJdCgogICAgICAgICAgICBmb3IgdHlwZSBpbiBwb3NzaWJsZVR5cGVzIHsKICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcHJlZGljYXRlID0gTlNQcmVkaWNhdGUoZm9ybWF0OiAiY3JlYXRvclVzZXJSZWNvcmRJRCA9PSAlQCIsIHVzZXJJRCkKICAgICAgICAgICAgICAgICAgICBsZXQgcXVlcnkgPSBDS1F1ZXJ5KHJlY29yZFR5cGU6IHR5cGUsIHByZWRpY2F0ZTogcHJlZGljYXRlKQoKICAgICAgICAgICAgICAgICAgICBsZXQgKG1hdGNoUmVzdWx0cywgXykgPSB0cnkgYXdhaXQgcHJpdmF0ZURhdGFiYXNlLnJlY29yZHMobWF0Y2hpbmc6IHF1ZXJ5LCBpblpvbmVXaXRoOiB1c2VySUQuem9uZUlEKQogICAgICAgICAgICAgICAgICAgIGxldCByZWNvcmRzID0gbWF0Y2hSZXN1bHRzLmNvbXBhY3RNYXAgeyByZXN1bHQgaW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2FzZSAuc3VjY2VzcyhsZXQgcmVjb3JkKSA9IHJlc3VsdC4xIHsgcmV0dXJuIHJlY29yZCB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuaWwKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICFyZWNvcmRzLmlzRW1wdHkgewogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgi8J+TiiBGb3VuZCBcKHJlY29yZHMuY291bnQpIHJlY29yZHMgb2YgdHlwZSAnXCh0eXBlKSc6IikKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHJlY29yZCBpbiByZWNvcmRzIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCIgICDigKIgSUQ6IFwocmVjb3JkLnJlY29yZElELnJlY29yZE5hbWUpLCBab25lOiBcKHJlY29yZC5yZWNvcmRJRC56b25lSUQuem9uZU5hbWUpIikKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLwn5OKIE5vIHJlY29yZHMgZm91bmQgb2YgdHlwZSAnXCh0eXBlKSciKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggbGV0IGVycm9yIGFzIENLRXJyb3Igd2hlcmUgZXJyb3IuY29kZSA9PSAudW5rbm93bkl0ZW0gewogICAgICAgICAgICAgICAgICAgIHByaW50KCLwn5OKIFJlY29yZCB0eXBlICdcKHR5cGUpJyBkb2Vzbid0IGV4aXN0IGluIHNjaGVtYSIpCiAgICAgICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICBwcmludCgi8J+TiiBFcnJvciBxdWVyeWluZyB0eXBlICdcKHR5cGUpJzogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHByaW50KCLinYwgRmFpbGVkIHRvIGluc3BlY3QgdXNlciByZWNvcmRzOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIpCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmMgY2xlYXJVc2VyRGF0YSgpIGFzeW5jIHsKICAgICAgICBwcmludCgi8J+Xke+4jyBDbGVhcmluZyB1c2VyIGRhdGEuLi4iKQogICAgICAgIGRvIHsKICAgICAgICAgICAgbGV0IHVzZXJJRCA9IHRyeSBhd2FpdCBjb250YWluZXIudXNlclJlY29yZElEKCkKICAgICAgICAgICAgbGV0IHJlY29yZElEID0gQ0tSZWNvcmQuSUQocmVjb3JkTmFtZTogdXNlcklELnJlY29yZE5hbWUsIHpvbmVJRDogdXNlcklELnpvbmVJRCkKCiAgICAgICAgICAgIC8vIFRyeSBtdWx0aXBsZSBhcHByb2FjaGVzIHRvIGRlbGV0ZSB0aGUgdXNlciByZWNvcmQKICAgICAgICAgICAgdmFyIGRlbGV0ZWQgPSBmYWxzZQoKICAgICAgICAgICAgLy8gQXBwcm9hY2ggMTogRGlyZWN0IGRlbGV0aW9uCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIHRyeSBhd2FpdCBwcml2YXRlRGF0YWJhc2UuZGVsZXRlUmVjb3JkKHdpdGhJRDogcmVjb3JkSUQpCiAgICAgICAgICAgICAgICBwcmludCgi4pyFIFVzZXIgcmVjb3JkIGRlbGV0ZWQgdmlhIGRpcmVjdCBJRCIpCiAgICAgICAgICAgICAgICBkZWxldGVkID0gdHJ1ZQogICAgICAgICAgICB9IGNhdGNoIGxldCBlcnJvciBhcyBDS0Vycm9yIHdoZXJlIGVycm9yLmNvZGUgPT0gLnVua25vd25JdGVtIHsKICAgICAgICAgICAgICAgIHByaW50KCLihLnvuI8gVXNlciByZWNvcmQgZGlkbid0IGV4aXN0IHZpYSBkaXJlY3QgSUQiKQogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIHByaW50KCLihLnvuI8gRGlyZWN0IGRlbGV0aW9uIGZhaWxlZDogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBBcHByb2FjaCAyOiBJZiBkaXJlY3QgZGVsZXRpb24gZmFpbHMsIHRyeSB3aXRoIGRpZmZlcmVudCB6b25lCiAgICAgICAgICAgIGlmICFkZWxldGVkIHsKICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZGVmYXVsdFpvbmVJRCA9IENLUmVjb3JkWm9uZS5JRC5kZWZhdWx0CiAgICAgICAgICAgICAgICAgICAgbGV0IGRlZmF1bHRSZWNvcmRJRCA9IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IHVzZXJJRC5yZWNvcmROYW1lLCB6b25lSUQ6IGRlZmF1bHRab25lSUQpCiAgICAgICAgICAgICAgICAgICAgdHJ5IGF3YWl0IHByaXZhdGVEYXRhYmFzZS5kZWxldGVSZWNvcmQod2l0aElEOiBkZWZhdWx0UmVjb3JkSUQpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIuKchSBVc2VyIHJlY29yZCBkZWxldGVkIHZpYSBkZWZhdWx0IHpvbmUiKQogICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQgPSB0cnVlCiAgICAgICAgICAgICAgICB9IGNhdGNoIGxldCBlcnJvciBhcyBDS0Vycm9yIHdoZXJlIGVycm9yLmNvZGUgPT0gLnVua25vd25JdGVtIHsKICAgICAgICAgICAgICAgICAgICBwcmludCgi4oS577iPIFVzZXIgcmVjb3JkIGRpZG4ndCBleGlzdCBpbiBkZWZhdWx0IHpvbmUiKQogICAgICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIuKEue+4jyBEZWZhdWx0IHpvbmUgZGVsZXRpb24gZmFpbGVkOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIEFwcHJvYWNoIDM6IFRyeSB0byBkZWxldGUgYWxsIHJlY29yZHMgdGhhdCBtaWdodCBiZSBhc3NvY2lhdGVkIHdpdGggdGhpcyB1c2VyCiAgICAgICAgICAgIGlmICFkZWxldGVkIHsKICAgICAgICAgICAgICAgIGF3YWl0IGZvcmNlRGVsZXRlVXNlclJlY29yZHMoKQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBDbGVhciBsb2NhbCBzdGF0ZQogICAgICAgICAgICBjdXJyZW50VXNlciA9IG5pbAogICAgICAgICAgICBpc1NpZ25lZEluID0gZmFsc2UKICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gbmlsCiAgICAgICAgICAgIGRpc21pc3NMb2dpbkVycm9yKCkKCiAgICAgICAgICAgIHByaW50KCLinIUgVXNlciBkYXRhIGNsZWFyZWQgc3VjY2Vzc2Z1bGx5IikKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIuKdjCBGYWlsZWQgdG8gY2xlYXIgdXNlciBkYXRhOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIpCiAgICAgICAgICAgIHNob3dMb2dpbkVycm9yKHRpdGxlOiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJGYWlsZWQgdG8gY2xlYXIgdXNlciBkYXRhLiBQbGVhc2UgdHJ5IGFnYWluLiIpCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmMgZm9yY2VEZWxldGVVc2VyUmVjb3JkcygpIGFzeW5jIHsKICAgICAgICBwcmludCgi8J+UqCBGb3JjZSBkZWxldGluZyB1c2VyIHJlY29yZHMuLi4iKQogICAgICAgIGRvIHsKICAgICAgICAgICAgbGV0IHVzZXJJRCA9IHRyeSBhd2FpdCBjb250YWluZXIudXNlclJlY29yZElEKCkKCiAgICAgICAgICAgIC8vIFF1ZXJ5IGZvciBhbGwgcmVjb3JkcyBjcmVhdGVkIGJ5IHRoaXMgdXNlcgogICAgICAgICAgICBsZXQgcHJlZGljYXRlID0gTlNQcmVkaWNhdGUoZm9ybWF0OiAiY3JlYXRvclVzZXJSZWNvcmRJRCA9PSAlQCIsIHVzZXJJRCkKICAgICAgICAgICAgbGV0IHF1ZXJ5ID0gQ0tRdWVyeShyZWNvcmRUeXBlOiAiVXNlciIsIHByZWRpY2F0ZTogcHJlZGljYXRlKQoKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgbGV0IChtYXRjaFJlc3VsdHMsIF8pID0gdHJ5IGF3YWl0IHByaXZhdGVEYXRhYmFzZS5yZWNvcmRzKG1hdGNoaW5nOiBxdWVyeSwgaW5ab25lV2l0aDogdXNlcklELnpvbmVJRCkKICAgICAgICAgICAgICAgIGxldCByZWNvcmRzID0gbWF0Y2hSZXN1bHRzLmNvbXBhY3RNYXAgeyByZXN1bHQgaW4KICAgICAgICAgICAgICAgICAgICBpZiBjYXNlIC5zdWNjZXNzKGxldCByZWNvcmQpID0gcmVzdWx0LjEgeyByZXR1cm4gcmVjb3JkIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmlsCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZm9yIHJlY29yZCBpbiByZWNvcmRzIHsKICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSBhd2FpdCBwcml2YXRlRGF0YWJhc2UuZGVsZXRlUmVjb3JkKHdpdGhJRDogcmVjb3JkLnJlY29yZElEKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgi8J+Xke+4jyBGb3JjZSBkZWxldGVkIHJlY29yZDogXChyZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSkiKQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgi4p2MIEZhaWxlZCB0byBkZWxldGUgcmVjb3JkIFwocmVjb3JkLnJlY29yZElELnJlY29yZE5hbWUpOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIHByaW50KCLihLnvuI8gTm8gVXNlciByZWNvcmRzIGZvdW5kIHRvIGZvcmNlIGRlbGV0ZSIpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIEFsc28gdHJ5IHdpdGggIlVzZXJzIiB0eXBlCiAgICAgICAgICAgIGxldCB1c2Vyc1F1ZXJ5ID0gQ0tRdWVyeShyZWNvcmRUeXBlOiAiVXNlcnMiLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSkKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgbGV0IChtYXRjaFJlc3VsdHMsIF8pID0gdHJ5IGF3YWl0IHByaXZhdGVEYXRhYmFzZS5yZWNvcmRzKG1hdGNoaW5nOiB1c2Vyc1F1ZXJ5LCBpblpvbmVXaXRoOiB1c2VySUQuem9uZUlEKQogICAgICAgICAgICAgICAgbGV0IHJlY29yZHMgPSBtYXRjaFJlc3VsdHMuY29tcGFjdE1hcCB7IHJlc3VsdCBpbgogICAgICAgICAgICAgICAgICAgIGlmIGNhc2UgLnN1Y2Nlc3MobGV0IHJlY29yZCkgPSByZXN1bHQuMSB7IHJldHVybiByZWNvcmQgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuaWwKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmb3IgcmVjb3JkIGluIHJlY29yZHMgewogICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IGF3YWl0IHByaXZhdGVEYXRhYmFzZS5kZWxldGVSZWNvcmQod2l0aElEOiByZWNvcmQucmVjb3JkSUQpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLwn5eR77iPIEZvcmNlIGRlbGV0ZWQgVXNlcnMgcmVjb3JkOiBcKHJlY29yZC5yZWNvcmRJRC5yZWNvcmROYW1lKSIpCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLinYwgRmFpbGVkIHRvIGRlbGV0ZSBVc2VycyByZWNvcmQgXChyZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSk6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgcHJpbnQoIuKEue+4jyBObyBVc2VycyByZWNvcmRzIGZvdW5kIHRvIGZvcmNlIGRlbGV0ZSIpCiAgICAgICAgICAgIH0KCiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHByaW50KCLinYwgRmFpbGVkIGZvcmNlIGRlbGV0aW9uOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIpCiAgICAgICAgfQogICAgfQoKICAgIGZ1bmMgc2hvd0xvZ2luRXJyb3IodGl0bGU6IFN0cmluZywgbWVzc2FnZTogU3RyaW5nKSB7CiAgICAgICAgbG9naW5FcnJvclRpdGxlID0gdGl0bGUKICAgICAgICBsb2dpbkVycm9yTWVzc2FnZSA9IG1lc3NhZ2UKICAgICAgICBzaG93TG9naW5FcnJvciA9IHRydWUKICAgICAgICBpc1NpZ25lZEluID0gZmFsc2UKICAgICAgICBpc0xvYWRpbmcgPSBmYWxzZQogICAgfQoKICAgIGZ1bmMgZGlzbWlzc0xvZ2luRXJyb3IoKSB7CiAgICAgICAgc2hvd0xvZ2luRXJyb3IgPSBmYWxzZQogICAgICAgIGxvZ2luRXJyb3JUaXRsZSA9ICIiCiAgICAgICAgbG9naW5FcnJvck1lc3NhZ2UgPSAiIgogICAgfQoKICAgIGZ1bmMgc2lnbk91dCgpIHsKICAgICAgICBwcmludCgi4piB77iPIENsb3VkS2l0IHNpZ25pbmcgb3V0Li4uIikKICAgICAgICBpc1NpZ25lZEluID0gZmFsc2UKICAgICAgICBjdXJyZW50VXNlciA9IG5pbAogICAgICAgIGRpc21pc3NMb2dpbkVycm9yKCkKICAgIH0KCiAgICAvLyBNQVJLOiAtIFpvbmUgTWFuYWdlbWVudAoKICAgIC8vLyBHZXQgdGhlIHVzZXIgcmVjb3JkIElEIGZvciBwcml2YXRlIGRhdGFiYXNlIG9wZXJhdGlvbnMKICAgIGZ1bmMgZ2V0VXNlclJlY29yZElEKCkgYXN5bmMgdGhyb3dzIC0+IENLUmVjb3JkLklEIHsKICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IGNvbnRhaW5lci51c2VyUmVjb3JkSUQoKQogICAgfQoKICAgIC8vLyBFbnN1cmUgZGF0YWJhc2VzIGFyZSByZWFkeSAoc2ltcGxpZmllZCAtIG5vIGN1c3RvbSB6b25lcyBuZWVkZWQpCiAgICBmdW5jIGVuc3VyZURhdGFiYXNlc1JlYWR5KCkgYXN5bmMgdGhyb3dzIHsKICAgICAgICAvLyBObyBjdXN0b20gem9uZXMgbmVlZGVkIC0gdXNpbmcgZGVmYXVsdCB6b25lcyBpbiBwdWJsaWMgYW5kIHByaXZhdGUgZGF0YWJhc2VzCiAgICAgICAgcHJpbnQoIkRhdGFiYXNlcyByZWFkeSAtIHVzaW5nIGRlZmF1bHQgem9uZXMiKQogICAgfQoKICAgIAogICAgZnVuYyBjcmVhdGVPclVwZGF0ZVVzZXIoZnJvbSBjcmVkZW50aWFsOiBBU0F1dGhvcml6YXRpb25BcHBsZUlEQ3JlZGVudGlhbCkgYXN5bmMgdGhyb3dzIC0+IEZvcnVtVXNlciB7CiAgICAgICAgLy8gRW5zdXJlIGRhdGFiYXNlcyBhcmUgcmVhZHkKICAgICAgICB0cnkgYXdhaXQgZW5zdXJlRGF0YWJhc2VzUmVhZHkoKQoKICAgICAgICBsZXQgdXNlclJlY29yZElEID0gdHJ5IGF3YWl0IGdldFVzZXJSZWNvcmRJRCgpCgogICAgICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgdGhlIGZpcnN0IHVzZXIgKG5vIGV4aXN0aW5nIHVzZXJzKQogICAgICAgIGxldCBleGlzdGluZ1VzZXJzID0gdHJ5IGF3YWl0IHF1ZXJ5KEZvcnVtVXNlci5zZWxmLCBwcmVkaWNhdGU6IE5TUHJlZGljYXRlKHZhbHVlOiB0cnVlKSwgZnJvbTogcHJpdmF0ZURhdGFiYXNlKQogICAgICAgIGxldCBpc0ZpcnN0VXNlciA9IGV4aXN0aW5nVXNlcnMuaXNFbXB0eQoKICAgICAgICBsZXQgcmVjb3JkID0gQ0tSZWNvcmQocmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLnVzZXIucmF3VmFsdWUsIHJlY29yZElEOiB1c2VyUmVjb3JkSUQpCgogICAgICAgIC8vIEV4dHJhY3QgdXNlciBpbmZvIGZyb20gU2lnbiBpbiB3aXRoIEFwcGxlIGNyZWRlbnRpYWwKICAgICAgICBsZXQgdXNlcm5hbWUgPSBjcmVkZW50aWFsLmZ1bGxOYW1lPy5mb3JtYXR0ZWQoKSA/PyAiVXNlciIKICAgICAgICBsZXQgZW1haWwgPSBjcmVkZW50aWFsLmVtYWlsCgogICAgICAgIHJlY29yZFsidXNlcm5hbWUiXSA9IHVzZXJuYW1lCiAgICAgICAgcmVjb3JkWyJkaXNwbGF5TmFtZSJdID0gdXNlcm5hbWUKICAgICAgICByZWNvcmRbImVtYWlsIl0gPSBlbWFpbAogICAgICAgIHJlY29yZFsiam9pbkRhdGUiXSA9IERhdGUoKQogICAgICAgIHJlY29yZFsibGFzdEFjdGl2ZSJdID0gRGF0ZSgpCiAgICAgICAgcmVjb3JkWyJwb3N0Q291bnQiXSA9IDAKICAgICAgICByZWNvcmRbInJlcHV0YXRpb24iXSA9IDAKICAgICAgICByZWNvcmRbImlzTW9kZXJhdG9yIl0gPSBmYWxzZQogICAgICAgIHJlY29yZFsiaXNBZG1pbiJdID0gaXNGaXJzdFVzZXIgLy8gRmlyc3QgdXNlciBhdXRvbWF0aWNhbGx5IGJlY29tZXMgYWRtaW4KICAgICAgICByZWNvcmRbImlzQmFubmVkIl0gPSBmYWxzZQogICAgICAgIHJlY29yZFsidXNlckdyb3VwcyJdID0gWyJyZWdpc3RlcmVkIl0KICAgICAgICByZWNvcmRbInByZWZlcmVuY2VzIl0gPSB0cnkgSlNPTkVuY29kZXIoKS5lbmNvZGUoVXNlclByZWZlcmVuY2VzKCkpCgogICAgICAgIGxldCBzYXZlZFJlY29yZCA9IHRyeSBhd2FpdCBwcml2YXRlRGF0YWJhc2Uuc2F2ZShyZWNvcmQpCiAgICAgICAgZ3VhcmQgbGV0IHVzZXIgPSBGb3J1bVVzZXIuZnJvbUNsb3VkS2l0UmVjb3JkKHNhdmVkUmVjb3JkKSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgQ2xvdWRLaXRFcnJvci5yZWNvcmRDb252ZXJzaW9uRmFpbGVkCiAgICAgICAgfQoKICAgICAgICBpZiBpc0ZpcnN0VXNlciB7CiAgICAgICAgICAgIHByaW50KCJGaXJzdCB1c2VyIGNyZWF0ZWQgYW5kIGF1dG9tYXRpY2FsbHkgcHJvbW90ZWQgdG8gYWRtaW46IFwodXNlci5kaXNwbGF5TmFtZSkiKQogICAgICAgIH0KCiAgICAgICAgY3VycmVudFVzZXIgPSB1c2VyCiAgICAgICAgcmV0dXJuIHVzZXIKICAgIH0KICAgIAogICAgLy8gTUFSSzogLSBHZW5lcmljIENSVUQgT3BlcmF0aW9ucwogICAgCiAgICBmdW5jIHNhdmU8VD4oXyBpdGVtOiBULCB0byBkYXRhYmFzZTogQ0tEYXRhYmFzZSkgYXN5bmMgdGhyb3dzIC0+IFQgd2hlcmUgVDogQ2xvdWRLaXRSZWNvcmRDb252ZXJ0aWJsZSB7CiAgICAgICAgbGV0IHJlY29yZCA9IGl0ZW0udG9DbG91ZEtpdFJlY29yZCgpCiAgICAgICAgbGV0IHNhdmVkUmVjb3JkID0gdHJ5IGF3YWl0IGRhdGFiYXNlLnNhdmUocmVjb3JkKQogICAgICAgIHJldHVybiBULmZyb21DbG91ZEtpdFJlY29yZChzYXZlZFJlY29yZCkgPz8gaXRlbQogICAgfQogICAgCiAgICBmdW5jIGZldGNoPFQ+KF8gdHlwZTogVC5UeXBlLCByZWNvcmRJRDogQ0tSZWNvcmQuSUQsIGZyb20gZGF0YWJhc2U6IENLRGF0YWJhc2UpIGFzeW5jIHRocm93cyAtPiBUPyB3aGVyZSBUOiBDbG91ZEtpdFJlY29yZENvbnZlcnRpYmxlIHsKICAgICAgICBsZXQgcmVjb3JkID0gdHJ5IGF3YWl0IGRhdGFiYXNlLnJlY29yZChmb3I6IHJlY29yZElEKQogICAgICAgIHJldHVybiBULmZyb21DbG91ZEtpdFJlY29yZChyZWNvcmQpCiAgICB9CiAgICAKICAgIGZ1bmMgZGVsZXRlKHJlY29yZElEOiBDS1JlY29yZC5JRCwgZnJvbSBkYXRhYmFzZTogQ0tEYXRhYmFzZSkgYXN5bmMgdGhyb3dzIHsKICAgICAgICB0cnkgYXdhaXQgZGF0YWJhc2UuZGVsZXRlUmVjb3JkKHdpdGhJRDogcmVjb3JkSUQpCiAgICB9CiAgICAKICAgIGZ1bmMgcXVlcnk8VD4oXyB0eXBlOiBULlR5cGUsIHByZWRpY2F0ZTogTlNQcmVkaWNhdGUsIHNvcnREZXNjcmlwdG9yczogW05TU29ydERlc2NyaXB0b3JdID0gW10sIGxpbWl0OiBJbnQgPSAxMDAsIGZyb20gZGF0YWJhc2U6IENLRGF0YWJhc2UpIGFzeW5jIHRocm93cyAtPiBbVF0gd2hlcmUgVDogQ2xvdWRLaXRSZWNvcmRDb252ZXJ0aWJsZSB7CiAgICAgICAgbGV0IHF1ZXJ5ID0gQ0tRdWVyeShyZWNvcmRUeXBlOiB0eXBlLnJlY29yZFR5cGUucmF3VmFsdWUsIHByZWRpY2F0ZTogcHJlZGljYXRlKQogICAgICAgIHF1ZXJ5LnNvcnREZXNjcmlwdG9ycyA9IHNvcnREZXNjcmlwdG9ycwogICAgICAgIAogICAgICAgIGxldCBvcGVyYXRpb24gPSBDS1F1ZXJ5T3BlcmF0aW9uKHF1ZXJ5OiBxdWVyeSkKICAgICAgICBvcGVyYXRpb24ucmVzdWx0c0xpbWl0ID0gbGltaXQKICAgICAgICAKICAgICAgICB2YXIgcmVzdWx0czogW1RdID0gW10KICAgICAgICAKICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHdpdGhDaGVja2VkVGhyb3dpbmdDb250aW51YXRpb24geyBjb250aW51YXRpb24gaW4KICAgICAgICAgICAgb3BlcmF0aW9uLnJlY29yZE1hdGNoZWRCbG9jayA9IHsgcmVjb3JkSUQsIHJlc3VsdCBpbgogICAgICAgICAgICAgICAgc3dpdGNoIHJlc3VsdCB7CiAgICAgICAgICAgICAgICBjYXNlIC5zdWNjZXNzKGxldCByZWNvcmQpOgogICAgICAgICAgICAgICAgICAgIGlmIGxldCBpdGVtID0gVC5mcm9tQ2xvdWRLaXRSZWNvcmQocmVjb3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKGl0ZW0pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2FzZSAuZmFpbHVyZShsZXQgZXJyb3IpOgogICAgICAgICAgICAgICAgICAgIHByaW50KCJGYWlsZWQgdG8gZmV0Y2ggcmVjb3JkIFwocmVjb3JkSUQpOiBcKGVycm9yKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG9wZXJhdGlvbi5xdWVyeVJlc3VsdEJsb2NrID0geyByZXN1bHQgaW4KICAgICAgICAgICAgICAgIHN3aXRjaCByZXN1bHQgewogICAgICAgICAgICAgICAgY2FzZSAuc3VjY2VzczoKICAgICAgICAgICAgICAgICAgICBjb250aW51YXRpb24ucmVzdW1lKHJldHVybmluZzogcmVzdWx0cykKICAgICAgICAgICAgICAgIGNhc2UgLmZhaWx1cmUobGV0IGVycm9yKToKICAgICAgICAgICAgICAgICAgICBjb250aW51YXRpb24ucmVzdW1lKHRocm93aW5nOiBlcnJvcikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgZGF0YWJhc2UuYWRkKG9wZXJhdGlvbikKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gRm9ydW0gT3BlcmF0aW9ucwogICAgCiAgICBmdW5jIGZldGNoRm9ydW1zKCkgYXN5bmMgdGhyb3dzIC0+IFtGb3J1bV0gewogICAgICAgIGxldCBwcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZSh2YWx1ZTogdHJ1ZSkKICAgICAgICBsZXQgc29ydERlc2NyaXB0b3JzID0gW05TU29ydERlc2NyaXB0b3Ioa2V5OiAiZGlzcGxheU9yZGVyIiwgYXNjZW5kaW5nOiB0cnVlKV0KICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHF1ZXJ5KEZvcnVtLnNlbGYsIHByZWRpY2F0ZTogcHJlZGljYXRlLCBzb3J0RGVzY3JpcHRvcnM6IHNvcnREZXNjcmlwdG9ycywgZnJvbTogcHVibGljRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIGZ1bmMgY3JlYXRlRm9ydW0oXyBmb3J1bTogRm9ydW0pIGFzeW5jIHRocm93cyAtPiBGb3J1bSB7CiAgICAgICAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgYWRtaW4gcHJpdmlsZWdlcwogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyLCBjdXJyZW50VXNlci5pc0FkbWluIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIk9ubHkgYWRtaW5pc3RyYXRvcnMgY2FuIGNyZWF0ZSBmb3J1bXMiXSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRyeSBhd2FpdCBzYXZlKGZvcnVtLCB0bzogcHVibGljRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIGZ1bmMgdXBkYXRlRm9ydW0oXyBmb3J1bTogRm9ydW0pIGFzeW5jIHRocm93cyAtPiBGb3J1bSB7CiAgICAgICAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgYWRtaW4gcHJpdmlsZWdlcwogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyLCBjdXJyZW50VXNlci5pc0FkbWluIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIk9ubHkgYWRtaW5pc3RyYXRvcnMgY2FuIHVwZGF0ZSBmb3J1bXMiXSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRyeSBhd2FpdCBzYXZlKGZvcnVtLCB0bzogcHVibGljRGF0YWJhc2UpCiAgICB9CgogICAgZnVuYyBkZWxldGVGb3J1bShfIGZvcnVtSUQ6IFN0cmluZykgYXN5bmMgdGhyb3dzIHsKICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGhhcyBhZG1pbiBwcml2aWxlZ2VzCiAgICAgICAgZ3VhcmQgbGV0IGN1cnJlbnRVc2VyID0gY3VycmVudFVzZXIsIGN1cnJlbnRVc2VyLmlzQWRtaW4gZWxzZSB7CiAgICAgICAgICAgIHRocm93IE5TRXJyb3IoZG9tYWluOiAiTWFjQ2hhbiIsIGNvZGU6IDQwMywgdXNlckluZm86IFtOU0xvY2FsaXplZERlc2NyaXB0aW9uS2V5OiAiT25seSBhZG1pbmlzdHJhdG9ycyBjYW4gZGVsZXRlIGZvcnVtcyJdKQogICAgICAgIH0KICAgICAgICBsZXQgcmVjb3JkSUQgPSBDS1JlY29yZC5JRChyZWNvcmROYW1lOiBmb3J1bUlEKQogICAgICAgIHRyeSBhd2FpdCBkZWxldGUocmVjb3JkSUQ6IHJlY29yZElELCBmcm9tOiBwdWJsaWNEYXRhYmFzZSkKICAgIH0KCiAgICBmdW5jIHNlZWRJbml0aWFsRm9ydW1zKGFkbWluVXNlcklEOiBTdHJpbmcpIGFzeW5jIHRocm93cyB7CiAgICAgICAgcHJpbnQoIvCflI0gQ2hlY2tpbmcgZm9yIGV4aXN0aW5nIGZvcnVtcy4uLiIpCgogICAgICAgIC8vIENoZWNrIGlmIGZvcnVtcyBhbHJlYWR5IGV4aXN0CiAgICAgICAgbGV0IGV4aXN0aW5nRm9ydW1zID0gdHJ5IGF3YWl0IGZldGNoRm9ydW1zKCkKICAgICAgICBwcmludCgi8J+TiiBGb3VuZCBcKGV4aXN0aW5nRm9ydW1zLmNvdW50KSBleGlzdGluZyBmb3J1bXMiKQoKICAgICAgICBpZiAhZXhpc3RpbmdGb3J1bXMuaXNFbXB0eSB7CiAgICAgICAgICAgIHByaW50KCLinIUgRm9ydW1zIGFscmVhZHkgc2VlZGVkLCBza2lwcGluZy4uLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgcHJpbnQoIvCfjLEgU3RhcnRpbmcgZm9ydW0gc2VlZGluZyBwcm9jZXNzLi4uIikKICAgICAgICBsZXQgZm9ydW1zVG9DcmVhdGUgPSBGb3J1bURhdGFTZWVkLmNyZWF0ZUZvcnVtcyhmb3I6IGFkbWluVXNlcklEKQogICAgICAgIHByaW50KCLwn5OdIFdpbGwgY3JlYXRlIFwoZm9ydW1zVG9DcmVhdGUuY291bnQpIGZvcnVtcyIpCgogICAgICAgIHZhciBjcmVhdGVkQ291bnQgPSAwCiAgICAgICAgdmFyIGZhaWxlZENvdW50ID0gMAoKICAgICAgICBmb3IgZm9ydW0gaW4gZm9ydW1zVG9DcmVhdGUgewogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICBfID0gdHJ5IGF3YWl0IGNyZWF0ZUZvcnVtKGZvcnVtKQogICAgICAgICAgICAgICAgcHJpbnQoIuKchSBDcmVhdGVkIGZvcnVtOiBcKGZvcnVtLm5hbWUpIikKICAgICAgICAgICAgICAgIGNyZWF0ZWRDb3VudCArPSAxCiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgcHJpbnQoIuKdjCBGYWlsZWQgdG8gY3JlYXRlIGZvcnVtIFwoZm9ydW0ubmFtZSk6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICAgICAgICAgIGZhaWxlZENvdW50ICs9IDEKICAgICAgICAgICAgICAgIC8vIENvbnRpbnVlIHdpdGggb3RoZXIgZm9ydW1zIGV2ZW4gaWYgb25lIGZhaWxzCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByaW50KCLwn46JIEZvcnVtIHNlZWRpbmcgY29tcGxldGVkISBDcmVhdGVkOiBcKGNyZWF0ZWRDb3VudCksIEZhaWxlZDogXChmYWlsZWRDb3VudCkiKQogICAgfQoKICAgIGZ1bmMgZGVidWdTZWVkRm9ydW1zKCkgYXN5bmMgewogICAgICAgIHByaW50KCLwn5SnIERFQlVHOiBNYW51YWwgZm9ydW0gc2VlZGluZyB0cmlnZ2VyZWQiKQoKICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjdXJyZW50VXNlciBlbHNlIHsKICAgICAgICAgICAgcHJpbnQoIuKdjCBObyBjdXJyZW50IHVzZXIgZm91bmQiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICB9CgogICAgICAgIHByaW50KCLwn5GkIEN1cnJlbnQgdXNlciBJRDogXChjdXJyZW50VXNlci5pZCkiKQoKICAgICAgICBkbyB7CiAgICAgICAgICAgIHRyeSBhd2FpdCBzZWVkSW5pdGlhbEZvcnVtcyhhZG1pblVzZXJJRDogY3VycmVudFVzZXIuaWQpCiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHByaW50KCLinYwgRGVidWcgc2VlZGluZyBmYWlsZWQ6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICAgICAgcHJpbnQoIvCfkqEgVHJ5IHVzaW5nICdQcmludCBDbG91ZEtpdCBDb25zb2xlIERhdGEnIG9wdGlvbiBpbnN0ZWFkIikKICAgICAgICB9CiAgICB9CgogICAgZnVuYyBkZWJ1Z1ByaW50Q2xvdWRLaXRDb25zb2xlRGF0YSgpIHsKICAgICAgICBwcmludCgiREVCVUc6IFByaW50aW5nIENsb3VkS2l0IENvbnNvbGUgZGF0YSIpCgogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyIGVsc2UgewogICAgICAgICAgICBwcmludCgiTm8gY3VycmVudCB1c2VyIGZvdW5kIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgfQoKICAgICAgICBwcmludCgiQ3VycmVudCB1c2VyIElEOiBcKGN1cnJlbnRVc2VyLmlkKSIpCiAgICAgICAgRm9ydW1EYXRhU2VlZC5wcmludENsb3VkS2l0Q29uc29sZURhdGEoYWRtaW5Vc2VySUQ6IGN1cnJlbnRVc2VyLmlkKQogICAgfQoKICAgIGZ1bmMgZGVidWdDaGVja0Nsb3VkS2l0U2NoZW1hKCkgYXN5bmMgewogICAgICAgIHByaW50KCJERUJVRzogQ2hlY2tpbmcgQ2xvdWRLaXQgc2NoZW1hIHNldHVwIikKCiAgICAgICAgZG8gewogICAgICAgICAgICAvLyBUcnkgdG8gcXVlcnkgZWFjaCByZWNvcmQgdHlwZSB0byBzZWUgaWYgaXQgZXhpc3RzCiAgICAgICAgICAgIGxldCByZWNvcmRUeXBlcyA9IENsb3VkS2l0UmVjb3JkVHlwZS5hbGxDYXNlcwoKICAgICAgICAgICAgZm9yIHJlY29yZFR5cGUgaW4gcmVjb3JkVHlwZXMgewogICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgIGxldCBwcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZSh2YWx1ZTogdHJ1ZSkKICAgICAgICAgICAgICAgICAgICBsZXQgcXVlcnkgPSBDS1F1ZXJ5KHJlY29yZFR5cGU6IHJlY29yZFR5cGUucmF3VmFsdWUsIHByZWRpY2F0ZTogcHJlZGljYXRlKQogICAgICAgICAgICAgICAgICAgIGxldCBvcGVyYXRpb24gPSBDS1F1ZXJ5T3BlcmF0aW9uKHF1ZXJ5OiBxdWVyeSkKICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb24ucmVzdWx0c0xpbWl0ID0gMSAvLyBKdXN0IGNoZWNrIGlmIHdlIGNhbiBxdWVyeQoKICAgICAgICAgICAgICAgICAgICB0cnkgYXdhaXQgd2l0aENoZWNrZWRUaHJvd2luZ0NvbnRpbnVhdGlvbiB7IChjb250aW51YXRpb246IENoZWNrZWRDb250aW51YXRpb248Vm9pZCwgRXJyb3I+KSBpbgogICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb24ucXVlcnlSZXN1bHRCbG9jayA9IHsgcmVzdWx0IGluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggcmVzdWx0IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgLnN1Y2Nlc3M6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIlJlY29yZCB0eXBlICdcKHJlY29yZFR5cGUucmF3VmFsdWUpJyBpcyBhdmFpbGFibGUiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVhdGlvbi5yZXN1bWUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAuZmFpbHVyZShsZXQgZXJyb3IpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJSZWNvcmQgdHlwZSAnXChyZWNvcmRUeXBlLnJhd1ZhbHVlKScgZXJyb3I6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51YXRpb24ucmVzdW1lKHRocm93aW5nOiBlcnJvcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBwdWJsaWNEYXRhYmFzZS5hZGQob3BlcmF0aW9uKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgIHByaW50KCJDYW5ub3QgcXVlcnkgcmVjb3JkIHR5cGUgJ1wocmVjb3JkVHlwZS5yYXdWYWx1ZSknOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIkVycm9yIGNoZWNraW5nIENsb3VkS2l0IHNjaGVtYTogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jIGRlYnVnQ2xlYXJVc2VyRGF0YSgpIGFzeW5jIHsKICAgICAgICBwcmludCgiREVCVUc6IENsZWFyaW5nIHVzZXIgZGF0YSIpCgogICAgICAgIGd1YXJkIGN1cnJlbnRVc2VyICE9IG5pbCBlbHNlIHsKICAgICAgICAgICAgcHJpbnQoIk5vIGN1cnJlbnQgdXNlciBmb3VuZCIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgZG8gewogICAgICAgICAgICAvLyBEZWxldGUgY3VycmVudCB1c2VyIHJlY29yZAogICAgICAgICAgICBsZXQgdXNlclJlY29yZElEID0gdHJ5IGF3YWl0IGdldFVzZXJSZWNvcmRJRCgpCiAgICAgICAgICAgIHRyeSBhd2FpdCBwcml2YXRlRGF0YWJhc2UuZGVsZXRlUmVjb3JkKHdpdGhJRDogdXNlclJlY29yZElEKQogICAgICAgICAgICBwcmludCgiRGVsZXRlZCBjdXJyZW50IHVzZXIgcmVjb3JkIikKCiAgICAgICAgICAgIC8vIFNpZ24gb3V0CiAgICAgICAgICAgIGF3YWl0IE1haW5BY3Rvci5ydW4gewogICAgICAgICAgICAgICAgLy8gQ2xlYXIgY3VycmVudCB1c2VyIHJlZmVyZW5jZSAobm90ZTogY2FuJ3Qgc2V0IHRvIG5pbCBkdWUgdG8gbGV0IGRlY2xhcmF0aW9uKQogICAgICAgICAgICAgICAgLy8gSW5zdGVhZCwgd2UnbGwganVzdCBzZXQgdGhlIHNpZ25lZCBpbiBzdGF0dXMgdG8gZmFsc2UKICAgICAgICAgICAgICAgIGlzU2lnbmVkSW4gPSBmYWxzZQogICAgICAgICAgICAgICAgcHJpbnQoIlVzZXIgZGF0YSBjbGVhcmVkIC0gcGxlYXNlIHJlc3RhcnQgdGhlIGFwcCBmb3IgZnVsbCBzaWduIG91dCIpCiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBjbGVhciB1c2VyIGRhdGE6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICB9CiAgICB9CgogICAgZnVuYyBkZWJ1Z0ZvcmNlRGVsZXRlUmVjb3JkcygpIGFzeW5jIHsKICAgICAgICBwcmludCgiREVCVUc6IEZvcmNlIGRlbGV0aW5nIGFsbCByZWNvcmRzIChVU0UgV0lUSCBDQVVUSU9OKSIpCgogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyLCBjdXJyZW50VXNlci5pc0FkbWluIGVsc2UgewogICAgICAgICAgICBwcmludCgiQWRtaW4gcHJpdmlsZWdlcyByZXF1aXJlZCIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgZG8gewogICAgICAgICAgICAvLyBEZWxldGUgYWxsIGZvcnVtIHJlY29yZHMKICAgICAgICAgICAgbGV0IGZvcnVtUHJlZGljYXRlID0gTlNQcmVkaWNhdGUodmFsdWU6IHRydWUpCiAgICAgICAgICAgIGxldCBmb3J1bVF1ZXJ5ID0gQ0tRdWVyeShyZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUuZm9ydW0ucmF3VmFsdWUsIHByZWRpY2F0ZTogZm9ydW1QcmVkaWNhdGUpCiAgICAgICAgICAgIGxldCBmb3J1bU9wZXJhdGlvbiA9IENLUXVlcnlPcGVyYXRpb24ocXVlcnk6IGZvcnVtUXVlcnkpCgogICAgICAgICAgICB2YXIgZm9ydW1SZWNvcmRJRHM6IFtDS1JlY29yZC5JRF0gPSBbXQoKICAgICAgICAgICAgdHJ5IGF3YWl0IHdpdGhDaGVja2VkVGhyb3dpbmdDb250aW51YXRpb24geyAoY29udGludWF0aW9uOiBDaGVja2VkQ29udGludWF0aW9uPFZvaWQsIEVycm9yPikgaW4KICAgICAgICAgICAgICAgIGZvcnVtT3BlcmF0aW9uLnJlY29yZE1hdGNoZWRCbG9jayA9IHsgcmVjb3JkSUQsIHJlc3VsdCBpbgogICAgICAgICAgICAgICAgICAgIGZvcnVtUmVjb3JkSURzLmFwcGVuZChyZWNvcmRJRCkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmb3J1bU9wZXJhdGlvbi5xdWVyeVJlc3VsdEJsb2NrID0geyByZXN1bHQgaW4KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggcmVzdWx0IHsKICAgICAgICAgICAgICAgICAgICBjYXNlIC5zdWNjZXNzOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiRm91bmQgXChmb3J1bVJlY29yZElEcy5jb3VudCkgZm9ydW0gcmVjb3JkcyB0byBkZWxldGUiKQogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51YXRpb24ucmVzdW1lKCkKICAgICAgICAgICAgICAgICAgICBjYXNlIC5mYWlsdXJlKGxldCBlcnJvcik6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJFcnJvciBxdWVyeWluZyBmb3J1bXM6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWF0aW9uLnJlc3VtZSh0aHJvd2luZzogZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcHVibGljRGF0YWJhc2UuYWRkKGZvcnVtT3BlcmF0aW9uKQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBEZWxldGUgZm9ydW0gcmVjb3JkcwogICAgICAgICAgICBpZiAhZm9ydW1SZWNvcmRJRHMuaXNFbXB0eSB7CiAgICAgICAgICAgICAgICBsZXQgZGVsZXRlT3BlcmF0aW9uID0gQ0tNb2RpZnlSZWNvcmRzT3BlcmF0aW9uKHJlY29yZHNUb1NhdmU6IG5pbCwgcmVjb3JkSURzVG9EZWxldGU6IGZvcnVtUmVjb3JkSURzKQogICAgICAgICAgICAgICAgdHJ5IGF3YWl0IHdpdGhDaGVja2VkVGhyb3dpbmdDb250aW51YXRpb24geyAoY29udGludWF0aW9uOiBDaGVja2VkQ29udGludWF0aW9uPFZvaWQsIEVycm9yPikgaW4KICAgICAgICAgICAgICAgICAgICBkZWxldGVPcGVyYXRpb24ubW9kaWZ5UmVjb3Jkc1Jlc3VsdEJsb2NrID0geyByZXN1bHQgaW4KICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIHJlc3VsdCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgLnN1Y2Nlc3M6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiU3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgXChmb3J1bVJlY29yZElEcy5jb3VudCkgZm9ydW0gcmVjb3JkcyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51YXRpb24ucmVzdW1lKCkKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAuZmFpbHVyZShsZXQgZXJyb3IpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIkVycm9yIGRlbGV0aW5nIGZvcnVtIHJlY29yZHM6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVhdGlvbi5yZXN1bWUodGhyb3dpbmc6IGVycm9yKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHB1YmxpY0RhdGFiYXNlLmFkZChkZWxldGVPcGVyYXRpb24pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHByaW50KCJGYWlsZWQgdG8gZm9yY2UgZGVsZXRlIHJlY29yZHM6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICB9CiAgICB9CgogICAgZnVuYyBkZWJ1Z0NyZWF0ZUJhc2ljRm9ydW0oKSBhc3luYyB7CiAgICAgICAgcHJpbnQoIkRFQlVHOiBDcmVhdGluZyBiYXNpYyBmb3J1bSBmb3IgdGVzdGluZyIpCgogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyLCBjdXJyZW50VXNlci5pc0FkbWluIGVsc2UgewogICAgICAgICAgICBwcmludCgiQWRtaW4gcHJpdmlsZWdlcyByZXF1aXJlZCB0byBjcmVhdGUgZm9ydW0iKQogICAgICAgICAgICByZXR1cm4KICAgICAgICB9CgogICAgICAgIGRvIHsKICAgICAgICAgICAgbGV0IGJhc2ljRm9ydW0gPSBGb3J1bSgKICAgICAgICAgICAgICAgIG5hbWU6ICJHZW5lcmFsIERpc2N1c3Npb24iLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICJBIHBsYWNlIGZvciBnZW5lcmFsIGRpc2N1c3Npb25zIGFuZCBjb252ZXJzYXRpb25zIiwKICAgICAgICAgICAgICAgIHBhcmVudEZvcnVtSUQ6IG5pbCwKICAgICAgICAgICAgICAgIGRpc3BsYXlPcmRlcjogMCwKICAgICAgICAgICAgICAgIGlzTG9ja2VkOiBmYWxzZSwKICAgICAgICAgICAgICAgIGlzSGlkZGVuOiBmYWxzZSwKICAgICAgICAgICAgICAgIHJlcXVpcmVkUGVybWlzc2lvbnM6IFtdLAogICAgICAgICAgICAgICAgdGhyZWFkQ291bnQ6IDAsCiAgICAgICAgICAgICAgICBwb3N0Q291bnQ6IDAsCiAgICAgICAgICAgICAgICBsYXN0UG9zdElEOiBuaWwsCiAgICAgICAgICAgICAgICBsYXN0UG9zdERhdGU6IG5pbCwKICAgICAgICAgICAgICAgIGxhc3RQb3N0VXNlcklEOiBuaWwsCiAgICAgICAgICAgICAgICBjcmVhdGVkRGF0ZTogRGF0ZSgpLAogICAgICAgICAgICAgICAgY3JlYXRlZEJ5VXNlcklEOiBjdXJyZW50VXNlci5pZAogICAgICAgICAgICApCgogICAgICAgICAgICBsZXQgY3JlYXRlZEZvcnVtID0gdHJ5IGF3YWl0IGNyZWF0ZUZvcnVtKGJhc2ljRm9ydW0pCiAgICAgICAgICAgIHByaW50KCJTdWNjZXNzZnVsbHkgY3JlYXRlZCBiYXNpYyBmb3J1bTogXChjcmVhdGVkRm9ydW0ubmFtZSkgKElEOiBcKGNyZWF0ZWRGb3J1bS5pZCkpIikKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBjcmVhdGUgYmFzaWMgZm9ydW06IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIikKICAgICAgICB9CiAgICB9CgogICAgZnVuYyBkZWJ1Z0NoZWNrRm9ydW1zKCkgYXN5bmMgewogICAgICAgIHByaW50KCLwn5SNIERFQlVHOiBDaGVja2luZyBleGlzdGluZyBmb3J1bXMiKQoKICAgICAgICBkbyB7CiAgICAgICAgICAgIGxldCBmb3J1bXMgPSB0cnkgYXdhaXQgZmV0Y2hGb3J1bXMoKQogICAgICAgICAgICBwcmludCgi8J+TiiBGb3VuZCBcKGZvcnVtcy5jb3VudCkgZm9ydW1zOiIpCiAgICAgICAgICAgIGZvciBmb3J1bSBpbiBmb3J1bXMgewogICAgICAgICAgICAgICAgcHJpbnQoIiAg4oCiIFwoZm9ydW0ubmFtZSkgKElEOiBcKGZvcnVtLmlkKSkiKQogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHByaW50KCLinYwgRmFpbGVkIHRvIGZldGNoIGZvcnVtczogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8gTUFSSzogLSBUaHJlYWQgT3BlcmF0aW9ucwogICAgCiAgICBmdW5jIGZldGNoVGhyZWFkcyhmb3IgZm9ydW1JRDogU3RyaW5nLCBsaW1pdDogSW50ID0gNTApIGFzeW5jIHRocm93cyAtPiBbRm9ydW1UaHJlYWRdIHsKICAgICAgICBsZXQgcHJlZGljYXRlID0gTlNQcmVkaWNhdGUoZm9ybWF0OiAiZm9ydW1JRCA9PSAlQCIsIGZvcnVtSUQpCiAgICAgICAgbGV0IHNvcnREZXNjcmlwdG9ycyA9IFsKICAgICAgICAgICAgTlNTb3J0RGVzY3JpcHRvcihrZXk6ICJpc1N0aWNreSIsIGFzY2VuZGluZzogZmFsc2UpLAogICAgICAgICAgICBOU1NvcnREZXNjcmlwdG9yKGtleTogImlzQW5ub3VuY2VtZW50IiwgYXNjZW5kaW5nOiBmYWxzZSksCiAgICAgICAgICAgIE5TU29ydERlc2NyaXB0b3Ioa2V5OiAibGFzdFBvc3REYXRlIiwgYXNjZW5kaW5nOiBmYWxzZSkKICAgICAgICBdCiAgICAgICAgcmV0dXJuIHRyeSBhd2FpdCBxdWVyeShGb3J1bVRocmVhZC5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgc29ydERlc2NyaXB0b3JzOiBzb3J0RGVzY3JpcHRvcnMsIGxpbWl0OiBsaW1pdCwgZnJvbTogcHVibGljRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIGZ1bmMgY3JlYXRlVGhyZWFkKF8gdGhyZWFkOiBGb3J1bVRocmVhZCkgYXN5bmMgdGhyb3dzIC0+IEZvcnVtVGhyZWFkIHsKICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGlzIG5vdCBiYW5uZWQKICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjdXJyZW50VXNlciwgIWN1cnJlbnRVc2VyLmlzQmFubmVkIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIllvdSBhcmUgYmFubmVkIGZyb20gY3JlYXRpbmcgdGhyZWFkcyJdKQogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHNhdmUodGhyZWFkLCB0bzogcHVibGljRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIGZ1bmMgdXBkYXRlVGhyZWFkKF8gdGhyZWFkOiBGb3J1bVRocmVhZCkgYXN5bmMgdGhyb3dzIC0+IEZvcnVtVGhyZWFkIHsKICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGlzIG5vdCBiYW5uZWQgYW5kIG93bnMgdGhlIHRocmVhZCBvciBpcyBtb2RlcmF0b3IvYWRtaW4KICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjdXJyZW50VXNlciwgIWN1cnJlbnRVc2VyLmlzQmFubmVkIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIllvdSBhcmUgYmFubmVkIGZyb20gdXBkYXRpbmcgdGhyZWFkcyJdKQogICAgICAgIH0KCiAgICAgICAgLy8gQWxsb3cgaWYgdXNlciBvd25zIHRoZSB0aHJlYWQsIGlzIG1vZGVyYXRvciwgb3IgaXMgYWRtaW4KICAgICAgICBndWFyZCB0aHJlYWQuYXV0aG9ySUQgPT0gY3VycmVudFVzZXIuaWQgfHwgY3VycmVudFVzZXIuaXNNb2RlcmF0b3IgfHwgY3VycmVudFVzZXIuaXNBZG1pbiBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDAzLCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJZb3UgY2FuIG9ubHkgdXBkYXRlIHlvdXIgb3duIHRocmVhZHMiXSkKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnkgYXdhaXQgc2F2ZSh0aHJlYWQsIHRvOiBwdWJsaWNEYXRhYmFzZSkKICAgIH0KICAgIAogICAgZnVuYyBkZWxldGVUaHJlYWQoXyB0aHJlYWRJRDogU3RyaW5nKSBhc3luYyB0aHJvd3MgewogICAgICAgIC8vIENoZWNrIGlmIHVzZXIgaGFzIG1vZGVyYXRvciBvciBhZG1pbiBwcml2aWxlZ2VzCiAgICAgICAgZ3VhcmQgbGV0IGN1cnJlbnRVc2VyID0gY3VycmVudFVzZXIsIChjdXJyZW50VXNlci5pc01vZGVyYXRvciB8fCBjdXJyZW50VXNlci5pc0FkbWluKSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDAzLCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJPbmx5IG1vZGVyYXRvcnMgYW5kIGFkbWluaXN0cmF0b3JzIGNhbiBkZWxldGUgdGhyZWFkcyJdKQogICAgICAgIH0KICAgICAgICBsZXQgcmVjb3JkSUQgPSBDS1JlY29yZC5JRChyZWNvcmROYW1lOiB0aHJlYWRJRCkKICAgICAgICB0cnkgYXdhaXQgZGVsZXRlKHJlY29yZElEOiByZWNvcmRJRCwgZnJvbTogcHVibGljRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gUG9zdCBPcGVyYXRpb25zCiAgICAKICAgIGZ1bmMgZmV0Y2hQb3N0cyhmb3IgdGhyZWFkSUQ6IFN0cmluZywgbGltaXQ6IEludCA9IDUwKSBhc3luYyB0aHJvd3MgLT4gW0ZvcnVtUG9zdF0gewogICAgICAgIGxldCBwcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZShmb3JtYXQ6ICJ0aHJlYWRJRCA9PSAlQCIsIHRocmVhZElEKQogICAgICAgIGxldCBzb3J0RGVzY3JpcHRvcnMgPSBbTlNTb3J0RGVzY3JpcHRvcihrZXk6ICJjcmVhdGVkRGF0ZSIsIGFzY2VuZGluZzogdHJ1ZSldCiAgICAgICAgcmV0dXJuIHRyeSBhd2FpdCBxdWVyeShGb3J1bVBvc3Quc2VsZiwgcHJlZGljYXRlOiBwcmVkaWNhdGUsIHNvcnREZXNjcmlwdG9yczogc29ydERlc2NyaXB0b3JzLCBsaW1pdDogbGltaXQsIGZyb206IHB1YmxpY0RhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIGNyZWF0ZVBvc3QoXyBwb3N0OiBGb3J1bVBvc3QpIGFzeW5jIHRocm93cyAtPiBGb3J1bVBvc3QgewogICAgICAgIC8vIENoZWNrIGlmIHVzZXIgaXMgbm90IGJhbm5lZAogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyLCAhY3VycmVudFVzZXIuaXNCYW5uZWQgZWxzZSB7CiAgICAgICAgICAgIHRocm93IE5TRXJyb3IoZG9tYWluOiAiTWFjQ2hhbiIsIGNvZGU6IDQwMywgdXNlckluZm86IFtOU0xvY2FsaXplZERlc2NyaXB0aW9uS2V5OiAiWW91IGFyZSBiYW5uZWQgZnJvbSBjcmVhdGluZyBwb3N0cyJdKQogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHNhdmUocG9zdCwgdG86IHB1YmxpY0RhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIHVwZGF0ZVBvc3QoXyBwb3N0OiBGb3J1bVBvc3QpIGFzeW5jIHRocm93cyAtPiBGb3J1bVBvc3QgewogICAgICAgIC8vIENoZWNrIGlmIHVzZXIgaXMgbm90IGJhbm5lZCBhbmQgb3ducyB0aGUgcG9zdCBvciBpcyBtb2RlcmF0b3IvYWRtaW4KICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjdXJyZW50VXNlciwgIWN1cnJlbnRVc2VyLmlzQmFubmVkIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIllvdSBhcmUgYmFubmVkIGZyb20gdXBkYXRpbmcgcG9zdHMiXSkKICAgICAgICB9CgogICAgICAgIC8vIEFsbG93IGlmIHVzZXIgb3ducyB0aGUgcG9zdCwgaXMgbW9kZXJhdG9yLCBvciBpcyBhZG1pbgogICAgICAgIGd1YXJkIHBvc3QuYXV0aG9ySUQgPT0gY3VycmVudFVzZXIuaWQgfHwgY3VycmVudFVzZXIuaXNNb2RlcmF0b3IgfHwgY3VycmVudFVzZXIuaXNBZG1pbiBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDAzLCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJZb3UgY2FuIG9ubHkgdXBkYXRlIHlvdXIgb3duIHBvc3RzIl0pCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHNhdmUocG9zdCwgdG86IHB1YmxpY0RhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIGRlbGV0ZVBvc3QoXyBwb3N0SUQ6IFN0cmluZykgYXN5bmMgdGhyb3dzIHsKICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGhhcyBtb2RlcmF0b3Igb3IgYWRtaW4gcHJpdmlsZWdlcwogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyLCAoY3VycmVudFVzZXIuaXNNb2RlcmF0b3IgfHwgY3VycmVudFVzZXIuaXNBZG1pbikgZWxzZSB7CiAgICAgICAgICAgIHRocm93IE5TRXJyb3IoZG9tYWluOiAiTWFjQ2hhbiIsIGNvZGU6IDQwMywgdXNlckluZm86IFtOU0xvY2FsaXplZERlc2NyaXB0aW9uS2V5OiAiT25seSBtb2RlcmF0b3JzIGFuZCBhZG1pbmlzdHJhdG9ycyBjYW4gZGVsZXRlIHBvc3RzIl0pCiAgICAgICAgfQogICAgICAgIGxldCByZWNvcmRJRCA9IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IHBvc3RJRCkKICAgICAgICB0cnkgYXdhaXQgZGVsZXRlKHJlY29yZElEOiByZWNvcmRJRCwgZnJvbTogcHVibGljRGF0YWJhc2UpCiAgICB9CgogICAgLy8gTUFSSzogLSBSb2xlIE1hbmFnZW1lbnQKCiAgICBmdW5jIHByb21vdGVVc2VyVG9Nb2RlcmF0b3IoXyB1c2VySUQ6IFN0cmluZykgYXN5bmMgdGhyb3dzIHsKICAgICAgICAvLyBDaGVjayBpZiBjdXJyZW50IHVzZXIgaXMgYWRtaW4KICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjdXJyZW50VXNlciwgY3VycmVudFVzZXIuaXNBZG1pbiBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDAzLCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJPbmx5IGFkbWluaXN0cmF0b3JzIGNhbiBwcm9tb3RlIHVzZXJzIl0pCiAgICAgICAgfQoKICAgICAgICBndWFyZCBsZXQgdXNlciA9IHRyeSBhd2FpdCBmZXRjaFVzZXIodXNlcklEKSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDA0LCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJVc2VyIG5vdCBmb3VuZCJdKQogICAgICAgIH0KCiAgICAgICAgdmFyIHVwZGF0ZWRVc2VyID0gdXNlcgogICAgICAgIHVwZGF0ZWRVc2VyLmlzTW9kZXJhdG9yID0gdHJ1ZQogICAgICAgIF8gPSB0cnkgYXdhaXQgdXBkYXRlVXNlcih1cGRhdGVkVXNlcikKICAgICAgICBwcmludCgi4pyFIFByb21vdGVkIHVzZXIgXCh1c2VyLmRpc3BsYXlOYW1lKSB0byBtb2RlcmF0b3IiKQogICAgfQoKICAgIGZ1bmMgcHJvbW90ZVVzZXJUb0FkbWluKF8gdXNlcklEOiBTdHJpbmcpIGFzeW5jIHRocm93cyB7CiAgICAgICAgLy8gQ2hlY2sgaWYgY3VycmVudCB1c2VyIGlzIGFkbWluIChvbmx5IGFkbWlucyBjYW4gcHJvbW90ZSB0byBhZG1pbikKICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjdXJyZW50VXNlciwgY3VycmVudFVzZXIuaXNBZG1pbiBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDAzLCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJPbmx5IGFkbWluaXN0cmF0b3JzIGNhbiBwcm9tb3RlIHVzZXJzIHRvIGFkbWluIl0pCiAgICAgICAgfQoKICAgICAgICBndWFyZCBsZXQgdXNlciA9IHRyeSBhd2FpdCBmZXRjaFVzZXIodXNlcklEKSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDA0LCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJVc2VyIG5vdCBmb3VuZCJdKQogICAgICAgIH0KCiAgICAgICAgdmFyIHVwZGF0ZWRVc2VyID0gdXNlcgogICAgICAgIHVwZGF0ZWRVc2VyLmlzQWRtaW4gPSB0cnVlCiAgICAgICAgdXBkYXRlZFVzZXIuaXNNb2RlcmF0b3IgPSB0cnVlIC8vIEFkbWlucyBhcmUgYWxzbyBtb2RlcmF0b3JzCiAgICAgICAgXyA9IHRyeSBhd2FpdCB1cGRhdGVVc2VyKHVwZGF0ZWRVc2VyKQogICAgICAgIHByaW50KCLinIUgUHJvbW90ZWQgdXNlciBcKHVzZXIuZGlzcGxheU5hbWUpIHRvIGFkbWluaXN0cmF0b3IiKQogICAgfQoKICAgIGZ1bmMgZGVtb3RlVXNlcihfIHVzZXJJRDogU3RyaW5nKSBhc3luYyB0aHJvd3MgewogICAgICAgIC8vIENoZWNrIGlmIGN1cnJlbnQgdXNlciBpcyBhZG1pbgogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGN1cnJlbnRVc2VyLCBjdXJyZW50VXNlci5pc0FkbWluIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIk9ubHkgYWRtaW5pc3RyYXRvcnMgY2FuIGRlbW90ZSB1c2VycyJdKQogICAgICAgIH0KCiAgICAgICAgZ3VhcmQgbGV0IHVzZXIgPSB0cnkgYXdhaXQgZmV0Y2hVc2VyKHVzZXJJRCkgZWxzZSB7CiAgICAgICAgICAgIHRocm93IE5TRXJyb3IoZG9tYWluOiAiTWFjQ2hhbiIsIGNvZGU6IDQwNCwgdXNlckluZm86IFtOU0xvY2FsaXplZERlc2NyaXB0aW9uS2V5OiAiVXNlciBub3QgZm91bmQiXSkKICAgICAgICB9CgogICAgICAgIC8vIFByZXZlbnQgZGVtb3RpbmcgeW91cnNlbGYKICAgICAgICBndWFyZCB1c2VyLmlkICE9IGN1cnJlbnRVc2VyLmlkIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIllvdSBjYW5ub3QgZGVtb3RlIHlvdXJzZWxmIl0pCiAgICAgICAgfQoKICAgICAgICB2YXIgdXBkYXRlZFVzZXIgPSB1c2VyCiAgICAgICAgdXBkYXRlZFVzZXIuaXNBZG1pbiA9IGZhbHNlCiAgICAgICAgdXBkYXRlZFVzZXIuaXNNb2RlcmF0b3IgPSBmYWxzZQogICAgICAgIF8gPSB0cnkgYXdhaXQgdXBkYXRlVXNlcih1cGRhdGVkVXNlcikKICAgICAgICBwcmludCgi4pyFIERlbW90ZWQgdXNlciBcKHVzZXIuZGlzcGxheU5hbWUpIikKICAgIH0KCiAgICBmdW5jIGJhblVzZXIoXyB1c2VySUQ6IFN0cmluZywgcmVhc29uOiBTdHJpbmc/LCBkdXJhdGlvbjogVGltZUludGVydmFsPyA9IG5pbCkgYXN5bmMgdGhyb3dzIHsKICAgICAgICAvLyBDaGVjayBpZiBjdXJyZW50IHVzZXIgaGFzIG1vZGVyYXRvciBvciBhZG1pbiBwcml2aWxlZ2VzCiAgICAgICAgZ3VhcmQgbGV0IGN1cnJlbnRVc2VyID0gY3VycmVudFVzZXIsIChjdXJyZW50VXNlci5pc01vZGVyYXRvciB8fCBjdXJyZW50VXNlci5pc0FkbWluKSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDAzLCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJPbmx5IG1vZGVyYXRvcnMgYW5kIGFkbWluaXN0cmF0b3JzIGNhbiBiYW4gdXNlcnMiXSkKICAgICAgICB9CgogICAgICAgIGd1YXJkIGxldCB1c2VyID0gdHJ5IGF3YWl0IGZldGNoVXNlcih1c2VySUQpIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDQsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIlVzZXIgbm90IGZvdW5kIl0pCiAgICAgICAgfQoKICAgICAgICAvLyBQcmV2ZW50IGJhbm5pbmcgeW91cnNlbGYKICAgICAgICBndWFyZCB1c2VyLmlkICE9IGN1cnJlbnRVc2VyLmlkIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIllvdSBjYW5ub3QgYmFuIHlvdXJzZWxmIl0pCiAgICAgICAgfQoKICAgICAgICB2YXIgdXBkYXRlZFVzZXIgPSB1c2VyCiAgICAgICAgdXBkYXRlZFVzZXIuaXNCYW5uZWQgPSB0cnVlCiAgICAgICAgdXBkYXRlZFVzZXIuYmFuUmVhc29uID0gcmVhc29uCiAgICAgICAgaWYgbGV0IGR1cmF0aW9uID0gZHVyYXRpb24gewogICAgICAgICAgICB1cGRhdGVkVXNlci5iYW5FeHBpcnkgPSBEYXRlKCkuYWRkaW5nVGltZUludGVydmFsKGR1cmF0aW9uKQogICAgICAgIH0KICAgICAgICBfID0gdHJ5IGF3YWl0IHVwZGF0ZVVzZXIodXBkYXRlZFVzZXIpCiAgICAgICAgcHJpbnQoIuKchSBCYW5uZWQgdXNlciBcKHVzZXIuZGlzcGxheU5hbWUpIikKICAgIH0KCiAgICBmdW5jIHVuYmFuVXNlcihfIHVzZXJJRDogU3RyaW5nKSBhc3luYyB0aHJvd3MgewogICAgICAgIC8vIENoZWNrIGlmIGN1cnJlbnQgdXNlciBoYXMgbW9kZXJhdG9yIG9yIGFkbWluIHByaXZpbGVnZXMKICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjdXJyZW50VXNlciwgKGN1cnJlbnRVc2VyLmlzTW9kZXJhdG9yIHx8IGN1cnJlbnRVc2VyLmlzQWRtaW4pIGVsc2UgewogICAgICAgICAgICB0aHJvdyBOU0Vycm9yKGRvbWFpbjogIk1hY0NoYW4iLCBjb2RlOiA0MDMsIHVzZXJJbmZvOiBbTlNMb2NhbGl6ZWREZXNjcmlwdGlvbktleTogIk9ubHkgbW9kZXJhdG9ycyBhbmQgYWRtaW5pc3RyYXRvcnMgY2FuIHVuYmFuIHVzZXJzIl0pCiAgICAgICAgfQoKICAgICAgICBndWFyZCBsZXQgdXNlciA9IHRyeSBhd2FpdCBmZXRjaFVzZXIodXNlcklEKSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgTlNFcnJvcihkb21haW46ICJNYWNDaGFuIiwgY29kZTogNDA0LCB1c2VySW5mbzogW05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6ICJVc2VyIG5vdCBmb3VuZCJdKQogICAgICAgIH0KCiAgICAgICAgdmFyIHVwZGF0ZWRVc2VyID0gdXNlcgogICAgICAgIHVwZGF0ZWRVc2VyLmlzQmFubmVkID0gZmFsc2UKICAgICAgICB1cGRhdGVkVXNlci5iYW5SZWFzb24gPSBuaWwKICAgICAgICB1cGRhdGVkVXNlci5iYW5FeHBpcnkgPSBuaWwKICAgICAgICBfID0gdHJ5IGF3YWl0IHVwZGF0ZVVzZXIodXBkYXRlZFVzZXIpCiAgICAgICAgcHJpbnQoIuKchSBVbmJhbm5lZCB1c2VyIFwodXNlci5kaXNwbGF5TmFtZSkiKQogICAgfQogICAgCiAgICAvLyBNQVJLOiAtIFVzZXIgT3BlcmF0aW9ucwogICAgCiAgICBmdW5jIGZldGNoVXNlcihfIHVzZXJJRDogU3RyaW5nKSBhc3luYyB0aHJvd3MgLT4gRm9ydW1Vc2VyPyB7CiAgICAgICAgbGV0IHJlY29yZElEID0gQ0tSZWNvcmQuSUQocmVjb3JkTmFtZTogdXNlcklEKQogICAgICAgIHJldHVybiB0cnkgYXdhaXQgZmV0Y2goRm9ydW1Vc2VyLnNlbGYsIHJlY29yZElEOiByZWNvcmRJRCwgZnJvbTogcHJpdmF0ZURhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIHVwZGF0ZVVzZXIoXyB1c2VyOiBGb3J1bVVzZXIpIGFzeW5jIHRocm93cyAtPiBGb3J1bVVzZXIgewogICAgICAgIHJldHVybiB0cnkgYXdhaXQgc2F2ZSh1c2VyLCB0bzogcHJpdmF0ZURhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIHNlYXJjaFVzZXJzKHF1ZXJ5OiBTdHJpbmcpIGFzeW5jIHRocm93cyAtPiBbRm9ydW1Vc2VyXSB7CiAgICAgICAgbGV0IHByZWRpY2F0ZSA9IE5TUHJlZGljYXRlKGZvcm1hdDogInVzZXJuYW1lIENPTlRBSU5TW2NkXSAlQCBPUiBkaXNwbGF5TmFtZSBDT05UQUlOU1tjZF0gJUAiLCBxdWVyeSwgcXVlcnkpCiAgICAgICAgbGV0IHNvcnREZXNjcmlwdG9ycyA9IFtOU1NvcnREZXNjcmlwdG9yKGtleTogInVzZXJuYW1lIiwgYXNjZW5kaW5nOiB0cnVlKV0KICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHNlbGYucXVlcnkoRm9ydW1Vc2VyLnNlbGYsIHByZWRpY2F0ZTogcHJlZGljYXRlLCBzb3J0RGVzY3JpcHRvcnM6IHNvcnREZXNjcmlwdG9ycywgZnJvbTogcHJpdmF0ZURhdGFiYXNlKQogICAgfQogICAgCiAgICAvLyBNQVJLOiAtIFByaXZhdGUgTWVzc2FnZSBPcGVyYXRpb25zCiAgICAKICAgIGZ1bmMgZmV0Y2hQcml2YXRlTWVzc2FnZXMoZm9yIHVzZXJJRDogU3RyaW5nKSBhc3luYyB0aHJvd3MgLT4gW1ByaXZhdGVNZXNzYWdlXSB7CiAgICAgICAgbGV0IHByZWRpY2F0ZSA9IE5TUHJlZGljYXRlKGZvcm1hdDogInJlY2lwaWVudElEID09ICVAIEFORCBpc0RlbGV0ZWRCeVJlY2lwaWVudCA9PSBOTyIsIHVzZXJJRCkKICAgICAgICBsZXQgc29ydERlc2NyaXB0b3JzID0gW05TU29ydERlc2NyaXB0b3Ioa2V5OiAic2VudERhdGUiLCBhc2NlbmRpbmc6IGZhbHNlKV0KICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHF1ZXJ5KFByaXZhdGVNZXNzYWdlLnNlbGYsIHByZWRpY2F0ZTogcHJlZGljYXRlLCBzb3J0RGVzY3JpcHRvcnM6IHNvcnREZXNjcmlwdG9ycywgZnJvbTogcHJpdmF0ZURhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIGZldGNoU2VudE1lc3NhZ2VzKGZvciB1c2VySUQ6IFN0cmluZykgYXN5bmMgdGhyb3dzIC0+IFtQcml2YXRlTWVzc2FnZV0gewogICAgICAgIGxldCBwcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZShmb3JtYXQ6ICJzZW5kZXJJRCA9PSAlQCBBTkQgaXNEZWxldGVkQnlTZW5kZXIgPT0gTk8iLCB1c2VySUQpCiAgICAgICAgbGV0IHNvcnREZXNjcmlwdG9ycyA9IFtOU1NvcnREZXNjcmlwdG9yKGtleTogInNlbnREYXRlIiwgYXNjZW5kaW5nOiBmYWxzZSldCiAgICAgICAgcmV0dXJuIHRyeSBhd2FpdCBxdWVyeShQcml2YXRlTWVzc2FnZS5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgc29ydERlc2NyaXB0b3JzOiBzb3J0RGVzY3JpcHRvcnMsIGZyb206IHByaXZhdGVEYXRhYmFzZSkKICAgIH0KICAgIAogICAgZnVuYyBjcmVhdGVQcml2YXRlTWVzc2FnZShfIG1lc3NhZ2U6IFByaXZhdGVNZXNzYWdlKSBhc3luYyB0aHJvd3MgLT4gUHJpdmF0ZU1lc3NhZ2UgewogICAgICAgIHJldHVybiB0cnkgYXdhaXQgc2F2ZShtZXNzYWdlLCB0bzogcHJpdmF0ZURhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIG1hcmtNZXNzYWdlQXNSZWFkKF8gbWVzc2FnZUlEOiBTdHJpbmcpIGFzeW5jIHRocm93cyB7CiAgICAgICAgbGV0IHJlY29yZElEID0gQ0tSZWNvcmQuSUQocmVjb3JkTmFtZTogbWVzc2FnZUlEKQogICAgICAgIGlmIGxldCByZWNvcmQgPSB0cnk/IGF3YWl0IHByaXZhdGVEYXRhYmFzZS5yZWNvcmQoZm9yOiByZWNvcmRJRCkgewogICAgICAgICAgICByZWNvcmRbImlzUmVhZCJdID0gdHJ1ZQogICAgICAgICAgICByZWNvcmRbInJlYWREYXRlIl0gPSBEYXRlKCkKICAgICAgICAgICAgdHJ5IGF3YWl0IHByaXZhdGVEYXRhYmFzZS5zYXZlKHJlY29yZCkKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gUG9sbCBPcGVyYXRpb25zCiAgICAKICAgIGZ1bmMgZmV0Y2hQb2xsKGZvciB0aHJlYWRJRDogU3RyaW5nKSBhc3luYyB0aHJvd3MgLT4gRm9ydW1Qb2xsPyB7CiAgICAgICAgbGV0IHByZWRpY2F0ZSA9IE5TUHJlZGljYXRlKGZvcm1hdDogInRocmVhZElEID09ICVAIiwgdGhyZWFkSUQpCiAgICAgICAgbGV0IHBvbGxzID0gdHJ5IGF3YWl0IHF1ZXJ5KEZvcnVtUG9sbC5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgZnJvbTogcHVibGljRGF0YWJhc2UpCiAgICAgICAgcmV0dXJuIHBvbGxzLmZpcnN0CiAgICB9CiAgICAKICAgIGZ1bmMgY3JlYXRlUG9sbChfIHBvbGw6IEZvcnVtUG9sbCkgYXN5bmMgdGhyb3dzIC0+IEZvcnVtUG9sbCB7CiAgICAgICAgcmV0dXJuIHRyeSBhd2FpdCBzYXZlKHBvbGwsIHRvOiBwdWJsaWNEYXRhYmFzZSkKICAgIH0KICAgIAogICAgZnVuYyB1cGRhdGVQb2xsKF8gcG9sbDogRm9ydW1Qb2xsKSBhc3luYyB0aHJvd3MgLT4gRm9ydW1Qb2xsIHsKICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHNhdmUocG9sbCwgdG86IHB1YmxpY0RhdGFiYXNlKQogICAgfQogICAgCiAgICAvLyBNQVJLOiAtIFNlYXJjaCBPcGVyYXRpb25zCiAgICAKICAgIGZ1bmMgc2VhcmNoUG9zdHMocXVlcnk6IFN0cmluZywgbGltaXQ6IEludCA9IDUwKSBhc3luYyB0aHJvd3MgLT4gW0ZvcnVtUG9zdF0gewogICAgICAgIGxldCBwcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZShmb3JtYXQ6ICJjb250ZW50IENPTlRBSU5TW2NkXSAlQCIsIHF1ZXJ5KQogICAgICAgIGxldCBzb3J0RGVzY3JpcHRvcnMgPSBbTlNTb3J0RGVzY3JpcHRvcihrZXk6ICJjcmVhdGVkRGF0ZSIsIGFzY2VuZGluZzogZmFsc2UpXQogICAgICAgIHJldHVybiB0cnkgYXdhaXQgc2VsZi5xdWVyeShGb3J1bVBvc3Quc2VsZiwgcHJlZGljYXRlOiBwcmVkaWNhdGUsIHNvcnREZXNjcmlwdG9yczogc29ydERlc2NyaXB0b3JzLCBsaW1pdDogbGltaXQsIGZyb206IHB1YmxpY0RhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIHNlYXJjaFRocmVhZHMocXVlcnk6IFN0cmluZywgbGltaXQ6IEludCA9IDUwKSBhc3luYyB0aHJvd3MgLT4gW0ZvcnVtVGhyZWFkXSB7CiAgICAgICAgbGV0IHByZWRpY2F0ZSA9IE5TUHJlZGljYXRlKGZvcm1hdDogInRpdGxlIENPTlRBSU5TW2NkXSAlQCIsIHF1ZXJ5KQogICAgICAgIGxldCBzb3J0RGVzY3JpcHRvcnMgPSBbTlNTb3J0RGVzY3JpcHRvcihrZXk6ICJjcmVhdGVkRGF0ZSIsIGFzY2VuZGluZzogZmFsc2UpXQogICAgICAgIHJldHVybiB0cnkgYXdhaXQgc2VsZi5xdWVyeShGb3J1bVRocmVhZC5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgc29ydERlc2NyaXB0b3JzOiBzb3J0RGVzY3JpcHRvcnMsIGxpbWl0OiBsaW1pdCwgZnJvbTogcHVibGljRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gQXR0YWNobWVudCBPcGVyYXRpb25zCiAgICAKICAgIGZ1bmMgdXBsb2FkQXR0YWNobWVudChfIGRhdGE6IERhdGEsIGZpbGVuYW1lOiBTdHJpbmcsIG1pbWVUeXBlOiBTdHJpbmcpIGFzeW5jIHRocm93cyAtPiBBdHRhY2htZW50IHsKICAgICAgICBsZXQgYXNzZXQgPSBDS0Fzc2V0KGZpbGVVUkw6IGNyZWF0ZVRlbXBvcmFyeUZpbGUoZGF0YTogZGF0YSwgZmlsZW5hbWU6IGZpbGVuYW1lKSkKICAgICAgICBsZXQgcmVjb3JkID0gQ0tSZWNvcmQocmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLmF0dGFjaG1lbnQucmF3VmFsdWUpCiAgICAgICAgcmVjb3JkWyJmaWxlbmFtZSJdID0gZmlsZW5hbWUKICAgICAgICByZWNvcmRbIm9yaWdpbmFsRmlsZW5hbWUiXSA9IGZpbGVuYW1lCiAgICAgICAgcmVjb3JkWyJmaWxlU2l6ZSJdID0gSW50NjQoZGF0YS5jb3VudCkKICAgICAgICByZWNvcmRbIm1pbWVUeXBlIl0gPSBtaW1lVHlwZQogICAgICAgIHJlY29yZFsidXBsb2FkZWRCeVVzZXJJRCJdID0gY3VycmVudFVzZXI/LmlkCiAgICAgICAgcmVjb3JkWyJ1cGxvYWRlZERhdGUiXSA9IERhdGUoKQogICAgICAgIHJlY29yZFsiaXNJbWFnZSJdID0gbWltZVR5cGUuaGFzUHJlZml4KCJpbWFnZS8iKQogICAgICAgIHJlY29yZFsiYXNzZXQiXSA9IGFzc2V0CiAgICAgICAgCiAgICAgICAgbGV0IHNhdmVkUmVjb3JkID0gdHJ5IGF3YWl0IHB1YmxpY0RhdGFiYXNlLnNhdmUocmVjb3JkKQogICAgICAgIHJldHVybiBBdHRhY2htZW50LmZyb21DbG91ZEtpdFJlY29yZChzYXZlZFJlY29yZCkgPz8gQXR0YWNobWVudChmaWxlbmFtZTogZmlsZW5hbWUsIG9yaWdpbmFsRmlsZW5hbWU6IGZpbGVuYW1lLCBmaWxlU2l6ZTogSW50NjQoZGF0YS5jb3VudCksIG1pbWVUeXBlOiBtaW1lVHlwZSwgdXBsb2FkZWRCeVVzZXJJRDogY3VycmVudFVzZXI/LmlkID8/ICIiKQogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgY3JlYXRlVGVtcG9yYXJ5RmlsZShkYXRhOiBEYXRhLCBmaWxlbmFtZTogU3RyaW5nKSAtPiBVUkwgewogICAgICAgIGxldCB0ZW1wVVJMID0gRmlsZU1hbmFnZXIuZGVmYXVsdC50ZW1wb3JhcnlEaXJlY3RvcnkuYXBwZW5kaW5nUGF0aENvbXBvbmVudChmaWxlbmFtZSkKICAgICAgICB0cnk/IGRhdGEud3JpdGUodG86IHRlbXBVUkwpCiAgICAgICAgcmV0dXJuIHRlbXBVUkwKICAgIH0KICAgIAogICAgLy8gTUFSSzogLSBTdWJzY3JpcHRpb24gT3BlcmF0aW9ucwogICAgCiAgICBmdW5jIHNldHVwU3Vic2NyaXB0aW9ucygpIGFzeW5jIHRocm93cyB7CiAgICAgICAgLy8gU3Vic2NyaWJlIHRvIG5ldyBwb3N0cwogICAgICAgIGxldCBwb3N0U3Vic2NyaXB0aW9uID0gQ0tRdWVyeVN1YnNjcmlwdGlvbigKICAgICAgICAgICAgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLnBvc3QucmF3VmFsdWUsCiAgICAgICAgICAgIHByZWRpY2F0ZTogTlNQcmVkaWNhdGUodmFsdWU6IHRydWUpLAogICAgICAgICAgICBzdWJzY3JpcHRpb25JRDogIm5ldy1wb3N0cyIsCiAgICAgICAgICAgIG9wdGlvbnM6IFsuZmlyZXNPblJlY29yZENyZWF0aW9uXQogICAgICAgICkKICAgICAgICAKICAgICAgICBsZXQgcG9zdE5vdGlmaWNhdGlvbiA9IENLU3Vic2NyaXB0aW9uLk5vdGlmaWNhdGlvbkluZm8oKQogICAgICAgIHBvc3ROb3RpZmljYXRpb24uYWxlcnRCb2R5ID0gIk5ldyBwb3N0IGluIGEgdGhyZWFkIHlvdSdyZSBmb2xsb3dpbmciCiAgICAgICAgcG9zdE5vdGlmaWNhdGlvbi5zaG91bGRCYWRnZSA9IHRydWUKICAgICAgICBwb3N0U3Vic2NyaXB0aW9uLm5vdGlmaWNhdGlvbkluZm8gPSBwb3N0Tm90aWZpY2F0aW9uCiAgICAgICAgCiAgICAgICAgdHJ5IGF3YWl0IHB1YmxpY0RhdGFiYXNlLnNhdmUocG9zdFN1YnNjcmlwdGlvbikKICAgICAgICAKICAgICAgICAvLyBTdWJzY3JpYmUgdG8gcHJpdmF0ZSBtZXNzYWdlcwogICAgICAgIGxldCBtZXNzYWdlU3Vic2NyaXB0aW9uID0gQ0tRdWVyeVN1YnNjcmlwdGlvbigKICAgICAgICAgICAgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLnByaXZhdGVNZXNzYWdlLnJhd1ZhbHVlLAogICAgICAgICAgICBwcmVkaWNhdGU6IE5TUHJlZGljYXRlKGZvcm1hdDogInJlY2lwaWVudElEID09ICVAIiwgY3VycmVudFVzZXI/LmlkID8/ICIiKSwKICAgICAgICAgICAgc3Vic2NyaXB0aW9uSUQ6ICJwcml2YXRlLW1lc3NhZ2VzIiwKICAgICAgICAgICAgb3B0aW9uczogWy5maXJlc09uUmVjb3JkQ3JlYXRpb25dCiAgICAgICAgKQogICAgICAgIAogICAgICAgIGxldCBtZXNzYWdlTm90aWZpY2F0aW9uID0gQ0tTdWJzY3JpcHRpb24uTm90aWZpY2F0aW9uSW5mbygpCiAgICAgICAgbWVzc2FnZU5vdGlmaWNhdGlvbi5hbGVydEJvZHkgPSAiWW91IGhhdmUgYSBuZXcgcHJpdmF0ZSBtZXNzYWdlIgogICAgICAgIG1lc3NhZ2VOb3RpZmljYXRpb24uc2hvdWxkQmFkZ2UgPSB0cnVlCiAgICAgICAgbWVzc2FnZVN1YnNjcmlwdGlvbi5ub3RpZmljYXRpb25JbmZvID0gbWVzc2FnZU5vdGlmaWNhdGlvbgogICAgICAgIAogICAgICAgIHRyeSBhd2FpdCBwcml2YXRlRGF0YWJhc2Uuc2F2ZShtZXNzYWdlU3Vic2NyaXB0aW9uKQogICAgfQogICAgCiAgICAvLyBNQVJLOiAtIERyYWZ0IE9wZXJhdGlvbnMKICAgIAogICAgZnVuYyBzYXZlRHJhZnQoXyBkcmFmdDogUG9zdERyYWZ0KSBhc3luYyB0aHJvd3MgLT4gUG9zdERyYWZ0IHsKICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHNhdmUoZHJhZnQsIHRvOiBwcml2YXRlRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIGZ1bmMgZmV0Y2hEcmFmdHMoZm9yIHVzZXJJRDogU3RyaW5nKSBhc3luYyB0aHJvd3MgLT4gW1Bvc3REcmFmdF0gewogICAgICAgIGxldCBwcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZShmb3JtYXQ6ICJ1c2VySUQgPT0gJUAiLCB1c2VySUQpCiAgICAgICAgbGV0IHNvcnREZXNjcmlwdG9ycyA9IFtOU1NvcnREZXNjcmlwdG9yKGtleTogImxhc3RNb2RpZmllZERhdGUiLCBhc2NlbmRpbmc6IGZhbHNlKV0KICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHF1ZXJ5KFBvc3REcmFmdC5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgc29ydERlc2NyaXB0b3JzOiBzb3J0RGVzY3JpcHRvcnMsIGZyb206IHByaXZhdGVEYXRhYmFzZSkKICAgIH0KICAgIAogICAgZnVuYyBkZWxldGVEcmFmdChfIGRyYWZ0SUQ6IFN0cmluZykgYXN5bmMgdGhyb3dzIHsKICAgICAgICBsZXQgcmVjb3JkSUQgPSBDS1JlY29yZC5JRChyZWNvcmROYW1lOiBkcmFmdElEKQogICAgICAgIHRyeSBhd2FpdCBkZWxldGUocmVjb3JkSUQ6IHJlY29yZElELCBmcm9tOiBwcml2YXRlRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gTGlrZSBPcGVyYXRpb25zCiAgICAKICAgIGZ1bmMgdG9nZ2xlTGlrZShwb3N0SUQ6IFN0cmluZywgdXNlcklEOiBTdHJpbmcsIGlzTGlrZTogQm9vbCkgYXN5bmMgdGhyb3dzIHsKICAgICAgICBsZXQgcHJlZGljYXRlID0gTlNQcmVkaWNhdGUoZm9ybWF0OiAicG9zdElEID09ICVAIEFORCB1c2VySUQgPT0gJUAiLCBwb3N0SUQsIHVzZXJJRCkKICAgICAgICBsZXQgZXhpc3RpbmdMaWtlcyA9IHRyeSBhd2FpdCBxdWVyeShQb3N0TGlrZS5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgZnJvbTogcHVibGljRGF0YWJhc2UpCiAgICAgICAgCiAgICAgICAgaWYgbGV0IGV4aXN0aW5nTGlrZSA9IGV4aXN0aW5nTGlrZXMuZmlyc3QgewogICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgbGlrZQogICAgICAgICAgICBsZXQgdXBkYXRlZExpa2UgPSBQb3N0TGlrZShpZDogZXhpc3RpbmdMaWtlLmlkLCBwb3N0SUQ6IHBvc3RJRCwgdXNlcklEOiB1c2VySUQsIGlzTGlrZTogaXNMaWtlKQogICAgICAgICAgICBfID0gdHJ5IGF3YWl0IHNhdmUodXBkYXRlZExpa2UsIHRvOiBwdWJsaWNEYXRhYmFzZSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGxpa2UKICAgICAgICAgICAgbGV0IG5ld0xpa2UgPSBQb3N0TGlrZShwb3N0SUQ6IHBvc3RJRCwgdXNlcklEOiB1c2VySUQsIGlzTGlrZTogaXNMaWtlKQogICAgICAgICAgICBfID0gdHJ5IGF3YWl0IHNhdmUobmV3TGlrZSwgdG86IHB1YmxpY0RhdGFiYXNlKQogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuYyBmZXRjaExpa2VzKGZvciBwb3N0SUQ6IFN0cmluZykgYXN5bmMgdGhyb3dzIC0+IFtQb3N0TGlrZV0gewogICAgICAgIGxldCBwcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZShmb3JtYXQ6ICJwb3N0SUQgPT0gJUAiLCBwb3N0SUQpCiAgICAgICAgcmV0dXJuIHRyeSBhd2FpdCBxdWVyeShQb3N0TGlrZS5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgZnJvbTogcHVibGljRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gTW9kZXJhdGlvbiBPcGVyYXRpb25zCiAgICAKICAgIGZ1bmMgY3JlYXRlTW9kZXJhdGlvbkFjdGlvbihfIGFjdGlvbjogTW9kZXJhdGlvbkFjdGlvbikgYXN5bmMgdGhyb3dzIC0+IE1vZGVyYXRpb25BY3Rpb24gewogICAgICAgIHJldHVybiB0cnkgYXdhaXQgc2F2ZShhY3Rpb24sIHRvOiBwdWJsaWNEYXRhYmFzZSkKICAgIH0KICAgIAogICAgZnVuYyBmZXRjaE1vZGVyYXRpb25BY3Rpb25zKGZvciB0YXJnZXRJRDogU3RyaW5nKSBhc3luYyB0aHJvd3MgLT4gW01vZGVyYXRpb25BY3Rpb25dIHsKICAgICAgICBsZXQgcHJlZGljYXRlID0gTlNQcmVkaWNhdGUoZm9ybWF0OiAidGFyZ2V0SUQgPT0gJUAiLCB0YXJnZXRJRCkKICAgICAgICBsZXQgc29ydERlc2NyaXB0b3JzID0gW05TU29ydERlc2NyaXB0b3Ioa2V5OiAiYWN0aW9uRGF0ZSIsIGFzY2VuZGluZzogZmFsc2UpXQogICAgICAgIHJldHVybiB0cnkgYXdhaXQgcXVlcnkoTW9kZXJhdGlvbkFjdGlvbi5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgc29ydERlc2NyaXB0b3JzOiBzb3J0RGVzY3JpcHRvcnMsIGZyb206IHB1YmxpY0RhdGFiYXNlKQogICAgfQogICAgCiAgICBmdW5jIGNyZWF0ZVJlcG9ydChfIHJlcG9ydDogUmVwb3J0KSBhc3luYyB0aHJvd3MgLT4gUmVwb3J0IHsKICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHNhdmUocmVwb3J0LCB0bzogcHVibGljRGF0YWJhc2UpCiAgICB9CiAgICAKICAgIGZ1bmMgZmV0Y2hSZXBvcnRzKGlzUmVzb2x2ZWQ6IEJvb2w/ID0gbmlsKSBhc3luYyB0aHJvd3MgLT4gW1JlcG9ydF0gewogICAgICAgIGxldCBwcmVkaWNhdGU6IE5TUHJlZGljYXRlCiAgICAgICAgaWYgbGV0IGlzUmVzb2x2ZWQgPSBpc1Jlc29sdmVkIHsKICAgICAgICAgICAgcHJlZGljYXRlID0gTlNQcmVkaWNhdGUoZm9ybWF0OiAiaXNSZXNvbHZlZCA9PSAlQCIsIE5TTnVtYmVyKHZhbHVlOiBpc1Jlc29sdmVkKSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZSh2YWx1ZTogdHJ1ZSkKICAgICAgICB9CiAgICAgICAgbGV0IHNvcnREZXNjcmlwdG9ycyA9IFtOU1NvcnREZXNjcmlwdG9yKGtleTogInJlcG9ydERhdGUiLCBhc2NlbmRpbmc6IGZhbHNlKV0KICAgICAgICByZXR1cm4gdHJ5IGF3YWl0IHF1ZXJ5KFJlcG9ydC5zZWxmLCBwcmVkaWNhdGU6IHByZWRpY2F0ZSwgc29ydERlc2NyaXB0b3JzOiBzb3J0RGVzY3JpcHRvcnMsIGZyb206IHB1YmxpY0RhdGFiYXNlKQogICAgfQp9CgovLyBNQVJLOiAtIEV4dGVuc2lvbnMgZm9yIENsb3VkS2l0UmVjb3JkQ29udmVydGlibGUKCmV4dGVuc2lvbiBGb3J1bVVzZXI6IENsb3VkS2l0UmVjb3JkQ29udmVydGlibGUgewogICAgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC51c2VyIH0KICAgIHN0YXRpYyB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLnVzZXIgfQp9CgpleHRlbnNpb24gRm9ydW06IENsb3VkS2l0UmVjb3JkQ29udmVydGlibGUgewogICAgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC5mb3J1bSB9CiAgICBzdGF0aWMgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC5mb3J1bSB9Cn0KCmV4dGVuc2lvbiBGb3J1bVRocmVhZDogQ2xvdWRLaXRSZWNvcmRDb252ZXJ0aWJsZSB7CiAgICB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLnRocmVhZCB9CiAgICBzdGF0aWMgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC50aHJlYWQgfQp9CgpleHRlbnNpb24gRm9ydW1Qb3N0OiBDbG91ZEtpdFJlY29yZENvbnZlcnRpYmxlIHsKICAgIHZhciByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUgeyAucG9zdCB9CiAgICBzdGF0aWMgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC5wb3N0IH0KfQoKZXh0ZW5zaW9uIEZvcnVtUG9sbDogQ2xvdWRLaXRSZWNvcmRDb252ZXJ0aWJsZSB7CiAgICB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLnBvbGwgfQogICAgc3RhdGljIHZhciByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUgeyAucG9sbCB9Cn0KCmV4dGVuc2lvbiBQcml2YXRlTWVzc2FnZTogQ2xvdWRLaXRSZWNvcmRDb252ZXJ0aWJsZSB7CiAgICB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLnByaXZhdGVNZXNzYWdlIH0KICAgIHN0YXRpYyB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLnByaXZhdGVNZXNzYWdlIH0KfQoKZXh0ZW5zaW9uIEF0dGFjaG1lbnQ6IENsb3VkS2l0UmVjb3JkQ29udmVydGlibGUgewogICAgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC5hdHRhY2htZW50IH0KICAgIHN0YXRpYyB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLmF0dGFjaG1lbnQgfQp9CgpleHRlbnNpb24gVXNlckdyb3VwOiBDbG91ZEtpdFJlY29yZENvbnZlcnRpYmxlIHsKICAgIHZhciByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUgeyAudXNlckdyb3VwIH0KICAgIHN0YXRpYyB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLnVzZXJHcm91cCB9Cn0KCmV4dGVuc2lvbiBNb2RlcmF0aW9uQWN0aW9uOiBDbG91ZEtpdFJlY29yZENvbnZlcnRpYmxlIHsKICAgIHZhciByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUgeyAubW9kZXJhdGlvbkFjdGlvbiB9CiAgICBzdGF0aWMgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC5tb2RlcmF0aW9uQWN0aW9uIH0KfQoKZXh0ZW5zaW9uIFJlcG9ydDogQ2xvdWRLaXRSZWNvcmRDb252ZXJ0aWJsZSB7CiAgICB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLnJlcG9ydCB9CiAgICBzdGF0aWMgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC5yZXBvcnQgfQp9CgpleHRlbnNpb24gUG9zdERyYWZ0OiBDbG91ZEtpdFJlY29yZENvbnZlcnRpYmxlIHsKICAgIHZhciByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUgeyAuZHJhZnQgfQogICAgc3RhdGljIHZhciByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUgeyAuZHJhZnQgfQp9CgpleHRlbnNpb24gUG9zdExpa2U6IENsb3VkS2l0UmVjb3JkQ29udmVydGlibGUgewogICAgdmFyIHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZSB7IC5saWtlIH0KICAgIHN0YXRpYyB2YXIgcmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlIHsgLmxpa2UgfQp9CgpleHRlbnNpb24gUG9zdFF1b3RlOiBDbG91ZEtpdFJlY29yZENvbnZlcnRpYmxlIHsKICAgIHZhciByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUgeyAucXVvdGUgfQogICAgc3RhdGljIHZhciByZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUgeyAucXVvdGUgfQp9Cgo=
--- END ---

--- FILE: MacChan/Managers/OfflineManager.swift ---
BASE64: Ly8KLy8gIE9mZmxpbmVNYW5hZ2VyLnN3aWZ0Ci8vICBNYWNDaGFuCi8vCi8vICBDcmVhdGVkIGJ5IEphcmVkIE1heHdlbGwgb24gOS8zLzI1LgovLwoKaW1wb3J0IEZvdW5kYXRpb24KaW1wb3J0IENvcmVEYXRhCmltcG9ydCBDbG91ZEtpdAoKQE1haW5BY3RvcgpjbGFzcyBPZmZsaW5lTWFuYWdlcjogT2JzZXJ2YWJsZU9iamVjdCB7CiAgICBzdGF0aWMgbGV0IHNoYXJlZCA9IE9mZmxpbmVNYW5hZ2VyKCkKICAgIAogICAgQFB1Ymxpc2hlZCB2YXIgaXNPZmZsaW5lID0gZmFsc2UKICAgIEBQdWJsaXNoZWQgdmFyIHBlbmRpbmdTeW5jQ291bnQgPSAwCiAgICAKICAgIHByaXZhdGUgbGV0IGNsb3VkS2l0TWFuYWdlciA9IENsb3VkS2l0TWFuYWdlci5zaGFyZWQKICAgIHByaXZhdGUgbGV0IHBlcnNpc3RlbmNlQ29udHJvbGxlciA9IFBlcnNpc3RlbmNlQ29udHJvbGxlci5zaGFyZWQKICAgIHByaXZhdGUgbGV0IHVzZXJEZWZhdWx0cyA9IFVzZXJEZWZhdWx0cy5zdGFuZGFyZAogICAgCiAgICBwcml2YXRlIGluaXQoKSB7CiAgICAgICAgY2hlY2tOZXR3b3JrU3RhdHVzKCkKICAgICAgICBzZXR1cE5ldHdvcmtNb25pdG9yaW5nKCkKICAgIH0KICAgIAogICAgLy8gTUFSSzogLSBOZXR3b3JrIFN0YXR1cwogICAgCiAgICBwcml2YXRlIGZ1bmMgY2hlY2tOZXR3b3JrU3RhdHVzKCkgewogICAgICAgIC8vIFNpbXBsZSBuZXR3b3JrIGNoZWNrIC0gaW4gYSByZWFsIGFwcCB5b3UnZCB1c2UgTmV0d29yayBmcmFtZXdvcmsKICAgICAgICBpc09mZmxpbmUgPSAhaXNOZXR3b3JrQXZhaWxhYmxlKCkKICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGlzTmV0d29ya0F2YWlsYWJsZSgpIC0+IEJvb2wgewogICAgICAgIC8vIFRoaXMgaXMgYSBzaW1wbGlmaWVkIGNoZWNrIC0gaW4gcHJvZHVjdGlvbiB5b3UnZCB1c2UgcHJvcGVyIG5ldHdvcmsgbW9uaXRvcmluZwogICAgICAgIHJldHVybiB0cnVlIC8vIEZvciBub3csIGFzc3VtZSBuZXR3b3JrIGlzIGF2YWlsYWJsZQogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgc2V0dXBOZXR3b3JrTW9uaXRvcmluZygpIHsKICAgICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHlvdSdkIHVzZSBOZXR3b3JrIGZyYW1ld29yayB0byBtb25pdG9yIGNvbm5lY3Rpdml0eQogICAgICAgIC8vIEZvciBub3csIHdlJ2xsIGp1c3QgY2hlY2sgcGVyaW9kaWNhbGx5CiAgICAgICAgVGltZXIuc2NoZWR1bGVkVGltZXIod2l0aFRpbWVJbnRlcnZhbDogMzAuMCwgcmVwZWF0czogdHJ1ZSkgeyBfIGluCiAgICAgICAgICAgIFRhc2sgeyBATWFpbkFjdG9yIGluCiAgICAgICAgICAgICAgICBzZWxmLmNoZWNrTmV0d29ya1N0YXR1cygpCiAgICAgICAgICAgICAgICBpZiAhc2VsZi5pc09mZmxpbmUgewogICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuc3luY1BlbmRpbmdDaGFuZ2VzKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8gTUFSSzogLSBPZmZsaW5lIENhY2hpbmcKICAgIAogICAgZnVuYyBjYWNoZUZvcnVtKF8gZm9ydW06IEZvcnVtKSB7CiAgICAgICAgbGV0IGtleSA9ICJjYWNoZWRfZm9ydW1fXChmb3J1bS5pZCkiCiAgICAgICAgaWYgbGV0IGRhdGEgPSB0cnk/IEpTT05FbmNvZGVyKCkuZW5jb2RlKGZvcnVtKSB7CiAgICAgICAgICAgIHVzZXJEZWZhdWx0cy5zZXQoZGF0YSwgZm9yS2V5OiBrZXkpCiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jIGdldENhY2hlZEZvcnVtKF8gZm9ydW1JRDogU3RyaW5nKSAtPiBGb3J1bT8gewogICAgICAgIGxldCBrZXkgPSAiY2FjaGVkX2ZvcnVtX1woZm9ydW1JRCkiCiAgICAgICAgZ3VhcmQgbGV0IGRhdGEgPSB1c2VyRGVmYXVsdHMuZGF0YShmb3JLZXk6IGtleSkgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIHJldHVybiB0cnk/IEpTT05EZWNvZGVyKCkuZGVjb2RlKEZvcnVtLnNlbGYsIGZyb206IGRhdGEpCiAgICB9CiAgICAKICAgIGZ1bmMgY2FjaGVUaHJlYWQoXyB0aHJlYWQ6IEZvcnVtVGhyZWFkKSB7CiAgICAgICAgbGV0IGtleSA9ICJjYWNoZWRfdGhyZWFkX1wodGhyZWFkLmlkKSIKICAgICAgICBpZiBsZXQgZGF0YSA9IHRyeT8gSlNPTkVuY29kZXIoKS5lbmNvZGUodGhyZWFkKSB7CiAgICAgICAgICAgIHVzZXJEZWZhdWx0cy5zZXQoZGF0YSwgZm9yS2V5OiBrZXkpCiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jIGdldENhY2hlZFRocmVhZChfIHRocmVhZElEOiBTdHJpbmcpIC0+IEZvcnVtVGhyZWFkPyB7CiAgICAgICAgbGV0IGtleSA9ICJjYWNoZWRfdGhyZWFkX1wodGhyZWFkSUQpIgogICAgICAgIGd1YXJkIGxldCBkYXRhID0gdXNlckRlZmF1bHRzLmRhdGEoZm9yS2V5OiBrZXkpIGVsc2UgeyByZXR1cm4gbmlsIH0KICAgICAgICByZXR1cm4gdHJ5PyBKU09ORGVjb2RlcigpLmRlY29kZShGb3J1bVRocmVhZC5zZWxmLCBmcm9tOiBkYXRhKQogICAgfQogICAgCiAgICBmdW5jIGNhY2hlUG9zdChfIHBvc3Q6IEZvcnVtUG9zdCkgewogICAgICAgIGxldCBrZXkgPSAiY2FjaGVkX3Bvc3RfXChwb3N0LmlkKSIKICAgICAgICBpZiBsZXQgZGF0YSA9IHRyeT8gSlNPTkVuY29kZXIoKS5lbmNvZGUocG9zdCkgewogICAgICAgICAgICB1c2VyRGVmYXVsdHMuc2V0KGRhdGEsIGZvcktleToga2V5KQogICAgICAgIH0KICAgIH0KICAgIAogICAgZnVuYyBnZXRDYWNoZWRQb3N0KF8gcG9zdElEOiBTdHJpbmcpIC0+IEZvcnVtUG9zdD8gewogICAgICAgIGxldCBrZXkgPSAiY2FjaGVkX3Bvc3RfXChwb3N0SUQpIgogICAgICAgIGd1YXJkIGxldCBkYXRhID0gdXNlckRlZmF1bHRzLmRhdGEoZm9yS2V5OiBrZXkpIGVsc2UgeyByZXR1cm4gbmlsIH0KICAgICAgICByZXR1cm4gdHJ5PyBKU09ORGVjb2RlcigpLmRlY29kZShGb3J1bVBvc3Quc2VsZiwgZnJvbTogZGF0YSkKICAgIH0KICAgIAogICAgZnVuYyBjYWNoZVVzZXIoXyB1c2VyOiBGb3J1bVVzZXIpIHsKICAgICAgICBsZXQga2V5ID0gImNhY2hlZF91c2VyX1wodXNlci5pZCkiCiAgICAgICAgaWYgbGV0IGRhdGEgPSB0cnk/IEpTT05FbmNvZGVyKCkuZW5jb2RlKHVzZXIpIHsKICAgICAgICAgICAgdXNlckRlZmF1bHRzLnNldChkYXRhLCBmb3JLZXk6IGtleSkKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmMgZ2V0Q2FjaGVkVXNlcihfIHVzZXJJRDogU3RyaW5nKSAtPiBGb3J1bVVzZXI/IHsKICAgICAgICBsZXQga2V5ID0gImNhY2hlZF91c2VyX1wodXNlcklEKSIKICAgICAgICBndWFyZCBsZXQgZGF0YSA9IHVzZXJEZWZhdWx0cy5kYXRhKGZvcktleToga2V5KSBlbHNlIHsgcmV0dXJuIG5pbCB9CiAgICAgICAgcmV0dXJuIHRyeT8gSlNPTkRlY29kZXIoKS5kZWNvZGUoRm9ydW1Vc2VyLnNlbGYsIGZyb206IGRhdGEpCiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gT2ZmbGluZSBBY3Rpb25zIFF1ZXVlCiAgICAKICAgIGZ1bmMgcXVldWVPZmZsaW5lQWN0aW9uKF8gYWN0aW9uOiBPZmZsaW5lQWN0aW9uKSB7CiAgICAgICAgdmFyIGFjdGlvbnMgPSBnZXRQZW5kaW5nQWN0aW9ucygpCiAgICAgICAgYWN0aW9ucy5hcHBlbmQoYWN0aW9uKQogICAgICAgIHNhdmVQZW5kaW5nQWN0aW9ucyhhY3Rpb25zKQogICAgICAgIHBlbmRpbmdTeW5jQ291bnQgPSBhY3Rpb25zLmNvdW50CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBnZXRQZW5kaW5nQWN0aW9ucygpIC0+IFtPZmZsaW5lQWN0aW9uXSB7CiAgICAgICAgZ3VhcmQgbGV0IGRhdGEgPSB1c2VyRGVmYXVsdHMuZGF0YShmb3JLZXk6ICJwZW5kaW5nX2FjdGlvbnMiKSwKICAgICAgICAgICAgICBsZXQgYWN0aW9ucyA9IHRyeT8gSlNPTkRlY29kZXIoKS5kZWNvZGUoW09mZmxpbmVBY3Rpb25dLnNlbGYsIGZyb206IGRhdGEpIGVsc2UgewogICAgICAgICAgICByZXR1cm4gW10KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFjdGlvbnMKICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIHNhdmVQZW5kaW5nQWN0aW9ucyhfIGFjdGlvbnM6IFtPZmZsaW5lQWN0aW9uXSkgewogICAgICAgIGlmIGxldCBkYXRhID0gdHJ5PyBKU09ORW5jb2RlcigpLmVuY29kZShhY3Rpb25zKSB7CiAgICAgICAgICAgIHVzZXJEZWZhdWx0cy5zZXQoZGF0YSwgZm9yS2V5OiAicGVuZGluZ19hY3Rpb25zIikKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gU3luYyBPcGVyYXRpb25zCiAgICAKICAgIGZ1bmMgc3luY1BlbmRpbmdDaGFuZ2VzKCkgYXN5bmMgewogICAgICAgIGxldCBhY3Rpb25zID0gZ2V0UGVuZGluZ0FjdGlvbnMoKQogICAgICAgIGd1YXJkICFhY3Rpb25zLmlzRW1wdHkgZWxzZSB7IHJldHVybiB9CiAgICAgICAgCiAgICAgICAgdmFyIHN1Y2Nlc3NmdWxBY3Rpb25zOiBbSW50XSA9IFtdCiAgICAgICAgCiAgICAgICAgZm9yIChpbmRleCwgYWN0aW9uKSBpbiBhY3Rpb25zLmVudW1lcmF0ZWQoKSB7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIHRyeSBhd2FpdCBleGVjdXRlT2ZmbGluZUFjdGlvbihhY3Rpb24pCiAgICAgICAgICAgICAgICBzdWNjZXNzZnVsQWN0aW9ucy5hcHBlbmQoaW5kZXgpCiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBzeW5jIGFjdGlvbiBcKGFjdGlvbi50eXBlKTogXChlcnJvcikiKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIFJlbW92ZSBzdWNjZXNzZnVsIGFjdGlvbnMKICAgICAgICB2YXIgcmVtYWluaW5nQWN0aW9ucyA9IGFjdGlvbnMKICAgICAgICBmb3IgaW5kZXggaW4gc3VjY2Vzc2Z1bEFjdGlvbnMucmV2ZXJzZWQoKSB7CiAgICAgICAgICAgIHJlbWFpbmluZ0FjdGlvbnMucmVtb3ZlKGF0OiBpbmRleCkKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgc2F2ZVBlbmRpbmdBY3Rpb25zKHJlbWFpbmluZ0FjdGlvbnMpCiAgICAgICAgcGVuZGluZ1N5bmNDb3VudCA9IHJlbWFpbmluZ0FjdGlvbnMuY291bnQKICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGV4ZWN1dGVPZmZsaW5lQWN0aW9uKF8gYWN0aW9uOiBPZmZsaW5lQWN0aW9uKSBhc3luYyB0aHJvd3MgewogICAgICAgIHN3aXRjaCBhY3Rpb24udHlwZSB7CiAgICAgICAgY2FzZSAuY3JlYXRlUG9zdDoKICAgICAgICAgICAgaWYgbGV0IHBvc3REYXRhID0gYWN0aW9uLmRhdGEsCiAgICAgICAgICAgICAgIGxldCBwb3N0ID0gdHJ5PyBKU09ORGVjb2RlcigpLmRlY29kZShGb3J1bVBvc3Quc2VsZiwgZnJvbTogcG9zdERhdGEpIHsKICAgICAgICAgICAgICAgIF8gPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNyZWF0ZVBvc3QocG9zdCkKICAgICAgICAgICAgfQogICAgICAgIGNhc2UgLmNyZWF0ZVRocmVhZDoKICAgICAgICAgICAgaWYgbGV0IHRocmVhZERhdGEgPSBhY3Rpb24uZGF0YSwKICAgICAgICAgICAgICAgbGV0IHRocmVhZCA9IHRyeT8gSlNPTkRlY29kZXIoKS5kZWNvZGUoRm9ydW1UaHJlYWQuc2VsZiwgZnJvbTogdGhyZWFkRGF0YSkgewogICAgICAgICAgICAgICAgXyA9IHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuY3JlYXRlVGhyZWFkKHRocmVhZCkKICAgICAgICAgICAgfQogICAgICAgIGNhc2UgLmNyZWF0ZU1lc3NhZ2U6CiAgICAgICAgICAgIGlmIGxldCBtZXNzYWdlRGF0YSA9IGFjdGlvbi5kYXRhLAogICAgICAgICAgICAgICBsZXQgbWVzc2FnZSA9IHRyeT8gSlNPTkRlY29kZXIoKS5kZWNvZGUoUHJpdmF0ZU1lc3NhZ2Uuc2VsZiwgZnJvbTogbWVzc2FnZURhdGEpIHsKICAgICAgICAgICAgICAgIF8gPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNyZWF0ZVByaXZhdGVNZXNzYWdlKG1lc3NhZ2UpCiAgICAgICAgICAgIH0KICAgICAgICBjYXNlIC51cGRhdGVVc2VyOgogICAgICAgICAgICBpZiBsZXQgdXNlckRhdGEgPSBhY3Rpb24uZGF0YSwKICAgICAgICAgICAgICAgbGV0IHVzZXIgPSB0cnk/IEpTT05EZWNvZGVyKCkuZGVjb2RlKEZvcnVtVXNlci5zZWxmLCBmcm9tOiB1c2VyRGF0YSkgewogICAgICAgICAgICAgICAgXyA9IHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIudXBkYXRlVXNlcih1c2VyKQogICAgICAgICAgICB9CiAgICAgICAgY2FzZSAubGlrZVBvc3Q6CiAgICAgICAgICAgIGlmIGxldCBsaWtlRGF0YSA9IGFjdGlvbi5kYXRhLAogICAgICAgICAgICAgICBsZXQgbGlrZSA9IHRyeT8gSlNPTkRlY29kZXIoKS5kZWNvZGUoUG9zdExpa2Uuc2VsZiwgZnJvbTogbGlrZURhdGEpIHsKICAgICAgICAgICAgICAgIHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIudG9nZ2xlTGlrZShwb3N0SUQ6IGxpa2UucG9zdElELCB1c2VySUQ6IGxpa2UudXNlcklELCBpc0xpa2U6IGxpa2UuaXNMaWtlKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICAvLyBNQVJLOiAtIE9mZmxpbmUgRGF0YSBMb2FkaW5nCiAgICAKICAgIGZ1bmMgbG9hZE9mZmxpbmVGb3J1bXMoKSAtPiBbRm9ydW1dIHsKICAgICAgICAvLyBMb2FkIGNhY2hlZCBmb3J1bXMgZnJvbSBVc2VyRGVmYXVsdHMKICAgICAgICBsZXQga2V5cyA9IHVzZXJEZWZhdWx0cy5kaWN0aW9uYXJ5UmVwcmVzZW50YXRpb24oKS5rZXlzLmZpbHRlciB7ICQwLmhhc1ByZWZpeCgiY2FjaGVkX2ZvcnVtXyIpIH0KICAgICAgICB2YXIgZm9ydW1zOiBbRm9ydW1dID0gW10KICAgICAgICAKICAgICAgICBmb3Iga2V5IGluIGtleXMgewogICAgICAgICAgICBpZiBsZXQgZGF0YSA9IHVzZXJEZWZhdWx0cy5kYXRhKGZvcktleToga2V5KSwKICAgICAgICAgICAgICAgbGV0IGZvcnVtID0gdHJ5PyBKU09ORGVjb2RlcigpLmRlY29kZShGb3J1bS5zZWxmLCBmcm9tOiBkYXRhKSB7CiAgICAgICAgICAgICAgICBmb3J1bXMuYXBwZW5kKGZvcnVtKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiBmb3J1bXMuc29ydGVkIHsgJDAuZGlzcGxheU9yZGVyIDwgJDEuZGlzcGxheU9yZGVyIH0KICAgIH0KICAgIAogICAgZnVuYyBsb2FkT2ZmbGluZVRocmVhZHMoZm9yIGZvcnVtSUQ6IFN0cmluZykgLT4gW0ZvcnVtVGhyZWFkXSB7CiAgICAgICAgbGV0IGtleXMgPSB1c2VyRGVmYXVsdHMuZGljdGlvbmFyeVJlcHJlc2VudGF0aW9uKCkua2V5cy5maWx0ZXIgeyAkMC5oYXNQcmVmaXgoImNhY2hlZF90aHJlYWRfIikgfQogICAgICAgIHZhciB0aHJlYWRzOiBbRm9ydW1UaHJlYWRdID0gW10KICAgICAgICAKICAgICAgICBmb3Iga2V5IGluIGtleXMgewogICAgICAgICAgICBpZiBsZXQgZGF0YSA9IHVzZXJEZWZhdWx0cy5kYXRhKGZvcktleToga2V5KSwKICAgICAgICAgICAgICAgbGV0IHRocmVhZCA9IHRyeT8gSlNPTkRlY29kZXIoKS5kZWNvZGUoRm9ydW1UaHJlYWQuc2VsZiwgZnJvbTogZGF0YSksCiAgICAgICAgICAgICAgIHRocmVhZC5mb3J1bUlEID09IGZvcnVtSUQgewogICAgICAgICAgICAgICAgdGhyZWFkcy5hcHBlbmQodGhyZWFkKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiB0aHJlYWRzLnNvcnRlZCB7ICQwLmxhc3RQb3N0RGF0ZSA+ICQxLmxhc3RQb3N0RGF0ZSB9CiAgICB9CiAgICAKICAgIGZ1bmMgbG9hZE9mZmxpbmVQb3N0cyhmb3IgdGhyZWFkSUQ6IFN0cmluZykgLT4gW0ZvcnVtUG9zdF0gewogICAgICAgIGxldCBrZXlzID0gdXNlckRlZmF1bHRzLmRpY3Rpb25hcnlSZXByZXNlbnRhdGlvbigpLmtleXMuZmlsdGVyIHsgJDAuaGFzUHJlZml4KCJjYWNoZWRfcG9zdF8iKSB9CiAgICAgICAgdmFyIHBvc3RzOiBbRm9ydW1Qb3N0XSA9IFtdCiAgICAgICAgCiAgICAgICAgZm9yIGtleSBpbiBrZXlzIHsKICAgICAgICAgICAgaWYgbGV0IGRhdGEgPSB1c2VyRGVmYXVsdHMuZGF0YShmb3JLZXk6IGtleSksCiAgICAgICAgICAgICAgIGxldCBwb3N0ID0gdHJ5PyBKU09ORGVjb2RlcigpLmRlY29kZShGb3J1bVBvc3Quc2VsZiwgZnJvbTogZGF0YSksCiAgICAgICAgICAgICAgIHBvc3QudGhyZWFkSUQgPT0gdGhyZWFkSUQgewogICAgICAgICAgICAgICAgcG9zdHMuYXBwZW5kKHBvc3QpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHBvc3RzLnNvcnRlZCB7ICQwLmNyZWF0ZWREYXRlIDwgJDEuY3JlYXRlZERhdGUgfQogICAgfQogICAgCiAgICAvLyBNQVJLOiAtIENhY2hlIE1hbmFnZW1lbnQKICAgIAogICAgZnVuYyBjbGVhckNhY2hlKCkgewogICAgICAgIGxldCBrZXlzID0gdXNlckRlZmF1bHRzLmRpY3Rpb25hcnlSZXByZXNlbnRhdGlvbigpLmtleXMuZmlsdGVyIHsgCiAgICAgICAgICAgICQwLmhhc1ByZWZpeCgiY2FjaGVkXyIpIHx8ICQwID09ICJwZW5kaW5nX2FjdGlvbnMiCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZvciBrZXkgaW4ga2V5cyB7CiAgICAgICAgICAgIHVzZXJEZWZhdWx0cy5yZW1vdmVPYmplY3QoZm9yS2V5OiBrZXkpCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHBlbmRpbmdTeW5jQ291bnQgPSAwCiAgICB9CiAgICAKICAgIGZ1bmMgY2FjaGVTaXplKCkgLT4gSW50IHsKICAgICAgICBsZXQga2V5cyA9IHVzZXJEZWZhdWx0cy5kaWN0aW9uYXJ5UmVwcmVzZW50YXRpb24oKS5rZXlzLmZpbHRlciB7ICQwLmhhc1ByZWZpeCgiY2FjaGVkXyIpIH0KICAgICAgICByZXR1cm4ga2V5cy5jb3VudAogICAgfQp9CgovLyBNQVJLOiAtIE9mZmxpbmUgQWN0aW9uIE1vZGVsCgpzdHJ1Y3QgT2ZmbGluZUFjdGlvbjogQ29kYWJsZSB7CiAgICBsZXQgaWQ6IFN0cmluZwogICAgbGV0IHR5cGU6IE9mZmxpbmVBY3Rpb25UeXBlCiAgICBsZXQgZGF0YTogRGF0YT8KICAgIGxldCB0aW1lc3RhbXA6IERhdGUKICAgIAogICAgaW5pdCh0eXBlOiBPZmZsaW5lQWN0aW9uVHlwZSwgZGF0YTogRGF0YT8gPSBuaWwpIHsKICAgICAgICBzZWxmLmlkID0gVVVJRCgpLnV1aWRTdHJpbmcKICAgICAgICBzZWxmLnR5cGUgPSB0eXBlCiAgICAgICAgc2VsZi5kYXRhID0gZGF0YQogICAgICAgIHNlbGYudGltZXN0YW1wID0gRGF0ZSgpCiAgICB9Cn0KCmVudW0gT2ZmbGluZUFjdGlvblR5cGU6IFN0cmluZywgQ29kYWJsZSB7CiAgICBjYXNlIGNyZWF0ZVBvc3QgPSAiY3JlYXRlX3Bvc3QiCiAgICBjYXNlIGNyZWF0ZVRocmVhZCA9ICJjcmVhdGVfdGhyZWFkIgogICAgY2FzZSBjcmVhdGVNZXNzYWdlID0gImNyZWF0ZV9tZXNzYWdlIgogICAgY2FzZSB1cGRhdGVVc2VyID0gInVwZGF0ZV91c2VyIgogICAgY2FzZSBsaWtlUG9zdCA9ICJsaWtlX3Bvc3QiCn0KCi8vIE1BUks6IC0gQ29yZSBEYXRhIEludGVncmF0aW9uCgpleHRlbnNpb24gT2ZmbGluZU1hbmFnZXIgewogICAgZnVuYyBzYXZlVG9Db3JlRGF0YTxUOiBDb2RhYmxlPihfIGl0ZW06IFQsIGVudGl0eU5hbWU6IFN0cmluZykgewogICAgICAgIGxldCBjb250ZXh0ID0gcGVyc2lzdGVuY2VDb250cm9sbGVyLmNvbnRhaW5lci52aWV3Q29udGV4dAogICAgICAgIAogICAgICAgIC8vIENoZWNrIGlmIGl0ZW0gYWxyZWFkeSBleGlzdHMKICAgICAgICBsZXQgZmV0Y2hSZXF1ZXN0ID0gTlNGZXRjaFJlcXVlc3Q8TlNNYW5hZ2VkT2JqZWN0PihlbnRpdHlOYW1lOiBlbnRpdHlOYW1lKQogICAgICAgIGZldGNoUmVxdWVzdC5wcmVkaWNhdGUgPSBOU1ByZWRpY2F0ZShmb3JtYXQ6ICJpZCA9PSAlQCIsIChpdGVtIGFzPyBhbnkgSWRlbnRpZmlhYmxlKT8uaWQgYXM/IFN0cmluZyA/PyAiIikKICAgICAgICAKICAgICAgICBkbyB7CiAgICAgICAgICAgIGxldCBleGlzdGluZ0l0ZW1zID0gdHJ5IGNvbnRleHQuZmV0Y2goZmV0Y2hSZXF1ZXN0KQogICAgICAgICAgICBsZXQgbWFuYWdlZE9iamVjdDogTlNNYW5hZ2VkT2JqZWN0CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBsZXQgZXhpc3RpbmcgPSBleGlzdGluZ0l0ZW1zLmZpcnN0IHsKICAgICAgICAgICAgICAgIG1hbmFnZWRPYmplY3QgPSBleGlzdGluZwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbWFuYWdlZE9iamVjdCA9IE5TRW50aXR5RGVzY3JpcHRpb24uaW5zZXJ0TmV3T2JqZWN0KGZvckVudGl0eU5hbWU6IGVudGl0eU5hbWUsIGludG86IGNvbnRleHQpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFVwZGF0ZSBtYW5hZ2VkIG9iamVjdCB3aXRoIGl0ZW0gZGF0YQogICAgICAgICAgICBpZiBsZXQgZGF0YSA9IHRyeT8gSlNPTkVuY29kZXIoKS5lbmNvZGUoaXRlbSksCiAgICAgICAgICAgICAgIGxldCBqc29uID0gdHJ5PyBKU09OU2VyaWFsaXphdGlvbi5qc29uT2JqZWN0KHdpdGg6IGRhdGEpIGFzPyBbU3RyaW5nOiBBbnldIHsKICAgICAgICAgICAgICAgIGZvciAoa2V5LCB2YWx1ZSkgaW4ganNvbiB7CiAgICAgICAgICAgICAgICAgICAgbWFuYWdlZE9iamVjdC5zZXRWYWx1ZSh2YWx1ZSwgZm9yS2V5OiBrZXkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeSBjb250ZXh0LnNhdmUoKQogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIHNhdmUgdG8gQ29yZSBEYXRhOiBcKGVycm9yKSIpCiAgICAgICAgfQogICAgfQogICAgCiAgICBmdW5jIGxvYWRGcm9tQ29yZURhdGE8VDogQ29kYWJsZT4oXyB0eXBlOiBULlR5cGUsIGVudGl0eU5hbWU6IFN0cmluZykgLT4gW1RdIHsKICAgICAgICBsZXQgY29udGV4dCA9IHBlcnNpc3RlbmNlQ29udHJvbGxlci5jb250YWluZXIudmlld0NvbnRleHQKICAgICAgICBsZXQgZmV0Y2hSZXF1ZXN0ID0gTlNGZXRjaFJlcXVlc3Q8TlNNYW5hZ2VkT2JqZWN0PihlbnRpdHlOYW1lOiBlbnRpdHlOYW1lKQogICAgICAgIAogICAgICAgIGRvIHsKICAgICAgICAgICAgbGV0IG1hbmFnZWRPYmplY3RzID0gdHJ5IGNvbnRleHQuZmV0Y2goZmV0Y2hSZXF1ZXN0KQogICAgICAgICAgICB2YXIgaXRlbXM6IFtUXSA9IFtdCiAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgbWFuYWdlZE9iamVjdCBpbiBtYW5hZ2VkT2JqZWN0cyB7CiAgICAgICAgICAgICAgICBsZXQgZGljdGlvbmFyeSA9IG1hbmFnZWRPYmplY3QuZGljdGlvbmFyeVdpdGhWYWx1ZXMoZm9yS2V5czogbWFuYWdlZE9iamVjdC5lbnRpdHkuYXR0cmlidXRlc0J5TmFtZS5rZXlzLm1hcCB7ICQwIH0pCiAgICAgICAgICAgICAgICBpZiBsZXQgZGF0YSA9IHRyeT8gSlNPTlNlcmlhbGl6YXRpb24uZGF0YSh3aXRoSlNPTk9iamVjdDogZGljdGlvbmFyeSksCiAgICAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IHRyeT8gSlNPTkRlY29kZXIoKS5kZWNvZGUodHlwZSwgZnJvbTogZGF0YSkgewogICAgICAgICAgICAgICAgICAgIGl0ZW1zLmFwcGVuZChpdGVtKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gaXRlbXMKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBsb2FkIGZyb20gQ29yZSBEYXRhOiBcKGVycm9yKSIpCiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIH0KICAgIH0KfQo=
--- END ---

--- FILE: MacChan/Assets.xcassets/Contents.json ---
BASE64: ewogICJpbmZvIiA6IHsKICAgICJhdXRob3IiIDogInhjb2RlIiwKICAgICJ2ZXJzaW9uIiA6IDEKICB9Cn0K
--- END ---

--- FILE: MacChan/Assets.xcassets/AppIcon.appiconset/Contents.json ---
BASE64: ewogICJpbWFnZXMiIDogWwogICAgewogICAgICAiZmlsZW5hbWUiIDogIm1hY2NoYXR3YXZlLnBuZyIsCiAgICAgICJpZGlvbSIgOiAidW5pdmVyc2FsIiwKICAgICAgInBsYXRmb3JtIiA6ICJpb3MiLAogICAgICAic2l6ZSIgOiAiMTAyNHgxMDI0IgogICAgfSwKICAgIHsKICAgICAgImFwcGVhcmFuY2VzIiA6IFsKICAgICAgICB7CiAgICAgICAgICAiYXBwZWFyYW5jZSIgOiAibHVtaW5vc2l0eSIsCiAgICAgICAgICAidmFsdWUiIDogImRhcmsiCiAgICAgICAgfQogICAgICBdLAogICAgICAiZmlsZW5hbWUiIDogIm1hY2NoYXR3YXZlIDEucG5nIiwKICAgICAgImlkaW9tIiA6ICJ1bml2ZXJzYWwiLAogICAgICAicGxhdGZvcm0iIDogImlvcyIsCiAgICAgICJzaXplIiA6ICIxMDI0eDEwMjQiCiAgICB9LAogICAgewogICAgICAiYXBwZWFyYW5jZXMiIDogWwogICAgICAgIHsKICAgICAgICAgICJhcHBlYXJhbmNlIiA6ICJsdW1pbm9zaXR5IiwKICAgICAgICAgICJ2YWx1ZSIgOiAidGludGVkIgogICAgICAgIH0KICAgICAgXSwKICAgICAgImZpbGVuYW1lIiA6ICJtYWNjaGF0ZGFyayAxLnBuZyIsCiAgICAgICJpZGlvbSIgOiAidW5pdmVyc2FsIiwKICAgICAgInBsYXRmb3JtIiA6ICJpb3MiLAogICAgICAic2l6ZSIgOiAiMTAyNHgxMDI0IgogICAgfSwKICAgIHsKICAgICAgImlkaW9tIiA6ICJtYWMiLAogICAgICAic2NhbGUiIDogIjF4IiwKICAgICAgInNpemUiIDogIjE2eDE2IgogICAgfSwKICAgIHsKICAgICAgImlkaW9tIiA6ICJtYWMiLAogICAgICAic2NhbGUiIDogIjJ4IiwKICAgICAgInNpemUiIDogIjE2eDE2IgogICAgfSwKICAgIHsKICAgICAgImlkaW9tIiA6ICJtYWMiLAogICAgICAic2NhbGUiIDogIjF4IiwKICAgICAgInNpemUiIDogIjMyeDMyIgogICAgfSwKICAgIHsKICAgICAgImlkaW9tIiA6ICJtYWMiLAogICAgICAic2NhbGUiIDogIjJ4IiwKICAgICAgInNpemUiIDogIjMyeDMyIgogICAgfSwKICAgIHsKICAgICAgImlkaW9tIiA6ICJtYWMiLAogICAgICAic2NhbGUiIDogIjF4IiwKICAgICAgInNpemUiIDogIjEyOHgxMjgiCiAgICB9LAogICAgewogICAgICAiaWRpb20iIDogIm1hYyIsCiAgICAgICJzY2FsZSIgOiAiMngiLAogICAgICAic2l6ZSIgOiAiMTI4eDEyOCIKICAgIH0sCiAgICB7CiAgICAgICJpZGlvbSIgOiAibWFjIiwKICAgICAgInNjYWxlIiA6ICIxeCIsCiAgICAgICJzaXplIiA6ICIyNTZ4MjU2IgogICAgfSwKICAgIHsKICAgICAgImlkaW9tIiA6ICJtYWMiLAogICAgICAic2NhbGUiIDogIjJ4IiwKICAgICAgInNpemUiIDogIjI1NngyNTYiCiAgICB9LAogICAgewogICAgICAiaWRpb20iIDogIm1hYyIsCiAgICAgICJzY2FsZSIgOiAiMXgiLAogICAgICAic2l6ZSIgOiAiNTEyeDUxMiIKICAgIH0sCiAgICB7CiAgICAgICJpZGlvbSIgOiAibWFjIiwKICAgICAgInNjYWxlIiA6ICIyeCIsCiAgICAgICJzaXplIiA6ICI1MTJ4NTEyIgogICAgfQogIF0sCiAgImluZm8iIDogewogICAgImF1dGhvciIgOiAieGNvZGUiLAogICAgInZlcnNpb24iIDogMQogIH0KfQo=
--- END ---

--- FILE: MacChan/Assets.xcassets/AccentColor.colorset/Contents.json ---
BASE64: ewogICJjb2xvcnMiIDogWwogICAgewogICAgICAiaWRpb20iIDogInVuaXZlcnNhbCIKICAgIH0KICBdLAogICJpbmZvIiA6IHsKICAgICJhdXRob3IiIDogInhjb2RlIiwKICAgICJ2ZXJzaW9uIiA6IDEKICB9Cn0K
--- END ---

--- FILE: MacChan/Utils/BBCodeParser.swift ---
BASE64: Ly8KLy8gIEJCQ29kZVBhcnNlci5zd2lmdAovLyAgTWFjQ2hhbgovLwovLyAgQ3JlYXRlZCBieSBKYXJlZCBNYXh3ZWxsIG9uIDkvMy8yNS4KLy8KCmltcG9ydCBGb3VuZGF0aW9uCmltcG9ydCBTd2lmdFVJCgpzdHJ1Y3QgQkJDb2RlUGFyc2VyIHsKICAgIHN0YXRpYyBsZXQgc2hhcmVkID0gQkJDb2RlUGFyc2VyKCkKICAgIAogICAgcHJpdmF0ZSBpbml0KCkge30KICAgIAogICAgZnVuYyBwYXJzZShfIHRleHQ6IFN0cmluZykgLT4gQXR0cmlidXRlZFN0cmluZyB7CiAgICAgICAgdmFyIGF0dHJpYnV0ZWRTdHJpbmcgPSBBdHRyaWJ1dGVkU3RyaW5nKHRleHQpCiAgICAgICAgCiAgICAgICAgLy8gUGFyc2UgQkJDb2RlIHRhZ3MKICAgICAgICBhdHRyaWJ1dGVkU3RyaW5nID0gcGFyc2VCb2xkKGF0dHJpYnV0ZWRTdHJpbmcpCiAgICAgICAgYXR0cmlidXRlZFN0cmluZyA9IHBhcnNlSXRhbGljKGF0dHJpYnV0ZWRTdHJpbmcpCiAgICAgICAgYXR0cmlidXRlZFN0cmluZyA9IHBhcnNlVW5kZXJsaW5lKGF0dHJpYnV0ZWRTdHJpbmcpCiAgICAgICAgYXR0cmlidXRlZFN0cmluZyA9IHBhcnNlU3RyaWtldGhyb3VnaChhdHRyaWJ1dGVkU3RyaW5nKQogICAgICAgIGF0dHJpYnV0ZWRTdHJpbmcgPSBwYXJzZUNvZGUoYXR0cmlidXRlZFN0cmluZykKICAgICAgICBhdHRyaWJ1dGVkU3RyaW5nID0gcGFyc2VDb2RlQmxvY2soYXR0cmlidXRlZFN0cmluZykKICAgICAgICBhdHRyaWJ1dGVkU3RyaW5nID0gcGFyc2VMaW5rcyhhdHRyaWJ1dGVkU3RyaW5nKQogICAgICAgIGF0dHJpYnV0ZWRTdHJpbmcgPSBwYXJzZUltYWdlcyhhdHRyaWJ1dGVkU3RyaW5nKQogICAgICAgIGF0dHJpYnV0ZWRTdHJpbmcgPSBwYXJzZVF1b3RlcyhhdHRyaWJ1dGVkU3RyaW5nKQogICAgICAgIGF0dHJpYnV0ZWRTdHJpbmcgPSBwYXJzZUxpc3RzKGF0dHJpYnV0ZWRTdHJpbmcpCiAgICAgICAgYXR0cmlidXRlZFN0cmluZyA9IHBhcnNlQ29sb3JzKGF0dHJpYnV0ZWRTdHJpbmcpCiAgICAgICAgYXR0cmlidXRlZFN0cmluZyA9IHBhcnNlU2l6ZXMoYXR0cmlidXRlZFN0cmluZykKICAgICAgICBhdHRyaWJ1dGVkU3RyaW5nID0gcGFyc2VFbW9qaXMoYXR0cmlidXRlZFN0cmluZykKICAgICAgICAKICAgICAgICByZXR1cm4gYXR0cmlidXRlZFN0cmluZwogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgcGFyc2VCb2xkKF8gdGV4dDogQXR0cmlidXRlZFN0cmluZykgLT4gQXR0cmlidXRlZFN0cmluZyB7CiAgICAgICAgcmV0dXJuIHBhcnNlVGFnKHRleHQsIHRhZzogImIiKSB7IHJhbmdlIGluCiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBBdHRyaWJ1dGVDb250YWluZXIoKQogICAgICAgICAgICBjb250YWluZXIuZm9udCA9IC5ib2R5LmJvbGQoKQogICAgICAgICAgICByZXR1cm4gY29udGFpbmVyCiAgICAgICAgfQogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgcGFyc2VJdGFsaWMoXyB0ZXh0OiBBdHRyaWJ1dGVkU3RyaW5nKSAtPiBBdHRyaWJ1dGVkU3RyaW5nIHsKICAgICAgICByZXR1cm4gcGFyc2VUYWcodGV4dCwgdGFnOiAiaSIpIHsgcmFuZ2UgaW4KICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IEF0dHJpYnV0ZUNvbnRhaW5lcigpCiAgICAgICAgICAgIGNvbnRhaW5lci5mb250ID0gLmJvZHkuaXRhbGljKCkKICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5lcgogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIHBhcnNlVW5kZXJsaW5lKF8gdGV4dDogQXR0cmlidXRlZFN0cmluZykgLT4gQXR0cmlidXRlZFN0cmluZyB7CiAgICAgICAgcmV0dXJuIHBhcnNlVGFnKHRleHQsIHRhZzogInUiKSB7IHJhbmdlIGluCiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBBdHRyaWJ1dGVDb250YWluZXIoKQogICAgICAgICAgICBjb250YWluZXIudW5kZXJsaW5lU3R5bGUgPSAuc2luZ2xlCiAgICAgICAgICAgIHJldHVybiBjb250YWluZXIKICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBwYXJzZVN0cmlrZXRocm91Z2goXyB0ZXh0OiBBdHRyaWJ1dGVkU3RyaW5nKSAtPiBBdHRyaWJ1dGVkU3RyaW5nIHsKICAgICAgICByZXR1cm4gcGFyc2VUYWcodGV4dCwgdGFnOiAicyIpIHsgcmFuZ2UgaW4KICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IEF0dHJpYnV0ZUNvbnRhaW5lcigpCiAgICAgICAgICAgIGNvbnRhaW5lci5zdHJpa2V0aHJvdWdoU3R5bGUgPSAuc2luZ2xlCiAgICAgICAgICAgIHJldHVybiBjb250YWluZXIKICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBwYXJzZUNvZGUoXyB0ZXh0OiBBdHRyaWJ1dGVkU3RyaW5nKSAtPiBBdHRyaWJ1dGVkU3RyaW5nIHsKICAgICAgICByZXR1cm4gcGFyc2VUYWcodGV4dCwgdGFnOiAiY29kZSIpIHsgcmFuZ2UgaW4KICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IEF0dHJpYnV0ZUNvbnRhaW5lcigpCiAgICAgICAgICAgIGNvbnRhaW5lci5mb250ID0gLnN5c3RlbSguYm9keSwgZGVzaWduOiAubW9ub3NwYWNlZCkKICAgICAgICAgICAgY29udGFpbmVyLmJhY2tncm91bmRDb2xvciA9IC5zZWNvbmRhcnkub3BhY2l0eSgwLjEpCiAgICAgICAgICAgIHJldHVybiBjb250YWluZXIKICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBwYXJzZUNvZGVCbG9jayhfIHRleHQ6IEF0dHJpYnV0ZWRTdHJpbmcpIC0+IEF0dHJpYnV0ZWRTdHJpbmcgewogICAgICAgIHJldHVybiBwYXJzZVRhZyh0ZXh0LCB0YWc6ICJjb2RlYmxvY2siKSB7IHJhbmdlIGluCiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBBdHRyaWJ1dGVDb250YWluZXIoKQogICAgICAgICAgICBjb250YWluZXIuZm9udCA9IC5zeXN0ZW0oLmJvZHksIGRlc2lnbjogLm1vbm9zcGFjZWQpCiAgICAgICAgICAgIGNvbnRhaW5lci5iYWNrZ3JvdW5kQ29sb3IgPSAuc2Vjb25kYXJ5Lm9wYWNpdHkoMC4xKQogICAgICAgICAgICByZXR1cm4gY29udGFpbmVyCiAgICAgICAgfQogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgcGFyc2VMaW5rcyhfIHRleHQ6IEF0dHJpYnV0ZWRTdHJpbmcpIC0+IEF0dHJpYnV0ZWRTdHJpbmcgewogICAgICAgIHZhciByZXN1bHQgPSB0ZXh0CiAgICAgICAgCiAgICAgICAgLy8gUGFyc2UgW3VybF1saW5rWy91cmxdIGZvcm1hdAogICAgICAgIGxldCB1cmxQYXR0ZXJuID0gIyJcW3VybFxdKC4qPylcWy91cmxcXSIjCiAgICAgICAgbGV0IHVybFJlZ2V4ID0gdHJ5ISBOU1JlZ3VsYXJFeHByZXNzaW9uKHBhdHRlcm46IHVybFBhdHRlcm4sIG9wdGlvbnM6IFtdKQogICAgICAgIGxldCB1cmxNYXRjaGVzID0gdXJsUmVnZXgubWF0Y2hlcyhpbjogU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKSwgb3B0aW9uczogW10sIHJhbmdlOiBOU1JhbmdlKGxvY2F0aW9uOiAwLCBsZW5ndGg6IHJlc3VsdC5jaGFyYWN0ZXJzLmNvdW50KSkKICAgICAgICAKICAgICAgICBmb3IgbWF0Y2ggaW4gdXJsTWF0Y2hlcy5yZXZlcnNlZCgpIHsKICAgICAgICAgICAgaWYgbWF0Y2gubnVtYmVyT2ZSYW5nZXMgPT0gMiB7CiAgICAgICAgICAgICAgICBsZXQgbGlua1JhbmdlID0gbWF0Y2gucmFuZ2UoYXQ6IDEpCiAgICAgICAgICAgICAgICBpZiBsZXQgcmFuZ2UgPSBSYW5nZShsaW5rUmFuZ2UsIGluOiBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGxpbmtUZXh0ID0gU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKVtyYW5nZV0KICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHJlc3VsdC5jaGFyYWN0ZXJzLnN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sb2NhdGlvbikKICAgICAgICAgICAgICAgICAgICBsZXQgZW5kSW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChzdGFydEluZGV4LCBvZmZzZXRCeTogbWF0Y2gucmFuZ2UubGVuZ3RoKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jaGFyYWN0ZXJzLnJlbW92ZVN1YnJhbmdlKHN0YXJ0SW5kZXguLjxlbmRJbmRleCkKICAgICAgICAgICAgICAgICAgICByZXN1bHQuY2hhcmFjdGVycy5pbnNlcnQoY29udGVudHNPZjogbGlua1RleHQsIGF0OiBzdGFydEluZGV4KQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IGxpbmsgYXR0cmlidXRlcwogICAgICAgICAgICAgICAgICAgIGxldCBsaW5rU3RhcnRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHJlc3VsdC5jaGFyYWN0ZXJzLnN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sb2NhdGlvbikKICAgICAgICAgICAgICAgICAgICBsZXQgbGlua0VuZEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgobGlua1N0YXJ0SW5kZXgsIG9mZnNldEJ5OiBsaW5rVGV4dC5jb3VudCkKICAgICAgICAgICAgICAgICAgICBsZXQgbGlua1RleHRSYW5nZSA9IGxpbmtTdGFydEluZGV4Li48bGlua0VuZEluZGV4CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IEF0dHJpYnV0ZUNvbnRhaW5lcigpCiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmZvcmVncm91bmRDb2xvciA9IC5ibHVlCiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnVuZGVybGluZVN0eWxlID0gLnNpbmdsZQogICAgICAgICAgICAgICAgICAgIHJlc3VsdFtsaW5rVGV4dFJhbmdlXS5tZXJnZUF0dHJpYnV0ZXMoY29udGFpbmVyKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIFBhcnNlIFt1cmw9bGlua110ZXh0Wy91cmxdIGZvcm1hdAogICAgICAgIGxldCB1cmxXaXRoVGV4dFBhdHRlcm4gPSAjIlxbdXJsPSguKj8pXF0oLio/KVxbL3VybFxdIiMKICAgICAgICBsZXQgdXJsV2l0aFRleHRSZWdleCA9IHRyeSEgTlNSZWd1bGFyRXhwcmVzc2lvbihwYXR0ZXJuOiB1cmxXaXRoVGV4dFBhdHRlcm4sIG9wdGlvbnM6IFtdKQogICAgICAgIGxldCB1cmxXaXRoVGV4dE1hdGNoZXMgPSB1cmxXaXRoVGV4dFJlZ2V4Lm1hdGNoZXMoaW46IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycyksIG9wdGlvbnM6IFtdLCByYW5nZTogTlNSYW5nZShsb2NhdGlvbjogMCwgbGVuZ3RoOiByZXN1bHQuY2hhcmFjdGVycy5jb3VudCkpCiAgICAgICAgCiAgICAgICAgZm9yIG1hdGNoIGluIHVybFdpdGhUZXh0TWF0Y2hlcy5yZXZlcnNlZCgpIHsKICAgICAgICAgICAgaWYgbWF0Y2gubnVtYmVyT2ZSYW5nZXMgPT0gMyB7CiAgICAgICAgICAgICAgICBsZXQgdXJsUmFuZ2UgPSBtYXRjaC5yYW5nZShhdDogMSkKICAgICAgICAgICAgICAgIGxldCB0ZXh0UmFuZ2UgPSBtYXRjaC5yYW5nZShhdDogMikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgbGV0IHVybFJhbmdlID0gUmFuZ2UodXJsUmFuZ2UsIGluOiBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpKSwKICAgICAgICAgICAgICAgICAgIGxldCB0ZXh0UmFuZ2UgPSBSYW5nZSh0ZXh0UmFuZ2UsIGluOiBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IF8gPSBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpW3VybFJhbmdlXQogICAgICAgICAgICAgICAgICAgIGxldCBsaW5rVGV4dCA9IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycylbdGV4dFJhbmdlXQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGxldCBzdGFydEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgocmVzdWx0LmNoYXJhY3RlcnMuc3RhcnRJbmRleCwgb2Zmc2V0Qnk6IG1hdGNoLnJhbmdlLmxvY2F0aW9uKQogICAgICAgICAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sZW5ndGgpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNoYXJhY3RlcnMucmVtb3ZlU3VicmFuZ2Uoc3RhcnRJbmRleC4uPGVuZEluZGV4KQogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jaGFyYWN0ZXJzLmluc2VydChjb250ZW50c09mOiBsaW5rVGV4dCwgYXQ6IHN0YXJ0SW5kZXgpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgbGluayBhdHRyaWJ1dGVzCiAgICAgICAgICAgICAgICAgICAgbGV0IGxpbmtTdGFydEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgocmVzdWx0LmNoYXJhY3RlcnMuc3RhcnRJbmRleCwgb2Zmc2V0Qnk6IG1hdGNoLnJhbmdlLmxvY2F0aW9uKQogICAgICAgICAgICAgICAgICAgIGxldCBsaW5rRW5kSW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChsaW5rU3RhcnRJbmRleCwgb2Zmc2V0Qnk6IGxpbmtUZXh0LmNvdW50KQogICAgICAgICAgICAgICAgICAgIGxldCBsaW5rVGV4dFJhbmdlID0gbGlua1N0YXJ0SW5kZXguLjxsaW5rRW5kSW5kZXgKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID0gQXR0cmlidXRlQ29udGFpbmVyKCkKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuZm9yZWdyb3VuZENvbG9yID0gLmJsdWUKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIudW5kZXJsaW5lU3R5bGUgPSAuc2luZ2xlCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2xpbmtUZXh0UmFuZ2VdLm1lcmdlQXR0cmlidXRlcyhjb250YWluZXIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgcGFyc2VJbWFnZXMoXyB0ZXh0OiBBdHRyaWJ1dGVkU3RyaW5nKSAtPiBBdHRyaWJ1dGVkU3RyaW5nIHsKICAgICAgICB2YXIgcmVzdWx0ID0gdGV4dAogICAgICAgIAogICAgICAgIGxldCBpbWFnZVBhdHRlcm4gPSAjIlxbaW1nXF0oLio/KVxbL2ltZ1xdIiMKICAgICAgICBsZXQgaW1hZ2VSZWdleCA9IHRyeSEgTlNSZWd1bGFyRXhwcmVzc2lvbihwYXR0ZXJuOiBpbWFnZVBhdHRlcm4sIG9wdGlvbnM6IFtdKQogICAgICAgIGxldCBpbWFnZU1hdGNoZXMgPSBpbWFnZVJlZ2V4Lm1hdGNoZXMoaW46IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycyksIG9wdGlvbnM6IFtdLCByYW5nZTogTlNSYW5nZShsb2NhdGlvbjogMCwgbGVuZ3RoOiByZXN1bHQuY2hhcmFjdGVycy5jb3VudCkpCiAgICAgICAgCiAgICAgICAgZm9yIG1hdGNoIGluIGltYWdlTWF0Y2hlcy5yZXZlcnNlZCgpIHsKICAgICAgICAgICAgaWYgbWF0Y2gubnVtYmVyT2ZSYW5nZXMgPT0gMiB7CiAgICAgICAgICAgICAgICBsZXQgaW1hZ2VSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAxKQogICAgICAgICAgICAgICAgaWYgbGV0IHJhbmdlID0gUmFuZ2UoaW1hZ2VSYW5nZSwgaW46IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycykpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgaW1hZ2VVUkwgPSBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpW3JhbmdlXQogICAgICAgICAgICAgICAgICAgIGxldCBzdGFydEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgocmVzdWx0LmNoYXJhY3RlcnMuc3RhcnRJbmRleCwgb2Zmc2V0Qnk6IG1hdGNoLnJhbmdlLmxvY2F0aW9uKQogICAgICAgICAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sZW5ndGgpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNoYXJhY3RlcnMucmVtb3ZlU3VicmFuZ2Uoc3RhcnRJbmRleC4uPGVuZEluZGV4KQogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jaGFyYWN0ZXJzLmluc2VydChjb250ZW50c09mOiAiW0ltYWdlOiBcKGltYWdlVVJMKV0iLCBhdDogc3RhcnRJbmRleCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBwYXJzZVF1b3RlcyhfIHRleHQ6IEF0dHJpYnV0ZWRTdHJpbmcpIC0+IEF0dHJpYnV0ZWRTdHJpbmcgewogICAgICAgIHZhciByZXN1bHQgPSB0ZXh0CiAgICAgICAgCiAgICAgICAgbGV0IHF1b3RlUGF0dGVybiA9ICMiXFtxdW90ZVxdKC4qPylcWy9xdW90ZVxdIiMKICAgICAgICBsZXQgcXVvdGVSZWdleCA9IHRyeSEgTlNSZWd1bGFyRXhwcmVzc2lvbihwYXR0ZXJuOiBxdW90ZVBhdHRlcm4sIG9wdGlvbnM6IFtdKQogICAgICAgIGxldCBxdW90ZU1hdGNoZXMgPSBxdW90ZVJlZ2V4Lm1hdGNoZXMoaW46IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycyksIG9wdGlvbnM6IFtdLCByYW5nZTogTlNSYW5nZShsb2NhdGlvbjogMCwgbGVuZ3RoOiByZXN1bHQuY2hhcmFjdGVycy5jb3VudCkpCiAgICAgICAgCiAgICAgICAgZm9yIG1hdGNoIGluIHF1b3RlTWF0Y2hlcy5yZXZlcnNlZCgpIHsKICAgICAgICAgICAgaWYgbWF0Y2gubnVtYmVyT2ZSYW5nZXMgPT0gMiB7CiAgICAgICAgICAgICAgICBsZXQgcXVvdGVSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAxKQogICAgICAgICAgICAgICAgaWYgbGV0IHJhbmdlID0gUmFuZ2UocXVvdGVSYW5nZSwgaW46IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycykpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcXVvdGVUZXh0ID0gU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKVtyYW5nZV0KICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHJlc3VsdC5jaGFyYWN0ZXJzLnN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sb2NhdGlvbikKICAgICAgICAgICAgICAgICAgICBsZXQgZW5kSW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChzdGFydEluZGV4LCBvZmZzZXRCeTogbWF0Y2gucmFuZ2UubGVuZ3RoKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jaGFyYWN0ZXJzLnJlbW92ZVN1YnJhbmdlKHN0YXJ0SW5kZXguLjxlbmRJbmRleCkKICAgICAgICAgICAgICAgICAgICByZXN1bHQuY2hhcmFjdGVycy5pbnNlcnQoY29udGVudHNPZjogIj4gXChxdW90ZVRleHQpIiwgYXQ6IHN0YXJ0SW5kZXgpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgcXVvdGUgc3R5bGluZwogICAgICAgICAgICAgICAgICAgIGxldCBxdW90ZVN0YXJ0SW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChyZXN1bHQuY2hhcmFjdGVycy5zdGFydEluZGV4LCBvZmZzZXRCeTogbWF0Y2gucmFuZ2UubG9jYXRpb24pCiAgICAgICAgICAgICAgICAgICAgbGV0IHF1b3RlRW5kSW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChxdW90ZVN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBxdW90ZVRleHQuY291bnQgKyAyKQogICAgICAgICAgICAgICAgICAgIGxldCBxdW90ZVRleHRSYW5nZSA9IHF1b3RlU3RhcnRJbmRleC4uPHF1b3RlRW5kSW5kZXgKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID0gQXR0cmlidXRlQ29udGFpbmVyKCkKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuZm9yZWdyb3VuZENvbG9yID0gLnNlY29uZGFyeQogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5mb250ID0gLmJvZHkuaXRhbGljKCkKICAgICAgICAgICAgICAgICAgICByZXN1bHRbcXVvdGVUZXh0UmFuZ2VdLm1lcmdlQXR0cmlidXRlcyhjb250YWluZXIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgcGFyc2VMaXN0cyhfIHRleHQ6IEF0dHJpYnV0ZWRTdHJpbmcpIC0+IEF0dHJpYnV0ZWRTdHJpbmcgewogICAgICAgIHZhciByZXN1bHQgPSB0ZXh0CiAgICAgICAgCiAgICAgICAgLy8gUGFyc2UgdW5vcmRlcmVkIGxpc3RzCiAgICAgICAgbGV0IHVsUGF0dGVybiA9ICMiXFt1bFxdKC4qPylcWy91bFxdIiMKICAgICAgICBsZXQgdWxSZWdleCA9IHRyeSEgTlNSZWd1bGFyRXhwcmVzc2lvbihwYXR0ZXJuOiB1bFBhdHRlcm4sIG9wdGlvbnM6IFsuZG90TWF0Y2hlc0xpbmVTZXBhcmF0b3JzXSkKICAgICAgICBsZXQgdWxNYXRjaGVzID0gdWxSZWdleC5tYXRjaGVzKGluOiBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpLCBvcHRpb25zOiBbXSwgcmFuZ2U6IE5TUmFuZ2UobG9jYXRpb246IDAsIGxlbmd0aDogcmVzdWx0LmNoYXJhY3RlcnMuY291bnQpKQogICAgICAgIAogICAgICAgIGZvciBtYXRjaCBpbiB1bE1hdGNoZXMucmV2ZXJzZWQoKSB7CiAgICAgICAgICAgIGlmIG1hdGNoLm51bWJlck9mUmFuZ2VzID09IDIgewogICAgICAgICAgICAgICAgbGV0IGxpc3RSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAxKQogICAgICAgICAgICAgICAgaWYgbGV0IHJhbmdlID0gUmFuZ2UobGlzdFJhbmdlLCBpbjogU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKSkgewogICAgICAgICAgICAgICAgICAgIGxldCBsaXN0Q29udGVudCA9IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycylbcmFuZ2VdCiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChyZXN1bHQuY2hhcmFjdGVycy5zdGFydEluZGV4LCBvZmZzZXRCeTogbWF0Y2gucmFuZ2UubG9jYXRpb24pCiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgoc3RhcnRJbmRleCwgb2Zmc2V0Qnk6IG1hdGNoLnJhbmdlLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICByZXN1bHQuY2hhcmFjdGVycy5yZW1vdmVTdWJyYW5nZShzdGFydEluZGV4Li48ZW5kSW5kZXgpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNoYXJhY3RlcnMuaW5zZXJ0KGNvbnRlbnRzT2Y6IGxpc3RDb250ZW50LCBhdDogc3RhcnRJbmRleCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBQYXJzZSBvcmRlcmVkIGxpc3RzCiAgICAgICAgbGV0IG9sUGF0dGVybiA9ICMiXFtvbFxdKC4qPylcWy9vbFxdIiMKICAgICAgICBsZXQgb2xSZWdleCA9IHRyeSEgTlNSZWd1bGFyRXhwcmVzc2lvbihwYXR0ZXJuOiBvbFBhdHRlcm4sIG9wdGlvbnM6IFsuZG90TWF0Y2hlc0xpbmVTZXBhcmF0b3JzXSkKICAgICAgICBsZXQgb2xNYXRjaGVzID0gb2xSZWdleC5tYXRjaGVzKGluOiBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpLCBvcHRpb25zOiBbXSwgcmFuZ2U6IE5TUmFuZ2UobG9jYXRpb246IDAsIGxlbmd0aDogcmVzdWx0LmNoYXJhY3RlcnMuY291bnQpKQogICAgICAgIAogICAgICAgIGZvciBtYXRjaCBpbiBvbE1hdGNoZXMucmV2ZXJzZWQoKSB7CiAgICAgICAgICAgIGlmIG1hdGNoLm51bWJlck9mUmFuZ2VzID09IDIgewogICAgICAgICAgICAgICAgbGV0IGxpc3RSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAxKQogICAgICAgICAgICAgICAgaWYgbGV0IHJhbmdlID0gUmFuZ2UobGlzdFJhbmdlLCBpbjogU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKSkgewogICAgICAgICAgICAgICAgICAgIGxldCBsaXN0Q29udGVudCA9IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycylbcmFuZ2VdCiAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChyZXN1bHQuY2hhcmFjdGVycy5zdGFydEluZGV4LCBvZmZzZXRCeTogbWF0Y2gucmFuZ2UubG9jYXRpb24pCiAgICAgICAgICAgICAgICAgICAgbGV0IGVuZEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgoc3RhcnRJbmRleCwgb2Zmc2V0Qnk6IG1hdGNoLnJhbmdlLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICByZXN1bHQuY2hhcmFjdGVycy5yZW1vdmVTdWJyYW5nZShzdGFydEluZGV4Li48ZW5kSW5kZXgpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNoYXJhY3RlcnMuaW5zZXJ0KGNvbnRlbnRzT2Y6IGxpc3RDb250ZW50LCBhdDogc3RhcnRJbmRleCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBwYXJzZUNvbG9ycyhfIHRleHQ6IEF0dHJpYnV0ZWRTdHJpbmcpIC0+IEF0dHJpYnV0ZWRTdHJpbmcgewogICAgICAgIHZhciByZXN1bHQgPSB0ZXh0CiAgICAgICAgCiAgICAgICAgbGV0IGNvbG9yUGF0dGVybiA9ICMiXFtjb2xvcj0oLio/KVxdKC4qPylcWy9jb2xvclxdIiMKICAgICAgICBsZXQgY29sb3JSZWdleCA9IHRyeSEgTlNSZWd1bGFyRXhwcmVzc2lvbihwYXR0ZXJuOiBjb2xvclBhdHRlcm4sIG9wdGlvbnM6IFtdKQogICAgICAgIGxldCBjb2xvck1hdGNoZXMgPSBjb2xvclJlZ2V4Lm1hdGNoZXMoaW46IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycyksIG9wdGlvbnM6IFtdLCByYW5nZTogTlNSYW5nZShsb2NhdGlvbjogMCwgbGVuZ3RoOiByZXN1bHQuY2hhcmFjdGVycy5jb3VudCkpCiAgICAgICAgCiAgICAgICAgZm9yIG1hdGNoIGluIGNvbG9yTWF0Y2hlcy5yZXZlcnNlZCgpIHsKICAgICAgICAgICAgaWYgbWF0Y2gubnVtYmVyT2ZSYW5nZXMgPT0gMyB7CiAgICAgICAgICAgICAgICBsZXQgY29sb3JSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAxKQogICAgICAgICAgICAgICAgbGV0IHRleHRSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAyKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBsZXQgY29sb3JSYW5nZSA9IFJhbmdlKGNvbG9yUmFuZ2UsIGluOiBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpKSwKICAgICAgICAgICAgICAgICAgIGxldCB0ZXh0UmFuZ2UgPSBSYW5nZSh0ZXh0UmFuZ2UsIGluOiBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbG9yU3RyaW5nID0gU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKVtjb2xvclJhbmdlXQogICAgICAgICAgICAgICAgICAgIGxldCBjb2xvcmVkVGV4dCA9IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycylbdGV4dFJhbmdlXQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGxldCBzdGFydEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgocmVzdWx0LmNoYXJhY3RlcnMuc3RhcnRJbmRleCwgb2Zmc2V0Qnk6IG1hdGNoLnJhbmdlLmxvY2F0aW9uKQogICAgICAgICAgICAgICAgICAgIGxldCBlbmRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sZW5ndGgpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNoYXJhY3RlcnMucmVtb3ZlU3VicmFuZ2Uoc3RhcnRJbmRleC4uPGVuZEluZGV4KQogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jaGFyYWN0ZXJzLmluc2VydChjb250ZW50c09mOiBjb2xvcmVkVGV4dCwgYXQ6IHN0YXJ0SW5kZXgpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgY29sb3IKICAgICAgICAgICAgICAgICAgICBsZXQgY29sb3JlZFN0YXJ0SW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChyZXN1bHQuY2hhcmFjdGVycy5zdGFydEluZGV4LCBvZmZzZXRCeTogbWF0Y2gucmFuZ2UubG9jYXRpb24pCiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbG9yZWRFbmRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KGNvbG9yZWRTdGFydEluZGV4LCBvZmZzZXRCeTogY29sb3JlZFRleHQuY291bnQpCiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbG9yZWRUZXh0UmFuZ2UgPSBjb2xvcmVkU3RhcnRJbmRleC4uPGNvbG9yZWRFbmRJbmRleAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBBdHRyaWJ1dGVDb250YWluZXIoKQogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5mb3JlZ3JvdW5kQ29sb3IgPSBwYXJzZUNvbG9yKFN0cmluZyhjb2xvclN0cmluZykpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2NvbG9yZWRUZXh0UmFuZ2VdLm1lcmdlQXR0cmlidXRlcyhjb250YWluZXIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgcGFyc2VTaXplcyhfIHRleHQ6IEF0dHJpYnV0ZWRTdHJpbmcpIC0+IEF0dHJpYnV0ZWRTdHJpbmcgewogICAgICAgIHZhciByZXN1bHQgPSB0ZXh0CiAgICAgICAgCiAgICAgICAgbGV0IHNpemVQYXR0ZXJuID0gIyJcW3NpemU9KC4qPylcXSguKj8pXFsvc2l6ZVxdIiMKICAgICAgICBsZXQgc2l6ZVJlZ2V4ID0gdHJ5ISBOU1JlZ3VsYXJFeHByZXNzaW9uKHBhdHRlcm46IHNpemVQYXR0ZXJuLCBvcHRpb25zOiBbXSkKICAgICAgICBsZXQgc2l6ZU1hdGNoZXMgPSBzaXplUmVnZXgubWF0Y2hlcyhpbjogU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKSwgb3B0aW9uczogW10sIHJhbmdlOiBOU1JhbmdlKGxvY2F0aW9uOiAwLCBsZW5ndGg6IHJlc3VsdC5jaGFyYWN0ZXJzLmNvdW50KSkKICAgICAgICAKICAgICAgICBmb3IgbWF0Y2ggaW4gc2l6ZU1hdGNoZXMucmV2ZXJzZWQoKSB7CiAgICAgICAgICAgIGlmIG1hdGNoLm51bWJlck9mUmFuZ2VzID09IDMgewogICAgICAgICAgICAgICAgbGV0IHNpemVSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAxKQogICAgICAgICAgICAgICAgbGV0IHRleHRSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAyKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBsZXQgc2l6ZVJhbmdlID0gUmFuZ2Uoc2l6ZVJhbmdlLCBpbjogU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKSksCiAgICAgICAgICAgICAgICAgICBsZXQgdGV4dFJhbmdlID0gUmFuZ2UodGV4dFJhbmdlLCBpbjogU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKSkgewogICAgICAgICAgICAgICAgICAgIGxldCBzaXplU3RyaW5nID0gU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKVtzaXplUmFuZ2VdCiAgICAgICAgICAgICAgICAgICAgaWYgbGV0IHNpemVWYWx1ZSA9IERvdWJsZShzaXplU3RyaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzaXplZFRleHQgPSBTdHJpbmcocmVzdWx0LmNoYXJhY3RlcnMpW3RleHRSYW5nZV0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgocmVzdWx0LmNoYXJhY3RlcnMuc3RhcnRJbmRleCwgb2Zmc2V0Qnk6IG1hdGNoLnJhbmdlLmxvY2F0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5kSW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChzdGFydEluZGV4LCBvZmZzZXRCeTogbWF0Y2gucmFuZ2UubGVuZ3RoKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNoYXJhY3RlcnMucmVtb3ZlU3VicmFuZ2Uoc3RhcnRJbmRleC4uPGVuZEluZGV4KQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuY2hhcmFjdGVycy5pbnNlcnQoY29udGVudHNPZjogc2l6ZWRUZXh0LCBhdDogc3RhcnRJbmRleCkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHNpemUKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNpemVkU3RhcnRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHJlc3VsdC5jaGFyYWN0ZXJzLnN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sb2NhdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNpemVkRW5kSW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChzaXplZFN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBzaXplZFRleHQuY291bnQpCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzaXplZFRleHRSYW5nZSA9IHNpemVkU3RhcnRJbmRleC4uPHNpemVkRW5kSW5kZXgKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250YWluZXIgPSBBdHRyaWJ1dGVDb250YWluZXIoKQogICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuZm9udCA9IC5zeXN0ZW0oc2l6ZTogQ0dGbG9hdChzaXplVmFsdWUpKQogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbc2l6ZWRUZXh0UmFuZ2VdLm1lcmdlQXR0cmlidXRlcyhjb250YWluZXIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIHBhcnNlRW1vamlzKF8gdGV4dDogQXR0cmlidXRlZFN0cmluZykgLT4gQXR0cmlidXRlZFN0cmluZyB7CiAgICAgICAgdmFyIHJlc3VsdCA9IHRleHQKICAgICAgICAKICAgICAgICAvLyBTaW1wbGUgZW1vamkgbWFwcGluZwogICAgICAgIGxldCBlbW9qaU1hcDogW1N0cmluZzogU3RyaW5nXSA9IFsKICAgICAgICAgICAgIjpzbWlsZToiOiAi8J+YiiIsCiAgICAgICAgICAgICI6c2FkOiI6ICLwn5iiIiwKICAgICAgICAgICAgIjphbmdyeToiOiAi8J+YoCIsCiAgICAgICAgICAgICI6bGF1Z2g6IjogIvCfmIIiLAogICAgICAgICAgICAiOndpbms6IjogIvCfmIkiLAogICAgICAgICAgICAiOmhlYXJ0OiI6ICLinaTvuI8iLAogICAgICAgICAgICAiOnRodW1ic3VwOiI6ICLwn5GNIiwKICAgICAgICAgICAgIjp0aHVtYnNkb3duOiI6ICLwn5GOIgogICAgICAgIF0KICAgICAgICAKICAgICAgICBmb3IgKGNvZGUsIGVtb2ppKSBpbiBlbW9qaU1hcCB7CiAgICAgICAgICAgIHJlc3VsdCA9IEF0dHJpYnV0ZWRTdHJpbmcoU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKS5yZXBsYWNpbmdPY2N1cnJlbmNlcyhvZjogY29kZSwgd2l0aDogZW1vamkpKQogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICB9CiAgICAKICAgIC8vIE1BUks6IC0gSGVscGVyIE1ldGhvZHMKICAgIAogICAgcHJpdmF0ZSBmdW5jIHBhcnNlVGFnKF8gdGV4dDogQXR0cmlidXRlZFN0cmluZywgdGFnOiBTdHJpbmcsIGF0dHJpYnV0ZXM6IChSYW5nZTxBdHRyaWJ1dGVkU3RyaW5nLkluZGV4PikgLT4gQXR0cmlidXRlQ29udGFpbmVyKSAtPiBBdHRyaWJ1dGVkU3RyaW5nIHsKICAgICAgICB2YXIgcmVzdWx0ID0gdGV4dAogICAgICAgIAogICAgICAgIGxldCBwYXR0ZXJuID0gIyJcWyN0YWdcXSguKj8pXFsvI3RhZ1xdIiMKICAgICAgICBsZXQgcmVnZXggPSB0cnkhIE5TUmVndWxhckV4cHJlc3Npb24ocGF0dGVybjogcGF0dGVybi5yZXBsYWNpbmdPY2N1cnJlbmNlcyhvZjogIiN0YWciLCB3aXRoOiB0YWcpLCBvcHRpb25zOiBbXSkKICAgICAgICBsZXQgbWF0Y2hlcyA9IHJlZ2V4Lm1hdGNoZXMoaW46IFN0cmluZyhyZXN1bHQuY2hhcmFjdGVycyksIG9wdGlvbnM6IFtdLCByYW5nZTogTlNSYW5nZShsb2NhdGlvbjogMCwgbGVuZ3RoOiByZXN1bHQuY2hhcmFjdGVycy5jb3VudCkpCiAgICAgICAgCiAgICAgICAgZm9yIG1hdGNoIGluIG1hdGNoZXMucmV2ZXJzZWQoKSB7CiAgICAgICAgICAgIGlmIG1hdGNoLm51bWJlck9mUmFuZ2VzID09IDIgewogICAgICAgICAgICAgICAgbGV0IGNvbnRlbnRSYW5nZSA9IG1hdGNoLnJhbmdlKGF0OiAxKQogICAgICAgICAgICAgICAgaWYgbGV0IHJhbmdlID0gUmFuZ2UoY29udGVudFJhbmdlLCBpbjogU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKSkgewogICAgICAgICAgICAgICAgICAgIGxldCBjb250ZW50ID0gU3RyaW5nKHJlc3VsdC5jaGFyYWN0ZXJzKVtyYW5nZV0KICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHJlc3VsdC5jaGFyYWN0ZXJzLnN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sb2NhdGlvbikKICAgICAgICAgICAgICAgICAgICBsZXQgZW5kSW5kZXggPSByZXN1bHQuY2hhcmFjdGVycy5pbmRleChzdGFydEluZGV4LCBvZmZzZXRCeTogbWF0Y2gucmFuZ2UubGVuZ3RoKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jaGFyYWN0ZXJzLnJlbW92ZVN1YnJhbmdlKHN0YXJ0SW5kZXguLjxlbmRJbmRleCkKICAgICAgICAgICAgICAgICAgICByZXN1bHQuY2hhcmFjdGVycy5pbnNlcnQoY29udGVudHNPZjogY29udGVudCwgYXQ6IHN0YXJ0SW5kZXgpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgYXR0cmlidXRlcwogICAgICAgICAgICAgICAgICAgIGxldCBjb250ZW50U3RhcnRJbmRleCA9IHJlc3VsdC5jaGFyYWN0ZXJzLmluZGV4KHJlc3VsdC5jaGFyYWN0ZXJzLnN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBtYXRjaC5yYW5nZS5sb2NhdGlvbikKICAgICAgICAgICAgICAgICAgICBsZXQgY29udGVudEVuZEluZGV4ID0gcmVzdWx0LmNoYXJhY3RlcnMuaW5kZXgoY29udGVudFN0YXJ0SW5kZXgsIG9mZnNldEJ5OiBjb250ZW50LmNvdW50KQogICAgICAgICAgICAgICAgICAgIGxldCBjb250ZW50VGV4dFJhbmdlID0gY29udGVudFN0YXJ0SW5kZXguLjxjb250ZW50RW5kSW5kZXgKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gYXR0cmlidXRlcyhjb250ZW50VGV4dFJhbmdlKQogICAgICAgICAgICAgICAgICAgIHJlc3VsdFtjb250ZW50VGV4dFJhbmdlXS5tZXJnZUF0dHJpYnV0ZXMoY29udGFpbmVyKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIHBhcnNlQ29sb3IoXyBjb2xvclN0cmluZzogU3RyaW5nKSAtPiBDb2xvciB7CiAgICAgICAgc3dpdGNoIGNvbG9yU3RyaW5nLmxvd2VyY2FzZWQoKSB7CiAgICAgICAgY2FzZSAicmVkIjogcmV0dXJuIC5yZWQKICAgICAgICBjYXNlICJibHVlIjogcmV0dXJuIC5ibHVlCiAgICAgICAgY2FzZSAiZ3JlZW4iOiByZXR1cm4gLmdyZWVuCiAgICAgICAgY2FzZSAieWVsbG93IjogcmV0dXJuIC55ZWxsb3cKICAgICAgICBjYXNlICJvcmFuZ2UiOiByZXR1cm4gLm9yYW5nZQogICAgICAgIGNhc2UgInB1cnBsZSI6IHJldHVybiAucHVycGxlCiAgICAgICAgY2FzZSAicGluayI6IHJldHVybiAucGluawogICAgICAgIGNhc2UgImJsYWNrIjogcmV0dXJuIC5ibGFjawogICAgICAgIGNhc2UgIndoaXRlIjogcmV0dXJuIC53aGl0ZQogICAgICAgIGNhc2UgImdyYXkiLCAiZ3JleSI6IHJldHVybiAuZ3JheQogICAgICAgIGRlZmF1bHQ6IHJldHVybiAucHJpbWFyeQogICAgICAgIH0KICAgIH0KfQ==
--- END ---

--- FILE: MacChan/Models/SharedModels.swift ---
BASE64: Ly8KLy8gIFNoYXJlZE1vZGVscy5zd2lmdAovLyAgTWFjQ2hhbgovLwovLyAgQ3JlYXRlZCBieSBKYXJlZCBNYXh3ZWxsIG9uIDkvMy8yNS4KLy8KCmltcG9ydCBGb3VuZGF0aW9uCgovLyBNQVJLOiAtIEZvcnVtIFN0YXRpc3RpY3MgTW9kZWwKc3RydWN0IEZvcnVtU3RhdGlzdGljcyB7CiAgICBsZXQgdG90YWxQb3N0czogSW50CiAgICBsZXQgdG90YWxUaHJlYWRzOiBJbnQKICAgIGxldCByZWdpc3RlcmVkVXNlcnM6IEludAogICAgbGV0IHRvdGFsRm9ydW1zOiBJbnQKICAgIGxldCBwb3N0c1RvZGF5OiBJbnQKICAgIGxldCBwb3N0c1RoaXNXZWVrOiBJbnQKICAgIGxldCBwb3N0c1RoaXNNb250aDogSW50CiAgICBsZXQgbmV3VXNlcnNUb2RheTogSW50CiAgICBsZXQgbW9zdEFjdGl2ZUZvcnVtOiBTdHJpbmcKICAgIGxldCBidXNpZXN0RGF5OiBTdHJpbmcKICAgIGxldCBhdmVyYWdlUG9zdHNQZXJEYXk6IEludAogICAgbGV0IHRvdGFsQXR0YWNobWVudHM6IEludAoKICAgIHN0YXRpYyBmdW5jIG1vY2tEYXRhKCkgLT4gRm9ydW1TdGF0aXN0aWNzIHsKICAgICAgICByZXR1cm4gRm9ydW1TdGF0aXN0aWNzKAogICAgICAgICAgICB0b3RhbFBvc3RzOiAxMjUwLAogICAgICAgICAgICB0b3RhbFRocmVhZHM6IDg5LAogICAgICAgICAgICByZWdpc3RlcmVkVXNlcnM6IDQ1LAogICAgICAgICAgICB0b3RhbEZvcnVtczogOCwKICAgICAgICAgICAgcG9zdHNUb2RheTogMjMsCiAgICAgICAgICAgIHBvc3RzVGhpc1dlZWs6IDE1NiwKICAgICAgICAgICAgcG9zdHNUaGlzTW9udGg6IDY3OCwKICAgICAgICAgICAgbmV3VXNlcnNUb2RheTogMywKICAgICAgICAgICAgbW9zdEFjdGl2ZUZvcnVtOiAiR2VuZXJhbCBEaXNjdXNzaW9uIiwKICAgICAgICAgICAgYnVzaWVzdERheTogIk1vbmRheSIsCiAgICAgICAgICAgIGF2ZXJhZ2VQb3N0c1BlckRheTogNDIsCiAgICAgICAgICAgIHRvdGFsQXR0YWNobWVudHM6IDg5CiAgICAgICAgKQogICAgfQp9CgovLyBNQVJLOiAtIEFubm91bmNlbWVudCBNb2RlbApzdHJ1Y3QgQW5ub3VuY2VtZW50OiBJZGVudGlmaWFibGUgewogICAgbGV0IGlkID0gVVVJRCgpCiAgICBsZXQgdGl0bGU6IFN0cmluZwogICAgbGV0IGNvbnRlbnQ6IFN0cmluZwogICAgbGV0IGNyZWF0ZWREYXRlOiBEYXRlCiAgICBsZXQgaXNJbXBvcnRhbnQ6IEJvb2wKfQoKLy8gTUFSSzogLSBEYXRlIEZvcm1hdHRlcnMKbGV0IHJlbGF0aXZlRGF0ZUZvcm1hdHRlcjogUmVsYXRpdmVEYXRlVGltZUZvcm1hdHRlciA9IHsKICAgIGxldCBmb3JtYXR0ZXIgPSBSZWxhdGl2ZURhdGVUaW1lRm9ybWF0dGVyKCkKICAgIGZvcm1hdHRlci51bml0c1N0eWxlID0gLmFiYnJldmlhdGVkCiAgICByZXR1cm4gZm9ybWF0dGVyCn0oKQo=
--- END ---

--- FILE: MacChan/Models/ForumDataSeed.swift ---
BASE64: Ly8KLy8gIEZvcnVtRGF0YVNlZWQuc3dpZnQKLy8gIE1hY0NoYW4KLy8KLy8gIENyZWF0ZWQgYnkgSmFyZWQgTWF4d2VsbCBvbiA5LzMvMjUuCi8vCgppbXBvcnQgRm91bmRhdGlvbgoKLy8gTUFSSzogLSBGb3J1bSBEYXRhIFNlZWRpbmcKc3RydWN0IEZvcnVtRGF0YVNlZWQgewogICAgc3RhdGljIGxldCBtYWluRm9ydW1zOiBbRm9ydW1TZWVkXSA9IFsKICAgICAgICBGb3J1bVNlZWQoCiAgICAgICAgICAgIGlkOiAiZ2VuZXJhbC1kaXNjdXNzaW9uIiwKICAgICAgICAgICAgbmFtZTogIkdlbmVyYWwgRGlzY3Vzc2lvbiIsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAiVGFsayBhYm91dCBhbnl0aGluZyBhbmQgZXZlcnl0aGluZy4gVGhpcyBpcyB0aGUgcGxhY2UgZm9yIGNhc3VhbCBjb252ZXJzYXRpb24uIiwKICAgICAgICAgICAgZGlzcGxheU9yZGVyOiAxLAogICAgICAgICAgICBpY29uOiAiYnViYmxlLmxlZnQuYW5kLmJ1YmJsZS5yaWdodC5maWxsIgogICAgICAgICksCiAgICAgICAgRm9ydW1TZWVkKAogICAgICAgICAgICBpZDogImludmVzdGluZyIsCiAgICAgICAgICAgIG5hbWU6ICJJbnZlc3RpbmciLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogIkRpc2N1c3Mgc3RvY2tzLCBjcnlwdG8sIHJlYWwgZXN0YXRlLCBhbmQgaW52ZXN0bWVudCBzdHJhdGVnaWVzLiIsCiAgICAgICAgICAgIGRpc3BsYXlPcmRlcjogMiwKICAgICAgICAgICAgaWNvbjogImNoYXJ0LmxpbmUudXB0cmVuZC54eWF4aXMiCiAgICAgICAgKSwKICAgICAgICBGb3J1bVNlZWQoCiAgICAgICAgICAgIGlkOiAidGVjaG5vbG9neSIsCiAgICAgICAgICAgIG5hbWU6ICJUZWNobm9sb2d5IiwKICAgICAgICAgICAgZGVzY3JpcHRpb246ICJUYWxrIGFib3V0IHNvZnR3YXJlLCBoYXJkd2FyZSwgcHJvZ3JhbW1pbmcsIGFuZCB0ZWNoIG5ld3MuIiwKICAgICAgICAgICAgZGlzcGxheU9yZGVyOiAzLAogICAgICAgICAgICBpY29uOiAiZGVza3RvcGNvbXB1dGVyIgogICAgICAgICksCiAgICAgICAgRm9ydW1TZWVkKAogICAgICAgICAgICBpZDogImdhbWluZyIsCiAgICAgICAgICAgIG5hbWU6ICJHYW1pbmciLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogIlZpZGVvIGdhbWVzLCBib2FyZCBnYW1lcywgYW5kIGdhbWluZyBjdWx0dXJlIGRpc2N1c3Npb25zLiIsCiAgICAgICAgICAgIGRpc3BsYXlPcmRlcjogNCwKICAgICAgICAgICAgaWNvbjogImdhbWVjb250cm9sbGVyLmZpbGwiCiAgICAgICAgKSwKICAgICAgICBGb3J1bVNlZWQoCiAgICAgICAgICAgIGlkOiAicG9saXRpY3MiLAogICAgICAgICAgICBuYW1lOiAiUG9saXRpY3MiLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogIlBvbGl0aWNhbCBkaXNjdXNzaW9ucyBhbmQgY3VycmVudCBldmVudHMuIFBsZWFzZSBrZWVwIGl0IGNpdmlsLiIsCiAgICAgICAgICAgIGRpc3BsYXlPcmRlcjogNSwKICAgICAgICAgICAgaWNvbjogImJ1aWxkaW5nLmNvbHVtbnMuZmlsbCIKICAgICAgICApLAogICAgICAgIEZvcnVtU2VlZCgKICAgICAgICAgICAgaWQ6ICJob21ldG93biIsCiAgICAgICAgICAgIG5hbWU6ICJIb21ldG93biIsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAiQ29ubmVjdCB3aXRoIHBlb3BsZSBmcm9tIHlvdXIgYXJlYS4gRmluZCBsb2NhbCBldmVudHMgYW5kIGRpc2N1c3Npb25zLiIsCiAgICAgICAgICAgIGRpc3BsYXlPcmRlcjogNiwKICAgICAgICAgICAgaWNvbjogImhvdXNlLmZpbGwiLAogICAgICAgICAgICBzdWJmb3J1bXM6IGNyZWF0ZUhvbWV0b3duU3ViZm9ydW1zKCkKICAgICAgICApCiAgICBdCgogICAgc3RhdGljIGZ1bmMgY3JlYXRlSG9tZXRvd25TdWJmb3J1bXMoKSAtPiBbRm9ydW1TZWVkXSB7CiAgICAgICAgdmFyIHN1YmZvcnVtczogW0ZvcnVtU2VlZF0gPSBbXQoKICAgICAgICAvLyBVUyBTdGF0ZXMKICAgICAgICBsZXQgdXNTdGF0ZXMgPSBbCiAgICAgICAgICAgICgiQUwiLCAiQWxhYmFtYSIpLCAoIkFLIiwgIkFsYXNrYSIpLCAoIkFaIiwgIkFyaXpvbmEiKSwgKCJBUiIsICJBcmthbnNhcyIpLCAoIkNBIiwgIkNhbGlmb3JuaWEiKSwKICAgICAgICAgICAgKCJDTyIsICJDb2xvcmFkbyIpLCAoIkNUIiwgIkNvbm5lY3RpY3V0IiksICgiREUiLCAiRGVsYXdhcmUiKSwgKCJGTCIsICJGbG9yaWRhIiksICgiR0EiLCAiR2VvcmdpYSIpLAogICAgICAgICAgICAoIkhJIiwgIkhhd2FpaSIpLCAoIklEIiwgIklkYWhvIiksICgiSUwiLCAiSWxsaW5vaXMiKSwgKCJJTiIsICJJbmRpYW5hIiksICgiSUEiLCAiSW93YSIpLAogICAgICAgICAgICAoIktTIiwgIkthbnNhcyIpLCAoIktZIiwgIktlbnR1Y2t5IiksICgiTEEiLCAiTG91aXNpYW5hIiksICgiTUUiLCAiTWFpbmUiKSwgKCJNRCIsICJNYXJ5bGFuZCIpLAogICAgICAgICAgICAoIk1BIiwgIk1hc3NhY2h1c2V0dHMiKSwgKCJNSSIsICJNaWNoaWdhbiIpLCAoIk1OIiwgIk1pbm5lc290YSIpLCAoIk1TIiwgIk1pc3Npc3NpcHBpIiksICgiTU8iLCAiTWlzc291cmkiKSwKICAgICAgICAgICAgKCJNVCIsICJNb250YW5hIiksICgiTkUiLCAiTmVicmFza2EiKSwgKCJOViIsICJOZXZhZGEiKSwgKCJOSCIsICJOZXcgSGFtcHNoaXJlIiksICgiTkoiLCAiTmV3IEplcnNleSIpLAogICAgICAgICAgICAoIk5NIiwgIk5ldyBNZXhpY28iKSwgKCJOWSIsICJOZXcgWW9yayIpLCAoIk5DIiwgIk5vcnRoIENhcm9saW5hIiksICgiTkQiLCAiTm9ydGggRGFrb3RhIiksICgiT0giLCAiT2hpbyIpLAogICAgICAgICAgICAoIk9LIiwgIk9rbGFob21hIiksICgiT1IiLCAiT3JlZ29uIiksICgiUEEiLCAiUGVubnN5bHZhbmlhIiksICgiUkkiLCAiUmhvZGUgSXNsYW5kIiksICgiU0MiLCAiU291dGggQ2Fyb2xpbmEiKSwKICAgICAgICAgICAgKCJTRCIsICJTb3V0aCBEYWtvdGEiKSwgKCJUTiIsICJUZW5uZXNzZWUiKSwgKCJUWCIsICJUZXhhcyIpLCAoIlVUIiwgIlV0YWgiKSwgKCJWVCIsICJWZXJtb250IiksCiAgICAgICAgICAgICgiVkEiLCAiVmlyZ2luaWEiKSwgKCJXQSIsICJXYXNoaW5ndG9uIiksICgiV1YiLCAiV2VzdCBWaXJnaW5pYSIpLCAoIldJIiwgIldpc2NvbnNpbiIpLCAoIldZIiwgIld5b21pbmciKSwKICAgICAgICAgICAgKCJEQyIsICJEaXN0cmljdCBvZiBDb2x1bWJpYSIpCiAgICAgICAgXQoKICAgICAgICB2YXIgb3JkZXIgPSAxCiAgICAgICAgZm9yIChjb2RlLCBuYW1lKSBpbiB1c1N0YXRlcyB7CiAgICAgICAgICAgIHN1YmZvcnVtcy5hcHBlbmQoRm9ydW1TZWVkKAogICAgICAgICAgICAgICAgaWQ6ICJob21ldG93bi1cKGNvZGUubG93ZXJjYXNlZCgpKSIsCiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICJEaXNjdXNzaW9ucyBhbmQgZXZlbnRzIGluIFwobmFtZSkuIENvbm5lY3Qgd2l0aCBsb2NhbCBjb21tdW5pdHkuIiwKICAgICAgICAgICAgICAgIGRpc3BsYXlPcmRlcjogb3JkZXIsCiAgICAgICAgICAgICAgICBwYXJlbnRGb3J1bUlEOiAiaG9tZXRvd24iLAogICAgICAgICAgICAgICAgaWNvbjogIm1hcHBpbi5hbmQuZWxsaXBzZSIKICAgICAgICAgICAgKSkKICAgICAgICAgICAgb3JkZXIgKz0gMQogICAgICAgIH0KCiAgICAgICAgLy8gSW50ZXJuYXRpb25hbCBDb250aW5lbnRzCiAgICAgICAgbGV0IGNvbnRpbmVudHMgPSBbCiAgICAgICAgICAgICgiZXVyb3BlIiwgIkV1cm9wZSIsICJFdXJvcGVhbiBjb3VudHJpZXMgYW5kIGRpc2N1c3Npb25zIiksCiAgICAgICAgICAgICgiYXNpYSIsICJBc2lhIiwgIkFzaWFuIGNvdW50cmllcyBhbmQgZGlzY3Vzc2lvbnMiKSwKICAgICAgICAgICAgKCJhZnJpY2EiLCAiQWZyaWNhIiwgIkFmcmljYW4gY291bnRyaWVzIGFuZCBkaXNjdXNzaW9ucyIpLAogICAgICAgICAgICAoInNvdXRoLWFtZXJpY2EiLCAiU291dGggQW1lcmljYSIsICJTb3V0aCBBbWVyaWNhbiBjb3VudHJpZXMgYW5kIGRpc2N1c3Npb25zIiksCiAgICAgICAgICAgICgibm9ydGgtYW1lcmljYSIsICJOb3J0aCBBbWVyaWNhIChOb24tVVMpIiwgIkNhbmFkaWFuIGFuZCBNZXhpY2FuIGRpc2N1c3Npb25zIiksCiAgICAgICAgICAgICgiYXVzdHJhbGlhLW9jZWFuaWEiLCAiQXVzdHJhbGlhICYgT2NlYW5pYSIsICJBdXN0cmFsaWEsIE5ldyBaZWFsYW5kLCBhbmQgUGFjaWZpYyBpc2xhbmRzIiksCiAgICAgICAgICAgICgiYW50YXJjdGljYSIsICJBbnRhcmN0aWNhIiwgIkFudGFyY3RpYyByZXNlYXJjaCBhbmQgZXhwZWRpdGlvbnMiKQogICAgICAgIF0KCiAgICAgICAgZm9yIChjb2RlLCBuYW1lLCBkZXNjcmlwdGlvbikgaW4gY29udGluZW50cyB7CiAgICAgICAgICAgIHN1YmZvcnVtcy5hcHBlbmQoRm9ydW1TZWVkKAogICAgICAgICAgICAgICAgaWQ6ICJob21ldG93bi1cKGNvZGUpIiwKICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICBkaXNwbGF5T3JkZXI6IG9yZGVyLAogICAgICAgICAgICAgICAgcGFyZW50Rm9ydW1JRDogImhvbWV0b3duIiwKICAgICAgICAgICAgICAgIGljb246ICJnbG9iZSIKICAgICAgICAgICAgKSkKICAgICAgICAgICAgb3JkZXIgKz0gMQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHN1YmZvcnVtcwogICAgfQoKICAgIHN0YXRpYyBmdW5jIGNyZWF0ZUZvcnVtcyhmb3IgYWRtaW5Vc2VySUQ6IFN0cmluZykgLT4gW0ZvcnVtXSB7CiAgICAgICAgdmFyIGZvcnVtczogW0ZvcnVtXSA9IFtdCgogICAgICAgIGZvciBmb3J1bVNlZWQgaW4gbWFpbkZvcnVtcyB7CiAgICAgICAgICAgIGxldCBmb3J1bSA9IEZvcnVtKAogICAgICAgICAgICAgICAgaWQ6IGZvcnVtU2VlZC5pZCwKICAgICAgICAgICAgICAgIG5hbWU6IGZvcnVtU2VlZC5uYW1lLAogICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGZvcnVtU2VlZC5kZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgIHBhcmVudEZvcnVtSUQ6IGZvcnVtU2VlZC5wYXJlbnRGb3J1bUlELAogICAgICAgICAgICAgICAgZGlzcGxheU9yZGVyOiBmb3J1bVNlZWQuZGlzcGxheU9yZGVyLAogICAgICAgICAgICAgICAgaXNMb2NrZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgaXNIaWRkZW46IGZhbHNlLAogICAgICAgICAgICAgICAgcmVxdWlyZWRQZXJtaXNzaW9uczogW10sCiAgICAgICAgICAgICAgICB0aHJlYWRDb3VudDogMCwKICAgICAgICAgICAgICAgIHBvc3RDb3VudDogMCwKICAgICAgICAgICAgICAgIGxhc3RQb3N0SUQ6IG5pbCwKICAgICAgICAgICAgICAgIGxhc3RQb3N0RGF0ZTogbmlsLAogICAgICAgICAgICAgICAgbGFzdFBvc3RVc2VySUQ6IG5pbCwKICAgICAgICAgICAgICAgIGNyZWF0ZWREYXRlOiBEYXRlKCksCiAgICAgICAgICAgICAgICBjcmVhdGVkQnlVc2VySUQ6IGFkbWluVXNlcklECiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9ydW1zLmFwcGVuZChmb3J1bSkKCiAgICAgICAgICAgIC8vIEFkZCBzdWJmb3J1bXMgaWYgYW55CiAgICAgICAgICAgIGZvciBzdWJmb3J1bVNlZWQgaW4gZm9ydW1TZWVkLnN1YmZvcnVtcyB7CiAgICAgICAgICAgICAgICBsZXQgc3ViZm9ydW0gPSBGb3J1bSgKICAgICAgICAgICAgICAgICAgICBpZDogc3ViZm9ydW1TZWVkLmlkLAogICAgICAgICAgICAgICAgICAgIG5hbWU6IHN1YmZvcnVtU2VlZC5uYW1lLAogICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBzdWJmb3J1bVNlZWQuZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgICAgcGFyZW50Rm9ydW1JRDogc3ViZm9ydW1TZWVkLnBhcmVudEZvcnVtSUQsCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU9yZGVyOiBzdWJmb3J1bVNlZWQuZGlzcGxheU9yZGVyLAogICAgICAgICAgICAgICAgICAgIGlzTG9ja2VkOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBpc0hpZGRlbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWRQZXJtaXNzaW9uczogW10sCiAgICAgICAgICAgICAgICAgICAgdGhyZWFkQ291bnQ6IDAsCiAgICAgICAgICAgICAgICAgICAgcG9zdENvdW50OiAwLAogICAgICAgICAgICAgICAgICAgIGxhc3RQb3N0SUQ6IG5pbCwKICAgICAgICAgICAgICAgICAgICBsYXN0UG9zdERhdGU6IG5pbCwKICAgICAgICAgICAgICAgICAgICBsYXN0UG9zdFVzZXJJRDogbmlsLAogICAgICAgICAgICAgICAgICAgIGNyZWF0ZWREYXRlOiBEYXRlKCksCiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEJ5VXNlcklEOiBhZG1pblVzZXJJRAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZm9ydW1zLmFwcGVuZChzdWJmb3J1bSkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZvcnVtcwogICAgfQoKICAgIC8vIE1BUks6IC0gTWFudWFsIENsb3VkS2l0IENvbnNvbGUgU2VlZGluZwoKICAgIHN0YXRpYyBmdW5jIGdlbmVyYXRlQ2xvdWRLaXRDb25zb2xlRGF0YShhZG1pblVzZXJJRDogU3RyaW5nKSAtPiBbU3RyaW5nOiBBbnldIHsKICAgICAgICBsZXQgZm9ydW1zID0gY3JlYXRlRm9ydW1zKGZvcjogYWRtaW5Vc2VySUQpCiAgICAgICAgdmFyIHJlY29yZHM6IFtbU3RyaW5nOiBBbnldXSA9IFtdCgogICAgICAgIGZvciBmb3J1bSBpbiBmb3J1bXMgewogICAgICAgICAgICB2YXIgcmVjb3JkOiBbU3RyaW5nOiBBbnldID0gWwogICAgICAgICAgICAgICAgIl9fcmVjb3JkVHlwZSI6ICJGb3J1bSIsCiAgICAgICAgICAgICAgICAiX19yZWNvcmROYW1lIjogZm9ydW0uaWQsCiAgICAgICAgICAgICAgICAibmFtZSI6IGZvcnVtLm5hbWUsCiAgICAgICAgICAgICAgICAiY3JlYXRlZEJ5VXNlcklEIjogYWRtaW5Vc2VySUQsCiAgICAgICAgICAgICAgICAiY3JlYXRlZERhdGUiOiAiX19DS1JlY29yZERhdGVDdXJyZW50VGltZV9fIiwKICAgICAgICAgICAgICAgICJkaXNwbGF5T3JkZXIiOiBmb3J1bS5kaXNwbGF5T3JkZXIsCiAgICAgICAgICAgICAgICAiaXNMb2NrZWQiOiBmYWxzZSwKICAgICAgICAgICAgICAgICJpc0hpZGRlbiI6IGZhbHNlLAogICAgICAgICAgICAgICAgInRocmVhZENvdW50IjogMCwKICAgICAgICAgICAgICAgICJwb3N0Q291bnQiOiAwLAogICAgICAgICAgICAgICAgInJlcXVpcmVkUGVybWlzc2lvbnMiOiBbXQogICAgICAgICAgICBdCgogICAgICAgICAgICBpZiBsZXQgZGVzY3JpcHRpb24gPSBmb3J1bS5kZXNjcmlwdGlvbiB7CiAgICAgICAgICAgICAgICByZWNvcmRbImRlc2NyaXB0aW9uIl0gPSBkZXNjcmlwdGlvbgogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiBsZXQgcGFyZW50Rm9ydW1JRCA9IGZvcnVtLnBhcmVudEZvcnVtSUQgewogICAgICAgICAgICAgICAgcmVjb3JkWyJwYXJlbnRGb3J1bUlEIl0gPSBwYXJlbnRGb3J1bUlECiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlY29yZHMuYXBwZW5kKHJlY29yZCkKICAgICAgICB9CgogICAgICAgIHJldHVybiBbInJlY29yZHMiOiByZWNvcmRzXQogICAgfQoKICAgIHN0YXRpYyBmdW5jIHByaW50Q2xvdWRLaXRDb25zb2xlRGF0YShhZG1pblVzZXJJRDogU3RyaW5nKSB7CiAgICAgICAgbGV0IGRhdGEgPSBnZW5lcmF0ZUNsb3VkS2l0Q29uc29sZURhdGEoYWRtaW5Vc2VySUQ6IGFkbWluVXNlcklEKQoKICAgICAgICBkbyB7CiAgICAgICAgICAgIGxldCBqc29uRGF0YSA9IHRyeSBKU09OU2VyaWFsaXphdGlvbi5kYXRhKHdpdGhKU09OT2JqZWN0OiBkYXRhLCBvcHRpb25zOiAucHJldHR5UHJpbnRlZCkKICAgICAgICAgICAgaWYgbGV0IGpzb25TdHJpbmcgPSBTdHJpbmcoZGF0YToganNvbkRhdGEsIGVuY29kaW5nOiAudXRmOCkgewogICAgICAgICAgICAgICAgcHJpbnQoIvCfk4sgQ29weSB0aGlzIEpTT04gaW50byBDbG91ZEtpdCBDb25zb2xlICdJbXBvcnQgUmVjb3JkcycgZm9yIGNvbnRhaW5lciAnaUNsb3VkLm1hY2NoYW50ZXN0MSc6IikKICAgICAgICAgICAgICAgIHByaW50KCI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIpCiAgICAgICAgICAgICAgICBwcmludChqc29uU3RyaW5nKQogICAgICAgICAgICAgICAgcHJpbnQoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IikKICAgICAgICAgICAgICAgIHByaW50KCJJbnN0cnVjdGlvbnM6IikKICAgICAgICAgICAgICAgIHByaW50KCIxLiBHbyB0byBDbG91ZEtpdCBDb25zb2xlOiBodHRwczovL2ljbG91ZC5kZXZlbG9wZXIuYXBwbGUuY29tL2Rhc2hib2FyZCIpCiAgICAgICAgICAgICAgICBwcmludCgiMi4gU2VsZWN0IGNvbnRhaW5lcjogaUNsb3VkLm1hY2NoYW50ZXN0MSIpCiAgICAgICAgICAgICAgICBwcmludCgiMy4gR28gdG8gJ1JlY29yZHMnIHNlY3Rpb24iKQogICAgICAgICAgICAgICAgcHJpbnQoIjQuIENsaWNrICdJbXBvcnQgUmVjb3JkcyciKQogICAgICAgICAgICAgICAgcHJpbnQoIjUuIFBhc3RlIHRoZSBKU09OIGFib3ZlIikKICAgICAgICAgICAgICAgIHByaW50KCI2LiBDbGljayAnSW1wb3J0JyIpCiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIuKdjCBGYWlsZWQgdG8gZ2VuZXJhdGUgSlNPTjogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiKQogICAgICAgIH0KICAgIH0KfQoKc3RydWN0IEZvcnVtU2VlZCB7CiAgICBsZXQgaWQ6IFN0cmluZwogICAgbGV0IG5hbWU6IFN0cmluZwogICAgbGV0IGRlc2NyaXB0aW9uOiBTdHJpbmc/CiAgICBsZXQgZGlzcGxheU9yZGVyOiBJbnQKICAgIGxldCBwYXJlbnRGb3J1bUlEOiBTdHJpbmc/CiAgICBsZXQgaWNvbjogU3RyaW5nCiAgICBsZXQgc3ViZm9ydW1zOiBbRm9ydW1TZWVkXQoKICAgIGluaXQoaWQ6IFN0cmluZywgbmFtZTogU3RyaW5nLCBkZXNjcmlwdGlvbjogU3RyaW5nPyA9IG5pbCwgZGlzcGxheU9yZGVyOiBJbnQsIHBhcmVudEZvcnVtSUQ6IFN0cmluZz8gPSBuaWwsIGljb246IFN0cmluZyA9ICJmb2xkZXIuZmlsbCIsIHN1YmZvcnVtczogW0ZvcnVtU2VlZF0gPSBbXSkgewogICAgICAgIHNlbGYuaWQgPSBpZAogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgICAgICBzZWxmLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24KICAgICAgICBzZWxmLmRpc3BsYXlPcmRlciA9IGRpc3BsYXlPcmRlcgogICAgICAgIHNlbGYucGFyZW50Rm9ydW1JRCA9IHBhcmVudEZvcnVtSUQKICAgICAgICBzZWxmLmljb24gPSBpY29uCiAgICAgICAgc2VsZi5zdWJmb3J1bXMgPSBzdWJmb3J1bXMKICAgIH0KfQo=
--- END ---

--- FILE: MacChan/Models/CloudKitModels.swift ---
BASE64: Ly8KLy8gIENsb3VkS2l0TW9kZWxzLnN3aWZ0Ci8vICBNYWNDaGFuCi8vCi8vICBDcmVhdGVkIGJ5IEphcmVkIE1heHdlbGwgb24gOS8zLzI1LgovLwoKaW1wb3J0IEZvdW5kYXRpb24KaW1wb3J0IENsb3VkS2l0CmltcG9ydCBTd2lmdFVJCgpwcm90b2NvbCBDbG91ZEtpdFJlY29yZFR5cGVQcm90b2NvbCB7CiAgICB2YXIgcmF3VmFsdWU6IFN0cmluZyB7IGdldCB9Cn0KCnByb3RvY29sIENsb3VkS2l0UmVjb3JkQ29udmVydGlibGUgewogICAgYXNzb2NpYXRlZHR5cGUgUmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlUHJvdG9jb2wKICAgIHZhciByZWNvcmRUeXBlOiBSZWNvcmRUeXBlIHsgZ2V0IH0KICAgIHN0YXRpYyB2YXIgcmVjb3JkVHlwZTogUmVjb3JkVHlwZSB7IGdldCB9CiAgICBmdW5jIHRvQ2xvdWRLaXRSZWNvcmQoKSAtPiBDS1JlY29yZAogICAgc3RhdGljIGZ1bmMgZnJvbUNsb3VkS2l0UmVjb3JkKF8gcmVjb3JkOiBDS1JlY29yZCkgLT4gU2VsZj8KfQoKLy8gTUFSSzogLSBDbG91ZEtpdCBFcnJvcnMKZW51bSBDbG91ZEtpdEVycm9yOiBFcnJvciwgTG9jYWxpemVkRXJyb3IgewogICAgY2FzZSByZWNvcmRDb252ZXJzaW9uRmFpbGVkCiAgICBjYXNlIHJlY29yZE5vdEZvdW5kCiAgICBjYXNlIG5ldHdvcmtFcnJvcgogICAgY2FzZSBwZXJtaXNzaW9uRGVuaWVkCiAgICBjYXNlIHF1b3RhRXhjZWVkZWQKICAgIGNhc2UgaW52YWxpZERhdGEKICAgIGNhc2UgdW5rbm93bkVycm9yCiAgICAKICAgIHZhciBlcnJvckRlc2NyaXB0aW9uOiBTdHJpbmc/IHsKICAgICAgICBzd2l0Y2ggc2VsZiB7CiAgICAgICAgY2FzZSAucmVjb3JkQ29udmVyc2lvbkZhaWxlZDoKICAgICAgICAgICAgcmV0dXJuICJGYWlsZWQgdG8gY29udmVydCBDbG91ZEtpdCByZWNvcmQiCiAgICAgICAgY2FzZSAucmVjb3JkTm90Rm91bmQ6CiAgICAgICAgICAgIHJldHVybiAiUmVjb3JkIG5vdCBmb3VuZCIKICAgICAgICBjYXNlIC5uZXR3b3JrRXJyb3I6CiAgICAgICAgICAgIHJldHVybiAiTmV0d29yayBlcnJvciBvY2N1cnJlZCIKICAgICAgICBjYXNlIC5wZXJtaXNzaW9uRGVuaWVkOgogICAgICAgICAgICByZXR1cm4gIlBlcm1pc3Npb24gZGVuaWVkIgogICAgICAgIGNhc2UgLnF1b3RhRXhjZWVkZWQ6CiAgICAgICAgICAgIHJldHVybiAiQ2xvdWRLaXQgcXVvdGEgZXhjZWVkZWQiCiAgICAgICAgY2FzZSAuaW52YWxpZERhdGE6CiAgICAgICAgICAgIHJldHVybiAiSW52YWxpZCBkYXRhIHByb3ZpZGVkIgogICAgICAgIGNhc2UgLnVua25vd25FcnJvcjoKICAgICAgICAgICAgcmV0dXJuICJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkIgogICAgICAgIH0KICAgIH0KfQoKLy8gTUFSSzogLSBDbG91ZEtpdCBSZWNvcmQgVHlwZXMKZW51bSBDbG91ZEtpdFJlY29yZFR5cGU6IFN0cmluZywgQ2FzZUl0ZXJhYmxlIHsKICAgIGNhc2UgdXNlciA9ICJVc2VyIgogICAgY2FzZSBmb3J1bSA9ICJGb3J1bSIKICAgIGNhc2UgdGhyZWFkID0gIlRocmVhZCIKICAgIGNhc2UgcG9zdCA9ICJQb3N0IgogICAgY2FzZSBhdHRhY2htZW50ID0gIkF0dGFjaG1lbnQiCiAgICBjYXNlIHBvbGwgPSAiUG9sbCIKICAgIGNhc2UgcG9sbFZvdGUgPSAiUG9sbFZvdGUiCiAgICBjYXNlIHByaXZhdGVNZXNzYWdlID0gIlByaXZhdGVNZXNzYWdlIgogICAgY2FzZSB1c2VyR3JvdXAgPSAiVXNlckdyb3VwIgogICAgY2FzZSBtb2RlcmF0aW9uQWN0aW9uID0gIk1vZGVyYXRpb25BY3Rpb24iCiAgICBjYXNlIHVzZXJCYW4gPSAiVXNlckJhbiIKICAgIGNhc2UgZm9ydW1TdWJzY3JpcHRpb24gPSAiRm9ydW1TdWJzY3JpcHRpb24iCiAgICBjYXNlIHRocmVhZFN1YnNjcmlwdGlvbiA9ICJUaHJlYWRTdWJzY3JpcHRpb24iCiAgICBjYXNlIHJlcG9ydCA9ICJSZXBvcnQiCiAgICBjYXNlIGFubm91bmNlbWVudCA9ICJBbm5vdW5jZW1lbnQiCiAgICBjYXNlIHVzZXJBY3Rpdml0eSA9ICJVc2VyQWN0aXZpdHkiCiAgICBjYXNlIGRyYWZ0ID0gIkRyYWZ0IgogICAgY2FzZSB1c2VyUmFuayA9ICJVc2VyUmFuayIKICAgIGNhc2UgbGlrZSA9ICJMaWtlIgogICAgY2FzZSBxdW90ZSA9ICJRdW90ZSIKfQpleHRlbnNpb24gQ2xvdWRLaXRSZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGVQcm90b2NvbCB7fQoKLy8gTUFSSzogLSBVc2VyIE1vZGVsCnN0cnVjdCBGb3J1bVVzZXI6IElkZW50aWZpYWJsZSwgQ29kYWJsZSwgSGFzaGFibGUgewogICAgbGV0IGlkOiBTdHJpbmcKICAgIGxldCB1c2VybmFtZTogU3RyaW5nCiAgICBsZXQgZW1haWw6IFN0cmluZz8KICAgIGxldCBkaXNwbGF5TmFtZTogU3RyaW5nCiAgICBsZXQgYmlvOiBTdHJpbmc/CiAgICBsZXQgc2lnbmF0dXJlOiBTdHJpbmc/CiAgICBsZXQgYXZhdGFyVVJMOiBTdHJpbmc/CiAgICBsZXQgam9pbkRhdGU6IERhdGUKICAgIGxldCBsYXN0QWN0aXZlOiBEYXRlCiAgICBsZXQgcG9zdENvdW50OiBJbnQKICAgIGxldCByZXB1dGF0aW9uOiBJbnQKICAgIGxldCByYW5rOiBTdHJpbmc/CiAgICB2YXIgaXNNb2RlcmF0b3I6IEJvb2wKICAgIHZhciBpc0FkbWluOiBCb29sCiAgICB2YXIgaXNCYW5uZWQ6IEJvb2wKICAgIHZhciBiYW5SZWFzb246IFN0cmluZz8KICAgIHZhciBiYW5FeHBpcnk6IERhdGU/CiAgICBsZXQgdXNlckdyb3VwczogW1N0cmluZ10KICAgIGxldCBwcmVmZXJlbmNlczogVXNlclByZWZlcmVuY2VzCiAgICAKICAgIGluaXQoaWQ6IFN0cmluZyA9IFVVSUQoKS51dWlkU3RyaW5nLCB1c2VybmFtZTogU3RyaW5nLCBlbWFpbDogU3RyaW5nPyA9IG5pbCwgZGlzcGxheU5hbWU6IFN0cmluZywgYmlvOiBTdHJpbmc/ID0gbmlsLCBzaWduYXR1cmU6IFN0cmluZz8gPSBuaWwsIGF2YXRhclVSTDogU3RyaW5nPyA9IG5pbCwgam9pbkRhdGU6IERhdGUgPSBEYXRlKCksIGxhc3RBY3RpdmU6IERhdGUgPSBEYXRlKCksIHBvc3RDb3VudDogSW50ID0gMCwgcmVwdXRhdGlvbjogSW50ID0gMCwgcmFuazogU3RyaW5nPyA9IG5pbCwgaXNNb2RlcmF0b3I6IEJvb2wgPSBmYWxzZSwgaXNBZG1pbjogQm9vbCA9IGZhbHNlLCBpc0Jhbm5lZDogQm9vbCA9IGZhbHNlLCBiYW5SZWFzb246IFN0cmluZz8gPSBuaWwsIGJhbkV4cGlyeTogRGF0ZT8gPSBuaWwsIHVzZXJHcm91cHM6IFtTdHJpbmddID0gW10sIHByZWZlcmVuY2VzOiBVc2VyUHJlZmVyZW5jZXMgPSBVc2VyUHJlZmVyZW5jZXMoKSkgewogICAgICAgIHNlbGYuaWQgPSBpZAogICAgICAgIHNlbGYudXNlcm5hbWUgPSB1c2VybmFtZQogICAgICAgIHNlbGYuZW1haWwgPSBlbWFpbAogICAgICAgIHNlbGYuZGlzcGxheU5hbWUgPSBkaXNwbGF5TmFtZQogICAgICAgIHNlbGYuYmlvID0gYmlvCiAgICAgICAgc2VsZi5zaWduYXR1cmUgPSBzaWduYXR1cmUKICAgICAgICBzZWxmLmF2YXRhclVSTCA9IGF2YXRhclVSTAogICAgICAgIHNlbGYuam9pbkRhdGUgPSBqb2luRGF0ZQogICAgICAgIHNlbGYubGFzdEFjdGl2ZSA9IGxhc3RBY3RpdmUKICAgICAgICBzZWxmLnBvc3RDb3VudCA9IHBvc3RDb3VudAogICAgICAgIHNlbGYucmVwdXRhdGlvbiA9IHJlcHV0YXRpb24KICAgICAgICBzZWxmLnJhbmsgPSByYW5rCiAgICAgICAgc2VsZi5pc01vZGVyYXRvciA9IGlzTW9kZXJhdG9yCiAgICAgICAgc2VsZi5pc0FkbWluID0gaXNBZG1pbgogICAgICAgIHNlbGYuaXNCYW5uZWQgPSBpc0Jhbm5lZAogICAgICAgIHNlbGYuYmFuUmVhc29uID0gYmFuUmVhc29uCiAgICAgICAgc2VsZi5iYW5FeHBpcnkgPSBiYW5FeHBpcnkKICAgICAgICBzZWxmLnVzZXJHcm91cHMgPSB1c2VyR3JvdXBzCiAgICAgICAgc2VsZi5wcmVmZXJlbmNlcyA9IHByZWZlcmVuY2VzCiAgICB9CiAgICAKICAgIGZ1bmMgdG9DbG91ZEtpdFJlY29yZCgpIC0+IENLUmVjb3JkIHsKICAgICAgICAvLyBVc2VycyBhcmUgc3RvcmVkIGluIHByaXZhdGUgZGF0YWJhc2Ugd2l0aCBkZWZhdWx0IHpvbmUKICAgICAgICBsZXQgcmVjb3JkID0gQ0tSZWNvcmQocmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLnVzZXIucmF3VmFsdWUsIHJlY29yZElEOiBDS1JlY29yZC5JRChyZWNvcmROYW1lOiBpZCkpCiAgICAgICAgcmVjb3JkWyJ1c2VybmFtZSJdID0gdXNlcm5hbWUKICAgICAgICByZWNvcmRbImVtYWlsIl0gPSBlbWFpbAogICAgICAgIHJlY29yZFsiZGlzcGxheU5hbWUiXSA9IGRpc3BsYXlOYW1lCiAgICAgICAgcmVjb3JkWyJiaW8iXSA9IGJpbwogICAgICAgIHJlY29yZFsic2lnbmF0dXJlIl0gPSBzaWduYXR1cmUKICAgICAgICByZWNvcmRbImF2YXRhclVSTCJdID0gYXZhdGFyVVJMCiAgICAgICAgcmVjb3JkWyJqb2luRGF0ZSJdID0gam9pbkRhdGUKICAgICAgICByZWNvcmRbImxhc3RBY3RpdmUiXSA9IGxhc3RBY3RpdmUKICAgICAgICByZWNvcmRbInBvc3RDb3VudCJdID0gcG9zdENvdW50CiAgICAgICAgcmVjb3JkWyJyZXB1dGF0aW9uIl0gPSByZXB1dGF0aW9uCiAgICAgICAgcmVjb3JkWyJyYW5rIl0gPSByYW5rCiAgICAgICAgcmVjb3JkWyJpc01vZGVyYXRvciJdID0gaXNNb2RlcmF0b3IKICAgICAgICByZWNvcmRbImlzQWRtaW4iXSA9IGlzQWRtaW4KICAgICAgICByZWNvcmRbImlzQmFubmVkIl0gPSBpc0Jhbm5lZAogICAgICAgIHJlY29yZFsiYmFuUmVhc29uIl0gPSBiYW5SZWFzb24KICAgICAgICByZWNvcmRbImJhbkV4cGlyeSJdID0gYmFuRXhwaXJ5CiAgICAgICAgcmVjb3JkWyJ1c2VyR3JvdXBzIl0gPSB1c2VyR3JvdXBzCiAgICAgICAgcmVjb3JkWyJwcmVmZXJlbmNlcyJdID0gdHJ5PyBKU09ORW5jb2RlcigpLmVuY29kZShwcmVmZXJlbmNlcykKICAgICAgICByZXR1cm4gcmVjb3JkCiAgICB9CiAgICAKICAgIHN0YXRpYyBmdW5jIGZyb21DbG91ZEtpdFJlY29yZChfIHJlY29yZDogQ0tSZWNvcmQpIC0+IEZvcnVtVXNlcj8gewogICAgICAgIGd1YXJkIGxldCB1c2VybmFtZSA9IHJlY29yZFsidXNlcm5hbWUiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICAgIGxldCBkaXNwbGF5TmFtZSA9IHJlY29yZFsiZGlzcGxheU5hbWUiXSBhcz8gU3RyaW5nIGVsc2UgeyByZXR1cm4gbmlsIH0KICAgICAgICAKICAgICAgICBsZXQgcHJlZmVyZW5jZXNEYXRhID0gcmVjb3JkWyJwcmVmZXJlbmNlcyJdIGFzPyBEYXRhCiAgICAgICAgbGV0IHByZWZlcmVuY2VzID0gcHJlZmVyZW5jZXNEYXRhLmZsYXRNYXAgeyB0cnk/IEpTT05EZWNvZGVyKCkuZGVjb2RlKFVzZXJQcmVmZXJlbmNlcy5zZWxmLCBmcm9tOiAkMCkgfSA/PyBVc2VyUHJlZmVyZW5jZXMoKQogICAgICAgIAogICAgICAgIHJldHVybiBGb3J1bVVzZXIoCiAgICAgICAgICAgIGlkOiByZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSwKICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgICAgICAgICBlbWFpbDogcmVjb3JkWyJlbWFpbCJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBkaXNwbGF5TmFtZSwKICAgICAgICAgICAgYmlvOiByZWNvcmRbImJpbyJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgIHNpZ25hdHVyZTogcmVjb3JkWyJzaWduYXR1cmUiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICBhdmF0YXJVUkw6IHJlY29yZFsiYXZhdGFyVVJMIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgam9pbkRhdGU6IHJlY29yZFsiam9pbkRhdGUiXSBhcz8gRGF0ZSA/PyBEYXRlKCksCiAgICAgICAgICAgIGxhc3RBY3RpdmU6IHJlY29yZFsibGFzdEFjdGl2ZSJdIGFzPyBEYXRlID8/IERhdGUoKSwKICAgICAgICAgICAgcG9zdENvdW50OiByZWNvcmRbInBvc3RDb3VudCJdIGFzPyBJbnQgPz8gMCwKICAgICAgICAgICAgcmVwdXRhdGlvbjogcmVjb3JkWyJyZXB1dGF0aW9uIl0gYXM/IEludCA/PyAwLAogICAgICAgICAgICByYW5rOiByZWNvcmRbInJhbmsiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICBpc01vZGVyYXRvcjogcmVjb3JkWyJpc01vZGVyYXRvciJdIGFzPyBCb29sID8/IGZhbHNlLAogICAgICAgICAgICBpc0FkbWluOiByZWNvcmRbImlzQWRtaW4iXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgaXNCYW5uZWQ6IHJlY29yZFsiaXNCYW5uZWQiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgYmFuUmVhc29uOiByZWNvcmRbImJhblJlYXNvbiJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgIGJhbkV4cGlyeTogcmVjb3JkWyJiYW5FeHBpcnkiXSBhcz8gRGF0ZSwKICAgICAgICAgICAgdXNlckdyb3VwczogcmVjb3JkWyJ1c2VyR3JvdXBzIl0gYXM/IFtTdHJpbmddID8/IFtdLAogICAgICAgICAgICBwcmVmZXJlbmNlczogcHJlZmVyZW5jZXMKICAgICAgICApCiAgICB9CiAgICAKICAgIGZ1bmMgaGFzaChpbnRvIGhhc2hlcjogaW5vdXQgSGFzaGVyKSB7CiAgICAgICAgaGFzaGVyLmNvbWJpbmUoaWQpCiAgICB9CiAgICBzdGF0aWMgZnVuYyA9PSAobGhzOiBGb3J1bVVzZXIsIHJoczogRm9ydW1Vc2VyKSAtPiBCb29sIHsKICAgICAgICBsaHMuaWQgPT0gcmhzLmlkCiAgICB9Cn0KCnN0cnVjdCBVc2VyUHJlZmVyZW5jZXM6IENvZGFibGUgewogICAgbGV0IHRoZW1lOiBTdHJpbmcKICAgIGxldCBub3RpZmljYXRpb25zOiBOb3RpZmljYXRpb25QcmVmZXJlbmNlcwogICAgbGV0IHByaXZhY3k6IFByaXZhY3lQcmVmZXJlbmNlcwogICAgbGV0IGRpc3BsYXk6IERpc3BsYXlQcmVmZXJlbmNlcwogICAgCiAgICBpbml0KHRoZW1lOiBTdHJpbmcgPSAic3lzdGVtIiwgbm90aWZpY2F0aW9uczogTm90aWZpY2F0aW9uUHJlZmVyZW5jZXMgPSBOb3RpZmljYXRpb25QcmVmZXJlbmNlcygpLCBwcml2YWN5OiBQcml2YWN5UHJlZmVyZW5jZXMgPSBQcml2YWN5UHJlZmVyZW5jZXMoKSwgZGlzcGxheTogRGlzcGxheVByZWZlcmVuY2VzID0gRGlzcGxheVByZWZlcmVuY2VzKCkpIHsKICAgICAgICBzZWxmLnRoZW1lID0gdGhlbWUKICAgICAgICBzZWxmLm5vdGlmaWNhdGlvbnMgPSBub3RpZmljYXRpb25zCiAgICAgICAgc2VsZi5wcml2YWN5ID0gcHJpdmFjeQogICAgICAgIHNlbGYuZGlzcGxheSA9IGRpc3BsYXkKICAgIH0KfQoKc3RydWN0IE5vdGlmaWNhdGlvblByZWZlcmVuY2VzOiBDb2RhYmxlIHsKICAgIGxldCBlbWFpbE5vdGlmaWNhdGlvbnM6IEJvb2wKICAgIGxldCBwdXNoTm90aWZpY2F0aW9uczogQm9vbAogICAgbGV0IHRocmVhZFN1YnNjcmlwdGlvbnM6IEJvb2wKICAgIGxldCBwcml2YXRlTWVzc2FnZXM6IEJvb2wKICAgIGxldCBtZW50aW9uczogQm9vbAogICAgCiAgICBpbml0KGVtYWlsTm90aWZpY2F0aW9uczogQm9vbCA9IHRydWUsIHB1c2hOb3RpZmljYXRpb25zOiBCb29sID0gdHJ1ZSwgdGhyZWFkU3Vic2NyaXB0aW9uczogQm9vbCA9IHRydWUsIHByaXZhdGVNZXNzYWdlczogQm9vbCA9IHRydWUsIG1lbnRpb25zOiBCb29sID0gdHJ1ZSkgewogICAgICAgIHNlbGYuZW1haWxOb3RpZmljYXRpb25zID0gZW1haWxOb3RpZmljYXRpb25zCiAgICAgICAgc2VsZi5wdXNoTm90aWZpY2F0aW9ucyA9IHB1c2hOb3RpZmljYXRpb25zCiAgICAgICAgc2VsZi50aHJlYWRTdWJzY3JpcHRpb25zID0gdGhyZWFkU3Vic2NyaXB0aW9ucwogICAgICAgIHNlbGYucHJpdmF0ZU1lc3NhZ2VzID0gcHJpdmF0ZU1lc3NhZ2VzCiAgICAgICAgc2VsZi5tZW50aW9ucyA9IG1lbnRpb25zCiAgICB9Cn0KCnN0cnVjdCBQcml2YWN5UHJlZmVyZW5jZXM6IENvZGFibGUgewogICAgbGV0IHNob3dFbWFpbDogQm9vbAogICAgbGV0IHNob3dMYXN0QWN0aXZlOiBCb29sCiAgICBsZXQgYWxsb3dQcml2YXRlTWVzc2FnZXM6IEJvb2wKICAgIGxldCBzaG93T25saW5lU3RhdHVzOiBCb29sCiAgICAKICAgIGluaXQoc2hvd0VtYWlsOiBCb29sID0gZmFsc2UsIHNob3dMYXN0QWN0aXZlOiBCb29sID0gdHJ1ZSwgYWxsb3dQcml2YXRlTWVzc2FnZXM6IEJvb2wgPSB0cnVlLCBzaG93T25saW5lU3RhdHVzOiBCb29sID0gdHJ1ZSkgewogICAgICAgIHNlbGYuc2hvd0VtYWlsID0gc2hvd0VtYWlsCiAgICAgICAgc2VsZi5zaG93TGFzdEFjdGl2ZSA9IHNob3dMYXN0QWN0aXZlCiAgICAgICAgc2VsZi5hbGxvd1ByaXZhdGVNZXNzYWdlcyA9IGFsbG93UHJpdmF0ZU1lc3NhZ2VzCiAgICAgICAgc2VsZi5zaG93T25saW5lU3RhdHVzID0gc2hvd09ubGluZVN0YXR1cwogICAgfQp9CgpzdHJ1Y3QgRGlzcGxheVByZWZlcmVuY2VzOiBDb2RhYmxlIHsKICAgIGxldCBwb3N0c1BlclBhZ2U6IEludAogICAgbGV0IHRocmVhZHNQZXJQYWdlOiBJbnQKICAgIGxldCBzaG93U2lnbmF0dXJlczogQm9vbAogICAgbGV0IHNob3dBdmF0YXJzOiBCb29sCiAgICBsZXQgY29tcGFjdE1vZGU6IEJvb2wKICAgIAogICAgaW5pdChwb3N0c1BlclBhZ2U6IEludCA9IDIwLCB0aHJlYWRzUGVyUGFnZTogSW50ID0gMjUsIHNob3dTaWduYXR1cmVzOiBCb29sID0gdHJ1ZSwgc2hvd0F2YXRhcnM6IEJvb2wgPSB0cnVlLCBjb21wYWN0TW9kZTogQm9vbCA9IGZhbHNlKSB7CiAgICAgICAgc2VsZi5wb3N0c1BlclBhZ2UgPSBwb3N0c1BlclBhZ2UKICAgICAgICBzZWxmLnRocmVhZHNQZXJQYWdlID0gdGhyZWFkc1BlclBhZ2UKICAgICAgICBzZWxmLnNob3dTaWduYXR1cmVzID0gc2hvd1NpZ25hdHVyZXMKICAgICAgICBzZWxmLnNob3dBdmF0YXJzID0gc2hvd0F2YXRhcnMKICAgICAgICBzZWxmLmNvbXBhY3RNb2RlID0gY29tcGFjdE1vZGUKICAgIH0KfQoKLy8gTUFSSzogLSBGb3J1bSBNb2RlbApzdHJ1Y3QgRm9ydW06IElkZW50aWZpYWJsZSwgQ29kYWJsZSwgSGFzaGFibGUgewogICAgbGV0IGlkOiBTdHJpbmcKICAgIGxldCBuYW1lOiBTdHJpbmcKICAgIGxldCBkZXNjcmlwdGlvbjogU3RyaW5nPwogICAgbGV0IHBhcmVudEZvcnVtSUQ6IFN0cmluZz8KICAgIHZhciBkaXNwbGF5T3JkZXI6IEludAogICAgbGV0IGlzTG9ja2VkOiBCb29sCiAgICBsZXQgaXNIaWRkZW46IEJvb2wKICAgIGxldCByZXF1aXJlZFBlcm1pc3Npb25zOiBbU3RyaW5nXQogICAgbGV0IHRocmVhZENvdW50OiBJbnQKICAgIGxldCBwb3N0Q291bnQ6IEludAogICAgbGV0IGxhc3RQb3N0SUQ6IFN0cmluZz8KICAgIGxldCBsYXN0UG9zdERhdGU6IERhdGU/CiAgICBsZXQgbGFzdFBvc3RVc2VySUQ6IFN0cmluZz8KICAgIGxldCBjcmVhdGVkRGF0ZTogRGF0ZQogICAgbGV0IGNyZWF0ZWRCeVVzZXJJRDogU3RyaW5nCiAgICAKICAgIGluaXQoaWQ6IFN0cmluZyA9IFVVSUQoKS51dWlkU3RyaW5nLCBuYW1lOiBTdHJpbmcsIGRlc2NyaXB0aW9uOiBTdHJpbmc/ID0gbmlsLCBwYXJlbnRGb3J1bUlEOiBTdHJpbmc/ID0gbmlsLCBkaXNwbGF5T3JkZXI6IEludCA9IDAsIGlzTG9ja2VkOiBCb29sID0gZmFsc2UsIGlzSGlkZGVuOiBCb29sID0gZmFsc2UsIHJlcXVpcmVkUGVybWlzc2lvbnM6IFtTdHJpbmddID0gW10sIHRocmVhZENvdW50OiBJbnQgPSAwLCBwb3N0Q291bnQ6IEludCA9IDAsIGxhc3RQb3N0SUQ6IFN0cmluZz8gPSBuaWwsIGxhc3RQb3N0RGF0ZTogRGF0ZT8gPSBuaWwsIGxhc3RQb3N0VXNlcklEOiBTdHJpbmc/ID0gbmlsLCBjcmVhdGVkRGF0ZTogRGF0ZSA9IERhdGUoKSwgY3JlYXRlZEJ5VXNlcklEOiBTdHJpbmcpIHsKICAgICAgICBzZWxmLmlkID0gaWQKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCiAgICAgICAgc2VsZi5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uCiAgICAgICAgc2VsZi5wYXJlbnRGb3J1bUlEID0gcGFyZW50Rm9ydW1JRAogICAgICAgIHNlbGYuZGlzcGxheU9yZGVyID0gZGlzcGxheU9yZGVyCiAgICAgICAgc2VsZi5pc0xvY2tlZCA9IGlzTG9ja2VkCiAgICAgICAgc2VsZi5pc0hpZGRlbiA9IGlzSGlkZGVuCiAgICAgICAgc2VsZi5yZXF1aXJlZFBlcm1pc3Npb25zID0gcmVxdWlyZWRQZXJtaXNzaW9ucwogICAgICAgIHNlbGYudGhyZWFkQ291bnQgPSB0aHJlYWRDb3VudAogICAgICAgIHNlbGYucG9zdENvdW50ID0gcG9zdENvdW50CiAgICAgICAgc2VsZi5sYXN0UG9zdElEID0gbGFzdFBvc3RJRAogICAgICAgIHNlbGYubGFzdFBvc3REYXRlID0gbGFzdFBvc3REYXRlCiAgICAgICAgc2VsZi5sYXN0UG9zdFVzZXJJRCA9IGxhc3RQb3N0VXNlcklECiAgICAgICAgc2VsZi5jcmVhdGVkRGF0ZSA9IGNyZWF0ZWREYXRlCiAgICAgICAgc2VsZi5jcmVhdGVkQnlVc2VySUQgPSBjcmVhdGVkQnlVc2VySUQKICAgIH0KICAgIAogICAgZnVuYyB0b0Nsb3VkS2l0UmVjb3JkKCkgLT4gQ0tSZWNvcmQgewogICAgICAgIC8vIEZvcnVtcyBhcmUgc3RvcmVkIGluIHB1YmxpYyBkYXRhYmFzZSB3aXRoIGRlZmF1bHQgem9uZQogICAgICAgIGxldCByZWNvcmQgPSBDS1JlY29yZChyZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUuZm9ydW0ucmF3VmFsdWUsIHJlY29yZElEOiBDS1JlY29yZC5JRChyZWNvcmROYW1lOiBpZCkpCiAgICAgICAgcmVjb3JkWyJuYW1lIl0gPSBuYW1lCiAgICAgICAgcmVjb3JkWyJkZXNjcmlwdGlvbiJdID0gZGVzY3JpcHRpb24KICAgICAgICByZWNvcmRbInBhcmVudEZvcnVtSUQiXSA9IHBhcmVudEZvcnVtSUQKICAgICAgICByZWNvcmRbImRpc3BsYXlPcmRlciJdID0gZGlzcGxheU9yZGVyCiAgICAgICAgcmVjb3JkWyJpc0xvY2tlZCJdID0gaXNMb2NrZWQKICAgICAgICByZWNvcmRbImlzSGlkZGVuIl0gPSBpc0hpZGRlbgogICAgICAgIHJlY29yZFsicmVxdWlyZWRQZXJtaXNzaW9ucyJdID0gcmVxdWlyZWRQZXJtaXNzaW9ucwogICAgICAgIHJlY29yZFsidGhyZWFkQ291bnQiXSA9IHRocmVhZENvdW50CiAgICAgICAgcmVjb3JkWyJwb3N0Q291bnQiXSA9IHBvc3RDb3VudAogICAgICAgIHJlY29yZFsibGFzdFBvc3RJRCJdID0gbGFzdFBvc3RJRAogICAgICAgIHJlY29yZFsibGFzdFBvc3REYXRlIl0gPSBsYXN0UG9zdERhdGUKICAgICAgICByZWNvcmRbImxhc3RQb3N0VXNlcklEIl0gPSBsYXN0UG9zdFVzZXJJRAogICAgICAgIHJlY29yZFsiY3JlYXRlZERhdGUiXSA9IGNyZWF0ZWREYXRlCiAgICAgICAgcmVjb3JkWyJjcmVhdGVkQnlVc2VySUQiXSA9IGNyZWF0ZWRCeVVzZXJJRAogICAgICAgIHJldHVybiByZWNvcmQKICAgIH0KICAgIAogICAgc3RhdGljIGZ1bmMgZnJvbUNsb3VkS2l0UmVjb3JkKF8gcmVjb3JkOiBDS1JlY29yZCkgLT4gRm9ydW0/IHsKICAgICAgICBndWFyZCBsZXQgbmFtZSA9IHJlY29yZFsibmFtZSJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IGNyZWF0ZWRCeVVzZXJJRCA9IHJlY29yZFsiY3JlYXRlZEJ5VXNlcklEIl0gYXM/IFN0cmluZyBlbHNlIHsgcmV0dXJuIG5pbCB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIEZvcnVtKAogICAgICAgICAgICBpZDogcmVjb3JkLnJlY29yZElELnJlY29yZE5hbWUsCiAgICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZWNvcmRbImRlc2NyaXB0aW9uIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgcGFyZW50Rm9ydW1JRDogcmVjb3JkWyJwYXJlbnRGb3J1bUlEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgZGlzcGxheU9yZGVyOiByZWNvcmRbImRpc3BsYXlPcmRlciJdIGFzPyBJbnQgPz8gMCwKICAgICAgICAgICAgaXNMb2NrZWQ6IHJlY29yZFsiaXNMb2NrZWQiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgaXNIaWRkZW46IHJlY29yZFsiaXNIaWRkZW4iXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgcmVxdWlyZWRQZXJtaXNzaW9uczogcmVjb3JkWyJyZXF1aXJlZFBlcm1pc3Npb25zIl0gYXM/IFtTdHJpbmddID8/IFtdLAogICAgICAgICAgICB0aHJlYWRDb3VudDogcmVjb3JkWyJ0aHJlYWRDb3VudCJdIGFzPyBJbnQgPz8gMCwKICAgICAgICAgICAgcG9zdENvdW50OiByZWNvcmRbInBvc3RDb3VudCJdIGFzPyBJbnQgPz8gMCwKICAgICAgICAgICAgbGFzdFBvc3RJRDogcmVjb3JkWyJsYXN0UG9zdElEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgbGFzdFBvc3REYXRlOiByZWNvcmRbImxhc3RQb3N0RGF0ZSJdIGFzPyBEYXRlLAogICAgICAgICAgICBsYXN0UG9zdFVzZXJJRDogcmVjb3JkWyJsYXN0UG9zdFVzZXJJRCJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgIGNyZWF0ZWREYXRlOiByZWNvcmRbImNyZWF0ZWREYXRlIl0gYXM/IERhdGUgPz8gRGF0ZSgpLAogICAgICAgICAgICBjcmVhdGVkQnlVc2VySUQ6IGNyZWF0ZWRCeVVzZXJJRAogICAgICAgICkKICAgIH0KCiAgICBmdW5jIGhhc2goaW50byBoYXNoZXI6IGlub3V0IEhhc2hlcikgewogICAgICAgIGhhc2hlci5jb21iaW5lKGlkKQogICAgfQoKICAgIHN0YXRpYyBmdW5jID09IChsaHM6IEZvcnVtLCByaHM6IEZvcnVtKSAtPiBCb29sIHsKICAgICAgICBsaHMuaWQgPT0gcmhzLmlkCiAgICB9Cn0KCi8vIE1BUks6IC0gVGhyZWFkIE1vZGVsCnN0cnVjdCBGb3J1bVRocmVhZDogSWRlbnRpZmlhYmxlLCBDb2RhYmxlLCBIYXNoYWJsZSB7CiAgICBsZXQgaWQ6IFN0cmluZwogICAgbGV0IHRpdGxlOiBTdHJpbmcKICAgIGxldCBmb3J1bUlEOiBTdHJpbmcKICAgIGxldCBhdXRob3JJRDogU3RyaW5nCiAgICBsZXQgY3JlYXRlZERhdGU6IERhdGUKICAgIGxldCBsYXN0UG9zdERhdGU6IERhdGUKICAgIGxldCBsYXN0UG9zdFVzZXJJRDogU3RyaW5nCiAgICBsZXQgcG9zdENvdW50OiBJbnQKICAgIGxldCB2aWV3Q291bnQ6IEludAogICAgbGV0IGlzU3RpY2t5OiBCb29sCiAgICBsZXQgaXNMb2NrZWQ6IEJvb2wKICAgIGxldCBpc0Fubm91bmNlbWVudDogQm9vbAogICAgbGV0IGlzSGlkZGVuOiBCb29sCiAgICBsZXQgdGFnczogW1N0cmluZ10KICAgIGxldCBwb2xsSUQ6IFN0cmluZz8KICAgIAogICAgaW5pdChpZDogU3RyaW5nID0gVVVJRCgpLnV1aWRTdHJpbmcsIHRpdGxlOiBTdHJpbmcsIGZvcnVtSUQ6IFN0cmluZywgYXV0aG9ySUQ6IFN0cmluZywgY3JlYXRlZERhdGU6IERhdGUgPSBEYXRlKCksIGxhc3RQb3N0RGF0ZTogRGF0ZSA9IERhdGUoKSwgbGFzdFBvc3RVc2VySUQ6IFN0cmluZywgcG9zdENvdW50OiBJbnQgPSAxLCB2aWV3Q291bnQ6IEludCA9IDAsIGlzU3RpY2t5OiBCb29sID0gZmFsc2UsIGlzTG9ja2VkOiBCb29sID0gZmFsc2UsIGlzQW5ub3VuY2VtZW50OiBCb29sID0gZmFsc2UsIGlzSGlkZGVuOiBCb29sID0gZmFsc2UsIHRhZ3M6IFtTdHJpbmddID0gW10sIHBvbGxJRDogU3RyaW5nPyA9IG5pbCkgewogICAgICAgIHNlbGYuaWQgPSBpZAogICAgICAgIHNlbGYudGl0bGUgPSB0aXRsZQogICAgICAgIHNlbGYuZm9ydW1JRCA9IGZvcnVtSUQKICAgICAgICBzZWxmLmF1dGhvcklEID0gYXV0aG9ySUQKICAgICAgICBzZWxmLmNyZWF0ZWREYXRlID0gY3JlYXRlZERhdGUKICAgICAgICBzZWxmLmxhc3RQb3N0RGF0ZSA9IGxhc3RQb3N0RGF0ZQogICAgICAgIHNlbGYubGFzdFBvc3RVc2VySUQgPSBsYXN0UG9zdFVzZXJJRAogICAgICAgIHNlbGYucG9zdENvdW50ID0gcG9zdENvdW50CiAgICAgICAgc2VsZi52aWV3Q291bnQgPSB2aWV3Q291bnQKICAgICAgICBzZWxmLmlzU3RpY2t5ID0gaXNTdGlja3kKICAgICAgICBzZWxmLmlzTG9ja2VkID0gaXNMb2NrZWQKICAgICAgICBzZWxmLmlzQW5ub3VuY2VtZW50ID0gaXNBbm5vdW5jZW1lbnQKICAgICAgICBzZWxmLmlzSGlkZGVuID0gaXNIaWRkZW4KICAgICAgICBzZWxmLnRhZ3MgPSB0YWdzCiAgICAgICAgc2VsZi5wb2xsSUQgPSBwb2xsSUQKICAgIH0KICAgIAogICAgZnVuYyB0b0Nsb3VkS2l0UmVjb3JkKCkgLT4gQ0tSZWNvcmQgewogICAgICAgIC8vIFRocmVhZHMgYXJlIHN0b3JlZCBpbiBwdWJsaWMgZGF0YWJhc2Ugd2l0aCBkZWZhdWx0IHpvbmUKICAgICAgICBsZXQgcmVjb3JkID0gQ0tSZWNvcmQocmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLnRocmVhZC5yYXdWYWx1ZSwgcmVjb3JkSUQ6IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IGlkKSkKICAgICAgICByZWNvcmRbInRpdGxlIl0gPSB0aXRsZQogICAgICAgIHJlY29yZFsiZm9ydW1JRCJdID0gZm9ydW1JRAogICAgICAgIHJlY29yZFsiYXV0aG9ySUQiXSA9IGF1dGhvcklECiAgICAgICAgcmVjb3JkWyJjcmVhdGVkRGF0ZSJdID0gY3JlYXRlZERhdGUKICAgICAgICByZWNvcmRbImxhc3RQb3N0RGF0ZSJdID0gbGFzdFBvc3REYXRlCiAgICAgICAgcmVjb3JkWyJsYXN0UG9zdFVzZXJJRCJdID0gbGFzdFBvc3RVc2VySUQKICAgICAgICByZWNvcmRbInBvc3RDb3VudCJdID0gcG9zdENvdW50CiAgICAgICAgcmVjb3JkWyJ2aWV3Q291bnQiXSA9IHZpZXdDb3VudAogICAgICAgIHJlY29yZFsiaXNTdGlja3kiXSA9IGlzU3RpY2t5CiAgICAgICAgcmVjb3JkWyJpc0xvY2tlZCJdID0gaXNMb2NrZWQKICAgICAgICByZWNvcmRbImlzQW5ub3VuY2VtZW50Il0gPSBpc0Fubm91bmNlbWVudAogICAgICAgIHJlY29yZFsiaXNIaWRkZW4iXSA9IGlzSGlkZGVuCiAgICAgICAgcmVjb3JkWyJ0YWdzIl0gPSB0YWdzCiAgICAgICAgcmVjb3JkWyJwb2xsSUQiXSA9IHBvbGxJRAogICAgICAgIHJldHVybiByZWNvcmQKICAgIH0KICAgIAogICAgc3RhdGljIGZ1bmMgZnJvbUNsb3VkS2l0UmVjb3JkKF8gcmVjb3JkOiBDS1JlY29yZCkgLT4gRm9ydW1UaHJlYWQ/IHsKICAgICAgICBndWFyZCBsZXQgdGl0bGUgPSByZWNvcmRbInRpdGxlIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgZm9ydW1JRCA9IHJlY29yZFsiZm9ydW1JRCJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IGF1dGhvcklEID0gcmVjb3JkWyJhdXRob3JJRCJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIHJldHVybiBGb3J1bVRocmVhZCgKICAgICAgICAgICAgaWQ6IHJlY29yZC5yZWNvcmRJRC5yZWNvcmROYW1lLAogICAgICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAgICAgIGZvcnVtSUQ6IGZvcnVtSUQsCiAgICAgICAgICAgIGF1dGhvcklEOiBhdXRob3JJRCwKICAgICAgICAgICAgY3JlYXRlZERhdGU6IHJlY29yZFsiY3JlYXRlZERhdGUiXSBhcz8gRGF0ZSA/PyBEYXRlKCksCiAgICAgICAgICAgIGxhc3RQb3N0RGF0ZTogcmVjb3JkWyJsYXN0UG9zdERhdGUiXSBhcz8gRGF0ZSA/PyBEYXRlKCksCiAgICAgICAgICAgIGxhc3RQb3N0VXNlcklEOiByZWNvcmRbImxhc3RQb3N0VXNlcklEIl0gYXM/IFN0cmluZyA/PyBhdXRob3JJRCwKICAgICAgICAgICAgcG9zdENvdW50OiByZWNvcmRbInBvc3RDb3VudCJdIGFzPyBJbnQgPz8gMSwKICAgICAgICAgICAgdmlld0NvdW50OiByZWNvcmRbInZpZXdDb3VudCJdIGFzPyBJbnQgPz8gMCwKICAgICAgICAgICAgaXNTdGlja3k6IHJlY29yZFsiaXNTdGlja3kiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgaXNMb2NrZWQ6IHJlY29yZFsiaXNMb2NrZWQiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgaXNBbm5vdW5jZW1lbnQ6IHJlY29yZFsiaXNBbm5vdW5jZW1lbnQiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgaXNIaWRkZW46IHJlY29yZFsiaXNIaWRkZW4iXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgdGFnczogcmVjb3JkWyJ0YWdzIl0gYXM/IFtTdHJpbmddID8/IFtdLAogICAgICAgICAgICBwb2xsSUQ6IHJlY29yZFsicG9sbElEIl0gYXM/IFN0cmluZwogICAgICAgICkKICAgIH0KCiAgICBmdW5jIGhhc2goaW50byBoYXNoZXI6IGlub3V0IEhhc2hlcikgewogICAgICAgIGhhc2hlci5jb21iaW5lKGlkKQogICAgfQoKICAgIHN0YXRpYyBmdW5jID09IChsaHM6IEZvcnVtVGhyZWFkLCByaHM6IEZvcnVtVGhyZWFkKSAtPiBCb29sIHsKICAgICAgICBsaHMuaWQgPT0gcmhzLmlkCiAgICB9Cn0KCi8vIE1BUks6IC0gUG9zdCBNb2RlbApzdHJ1Y3QgRm9ydW1Qb3N0OiBJZGVudGlmaWFibGUsIENvZGFibGUsIEhhc2hhYmxlIHsKICAgIGxldCBpZDogU3RyaW5nCiAgICBsZXQgdGhyZWFkSUQ6IFN0cmluZwogICAgbGV0IGF1dGhvcklEOiBTdHJpbmcKICAgIGxldCBjb250ZW50OiBTdHJpbmcKICAgIGxldCBjcmVhdGVkRGF0ZTogRGF0ZQogICAgbGV0IGVkaXRlZERhdGU6IERhdGU/CiAgICBsZXQgZWRpdGVkQnlVc2VySUQ6IFN0cmluZz8KICAgIGxldCBlZGl0UmVhc29uOiBTdHJpbmc/CiAgICBsZXQgaXNIaWRkZW46IEJvb2wKICAgIGxldCBsaWtlQ291bnQ6IEludAogICAgbGV0IHF1b3RlQ291bnQ6IEludAogICAgbGV0IGF0dGFjaG1lbnRJRHM6IFtTdHJpbmddCiAgICBsZXQgcXVvdGVkUG9zdElEczogW1N0cmluZ10KICAgIGxldCBwYXJlbnRQb3N0SUQ6IFN0cmluZz8KICAgIGxldCBwb3N0TnVtYmVyOiBJbnQKICAgIAogICAgaW5pdChpZDogU3RyaW5nID0gVVVJRCgpLnV1aWRTdHJpbmcsIHRocmVhZElEOiBTdHJpbmcsIGF1dGhvcklEOiBTdHJpbmcsIGNvbnRlbnQ6IFN0cmluZywgY3JlYXRlZERhdGU6IERhdGUgPSBEYXRlKCksIGVkaXRlZERhdGU6IERhdGU/ID0gbmlsLCBlZGl0ZWRCeVVzZXJJRDogU3RyaW5nPyA9IG5pbCwgZWRpdFJlYXNvbjogU3RyaW5nPyA9IG5pbCwgaXNIaWRkZW46IEJvb2wgPSBmYWxzZSwgbGlrZUNvdW50OiBJbnQgPSAwLCBxdW90ZUNvdW50OiBJbnQgPSAwLCBhdHRhY2htZW50SURzOiBbU3RyaW5nXSA9IFtdLCBxdW90ZWRQb3N0SURzOiBbU3RyaW5nXSA9IFtdLCBwYXJlbnRQb3N0SUQ6IFN0cmluZz8gPSBuaWwsIHBvc3ROdW1iZXI6IEludCA9IDEpIHsKICAgICAgICBzZWxmLmlkID0gaWQKICAgICAgICBzZWxmLnRocmVhZElEID0gdGhyZWFkSUQKICAgICAgICBzZWxmLmF1dGhvcklEID0gYXV0aG9ySUQKICAgICAgICBzZWxmLmNvbnRlbnQgPSBjb250ZW50CiAgICAgICAgc2VsZi5jcmVhdGVkRGF0ZSA9IGNyZWF0ZWREYXRlCiAgICAgICAgc2VsZi5lZGl0ZWREYXRlID0gZWRpdGVkRGF0ZQogICAgICAgIHNlbGYuZWRpdGVkQnlVc2VySUQgPSBlZGl0ZWRCeVVzZXJJRAogICAgICAgIHNlbGYuZWRpdFJlYXNvbiA9IGVkaXRSZWFzb24KICAgICAgICBzZWxmLmlzSGlkZGVuID0gaXNIaWRkZW4KICAgICAgICBzZWxmLmxpa2VDb3VudCA9IGxpa2VDb3VudAogICAgICAgIHNlbGYucXVvdGVDb3VudCA9IHF1b3RlQ291bnQKICAgICAgICBzZWxmLmF0dGFjaG1lbnRJRHMgPSBhdHRhY2htZW50SURzCiAgICAgICAgc2VsZi5xdW90ZWRQb3N0SURzID0gcXVvdGVkUG9zdElEcwogICAgICAgIHNlbGYucGFyZW50UG9zdElEID0gcGFyZW50UG9zdElECiAgICAgICAgc2VsZi5wb3N0TnVtYmVyID0gcG9zdE51bWJlcgogICAgfQogICAgCiAgICBmdW5jIHRvQ2xvdWRLaXRSZWNvcmQoKSAtPiBDS1JlY29yZCB7CiAgICAgICAgLy8gUG9zdHMgYXJlIHN0b3JlZCBpbiBwdWJsaWMgZGF0YWJhc2Ugd2l0aCBkZWZhdWx0IHpvbmUKICAgICAgICBsZXQgcmVjb3JkID0gQ0tSZWNvcmQocmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLnBvc3QucmF3VmFsdWUsIHJlY29yZElEOiBDS1JlY29yZC5JRChyZWNvcmROYW1lOiBpZCkpCiAgICAgICAgcmVjb3JkWyJ0aHJlYWRJRCJdID0gdGhyZWFkSUQKICAgICAgICByZWNvcmRbImF1dGhvcklEIl0gPSBhdXRob3JJRAogICAgICAgIHJlY29yZFsiY29udGVudCJdID0gY29udGVudAogICAgICAgIHJlY29yZFsiY3JlYXRlZERhdGUiXSA9IGNyZWF0ZWREYXRlCiAgICAgICAgcmVjb3JkWyJlZGl0ZWREYXRlIl0gPSBlZGl0ZWREYXRlCiAgICAgICAgcmVjb3JkWyJlZGl0ZWRCeVVzZXJJRCJdID0gZWRpdGVkQnlVc2VySUQKICAgICAgICByZWNvcmRbImVkaXRSZWFzb24iXSA9IGVkaXRSZWFzb24KICAgICAgICByZWNvcmRbImlzSGlkZGVuIl0gPSBpc0hpZGRlbgogICAgICAgIHJlY29yZFsibGlrZUNvdW50Il0gPSBsaWtlQ291bnQKICAgICAgICByZWNvcmRbInF1b3RlQ291bnQiXSA9IHF1b3RlQ291bnQKICAgICAgICByZWNvcmRbImF0dGFjaG1lbnRJRHMiXSA9IGF0dGFjaG1lbnRJRHMKICAgICAgICByZWNvcmRbInF1b3RlZFBvc3RJRHMiXSA9IHF1b3RlZFBvc3RJRHMKICAgICAgICByZWNvcmRbInBhcmVudFBvc3RJRCJdID0gcGFyZW50UG9zdElECiAgICAgICAgcmVjb3JkWyJwb3N0TnVtYmVyIl0gPSBwb3N0TnVtYmVyCiAgICAgICAgcmV0dXJuIHJlY29yZAogICAgfQogICAgCiAgICBzdGF0aWMgZnVuYyBmcm9tQ2xvdWRLaXRSZWNvcmQoXyByZWNvcmQ6IENLUmVjb3JkKSAtPiBGb3J1bVBvc3Q/IHsKICAgICAgICBndWFyZCBsZXQgdGhyZWFkSUQgPSByZWNvcmRbInRocmVhZElEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgYXV0aG9ySUQgPSByZWNvcmRbImF1dGhvcklEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgY29udGVudCA9IHJlY29yZFsiY29udGVudCJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIHJldHVybiBGb3J1bVBvc3QoCiAgICAgICAgICAgIGlkOiByZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSwKICAgICAgICAgICAgdGhyZWFkSUQ6IHRocmVhZElELAogICAgICAgICAgICBhdXRob3JJRDogYXV0aG9ySUQsCiAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsCiAgICAgICAgICAgIGNyZWF0ZWREYXRlOiByZWNvcmRbImNyZWF0ZWREYXRlIl0gYXM/IERhdGUgPz8gRGF0ZSgpLAogICAgICAgICAgICBlZGl0ZWREYXRlOiByZWNvcmRbImVkaXRlZERhdGUiXSBhcz8gRGF0ZSwKICAgICAgICAgICAgZWRpdGVkQnlVc2VySUQ6IHJlY29yZFsiZWRpdGVkQnlVc2VySUQiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICBlZGl0UmVhc29uOiByZWNvcmRbImVkaXRSZWFzb24iXSBhcz8gU3RyaW5nLAogICAgICAgICAgICBpc0hpZGRlbjogcmVjb3JkWyJpc0hpZGRlbiJdIGFzPyBCb29sID8/IGZhbHNlLAogICAgICAgICAgICBsaWtlQ291bnQ6IHJlY29yZFsibGlrZUNvdW50Il0gYXM/IEludCA/PyAwLAogICAgICAgICAgICBxdW90ZUNvdW50OiByZWNvcmRbInF1b3RlQ291bnQiXSBhcz8gSW50ID8/IDAsCiAgICAgICAgICAgIGF0dGFjaG1lbnRJRHM6IHJlY29yZFsiYXR0YWNobWVudElEcyJdIGFzPyBbU3RyaW5nXSA/PyBbXSwKICAgICAgICAgICAgcXVvdGVkUG9zdElEczogcmVjb3JkWyJxdW90ZWRQb3N0SURzIl0gYXM/IFtTdHJpbmddID8/IFtdLAogICAgICAgICAgICBwYXJlbnRQb3N0SUQ6IHJlY29yZFsicGFyZW50UG9zdElEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgcG9zdE51bWJlcjogcmVjb3JkWyJwb3N0TnVtYmVyIl0gYXM/IEludCA/PyAxCiAgICAgICAgKQogICAgfQogICAgCiAgICBmdW5jIGhhc2goaW50byBoYXNoZXI6IGlub3V0IEhhc2hlcikgewogICAgICAgIGhhc2hlci5jb21iaW5lKGlkKQogICAgfQogICAgc3RhdGljIGZ1bmMgPT0gKGxoczogRm9ydW1Qb3N0LCByaHM6IEZvcnVtUG9zdCkgLT4gQm9vbCB7CiAgICAgICAgbGhzLmlkID09IHJocy5pZAogICAgfQp9CgovLyBNQVJLOiAtIFBvbGwgTW9kZWwKc3RydWN0IEZvcnVtUG9sbDogSWRlbnRpZmlhYmxlLCBDb2RhYmxlIHsKICAgIGxldCBpZDogU3RyaW5nCiAgICBsZXQgdGhyZWFkSUQ6IFN0cmluZwogICAgbGV0IHF1ZXN0aW9uOiBTdHJpbmcKICAgIGxldCBvcHRpb25zOiBbUG9sbE9wdGlvbl0KICAgIGxldCBhbGxvd011bHRpcGxlVm90ZXM6IEJvb2wKICAgIGxldCBhbGxvd1ZvdGVDaGFuZ2VzOiBCb29sCiAgICBsZXQgaXNQdWJsaWM6IEJvb2wKICAgIGxldCBlbmREYXRlOiBEYXRlPwogICAgbGV0IGNyZWF0ZWREYXRlOiBEYXRlCiAgICBsZXQgY3JlYXRlZEJ5VXNlcklEOiBTdHJpbmcKICAgIGxldCB0b3RhbFZvdGVzOiBJbnQKICAgIAogICAgaW5pdChpZDogU3RyaW5nID0gVVVJRCgpLnV1aWRTdHJpbmcsIHRocmVhZElEOiBTdHJpbmcsIHF1ZXN0aW9uOiBTdHJpbmcsIG9wdGlvbnM6IFtQb2xsT3B0aW9uXSwgYWxsb3dNdWx0aXBsZVZvdGVzOiBCb29sID0gZmFsc2UsIGFsbG93Vm90ZUNoYW5nZXM6IEJvb2wgPSB0cnVlLCBpc1B1YmxpYzogQm9vbCA9IHRydWUsIGVuZERhdGU6IERhdGU/ID0gbmlsLCBjcmVhdGVkRGF0ZTogRGF0ZSA9IERhdGUoKSwgY3JlYXRlZEJ5VXNlcklEOiBTdHJpbmcsIHRvdGFsVm90ZXM6IEludCA9IDApIHsKICAgICAgICBzZWxmLmlkID0gaWQKICAgICAgICBzZWxmLnRocmVhZElEID0gdGhyZWFkSUQKICAgICAgICBzZWxmLnF1ZXN0aW9uID0gcXVlc3Rpb24KICAgICAgICBzZWxmLm9wdGlvbnMgPSBvcHRpb25zCiAgICAgICAgc2VsZi5hbGxvd011bHRpcGxlVm90ZXMgPSBhbGxvd011bHRpcGxlVm90ZXMKICAgICAgICBzZWxmLmFsbG93Vm90ZUNoYW5nZXMgPSBhbGxvd1ZvdGVDaGFuZ2VzCiAgICAgICAgc2VsZi5pc1B1YmxpYyA9IGlzUHVibGljCiAgICAgICAgc2VsZi5lbmREYXRlID0gZW5kRGF0ZQogICAgICAgIHNlbGYuY3JlYXRlZERhdGUgPSBjcmVhdGVkRGF0ZQogICAgICAgIHNlbGYuY3JlYXRlZEJ5VXNlcklEID0gY3JlYXRlZEJ5VXNlcklECiAgICAgICAgc2VsZi50b3RhbFZvdGVzID0gdG90YWxWb3RlcwogICAgfQogICAgCiAgICBmdW5jIHRvQ2xvdWRLaXRSZWNvcmQoKSAtPiBDS1JlY29yZCB7CiAgICAgICAgbGV0IHJlY29yZCA9IENLUmVjb3JkKHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZS5wb2xsLnJhd1ZhbHVlLCByZWNvcmRJRDogQ0tSZWNvcmQuSUQocmVjb3JkTmFtZTogaWQpKQogICAgICAgIHJlY29yZFsidGhyZWFkSUQiXSA9IHRocmVhZElECiAgICAgICAgcmVjb3JkWyJxdWVzdGlvbiJdID0gcXVlc3Rpb24KICAgICAgICByZWNvcmRbIm9wdGlvbnMiXSA9IHRyeT8gSlNPTkVuY29kZXIoKS5lbmNvZGUob3B0aW9ucykKICAgICAgICByZWNvcmRbImFsbG93TXVsdGlwbGVWb3RlcyJdID0gYWxsb3dNdWx0aXBsZVZvdGVzCiAgICAgICAgcmVjb3JkWyJhbGxvd1ZvdGVDaGFuZ2VzIl0gPSBhbGxvd1ZvdGVDaGFuZ2VzCiAgICAgICAgcmVjb3JkWyJpc1B1YmxpYyJdID0gaXNQdWJsaWMKICAgICAgICByZWNvcmRbImVuZERhdGUiXSA9IGVuZERhdGUKICAgICAgICByZWNvcmRbImNyZWF0ZWREYXRlIl0gPSBjcmVhdGVkRGF0ZQogICAgICAgIHJlY29yZFsiY3JlYXRlZEJ5VXNlcklEIl0gPSBjcmVhdGVkQnlVc2VySUQKICAgICAgICByZWNvcmRbInRvdGFsVm90ZXMiXSA9IHRvdGFsVm90ZXMKICAgICAgICByZXR1cm4gcmVjb3JkCiAgICB9CiAgICAKICAgIHN0YXRpYyBmdW5jIGZyb21DbG91ZEtpdFJlY29yZChfIHJlY29yZDogQ0tSZWNvcmQpIC0+IEZvcnVtUG9sbD8gewogICAgICAgIGd1YXJkIGxldCB0aHJlYWRJRCA9IHJlY29yZFsidGhyZWFkSUQiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICAgIGxldCBxdWVzdGlvbiA9IHJlY29yZFsicXVlc3Rpb24iXSBhcz8gU3RyaW5nLAogICAgICAgICAgICAgIGxldCBjcmVhdGVkQnlVc2VySUQgPSByZWNvcmRbImNyZWF0ZWRCeVVzZXJJRCJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIGxldCBvcHRpb25zRGF0YSA9IHJlY29yZFsib3B0aW9ucyJdIGFzPyBEYXRhCiAgICAgICAgbGV0IG9wdGlvbnMgPSBvcHRpb25zRGF0YS5mbGF0TWFwIHsgdHJ5PyBKU09ORGVjb2RlcigpLmRlY29kZShbUG9sbE9wdGlvbl0uc2VsZiwgZnJvbTogJDApIH0gPz8gW10KICAgICAgICAKICAgICAgICByZXR1cm4gRm9ydW1Qb2xsKAogICAgICAgICAgICBpZDogcmVjb3JkLnJlY29yZElELnJlY29yZE5hbWUsCiAgICAgICAgICAgIHRocmVhZElEOiB0aHJlYWRJRCwKICAgICAgICAgICAgcXVlc3Rpb246IHF1ZXN0aW9uLAogICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zLAogICAgICAgICAgICBhbGxvd011bHRpcGxlVm90ZXM6IHJlY29yZFsiYWxsb3dNdWx0aXBsZVZvdGVzIl0gYXM/IEJvb2wgPz8gZmFsc2UsCiAgICAgICAgICAgIGFsbG93Vm90ZUNoYW5nZXM6IHJlY29yZFsiYWxsb3dWb3RlQ2hhbmdlcyJdIGFzPyBCb29sID8/IHRydWUsCiAgICAgICAgICAgIGlzUHVibGljOiByZWNvcmRbImlzUHVibGljIl0gYXM/IEJvb2wgPz8gdHJ1ZSwKICAgICAgICAgICAgZW5kRGF0ZTogcmVjb3JkWyJlbmREYXRlIl0gYXM/IERhdGUsCiAgICAgICAgICAgIGNyZWF0ZWREYXRlOiByZWNvcmRbImNyZWF0ZWREYXRlIl0gYXM/IERhdGUgPz8gRGF0ZSgpLAogICAgICAgICAgICBjcmVhdGVkQnlVc2VySUQ6IGNyZWF0ZWRCeVVzZXJJRCwKICAgICAgICAgICAgdG90YWxWb3RlczogcmVjb3JkWyJ0b3RhbFZvdGVzIl0gYXM/IEludCA/PyAwCiAgICAgICAgKQogICAgfQp9CgpzdHJ1Y3QgUG9sbE9wdGlvbjogSWRlbnRpZmlhYmxlLCBDb2RhYmxlIHsKICAgIGxldCBpZDogU3RyaW5nCiAgICBsZXQgdGV4dDogU3RyaW5nCiAgICBsZXQgdm90ZUNvdW50OiBJbnQKICAgIAogICAgaW5pdChpZDogU3RyaW5nID0gVVVJRCgpLnV1aWRTdHJpbmcsIHRleHQ6IFN0cmluZywgdm90ZUNvdW50OiBJbnQgPSAwKSB7CiAgICAgICAgc2VsZi5pZCA9IGlkCiAgICAgICAgc2VsZi50ZXh0ID0gdGV4dAogICAgICAgIHNlbGYudm90ZUNvdW50ID0gdm90ZUNvdW50CiAgICB9Cn0KCi8vIE1BUks6IC0gUHJpdmF0ZSBNZXNzYWdlIE1vZGVsCnN0cnVjdCBQcml2YXRlTWVzc2FnZTogSWRlbnRpZmlhYmxlLCBDb2RhYmxlIHsKICAgIGxldCBpZDogU3RyaW5nCiAgICBsZXQgc3ViamVjdDogU3RyaW5nCiAgICBsZXQgY29udGVudDogU3RyaW5nCiAgICBsZXQgc2VuZGVySUQ6IFN0cmluZwogICAgbGV0IHJlY2lwaWVudElEOiBTdHJpbmcKICAgIGxldCBzZW50RGF0ZTogRGF0ZQogICAgbGV0IGlzUmVhZDogQm9vbAogICAgbGV0IHJlYWREYXRlOiBEYXRlPwogICAgbGV0IGlzRGVsZXRlZEJ5U2VuZGVyOiBCb29sCiAgICBsZXQgaXNEZWxldGVkQnlSZWNpcGllbnQ6IEJvb2wKICAgIGxldCByZXBseVRvTWVzc2FnZUlEOiBTdHJpbmc/CiAgICBsZXQgYXR0YWNobWVudElEczogW1N0cmluZ10KICAgIAogICAgaW5pdChpZDogU3RyaW5nID0gVVVJRCgpLnV1aWRTdHJpbmcsIHN1YmplY3Q6IFN0cmluZywgY29udGVudDogU3RyaW5nLCBzZW5kZXJJRDogU3RyaW5nLCByZWNpcGllbnRJRDogU3RyaW5nLCBzZW50RGF0ZTogRGF0ZSA9IERhdGUoKSwgaXNSZWFkOiBCb29sID0gZmFsc2UsIHJlYWREYXRlOiBEYXRlPyA9IG5pbCwgaXNEZWxldGVkQnlTZW5kZXI6IEJvb2wgPSBmYWxzZSwgaXNEZWxldGVkQnlSZWNpcGllbnQ6IEJvb2wgPSBmYWxzZSwgcmVwbHlUb01lc3NhZ2VJRDogU3RyaW5nPyA9IG5pbCwgYXR0YWNobWVudElEczogW1N0cmluZ10gPSBbXSkgewogICAgICAgIHNlbGYuaWQgPSBpZAogICAgICAgIHNlbGYuc3ViamVjdCA9IHN1YmplY3QKICAgICAgICBzZWxmLmNvbnRlbnQgPSBjb250ZW50CiAgICAgICAgc2VsZi5zZW5kZXJJRCA9IHNlbmRlcklECiAgICAgICAgc2VsZi5yZWNpcGllbnRJRCA9IHJlY2lwaWVudElECiAgICAgICAgc2VsZi5zZW50RGF0ZSA9IHNlbnREYXRlCiAgICAgICAgc2VsZi5pc1JlYWQgPSBpc1JlYWQKICAgICAgICBzZWxmLnJlYWREYXRlID0gcmVhZERhdGUKICAgICAgICBzZWxmLmlzRGVsZXRlZEJ5U2VuZGVyID0gaXNEZWxldGVkQnlTZW5kZXIKICAgICAgICBzZWxmLmlzRGVsZXRlZEJ5UmVjaXBpZW50ID0gaXNEZWxldGVkQnlSZWNpcGllbnQKICAgICAgICBzZWxmLnJlcGx5VG9NZXNzYWdlSUQgPSByZXBseVRvTWVzc2FnZUlECiAgICAgICAgc2VsZi5hdHRhY2htZW50SURzID0gYXR0YWNobWVudElEcwogICAgfQogICAgCiAgICBmdW5jIHRvQ2xvdWRLaXRSZWNvcmQoKSAtPiBDS1JlY29yZCB7CiAgICAgICAgbGV0IHJlY29yZCA9IENLUmVjb3JkKHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZS5wcml2YXRlTWVzc2FnZS5yYXdWYWx1ZSwgcmVjb3JkSUQ6IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IGlkKSkKICAgICAgICByZWNvcmRbInN1YmplY3QiXSA9IHN1YmplY3QKICAgICAgICByZWNvcmRbImNvbnRlbnQiXSA9IGNvbnRlbnQKICAgICAgICByZWNvcmRbInNlbmRlcklEIl0gPSBzZW5kZXJJRAogICAgICAgIHJlY29yZFsicmVjaXBpZW50SUQiXSA9IHJlY2lwaWVudElECiAgICAgICAgcmVjb3JkWyJzZW50RGF0ZSJdID0gc2VudERhdGUKICAgICAgICByZWNvcmRbImlzUmVhZCJdID0gaXNSZWFkCiAgICAgICAgcmVjb3JkWyJyZWFkRGF0ZSJdID0gcmVhZERhdGUKICAgICAgICByZWNvcmRbImlzRGVsZXRlZEJ5U2VuZGVyIl0gPSBpc0RlbGV0ZWRCeVNlbmRlcgogICAgICAgIHJlY29yZFsiaXNEZWxldGVkQnlSZWNpcGllbnQiXSA9IGlzRGVsZXRlZEJ5UmVjaXBpZW50CiAgICAgICAgcmVjb3JkWyJyZXBseVRvTWVzc2FnZUlEIl0gPSByZXBseVRvTWVzc2FnZUlECiAgICAgICAgcmVjb3JkWyJhdHRhY2htZW50SURzIl0gPSBhdHRhY2htZW50SURzCiAgICAgICAgcmV0dXJuIHJlY29yZAogICAgfQogICAgCiAgICBzdGF0aWMgZnVuYyBmcm9tQ2xvdWRLaXRSZWNvcmQoXyByZWNvcmQ6IENLUmVjb3JkKSAtPiBQcml2YXRlTWVzc2FnZT8gewogICAgICAgIGd1YXJkIGxldCBzdWJqZWN0ID0gcmVjb3JkWyJzdWJqZWN0Il0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgY29udGVudCA9IHJlY29yZFsiY29udGVudCJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IHNlbmRlcklEID0gcmVjb3JkWyJzZW5kZXJJRCJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IHJlY2lwaWVudElEID0gcmVjb3JkWyJyZWNpcGllbnRJRCJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIHJldHVybiBQcml2YXRlTWVzc2FnZSgKICAgICAgICAgICAgaWQ6IHJlY29yZC5yZWNvcmRJRC5yZWNvcmROYW1lLAogICAgICAgICAgICBzdWJqZWN0OiBzdWJqZWN0LAogICAgICAgICAgICBjb250ZW50OiBjb250ZW50LAogICAgICAgICAgICBzZW5kZXJJRDogc2VuZGVySUQsCiAgICAgICAgICAgIHJlY2lwaWVudElEOiByZWNpcGllbnRJRCwKICAgICAgICAgICAgc2VudERhdGU6IHJlY29yZFsic2VudERhdGUiXSBhcz8gRGF0ZSA/PyBEYXRlKCksCiAgICAgICAgICAgIGlzUmVhZDogcmVjb3JkWyJpc1JlYWQiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgcmVhZERhdGU6IHJlY29yZFsicmVhZERhdGUiXSBhcz8gRGF0ZSwKICAgICAgICAgICAgaXNEZWxldGVkQnlTZW5kZXI6IHJlY29yZFsiaXNEZWxldGVkQnlTZW5kZXIiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgaXNEZWxldGVkQnlSZWNpcGllbnQ6IHJlY29yZFsiaXNEZWxldGVkQnlSZWNpcGllbnQiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgcmVwbHlUb01lc3NhZ2VJRDogcmVjb3JkWyJyZXBseVRvTWVzc2FnZUlEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgYXR0YWNobWVudElEczogcmVjb3JkWyJhdHRhY2htZW50SURzIl0gYXM/IFtTdHJpbmddID8/IFtdCiAgICAgICAgKQogICAgfQp9CgovLyBNQVJLOiAtIEF0dGFjaG1lbnQgTW9kZWwKc3RydWN0IEF0dGFjaG1lbnQ6IElkZW50aWZpYWJsZSwgQ29kYWJsZSB7CiAgICBsZXQgaWQ6IFN0cmluZwogICAgbGV0IGZpbGVuYW1lOiBTdHJpbmcKICAgIGxldCBvcmlnaW5hbEZpbGVuYW1lOiBTdHJpbmcKICAgIGxldCBmaWxlU2l6ZTogSW50NjQKICAgIGxldCBtaW1lVHlwZTogU3RyaW5nCiAgICBsZXQgdXBsb2FkZWRCeVVzZXJJRDogU3RyaW5nCiAgICBsZXQgdXBsb2FkZWREYXRlOiBEYXRlCiAgICBsZXQgaXNJbWFnZTogQm9vbAogICAgbGV0IHRodW1ibmFpbFVSTDogU3RyaW5nPwogICAgbGV0IGRvd25sb2FkVVJMOiBTdHJpbmc/CiAgICAKICAgIGluaXQoaWQ6IFN0cmluZyA9IFVVSUQoKS51dWlkU3RyaW5nLCBmaWxlbmFtZTogU3RyaW5nLCBvcmlnaW5hbEZpbGVuYW1lOiBTdHJpbmcsIGZpbGVTaXplOiBJbnQ2NCwgbWltZVR5cGU6IFN0cmluZywgdXBsb2FkZWRCeVVzZXJJRDogU3RyaW5nLCB1cGxvYWRlZERhdGU6IERhdGUgPSBEYXRlKCksIGlzSW1hZ2U6IEJvb2wgPSBmYWxzZSwgdGh1bWJuYWlsVVJMOiBTdHJpbmc/ID0gbmlsLCBkb3dubG9hZFVSTDogU3RyaW5nPyA9IG5pbCkgewogICAgICAgIHNlbGYuaWQgPSBpZAogICAgICAgIHNlbGYuZmlsZW5hbWUgPSBmaWxlbmFtZQogICAgICAgIHNlbGYub3JpZ2luYWxGaWxlbmFtZSA9IG9yaWdpbmFsRmlsZW5hbWUKICAgICAgICBzZWxmLmZpbGVTaXplID0gZmlsZVNpemUKICAgICAgICBzZWxmLm1pbWVUeXBlID0gbWltZVR5cGUKICAgICAgICBzZWxmLnVwbG9hZGVkQnlVc2VySUQgPSB1cGxvYWRlZEJ5VXNlcklECiAgICAgICAgc2VsZi51cGxvYWRlZERhdGUgPSB1cGxvYWRlZERhdGUKICAgICAgICBzZWxmLmlzSW1hZ2UgPSBpc0ltYWdlCiAgICAgICAgc2VsZi50aHVtYm5haWxVUkwgPSB0aHVtYm5haWxVUkwKICAgICAgICBzZWxmLmRvd25sb2FkVVJMID0gZG93bmxvYWRVUkwKICAgIH0KICAgIAogICAgZnVuYyB0b0Nsb3VkS2l0UmVjb3JkKCkgLT4gQ0tSZWNvcmQgewogICAgICAgIGxldCByZWNvcmQgPSBDS1JlY29yZChyZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUuYXR0YWNobWVudC5yYXdWYWx1ZSwgcmVjb3JkSUQ6IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IGlkKSkKICAgICAgICByZWNvcmRbImZpbGVuYW1lIl0gPSBmaWxlbmFtZQogICAgICAgIHJlY29yZFsib3JpZ2luYWxGaWxlbmFtZSJdID0gb3JpZ2luYWxGaWxlbmFtZQogICAgICAgIHJlY29yZFsiZmlsZVNpemUiXSA9IGZpbGVTaXplCiAgICAgICAgcmVjb3JkWyJtaW1lVHlwZSJdID0gbWltZVR5cGUKICAgICAgICByZWNvcmRbInVwbG9hZGVkQnlVc2VySUQiXSA9IHVwbG9hZGVkQnlVc2VySUQKICAgICAgICByZWNvcmRbInVwbG9hZGVkRGF0ZSJdID0gdXBsb2FkZWREYXRlCiAgICAgICAgcmVjb3JkWyJpc0ltYWdlIl0gPSBpc0ltYWdlCiAgICAgICAgcmVjb3JkWyJ0aHVtYm5haWxVUkwiXSA9IHRodW1ibmFpbFVSTAogICAgICAgIHJlY29yZFsiZG93bmxvYWRVUkwiXSA9IGRvd25sb2FkVVJMCiAgICAgICAgcmV0dXJuIHJlY29yZAogICAgfQogICAgCiAgICBzdGF0aWMgZnVuYyBmcm9tQ2xvdWRLaXRSZWNvcmQoXyByZWNvcmQ6IENLUmVjb3JkKSAtPiBBdHRhY2htZW50PyB7CiAgICAgICAgZ3VhcmQgbGV0IGZpbGVuYW1lID0gcmVjb3JkWyJmaWxlbmFtZSJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IG9yaWdpbmFsRmlsZW5hbWUgPSByZWNvcmRbIm9yaWdpbmFsRmlsZW5hbWUiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICAgIGxldCBmaWxlU2l6ZSA9IHJlY29yZFsiZmlsZVNpemUiXSBhcz8gSW50NjQsCiAgICAgICAgICAgICAgbGV0IG1pbWVUeXBlID0gcmVjb3JkWyJtaW1lVHlwZSJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IHVwbG9hZGVkQnlVc2VySUQgPSByZWNvcmRbInVwbG9hZGVkQnlVc2VySUQiXSBhcz8gU3RyaW5nIGVsc2UgeyByZXR1cm4gbmlsIH0KICAgICAgICAKICAgICAgICByZXR1cm4gQXR0YWNobWVudCgKICAgICAgICAgICAgaWQ6IHJlY29yZC5yZWNvcmRJRC5yZWNvcmROYW1lLAogICAgICAgICAgICBmaWxlbmFtZTogZmlsZW5hbWUsCiAgICAgICAgICAgIG9yaWdpbmFsRmlsZW5hbWU6IG9yaWdpbmFsRmlsZW5hbWUsCiAgICAgICAgICAgIGZpbGVTaXplOiBmaWxlU2l6ZSwKICAgICAgICAgICAgbWltZVR5cGU6IG1pbWVUeXBlLAogICAgICAgICAgICB1cGxvYWRlZEJ5VXNlcklEOiB1cGxvYWRlZEJ5VXNlcklELAogICAgICAgICAgICB1cGxvYWRlZERhdGU6IHJlY29yZFsidXBsb2FkZWREYXRlIl0gYXM/IERhdGUgPz8gRGF0ZSgpLAogICAgICAgICAgICBpc0ltYWdlOiByZWNvcmRbImlzSW1hZ2UiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgdGh1bWJuYWlsVVJMOiByZWNvcmRbInRodW1ibmFpbFVSTCJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgIGRvd25sb2FkVVJMOiByZWNvcmRbImRvd25sb2FkVVJMIl0gYXM/IFN0cmluZwogICAgICAgICkKICAgIH0KfQoKLy8gTUFSSzogLSBVc2VyIEdyb3VwIE1vZGVsCnN0cnVjdCBVc2VyR3JvdXA6IElkZW50aWZpYWJsZSwgQ29kYWJsZSB7CiAgICBsZXQgaWQ6IFN0cmluZwogICAgbGV0IG5hbWU6IFN0cmluZwogICAgbGV0IGRlc2NyaXB0aW9uOiBTdHJpbmc/CiAgICBsZXQgY29sb3I6IFN0cmluZz8KICAgIGxldCBwZXJtaXNzaW9uczogW1N0cmluZ10KICAgIGxldCBpc0RlZmF1bHQ6IEJvb2wKICAgIGxldCBjcmVhdGVkRGF0ZTogRGF0ZQogICAgbGV0IGNyZWF0ZWRCeVVzZXJJRDogU3RyaW5nCiAgICAKICAgIGluaXQoaWQ6IFN0cmluZyA9IFVVSUQoKS51dWlkU3RyaW5nLCBuYW1lOiBTdHJpbmcsIGRlc2NyaXB0aW9uOiBTdHJpbmc/ID0gbmlsLCBjb2xvcjogU3RyaW5nPyA9IG5pbCwgcGVybWlzc2lvbnM6IFtTdHJpbmddID0gW10sIGlzRGVmYXVsdDogQm9vbCA9IGZhbHNlLCBjcmVhdGVkRGF0ZTogRGF0ZSA9IERhdGUoKSwgY3JlYXRlZEJ5VXNlcklEOiBTdHJpbmcpIHsKICAgICAgICBzZWxmLmlkID0gaWQKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCiAgICAgICAgc2VsZi5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uCiAgICAgICAgc2VsZi5jb2xvciA9IGNvbG9yCiAgICAgICAgc2VsZi5wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zCiAgICAgICAgc2VsZi5pc0RlZmF1bHQgPSBpc0RlZmF1bHQKICAgICAgICBzZWxmLmNyZWF0ZWREYXRlID0gY3JlYXRlZERhdGUKICAgICAgICBzZWxmLmNyZWF0ZWRCeVVzZXJJRCA9IGNyZWF0ZWRCeVVzZXJJRAogICAgfQogICAgCiAgICBmdW5jIHRvQ2xvdWRLaXRSZWNvcmQoKSAtPiBDS1JlY29yZCB7CiAgICAgICAgbGV0IHJlY29yZCA9IENLUmVjb3JkKHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZS51c2VyR3JvdXAucmF3VmFsdWUsIHJlY29yZElEOiBDS1JlY29yZC5JRChyZWNvcmROYW1lOiBpZCkpCiAgICAgICAgcmVjb3JkWyJuYW1lIl0gPSBuYW1lCiAgICAgICAgcmVjb3JkWyJkZXNjcmlwdGlvbiJdID0gZGVzY3JpcHRpb24KICAgICAgICByZWNvcmRbImNvbG9yIl0gPSBjb2xvcgogICAgICAgIHJlY29yZFsicGVybWlzc2lvbnMiXSA9IHBlcm1pc3Npb25zCiAgICAgICAgcmVjb3JkWyJpc0RlZmF1bHQiXSA9IGlzRGVmYXVsdAogICAgICAgIHJlY29yZFsiY3JlYXRlZERhdGUiXSA9IGNyZWF0ZWREYXRlCiAgICAgICAgcmVjb3JkWyJjcmVhdGVkQnlVc2VySUQiXSA9IGNyZWF0ZWRCeVVzZXJJRAogICAgICAgIHJldHVybiByZWNvcmQKICAgIH0KICAgIAogICAgc3RhdGljIGZ1bmMgZnJvbUNsb3VkS2l0UmVjb3JkKF8gcmVjb3JkOiBDS1JlY29yZCkgLT4gVXNlckdyb3VwPyB7CiAgICAgICAgZ3VhcmQgbGV0IG5hbWUgPSByZWNvcmRbIm5hbWUiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICAgIGxldCBjcmVhdGVkQnlVc2VySUQgPSByZWNvcmRbImNyZWF0ZWRCeVVzZXJJRCJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIHJldHVybiBVc2VyR3JvdXAoCiAgICAgICAgICAgIGlkOiByZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSwKICAgICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgICAgZGVzY3JpcHRpb246IHJlY29yZFsiZGVzY3JpcHRpb24iXSBhcz8gU3RyaW5nLAogICAgICAgICAgICBjb2xvcjogcmVjb3JkWyJjb2xvciJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgIHBlcm1pc3Npb25zOiByZWNvcmRbInBlcm1pc3Npb25zIl0gYXM/IFtTdHJpbmddID8/IFtdLAogICAgICAgICAgICBpc0RlZmF1bHQ6IHJlY29yZFsiaXNEZWZhdWx0Il0gYXM/IEJvb2wgPz8gZmFsc2UsCiAgICAgICAgICAgIGNyZWF0ZWREYXRlOiByZWNvcmRbImNyZWF0ZWREYXRlIl0gYXM/IERhdGUgPz8gRGF0ZSgpLAogICAgICAgICAgICBjcmVhdGVkQnlVc2VySUQ6IGNyZWF0ZWRCeVVzZXJJRAogICAgICAgICkKICAgIH0KfQoKLy8gTUFSSzogLSBNb2RlcmF0aW9uIEFjdGlvbiBNb2RlbApzdHJ1Y3QgTW9kZXJhdGlvbkFjdGlvbjogSWRlbnRpZmlhYmxlLCBDb2RhYmxlIHsKICAgIGxldCBpZDogU3RyaW5nCiAgICBsZXQgYWN0aW9uVHlwZTogTW9kZXJhdGlvbkFjdGlvblR5cGUKICAgIGxldCB0YXJnZXRUeXBlOiBTdHJpbmcgLy8gInVzZXIiLCAicG9zdCIsICJ0aHJlYWQiLCAiZm9ydW0iCiAgICBsZXQgdGFyZ2V0SUQ6IFN0cmluZwogICAgbGV0IG1vZGVyYXRvcklEOiBTdHJpbmcKICAgIGxldCByZWFzb246IFN0cmluZz8KICAgIGxldCBkZXRhaWxzOiBTdHJpbmc/CiAgICBsZXQgYWN0aW9uRGF0ZTogRGF0ZQogICAgbGV0IGV4cGlyeURhdGU6IERhdGU/CiAgICBsZXQgaXNBY3RpdmU6IEJvb2wKICAgIAogICAgaW5pdChpZDogU3RyaW5nID0gVVVJRCgpLnV1aWRTdHJpbmcsIGFjdGlvblR5cGU6IE1vZGVyYXRpb25BY3Rpb25UeXBlLCB0YXJnZXRUeXBlOiBTdHJpbmcsIHRhcmdldElEOiBTdHJpbmcsIG1vZGVyYXRvcklEOiBTdHJpbmcsIHJlYXNvbjogU3RyaW5nPyA9IG5pbCwgZGV0YWlsczogU3RyaW5nPyA9IG5pbCwgYWN0aW9uRGF0ZTogRGF0ZSA9IERhdGUoKSwgZXhwaXJ5RGF0ZTogRGF0ZT8gPSBuaWwsIGlzQWN0aXZlOiBCb29sID0gdHJ1ZSkgewogICAgICAgIHNlbGYuaWQgPSBpZAogICAgICAgIHNlbGYuYWN0aW9uVHlwZSA9IGFjdGlvblR5cGUKICAgICAgICBzZWxmLnRhcmdldFR5cGUgPSB0YXJnZXRUeXBlCiAgICAgICAgc2VsZi50YXJnZXRJRCA9IHRhcmdldElECiAgICAgICAgc2VsZi5tb2RlcmF0b3JJRCA9IG1vZGVyYXRvcklECiAgICAgICAgc2VsZi5yZWFzb24gPSByZWFzb24KICAgICAgICBzZWxmLmRldGFpbHMgPSBkZXRhaWxzCiAgICAgICAgc2VsZi5hY3Rpb25EYXRlID0gYWN0aW9uRGF0ZQogICAgICAgIHNlbGYuZXhwaXJ5RGF0ZSA9IGV4cGlyeURhdGUKICAgICAgICBzZWxmLmlzQWN0aXZlID0gaXNBY3RpdmUKICAgIH0KICAgIAogICAgZnVuYyB0b0Nsb3VkS2l0UmVjb3JkKCkgLT4gQ0tSZWNvcmQgewogICAgICAgIGxldCByZWNvcmQgPSBDS1JlY29yZChyZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUubW9kZXJhdGlvbkFjdGlvbi5yYXdWYWx1ZSwgcmVjb3JkSUQ6IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IGlkKSkKICAgICAgICByZWNvcmRbImFjdGlvblR5cGUiXSA9IGFjdGlvblR5cGUucmF3VmFsdWUKICAgICAgICByZWNvcmRbInRhcmdldFR5cGUiXSA9IHRhcmdldFR5cGUKICAgICAgICByZWNvcmRbInRhcmdldElEIl0gPSB0YXJnZXRJRAogICAgICAgIHJlY29yZFsibW9kZXJhdG9ySUQiXSA9IG1vZGVyYXRvcklECiAgICAgICAgcmVjb3JkWyJyZWFzb24iXSA9IHJlYXNvbgogICAgICAgIHJlY29yZFsiZGV0YWlscyJdID0gZGV0YWlscwogICAgICAgIHJlY29yZFsiYWN0aW9uRGF0ZSJdID0gYWN0aW9uRGF0ZQogICAgICAgIHJlY29yZFsiZXhwaXJ5RGF0ZSJdID0gZXhwaXJ5RGF0ZQogICAgICAgIHJlY29yZFsiaXNBY3RpdmUiXSA9IGlzQWN0aXZlCiAgICAgICAgcmV0dXJuIHJlY29yZAogICAgfQogICAgCiAgICBzdGF0aWMgZnVuYyBmcm9tQ2xvdWRLaXRSZWNvcmQoXyByZWNvcmQ6IENLUmVjb3JkKSAtPiBNb2RlcmF0aW9uQWN0aW9uPyB7CiAgICAgICAgZ3VhcmQgbGV0IGFjdGlvblR5cGVTdHJpbmcgPSByZWNvcmRbImFjdGlvblR5cGUiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICAgIGxldCBhY3Rpb25UeXBlID0gTW9kZXJhdGlvbkFjdGlvblR5cGUocmF3VmFsdWU6IGFjdGlvblR5cGVTdHJpbmcpLAogICAgICAgICAgICAgIGxldCB0YXJnZXRUeXBlID0gcmVjb3JkWyJ0YXJnZXRUeXBlIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgdGFyZ2V0SUQgPSByZWNvcmRbInRhcmdldElEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgbW9kZXJhdG9ySUQgPSByZWNvcmRbIm1vZGVyYXRvcklEIl0gYXM/IFN0cmluZyBlbHNlIHsgcmV0dXJuIG5pbCB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIE1vZGVyYXRpb25BY3Rpb24oCiAgICAgICAgICAgIGlkOiByZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSwKICAgICAgICAgICAgYWN0aW9uVHlwZTogYWN0aW9uVHlwZSwKICAgICAgICAgICAgdGFyZ2V0VHlwZTogdGFyZ2V0VHlwZSwKICAgICAgICAgICAgdGFyZ2V0SUQ6IHRhcmdldElELAogICAgICAgICAgICBtb2RlcmF0b3JJRDogbW9kZXJhdG9ySUQsCiAgICAgICAgICAgIHJlYXNvbjogcmVjb3JkWyJyZWFzb24iXSBhcz8gU3RyaW5nLAogICAgICAgICAgICBkZXRhaWxzOiByZWNvcmRbImRldGFpbHMiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICBhY3Rpb25EYXRlOiByZWNvcmRbImFjdGlvbkRhdGUiXSBhcz8gRGF0ZSA/PyBEYXRlKCksCiAgICAgICAgICAgIGV4cGlyeURhdGU6IHJlY29yZFsiZXhwaXJ5RGF0ZSJdIGFzPyBEYXRlLAogICAgICAgICAgICBpc0FjdGl2ZTogcmVjb3JkWyJpc0FjdGl2ZSJdIGFzPyBCb29sID8/IHRydWUKICAgICAgICApCiAgICB9Cn0KCmVudW0gTW9kZXJhdGlvbkFjdGlvblR5cGU6IFN0cmluZywgQ2FzZUl0ZXJhYmxlLCBDb2RhYmxlIHsKICAgIGNhc2UgYmFuID0gImJhbiIKICAgIGNhc2Ugc3VzcGVuZCA9ICJzdXNwZW5kIgogICAgY2FzZSB3YXJuID0gIndhcm4iCiAgICBjYXNlIGRlbGV0ZVBvc3QgPSAiZGVsZXRlX3Bvc3QiCiAgICBjYXNlIGRlbGV0ZVRocmVhZCA9ICJkZWxldGVfdGhyZWFkIgogICAgY2FzZSBsb2NrVGhyZWFkID0gImxvY2tfdGhyZWFkIgogICAgY2FzZSB1bmxvY2tUaHJlYWQgPSAidW5sb2NrX3RocmVhZCIKICAgIGNhc2Ugc3RpY2t5VGhyZWFkID0gInN0aWNreV90aHJlYWQiCiAgICBjYXNlIHVuc3RpY2t5VGhyZWFkID0gInVuc3RpY2t5X3RocmVhZCIKICAgIGNhc2UgaGlkZVBvc3QgPSAiaGlkZV9wb3N0IgogICAgY2FzZSB1bmhpZGVQb3N0ID0gInVuaGlkZV9wb3N0IgogICAgY2FzZSBoaWRlVGhyZWFkID0gImhpZGVfdGhyZWFkIgogICAgY2FzZSB1bmhpZGVUaHJlYWQgPSAidW5oaWRlX3RocmVhZCIKICAgIGNhc2UgbWVyZ2VUaHJlYWRzID0gIm1lcmdlX3RocmVhZHMiCiAgICBjYXNlIHNwbGl0VGhyZWFkID0gInNwbGl0X3RocmVhZCIKICAgIGNhc2UgbW92ZVRocmVhZCA9ICJtb3ZlX3RocmVhZCIKfQoKLy8gTUFSSzogLSBSZXBvcnQgTW9kZWwKc3RydWN0IFJlcG9ydDogSWRlbnRpZmlhYmxlLCBDb2RhYmxlIHsKICAgIGxldCBpZDogU3RyaW5nCiAgICBsZXQgcmVwb3J0VHlwZTogU3RyaW5nIC8vICJwb3N0IiwgInRocmVhZCIsICJ1c2VyIiwgIm1lc3NhZ2UiCiAgICBsZXQgdGFyZ2V0SUQ6IFN0cmluZwogICAgbGV0IHJlcG9ydGVySUQ6IFN0cmluZwogICAgbGV0IHJlYXNvbjogU3RyaW5nCiAgICBsZXQgZGV0YWlsczogU3RyaW5nPwogICAgbGV0IHJlcG9ydERhdGU6IERhdGUKICAgIGxldCBpc1Jlc29sdmVkOiBCb29sCiAgICBsZXQgcmVzb2x2ZWRCeVVzZXJJRDogU3RyaW5nPwogICAgbGV0IHJlc29sdmVkRGF0ZTogRGF0ZT8KICAgIGxldCByZXNvbHV0aW9uOiBTdHJpbmc/CiAgICAKICAgIGluaXQoaWQ6IFN0cmluZyA9IFVVSUQoKS51dWlkU3RyaW5nLCByZXBvcnRUeXBlOiBTdHJpbmcsIHRhcmdldElEOiBTdHJpbmcsIHJlcG9ydGVySUQ6IFN0cmluZywgcmVhc29uOiBTdHJpbmcsIGRldGFpbHM6IFN0cmluZz8gPSBuaWwsIHJlcG9ydERhdGU6IERhdGUgPSBEYXRlKCksIGlzUmVzb2x2ZWQ6IEJvb2wgPSBmYWxzZSwgcmVzb2x2ZWRCeVVzZXJJRDogU3RyaW5nPyA9IG5pbCwgcmVzb2x2ZWREYXRlOiBEYXRlPyA9IG5pbCwgcmVzb2x1dGlvbjogU3RyaW5nPyA9IG5pbCkgewogICAgICAgIHNlbGYuaWQgPSBpZAogICAgICAgIHNlbGYucmVwb3J0VHlwZSA9IHJlcG9ydFR5cGUKICAgICAgICBzZWxmLnRhcmdldElEID0gdGFyZ2V0SUQKICAgICAgICBzZWxmLnJlcG9ydGVySUQgPSByZXBvcnRlcklECiAgICAgICAgc2VsZi5yZWFzb24gPSByZWFzb24KICAgICAgICBzZWxmLmRldGFpbHMgPSBkZXRhaWxzCiAgICAgICAgc2VsZi5yZXBvcnREYXRlID0gcmVwb3J0RGF0ZQogICAgICAgIHNlbGYuaXNSZXNvbHZlZCA9IGlzUmVzb2x2ZWQKICAgICAgICBzZWxmLnJlc29sdmVkQnlVc2VySUQgPSByZXNvbHZlZEJ5VXNlcklECiAgICAgICAgc2VsZi5yZXNvbHZlZERhdGUgPSByZXNvbHZlZERhdGUKICAgICAgICBzZWxmLnJlc29sdXRpb24gPSByZXNvbHV0aW9uCiAgICB9CiAgICAKICAgIGZ1bmMgdG9DbG91ZEtpdFJlY29yZCgpIC0+IENLUmVjb3JkIHsKICAgICAgICBsZXQgcmVjb3JkID0gQ0tSZWNvcmQocmVjb3JkVHlwZTogQ2xvdWRLaXRSZWNvcmRUeXBlLnJlcG9ydC5yYXdWYWx1ZSwgcmVjb3JkSUQ6IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IGlkKSkKICAgICAgICByZWNvcmRbInJlcG9ydFR5cGUiXSA9IHJlcG9ydFR5cGUKICAgICAgICByZWNvcmRbInRhcmdldElEIl0gPSB0YXJnZXRJRAogICAgICAgIHJlY29yZFsicmVwb3J0ZXJJRCJdID0gcmVwb3J0ZXJJRAogICAgICAgIHJlY29yZFsicmVhc29uIl0gPSByZWFzb24KICAgICAgICByZWNvcmRbImRldGFpbHMiXSA9IGRldGFpbHMKICAgICAgICByZWNvcmRbInJlcG9ydERhdGUiXSA9IHJlcG9ydERhdGUKICAgICAgICByZWNvcmRbImlzUmVzb2x2ZWQiXSA9IGlzUmVzb2x2ZWQKICAgICAgICByZWNvcmRbInJlc29sdmVkQnlVc2VySUQiXSA9IHJlc29sdmVkQnlVc2VySUQKICAgICAgICByZWNvcmRbInJlc29sdmVkRGF0ZSJdID0gcmVzb2x2ZWREYXRlCiAgICAgICAgcmVjb3JkWyJyZXNvbHV0aW9uIl0gPSByZXNvbHV0aW9uCiAgICAgICAgcmV0dXJuIHJlY29yZAogICAgfQogICAgCiAgICBzdGF0aWMgZnVuYyBmcm9tQ2xvdWRLaXRSZWNvcmQoXyByZWNvcmQ6IENLUmVjb3JkKSAtPiBSZXBvcnQ/IHsKICAgICAgICBndWFyZCBsZXQgcmVwb3J0VHlwZSA9IHJlY29yZFsicmVwb3J0VHlwZSJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IHRhcmdldElEID0gcmVjb3JkWyJ0YXJnZXRJRCJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IHJlcG9ydGVySUQgPSByZWNvcmRbInJlcG9ydGVySUQiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICAgIGxldCByZWFzb24gPSByZWNvcmRbInJlYXNvbiJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIHJldHVybiBSZXBvcnQoCiAgICAgICAgICAgIGlkOiByZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSwKICAgICAgICAgICAgcmVwb3J0VHlwZTogcmVwb3J0VHlwZSwKICAgICAgICAgICAgdGFyZ2V0SUQ6IHRhcmdldElELAogICAgICAgICAgICByZXBvcnRlcklEOiByZXBvcnRlcklELAogICAgICAgICAgICByZWFzb246IHJlYXNvbiwKICAgICAgICAgICAgZGV0YWlsczogcmVjb3JkWyJkZXRhaWxzIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgcmVwb3J0RGF0ZTogcmVjb3JkWyJyZXBvcnREYXRlIl0gYXM/IERhdGUgPz8gRGF0ZSgpLAogICAgICAgICAgICBpc1Jlc29sdmVkOiByZWNvcmRbImlzUmVzb2x2ZWQiXSBhcz8gQm9vbCA/PyBmYWxzZSwKICAgICAgICAgICAgcmVzb2x2ZWRCeVVzZXJJRDogcmVjb3JkWyJyZXNvbHZlZEJ5VXNlcklEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgcmVzb2x2ZWREYXRlOiByZWNvcmRbInJlc29sdmVkRGF0ZSJdIGFzPyBEYXRlLAogICAgICAgICAgICByZXNvbHV0aW9uOiByZWNvcmRbInJlc29sdXRpb24iXSBhcz8gU3RyaW5nCiAgICAgICAgKQogICAgfQp9CgovLyBNQVJLOiAtIERyYWZ0IE1vZGVsCnN0cnVjdCBQb3N0RHJhZnQ6IElkZW50aWZpYWJsZSwgQ29kYWJsZSB7CiAgICBsZXQgaWQ6IFN0cmluZwogICAgbGV0IHVzZXJJRDogU3RyaW5nCiAgICBsZXQgdGhyZWFkSUQ6IFN0cmluZz8KICAgIGxldCBzdWJqZWN0OiBTdHJpbmc/CiAgICBsZXQgY29udGVudDogU3RyaW5nCiAgICBsZXQgY3JlYXRlZERhdGU6IERhdGUKICAgIGxldCBsYXN0TW9kaWZpZWREYXRlOiBEYXRlCiAgICBsZXQgYXR0YWNobWVudElEczogW1N0cmluZ10KICAgIAogICAgaW5pdChpZDogU3RyaW5nID0gVVVJRCgpLnV1aWRTdHJpbmcsIHVzZXJJRDogU3RyaW5nLCB0aHJlYWRJRDogU3RyaW5nPyA9IG5pbCwgc3ViamVjdDogU3RyaW5nPyA9IG5pbCwgY29udGVudDogU3RyaW5nLCBjcmVhdGVkRGF0ZTogRGF0ZSA9IERhdGUoKSwgbGFzdE1vZGlmaWVkRGF0ZTogRGF0ZSA9IERhdGUoKSwgYXR0YWNobWVudElEczogW1N0cmluZ10gPSBbXSkgewogICAgICAgIHNlbGYuaWQgPSBpZAogICAgICAgIHNlbGYudXNlcklEID0gdXNlcklECiAgICAgICAgc2VsZi50aHJlYWRJRCA9IHRocmVhZElECiAgICAgICAgc2VsZi5zdWJqZWN0ID0gc3ViamVjdAogICAgICAgIHNlbGYuY29udGVudCA9IGNvbnRlbnQKICAgICAgICBzZWxmLmNyZWF0ZWREYXRlID0gY3JlYXRlZERhdGUKICAgICAgICBzZWxmLmxhc3RNb2RpZmllZERhdGUgPSBsYXN0TW9kaWZpZWREYXRlCiAgICAgICAgc2VsZi5hdHRhY2htZW50SURzID0gYXR0YWNobWVudElEcwogICAgfQogICAgCiAgICBmdW5jIHRvQ2xvdWRLaXRSZWNvcmQoKSAtPiBDS1JlY29yZCB7CiAgICAgICAgbGV0IHJlY29yZCA9IENLUmVjb3JkKHJlY29yZFR5cGU6IENsb3VkS2l0UmVjb3JkVHlwZS5kcmFmdC5yYXdWYWx1ZSwgcmVjb3JkSUQ6IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IGlkKSkKICAgICAgICByZWNvcmRbInVzZXJJRCJdID0gdXNlcklECiAgICAgICAgcmVjb3JkWyJ0aHJlYWRJRCJdID0gdGhyZWFkSUQKICAgICAgICByZWNvcmRbInN1YmplY3QiXSA9IHN1YmplY3QKICAgICAgICByZWNvcmRbImNvbnRlbnQiXSA9IGNvbnRlbnQKICAgICAgICByZWNvcmRbImNyZWF0ZWREYXRlIl0gPSBjcmVhdGVkRGF0ZQogICAgICAgIHJlY29yZFsibGFzdE1vZGlmaWVkRGF0ZSJdID0gbGFzdE1vZGlmaWVkRGF0ZQogICAgICAgIHJlY29yZFsiYXR0YWNobWVudElEcyJdID0gYXR0YWNobWVudElEcwogICAgICAgIHJldHVybiByZWNvcmQKICAgIH0KICAgIAogICAgc3RhdGljIGZ1bmMgZnJvbUNsb3VkS2l0UmVjb3JkKF8gcmVjb3JkOiBDS1JlY29yZCkgLT4gUG9zdERyYWZ0PyB7CiAgICAgICAgZ3VhcmQgbGV0IHVzZXJJRCA9IHJlY29yZFsidXNlcklEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgY29udGVudCA9IHJlY29yZFsiY29udGVudCJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIHJldHVybiBQb3N0RHJhZnQoCiAgICAgICAgICAgIGlkOiByZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSwKICAgICAgICAgICAgdXNlcklEOiB1c2VySUQsCiAgICAgICAgICAgIHRocmVhZElEOiByZWNvcmRbInRocmVhZElEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgc3ViamVjdDogcmVjb3JkWyJzdWJqZWN0Il0gYXM/IFN0cmluZywKICAgICAgICAgICAgY29udGVudDogY29udGVudCwKICAgICAgICAgICAgY3JlYXRlZERhdGU6IHJlY29yZFsiY3JlYXRlZERhdGUiXSBhcz8gRGF0ZSA/PyBEYXRlKCksCiAgICAgICAgICAgIGxhc3RNb2RpZmllZERhdGU6IHJlY29yZFsibGFzdE1vZGlmaWVkRGF0ZSJdIGFzPyBEYXRlID8/IERhdGUoKSwKICAgICAgICAgICAgYXR0YWNobWVudElEczogcmVjb3JkWyJhdHRhY2htZW50SURzIl0gYXM/IFtTdHJpbmddID8/IFtdCiAgICAgICAgKQogICAgfQp9CgovLyBNQVJLOiAtIExpa2UgTW9kZWwKc3RydWN0IFBvc3RMaWtlOiBJZGVudGlmaWFibGUsIENvZGFibGUgewogICAgbGV0IGlkOiBTdHJpbmcKICAgIGxldCBwb3N0SUQ6IFN0cmluZwogICAgbGV0IHVzZXJJRDogU3RyaW5nCiAgICBsZXQgY3JlYXRlZERhdGU6IERhdGUKICAgIGxldCBpc0xpa2U6IEJvb2wgLy8gdHJ1ZSBmb3IgbGlrZSwgZmFsc2UgZm9yIGRpc2xpa2UKICAgIAogICAgaW5pdChpZDogU3RyaW5nID0gVVVJRCgpLnV1aWRTdHJpbmcsIHBvc3RJRDogU3RyaW5nLCB1c2VySUQ6IFN0cmluZywgY3JlYXRlZERhdGU6IERhdGUgPSBEYXRlKCksIGlzTGlrZTogQm9vbCA9IHRydWUpIHsKICAgICAgICBzZWxmLmlkID0gaWQKICAgICAgICBzZWxmLnBvc3RJRCA9IHBvc3RJRAogICAgICAgIHNlbGYudXNlcklEID0gdXNlcklECiAgICAgICAgc2VsZi5jcmVhdGVkRGF0ZSA9IGNyZWF0ZWREYXRlCiAgICAgICAgc2VsZi5pc0xpa2UgPSBpc0xpa2UKICAgIH0KICAgIAogICAgZnVuYyB0b0Nsb3VkS2l0UmVjb3JkKCkgLT4gQ0tSZWNvcmQgewogICAgICAgIGxldCByZWNvcmQgPSBDS1JlY29yZChyZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUubGlrZS5yYXdWYWx1ZSwgcmVjb3JkSUQ6IENLUmVjb3JkLklEKHJlY29yZE5hbWU6IGlkKSkKICAgICAgICByZWNvcmRbInBvc3RJRCJdID0gcG9zdElECiAgICAgICAgcmVjb3JkWyJ1c2VySUQiXSA9IHVzZXJJRAogICAgICAgIHJlY29yZFsiY3JlYXRlZERhdGUiXSA9IGNyZWF0ZWREYXRlCiAgICAgICAgcmVjb3JkWyJpc0xpa2UiXSA9IGlzTGlrZQogICAgICAgIHJldHVybiByZWNvcmQKICAgIH0KICAgIAogICAgc3RhdGljIGZ1bmMgZnJvbUNsb3VkS2l0UmVjb3JkKF8gcmVjb3JkOiBDS1JlY29yZCkgLT4gUG9zdExpa2U/IHsKICAgICAgICBndWFyZCBsZXQgcG9zdElEID0gcmVjb3JkWyJwb3N0SUQiXSBhcz8gU3RyaW5nLAogICAgICAgICAgICAgIGxldCB1c2VySUQgPSByZWNvcmRbInVzZXJJRCJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIHJldHVybiBQb3N0TGlrZSgKICAgICAgICAgICAgaWQ6IHJlY29yZC5yZWNvcmRJRC5yZWNvcmROYW1lLAogICAgICAgICAgICBwb3N0SUQ6IHBvc3RJRCwKICAgICAgICAgICAgdXNlcklEOiB1c2VySUQsCiAgICAgICAgICAgIGNyZWF0ZWREYXRlOiByZWNvcmRbImNyZWF0ZWREYXRlIl0gYXM/IERhdGUgPz8gRGF0ZSgpLAogICAgICAgICAgICBpc0xpa2U6IHJlY29yZFsiaXNMaWtlIl0gYXM/IEJvb2wgPz8gdHJ1ZQogICAgICAgICkKICAgIH0KfQoKLy8gTUFSSzogLSBRdW90ZSBNb2RlbApzdHJ1Y3QgUG9zdFF1b3RlOiBJZGVudGlmaWFibGUsIENvZGFibGUgewogICAgbGV0IGlkOiBTdHJpbmcKICAgIGxldCBvcmlnaW5hbFBvc3RJRDogU3RyaW5nCiAgICBsZXQgcXVvdGVkUG9zdElEOiBTdHJpbmcKICAgIGxldCBxdW90ZWRCeVVzZXJJRDogU3RyaW5nCiAgICBsZXQgY3JlYXRlZERhdGU6IERhdGUKICAgIGxldCBjb250ZW50OiBTdHJpbmcgLy8gVGhlIGFjdHVhbCBxdW90ZWQgY29udGVudAogICAgCiAgICBpbml0KGlkOiBTdHJpbmcgPSBVVUlEKCkudXVpZFN0cmluZywgb3JpZ2luYWxQb3N0SUQ6IFN0cmluZywgcXVvdGVkUG9zdElEOiBTdHJpbmcsIHF1b3RlZEJ5VXNlcklEOiBTdHJpbmcsIGNyZWF0ZWREYXRlOiBEYXRlID0gRGF0ZSgpLCBjb250ZW50OiBTdHJpbmcpIHsKICAgICAgICBzZWxmLmlkID0gaWQKICAgICAgICBzZWxmLm9yaWdpbmFsUG9zdElEID0gb3JpZ2luYWxQb3N0SUQKICAgICAgICBzZWxmLnF1b3RlZFBvc3RJRCA9IHF1b3RlZFBvc3RJRAogICAgICAgIHNlbGYucXVvdGVkQnlVc2VySUQgPSBxdW90ZWRCeVVzZXJJRAogICAgICAgIHNlbGYuY3JlYXRlZERhdGUgPSBjcmVhdGVkRGF0ZQogICAgICAgIHNlbGYuY29udGVudCA9IGNvbnRlbnQKICAgIH0KICAgIAogICAgZnVuYyB0b0Nsb3VkS2l0UmVjb3JkKCkgLT4gQ0tSZWNvcmQgewogICAgICAgIGxldCByZWNvcmQgPSBDS1JlY29yZChyZWNvcmRUeXBlOiBDbG91ZEtpdFJlY29yZFR5cGUucXVvdGUucmF3VmFsdWUsIHJlY29yZElEOiBDS1JlY29yZC5JRChyZWNvcmROYW1lOiBpZCkpCiAgICAgICAgcmVjb3JkWyJvcmlnaW5hbFBvc3RJRCJdID0gb3JpZ2luYWxQb3N0SUQKICAgICAgICByZWNvcmRbInF1b3RlZFBvc3RJRCJdID0gcXVvdGVkUG9zdElECiAgICAgICAgcmVjb3JkWyJxdW90ZWRCeVVzZXJJRCJdID0gcXVvdGVkQnlVc2VySUQKICAgICAgICByZWNvcmRbImNyZWF0ZWREYXRlIl0gPSBjcmVhdGVkRGF0ZQogICAgICAgIHJlY29yZFsiY29udGVudCJdID0gY29udGVudAogICAgICAgIHJldHVybiByZWNvcmQKICAgIH0KICAgIAogICAgc3RhdGljIGZ1bmMgZnJvbUNsb3VkS2l0UmVjb3JkKF8gcmVjb3JkOiBDS1JlY29yZCkgLT4gUG9zdFF1b3RlPyB7CiAgICAgICAgZ3VhcmQgbGV0IG9yaWdpbmFsUG9zdElEID0gcmVjb3JkWyJvcmlnaW5hbFBvc3RJRCJdIGFzPyBTdHJpbmcsCiAgICAgICAgICAgICAgbGV0IHF1b3RlZFBvc3RJRCA9IHJlY29yZFsicXVvdGVkUG9zdElEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgcXVvdGVkQnlVc2VySUQgPSByZWNvcmRbInF1b3RlZEJ5VXNlcklEIl0gYXM/IFN0cmluZywKICAgICAgICAgICAgICBsZXQgY29udGVudCA9IHJlY29yZFsiY29udGVudCJdIGFzPyBTdHJpbmcgZWxzZSB7IHJldHVybiBuaWwgfQogICAgICAgIAogICAgICAgIHJldHVybiBQb3N0UXVvdGUoCiAgICAgICAgICAgIGlkOiByZWNvcmQucmVjb3JkSUQucmVjb3JkTmFtZSwKICAgICAgICAgICAgb3JpZ2luYWxQb3N0SUQ6IG9yaWdpbmFsUG9zdElELAogICAgICAgICAgICBxdW90ZWRQb3N0SUQ6IHF1b3RlZFBvc3RJRCwKICAgICAgICAgICAgcXVvdGVkQnlVc2VySUQ6IHF1b3RlZEJ5VXNlcklELAogICAgICAgICAgICBjcmVhdGVkRGF0ZTogcmVjb3JkWyJjcmVhdGVkRGF0ZSJdIGFzPyBEYXRlID8/IERhdGUoKSwKICAgICAgICAgICAgY29udGVudDogY29udGVudAogICAgICAgICkKICAgIH0KfQo=
--- END ---

--- FILE: MacChan/Views/UserSettingsStore.swift ---
BASE64: aW1wb3J0IEZvdW5kYXRpb24KaW1wb3J0IFN3aWZ0VUkKCnN0cnVjdCBVc2VyU2V0dGluZ3MgewogICAgdmFyIGFjY2VudENvbG9yOiBTdHJpbmcgPSAiYmx1ZSIKICAgIHZhciBkZWZhdWx0SG9tZVNlY3Rpb246IFN0cmluZyA9ICJGb3J1bXMiCiAgICB2YXIgc2hvd05TRlc6IEJvb2wgPSBmYWxzZQp9CgpjbGFzcyBVc2VyU2V0dGluZ3NTdG9yZTogT2JzZXJ2YWJsZU9iamVjdCB7CiAgICBzdGF0aWMgbGV0IHNoYXJlZCA9IFVzZXJTZXR0aW5nc1N0b3JlKCkKCiAgICBAUHVibGlzaGVkIHZhciBhY2NlbnRDb2xvcjogU3RyaW5nID0gImJsdWUiCiAgICBAUHVibGlzaGVkIHZhciBkZWZhdWx0SG9tZVNlY3Rpb246IFN0cmluZyA9ICJGb3J1bXMiCiAgICBAUHVibGlzaGVkIHZhciBzaG93TlNGVzogQm9vbCA9IGZhbHNlCgogICAgcHJpdmF0ZSBpbml0KCkgewogICAgICAgIGxvYWQoKQogICAgfQoKICAgIGZ1bmMgbG9hZCgpIHsKICAgICAgICAvLyBTdHViOiBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIGxvYWQgZnJvbSBDb3JlRGF0YSBoZXJlLgogICAgICAgIC8vIEV4YW1wbGU6IExvYWQgZnJvbSBVc2VyRGVmYXVsdHMgb3IganVzdCB1c2UgZGVmYXVsdHMgZm9yIG5vdy4KICAgICAgICBsZXQgc2F2ZWQgPSBVc2VyRGVmYXVsdHMuc3RhbmRhcmQKICAgICAgICBhY2NlbnRDb2xvciA9IHNhdmVkLnN0cmluZyhmb3JLZXk6ICJhY2NlbnRDb2xvciIpID8/ICJibHVlIgogICAgICAgIGRlZmF1bHRIb21lU2VjdGlvbiA9IHNhdmVkLnN0cmluZyhmb3JLZXk6ICJkZWZhdWx0SG9tZVNlY3Rpb24iKSA/PyAiRm9ydW1zIgogICAgICAgIHNob3dOU0ZXID0gc2F2ZWQuYm9vbChmb3JLZXk6ICJzaG93TlNGVyIpCiAgICB9CgogICAgZnVuYyBzYXZlKCkgewogICAgICAgIC8vIFN0dWI6IEluIGEgcmVhbCBpbXBsZW1lbnRhdGlvbiwgc2F2ZSB0byBDb3JlRGF0YSBoZXJlLgogICAgICAgIGxldCBzYXZlZCA9IFVzZXJEZWZhdWx0cy5zdGFuZGFyZAogICAgICAgIHNhdmVkLnNldChhY2NlbnRDb2xvciwgZm9yS2V5OiAiYWNjZW50Q29sb3IiKQogICAgICAgIHNhdmVkLnNldChkZWZhdWx0SG9tZVNlY3Rpb24sIGZvcktleTogImRlZmF1bHRIb21lU2VjdGlvbiIpCiAgICAgICAgc2F2ZWQuc2V0KHNob3dOU0ZXLCBmb3JLZXk6ICJzaG93TlNGVyIpCiAgICB9Cn0K
--- END ---

--- FILE: MacChan/Views/AdminPanelView.swift ---
BASE64: Ly8gQWRtaW5QYW5lbFZpZXcuc3dpZnQKLy8gTWFjQ2hhbiBBZG1pbiBQYW5lbAoKaW1wb3J0IFN3aWZ0VUkKCgpzdHJ1Y3QgQWRtaW5QYW5lbFZpZXc6IFZpZXcgewogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgYXV0aE1hbmFnZXI6IEF1dGhlbnRpY2F0aW9uTWFuYWdlcgoKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nQ3JlYXRlQ2F0ZWdvcnkgPSBmYWxzZQogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNob3dpbmdEZWxldGVDYXRlZ29yeSA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2hvd2luZ0xvY2tUaHJlYWQgPSBmYWxzZQogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNob3dpbmdCYW5Vc2VyID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nVW5iYW5Vc2VyID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nRWRpdFBvc3QgPSBmYWxzZQoKICAgIC8vIEZvciBzZWxlY3Rpb25zCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRGb3J1bTogRm9ydW0/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRUaHJlYWQ6IEZvcnVtVGhyZWFkPwogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNlbGVjdGVkVXNlcjogRm9ydW1Vc2VyPwogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNlbGVjdGVkUG9zdDogRm9ydW1Qb3N0PwoKICAgIHZhciBpc0FkbWluOiBCb29sIHsgY2xvdWRLaXRNYW5hZ2VyLmN1cnJlbnRVc2VyPy5pc0FkbWluID09IHRydWUgfQoKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIE5hdmlnYXRpb25WaWV3IHsKICAgICAgICAgICAgTGlzdCB7CiAgICAgICAgICAgICAgICBTZWN0aW9uKGhlYWRlcjogVGV4dCgiQ2F0ZWdvcmllcyAoRm9ydW1zKSIpKSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDcmVhdGUgTmV3IENhdGVnb3J5IikgeyBzaG93aW5nQ3JlYXRlQ2F0ZWdvcnkgPSB0cnVlIH0KICAgICAgICAgICAgICAgICAgICBCdXR0b24oIkRlbGV0ZSBDYXRlZ29yeSIpIHsgc2hvd2luZ0RlbGV0ZUNhdGVnb3J5ID0gdHJ1ZSB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTZWN0aW9uKGhlYWRlcjogVGV4dCgiVGhyZWFkcyIpKSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJMb2NrIFRocmVhZCIpIHsgc2hvd2luZ0xvY2tUaHJlYWQgPSB0cnVlIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFNlY3Rpb24oaGVhZGVyOiBUZXh0KCJVc2VyIE1vZGVyYXRpb24iKSkgewogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiQmFuIFVzZXIiKSB7IHNob3dpbmdCYW5Vc2VyID0gdHJ1ZSB9CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJVbmJhbiBVc2VyIikgeyBzaG93aW5nVW5iYW5Vc2VyID0gdHJ1ZSB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBTZWN0aW9uKGhlYWRlcjogVGV4dCgiUG9zdHMiKSkgewogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiRWRpdCBvciBSZW1vdmUgUG9zdCIpIHsgc2hvd2luZ0VkaXRQb3N0ID0gdHJ1ZSB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLm5hdmlnYXRpb25UaXRsZSgiQWRtaW4gVG9vbHMiKQogICAgICAgICAgICAuc2hlZXQoaXNQcmVzZW50ZWQ6ICRzaG93aW5nQ3JlYXRlQ2F0ZWdvcnkpIHsKICAgICAgICAgICAgICAgIE5ld0ZvcnVtVmlldyhvbkZvcnVtQ3JlYXRlZDogeyBzaG93aW5nQ3JlYXRlQ2F0ZWdvcnkgPSBmYWxzZSB9KQogICAgICAgICAgICAgICAgICAgIC5lbnZpcm9ubWVudE9iamVjdChjbG91ZEtpdE1hbmFnZXIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ0RlbGV0ZUNhdGVnb3J5KSB7CiAgICAgICAgICAgICAgICBDYXRlZ29yeURlbGV0ZVNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ0RlbGV0ZUNhdGVnb3J5KQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5zaGVldChpc1ByZXNlbnRlZDogJHNob3dpbmdMb2NrVGhyZWFkKSB7CiAgICAgICAgICAgICAgICBMb2NrVGhyZWFkU2hlZXQoaXNQcmVzZW50ZWQ6ICRzaG93aW5nTG9ja1RocmVhZCkKICAgICAgICAgICAgfQogICAgICAgICAgICAuc2hlZXQoaXNQcmVzZW50ZWQ6ICRzaG93aW5nQmFuVXNlcikgewogICAgICAgICAgICAgICAgQmFuVXNlclNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ0JhblVzZXIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ1VuYmFuVXNlcikgewogICAgICAgICAgICAgICAgVW5iYW5Vc2VyU2hlZXQoaXNQcmVzZW50ZWQ6ICRzaG93aW5nVW5iYW5Vc2VyKQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5zaGVldChpc1ByZXNlbnRlZDogJHNob3dpbmdFZGl0UG9zdCkgewogICAgICAgICAgICAgICAgRWRpdFBvc3RTaGVldChpc1ByZXNlbnRlZDogJHNob3dpbmdFZGl0UG9zdCkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAuZW52aXJvbm1lbnRPYmplY3QoY2xvdWRLaXRNYW5hZ2VyKQogICAgICAgIC5lbnZpcm9ubWVudE9iamVjdChhdXRoTWFuYWdlcikKICAgIH0KfQoKLy8gLS0tIENhdGVnb3J5IERlbGV0aW9uIC0tLQpzdHJ1Y3QgQ2F0ZWdvcnlEZWxldGVTaGVldDogVmlldyB7CiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBCaW5kaW5nIHZhciBpc1ByZXNlbnRlZDogQm9vbAogICAgQFN0YXRlIHByaXZhdGUgdmFyIGZvcnVtczogW0ZvcnVtXSA9IFtdCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRGb3J1bTogRm9ydW0/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgZXJyb3JNZXNzYWdlOiBTdHJpbmc/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaXNEZWxldGluZyA9IGZhbHNlCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBOYXZpZ2F0aW9uVmlldyB7CiAgICAgICAgICAgIFZTdGFjayB7CiAgICAgICAgICAgICAgICBQaWNrZXIoIlNlbGVjdCBDYXRlZ29yeSIsIHNlbGVjdGlvbjogJHNlbGVjdGVkRm9ydW0pIHsKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoKGZvcnVtcykgeyBmb3J1bSBpbgogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KGZvcnVtLm5hbWUpLnRhZyhmb3J1bSBhcyBGb3J1bT8pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLnBpY2tlclN0eWxlKC5yYWRpb0dyb3VwKQogICAgICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAgICAgQnV0dG9uKCJEZWxldGUiLCByb2xlOiAuZGVzdHJ1Y3RpdmUpIHsKICAgICAgICAgICAgICAgICAgICBndWFyZCBsZXQgZm9ydW0gPSBzZWxlY3RlZEZvcnVtIGVsc2UgeyByZXR1cm4gfQogICAgICAgICAgICAgICAgICAgIGlzRGVsZXRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgVGFzayB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuZGVsZXRlRm9ydW0oZm9ydW0uaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1ByZXNlbnRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpc0RlbGV0aW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LmRpc2FibGVkKGlzRGVsZXRpbmcgfHwgc2VsZWN0ZWRGb3J1bSA9PSBuaWwpCiAgICAgICAgICAgICAgICBCdXR0b24oIkNhbmNlbCIpIHsKICAgICAgICAgICAgICAgICAgICBpc1ByZXNlbnRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGFkZGluZygudG9wKQogICAgICAgICAgICAgICAgaWYgbGV0IGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dChlcnJvck1lc3NhZ2UpLmZvcmVncm91bmRDb2xvcigucmVkKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5uYXZpZ2F0aW9uVGl0bGUoIkRlbGV0ZSBDYXRlZ29yeSIpCiAgICAgICAgICAgIC50YXNrIHsKICAgICAgICAgICAgICAgIGZvcnVtcyA9ICh0cnk/IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5mZXRjaEZvcnVtcygpKSA/PyBbXQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Ci8vIC0tLSBMb2NrIFRocmVhZCAtLS0Kc3RydWN0IExvY2tUaHJlYWRTaGVldDogVmlldyB7CiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBCaW5kaW5nIHZhciBpc1ByZXNlbnRlZDogQm9vbAogICAgQFN0YXRlIHByaXZhdGUgdmFyIGZvcnVtczogW0ZvcnVtXSA9IFtdCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgdGhyZWFkczogW0ZvcnVtVGhyZWFkXSA9IFtdCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRGb3J1bTogRm9ydW0/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRUaHJlYWQ6IEZvcnVtVGhyZWFkPwogICAgQFN0YXRlIHByaXZhdGUgdmFyIGVycm9yTWVzc2FnZTogU3RyaW5nPwogICAgQFN0YXRlIHByaXZhdGUgdmFyIGlzTG9ja2luZyA9IGZhbHNlCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBOYXZpZ2F0aW9uVmlldyB7CiAgICAgICAgICAgIFZTdGFjayB7CiAgICAgICAgICAgICAgICBQaWNrZXIoIkNhdGVnb3J5Iiwgc2VsZWN0aW9uOiAkc2VsZWN0ZWRGb3J1bSkgewogICAgICAgICAgICAgICAgICAgIEZvckVhY2goZm9ydW1zKSB7IGZvcnVtIGluCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoZm9ydW0ubmFtZSkudGFnKGZvcnVtIGFzIEZvcnVtPykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9Lm9uQ2hhbmdlKG9mOiBzZWxlY3RlZEZvcnVtKSB7IF8sIGZvcnVtIGluCiAgICAgICAgICAgICAgICAgICAgbG9hZFRocmVhZHMoZm9yOiBmb3J1bSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5waWNrZXJTdHlsZSgucmFkaW9Hcm91cCkKICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgICAgIFBpY2tlcigiVGhyZWFkIiwgc2VsZWN0aW9uOiAkc2VsZWN0ZWRUaHJlYWQpIHsKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoKHRocmVhZHMpIHsgdGhyZWFkIGluCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQodGhyZWFkLnRpdGxlKS50YWcodGhyZWFkIGFzIEZvcnVtVGhyZWFkPykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGlja2VyU3R5bGUoLnJhZGlvR3JvdXApCiAgICAgICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgICAgICBCdXR0b24oIkxvY2sgVGhyZWFkIikgewogICAgICAgICAgICAgICAgICAgIGd1YXJkIGxldCB0aHJlYWQgPSBzZWxlY3RlZFRocmVhZCBlbHNlIHsgcmV0dXJuIH0KICAgICAgICAgICAgICAgICAgICBpc0xvY2tpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgVGFzayB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1cGRhdGVkID0gRm9ydW1UaHJlYWQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRocmVhZC5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGhyZWFkLnRpdGxlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcnVtSUQ6IHRocmVhZC5mb3J1bUlELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcklEOiB0aHJlYWQuYXV0aG9ySUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZERhdGU6IHRocmVhZC5jcmVhdGVkRGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0UG9zdERhdGU6IHRocmVhZC5sYXN0UG9zdERhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFBvc3RVc2VySUQ6IHRocmVhZC5sYXN0UG9zdFVzZXJJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0Q291bnQ6IHRocmVhZC5wb3N0Q291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld0NvdW50OiB0aHJlYWQudmlld0NvdW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzU3RpY2t5OiB0aHJlYWQuaXNTdGlja3ksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNMb2NrZWQ6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBbm5vdW5jZW1lbnQ6IHRocmVhZC5pc0Fubm91bmNlbWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0hpZGRlbjogdGhyZWFkLmlzSGlkZGVuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IHRocmVhZC50YWdzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbGxJRDogdGhyZWFkLnBvbGxJRAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgXyA9IHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIudXBkYXRlVGhyZWFkKHVwZGF0ZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1ByZXNlbnRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpc0xvY2tpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5kaXNhYmxlZChpc0xvY2tpbmcgfHwgc2VsZWN0ZWRUaHJlYWQgPT0gbmlsKQogICAgICAgICAgICAgICAgQnV0dG9uKCJDYW5jZWwiKSB7IGlzUHJlc2VudGVkID0gZmFsc2UgfQogICAgICAgICAgICAgICAgLnBhZGRpbmcoLnRvcCkKICAgICAgICAgICAgICAgIGlmIGxldCBlcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UgewogICAgICAgICAgICAgICAgICAgIFRleHQoZXJyb3JNZXNzYWdlKS5mb3JlZ3JvdW5kQ29sb3IoLnJlZCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJMb2NrIFRocmVhZCIpCiAgICAgICAgICAgIC50YXNrIHsKICAgICAgICAgICAgICAgIGZvcnVtcyA9ICh0cnk/IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5mZXRjaEZvcnVtcygpKSA/PyBbXQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgcHJpdmF0ZSBmdW5jIGxvYWRUaHJlYWRzKGZvciBmb3J1bTogRm9ydW0/KSB7CiAgICAgICAgZ3VhcmQgbGV0IGZvcnVtIGVsc2UgeyB0aHJlYWRzID0gW107IHJldHVybiB9CiAgICAgICAgVGFzayB7CiAgICAgICAgICAgIHRocmVhZHMgPSAodHJ5PyBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuZmV0Y2hUaHJlYWRzKGZvcjogZm9ydW0uaWQpKSA/PyBbXQogICAgICAgIH0KICAgIH0KfQovLyAtLS0gQmFuIFVzZXIgLS0tCnN0cnVjdCBCYW5Vc2VyU2hlZXQ6IFZpZXcgewogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBAQmluZGluZyB2YXIgaXNQcmVzZW50ZWQ6IEJvb2wKICAgIEBTdGF0ZSBwcml2YXRlIHZhciB1c2VyczogW0ZvcnVtVXNlcl0gPSBbXQogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNlbGVjdGVkVXNlcjogRm9ydW1Vc2VyPwogICAgQFN0YXRlIHByaXZhdGUgdmFyIHJlYXNvbiA9ICIiCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaXNCYW5uaW5nID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBlcnJvck1lc3NhZ2U6IFN0cmluZz8KICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIE5hdmlnYXRpb25WaWV3IHsKICAgICAgICAgICAgVlN0YWNrIHsKICAgICAgICAgICAgICAgIFBpY2tlcigiVXNlciIsIHNlbGVjdGlvbjogJHNlbGVjdGVkVXNlcikgewogICAgICAgICAgICAgICAgICAgIEZvckVhY2godXNlcnMpIHsgdXNlciBpbgogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KHVzZXIuZGlzcGxheU5hbWUpLnRhZyh1c2VyIGFzIEZvcnVtVXNlcj8pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfS5waWNrZXJTdHlsZSgucmFkaW9Hcm91cCkucGFkZGluZygpCiAgICAgICAgICAgICAgICBUZXh0RmllbGQoIlJlYXNvbiIsIHRleHQ6ICRyZWFzb24pCiAgICAgICAgICAgICAgICAgICAgLnRleHRGaWVsZFN0eWxlKC5yb3VuZGVkQm9yZGVyKQogICAgICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgICAgIEJ1dHRvbigiQmFuIFVzZXIiKSB7CiAgICAgICAgICAgICAgICAgICAgZ3VhcmQgbGV0IHVzZXIgPSBzZWxlY3RlZFVzZXIgZWxzZSB7IHJldHVybiB9CiAgICAgICAgICAgICAgICAgICAgaXNCYW5uaW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIFRhc2sgewogICAgICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmJhblVzZXIodXNlci5pZCwgcmVhc29uOiByZWFzb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1ByZXNlbnRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpc0Jhbm5pbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0uZGlzYWJsZWQoaXNCYW5uaW5nIHx8IHNlbGVjdGVkVXNlciA9PSBuaWwpCiAgICAgICAgICAgICAgICBCdXR0b24oIkNhbmNlbCIpIHsgaXNQcmVzZW50ZWQgPSBmYWxzZSB9CiAgICAgICAgICAgICAgICAucGFkZGluZygudG9wKQogICAgICAgICAgICAgICAgaWYgbGV0IGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dChlcnJvck1lc3NhZ2UpLmZvcmVncm91bmRDb2xvcigucmVkKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5uYXZpZ2F0aW9uVGl0bGUoIkJhbiBVc2VyIikKICAgICAgICAgICAgLnRhc2sgewogICAgICAgICAgICAgICAgdXNlcnMgPSAodHJ5PyBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuc2VhcmNoVXNlcnMocXVlcnk6ICIiKSkgPz8gW10KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQovLyAtLS0gVW5iYW4gVXNlciAtLS0Kc3RydWN0IFVuYmFuVXNlclNoZWV0OiBWaWV3IHsKICAgIEBFbnZpcm9ubWVudE9iamVjdCBwcml2YXRlIHZhciBjbG91ZEtpdE1hbmFnZXI6IENsb3VkS2l0TWFuYWdlcgogICAgQEJpbmRpbmcgdmFyIGlzUHJlc2VudGVkOiBCb29sCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgdXNlcnM6IFtGb3J1bVVzZXJdID0gW10KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzZWxlY3RlZFVzZXI6IEZvcnVtVXNlcj8KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc1VuYmFubmluZyA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgZXJyb3JNZXNzYWdlOiBTdHJpbmc/CiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBOYXZpZ2F0aW9uVmlldyB7CiAgICAgICAgICAgIFZTdGFjayB7CiAgICAgICAgICAgICAgICBQaWNrZXIoIlVzZXIiLCBzZWxlY3Rpb246ICRzZWxlY3RlZFVzZXIpIHsKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoKHVzZXJzLmZpbHRlciB7ICQwLmlzQmFubmVkIH0pIHsgdXNlciBpbgogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KHVzZXIuZGlzcGxheU5hbWUpLnRhZyh1c2VyIGFzIEZvcnVtVXNlcj8pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfS5waWNrZXJTdHlsZSgucmFkaW9Hcm91cCkucGFkZGluZygpCiAgICAgICAgICAgICAgICBCdXR0b24oIlVuYmFuIFVzZXIiKSB7CiAgICAgICAgICAgICAgICAgICAgZ3VhcmQgbGV0IHVzZXIgPSBzZWxlY3RlZFVzZXIgZWxzZSB7IHJldHVybiB9CiAgICAgICAgICAgICAgICAgICAgaXNVbmJhbm5pbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgVGFzayB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIudW5iYW5Vc2VyKHVzZXIuaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1ByZXNlbnRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpc1VuYmFubmluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfS5kaXNhYmxlZChpc1VuYmFubmluZyB8fCBzZWxlY3RlZFVzZXIgPT0gbmlsKQogICAgICAgICAgICAgICAgQnV0dG9uKCJDYW5jZWwiKSB7IGlzUHJlc2VudGVkID0gZmFsc2UgfQogICAgICAgICAgICAgICAgLnBhZGRpbmcoLnRvcCkKICAgICAgICAgICAgICAgIGlmIGxldCBlcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UgewogICAgICAgICAgICAgICAgICAgIFRleHQoZXJyb3JNZXNzYWdlKS5mb3JlZ3JvdW5kQ29sb3IoLnJlZCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJVbmJhbiBVc2VyIikKICAgICAgICAgICAgLnRhc2sgewogICAgICAgICAgICAgICAgdXNlcnMgPSAodHJ5PyBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuc2VhcmNoVXNlcnMocXVlcnk6ICIiKSkgPz8gW10KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQovLyAtLS0gRWRpdC9SZW1vdmUgUG9zdCAtLS0Kc3RydWN0IEVkaXRQb3N0U2hlZXQ6IFZpZXcgewogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgYXV0aE1hbmFnZXI6IEF1dGhlbnRpY2F0aW9uTWFuYWdlcgogICAgQEJpbmRpbmcgdmFyIGlzUHJlc2VudGVkOiBCb29sCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgcG9zdHM6IFtGb3J1bVBvc3RdID0gW10KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzZWxlY3RlZFBvc3Q6IEZvcnVtUG9zdD8KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc0VkaXRpbmcgPSBmYWxzZQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGVycm9yTWVzc2FnZTogU3RyaW5nPwogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgTmF2aWdhdGlvblZpZXcgewogICAgICAgICAgICBWU3RhY2sgewogICAgICAgICAgICAgICAgUGlja2VyKCJQb3N0Iiwgc2VsZWN0aW9uOiAkc2VsZWN0ZWRQb3N0KSB7CiAgICAgICAgICAgICAgICAgICAgRm9yRWFjaChwb3N0cykgeyBwb3N0IGluCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQocG9zdC5jb250ZW50LnByZWZpeCg0MCkpLnRhZyhwb3N0IGFzIEZvcnVtUG9zdD8pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfS5waWNrZXJTdHlsZSgucmFkaW9Hcm91cCkucGFkZGluZygpCiAgICAgICAgICAgICAgICBCdXR0b24oIlJlbW92ZS9SZXBsYWNlIFRleHQiKSB7CiAgICAgICAgICAgICAgICAgICAgZ3VhcmQgbGV0IHBvc3QgPSBzZWxlY3RlZFBvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFkbWluTmFtZSA9IGNsb3VkS2l0TWFuYWdlci5jdXJyZW50VXNlcj8uZGlzcGxheU5hbWUgZWxzZSB7IHJldHVybiB9CiAgICAgICAgICAgICAgICAgICAgaXNFZGl0aW5nID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIFRhc2sgewogICAgICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdXBkYXRlZCA9IEZvcnVtUG9zdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogcG9zdC5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJlYWRJRDogcG9zdC50aHJlYWRJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRob3JJRDogcG9zdC5hdXRob3JJRCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAiUG9zdCByZW1vdmVkIGJ5IFwoYWRtaW5OYW1lKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZERhdGU6IHBvc3QuY3JlYXRlZERhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdGVkRGF0ZTogRGF0ZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRlZEJ5VXNlcklEOiBjbG91ZEtpdE1hbmFnZXIuY3VycmVudFVzZXI/LmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRSZWFzb246ICJSZW1vdmVkIGJ5IEFkbWluIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0hpZGRlbjogcG9zdC5pc0hpZGRlbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWtlQ291bnQ6IHBvc3QubGlrZUNvdW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlQ291bnQ6IHBvc3QucXVvdGVDb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRhY2htZW50SURzOiBwb3N0LmF0dGFjaG1lbnRJRHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVvdGVkUG9zdElEczogcG9zdC5xdW90ZWRQb3N0SURzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudFBvc3RJRDogcG9zdC5wYXJlbnRQb3N0SUQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdE51bWJlcjogcG9zdC5wb3N0TnVtYmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci51cGRhdGVQb3N0KHVwZGF0ZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1ByZXNlbnRlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpc0VkaXRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0uZGlzYWJsZWQoaXNFZGl0aW5nIHx8IHNlbGVjdGVkUG9zdCA9PSBuaWwpCiAgICAgICAgICAgICAgICBCdXR0b24oIkNhbmNlbCIpIHsgaXNQcmVzZW50ZWQgPSBmYWxzZSB9CiAgICAgICAgICAgICAgICAucGFkZGluZygudG9wKQogICAgICAgICAgICAgICAgaWYgbGV0IGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dChlcnJvck1lc3NhZ2UpLmZvcmVncm91bmRDb2xvcigucmVkKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5uYXZpZ2F0aW9uVGl0bGUoIkVkaXQvUmVtb3ZlIFBvc3QiKQogICAgICAgICAgICAudGFzayB7CiAgICAgICAgICAgICAgICBwb3N0cyA9ICh0cnk/IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5zZWFyY2hQb3N0cyhxdWVyeTogIiIpKSA/PyBbXQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgojUHJldmlldyB7CiAgICBBZG1pblBhbmVsVmlldygpCiAgICAgICAgLmVudmlyb25tZW50T2JqZWN0KENsb3VkS2l0TWFuYWdlci5zaGFyZWQpCiAgICAgICAgLmVudmlyb25tZW50T2JqZWN0KEF1dGhlbnRpY2F0aW9uTWFuYWdlci5zaGFyZWQpCn0K
--- END ---

--- FILE: MacChan/Views/SettingsView.swift ---
BASE64: aW1wb3J0IFN3aWZ0VUkKaW1wb3J0IFN0b3JlS2l0CgojaWYgb3MoaU9TKQppbXBvcnQgVUlLaXQKI2VuZGlmCgojaWYgb3MobWFjT1MpCmltcG9ydCBBcHBLaXQKI2VuZGlmCgpzdHJ1Y3QgU2V0dGluZ3NWaWV3OiBWaWV3IHsKICAgIEBFbnZpcm9ubWVudE9iamVjdCBwcml2YXRlIHZhciBhdXRoTWFuYWdlcjogQXV0aGVudGljYXRpb25NYW5hZ2VyCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBPYnNlcnZlZE9iamVjdCBwcml2YXRlIHZhciB1c2VyU2V0dGluZ3MgPSBVc2VyU2V0dGluZ3NTdG9yZS5zaGFyZWQKCiAgICAvLyBGb3IgQ29sb3IgU2NoZW1lIChzdGlsbCB1c2luZyBBcHBTdG9yYWdlIGZvciBkZW1vKQogICAgQEFwcFN0b3JhZ2UoInRoZW1lIikgcHJpdmF0ZSB2YXIgdGhlbWU6IFN0cmluZyA9ICJzeXN0ZW0iIC8vICJzeXN0ZW0iLCAibGlnaHQiLCAiZGFyayIKCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2hvd0RlbGV0ZUFsZXJ0ID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93RXhwb3J0U2hlZXQgPSBmYWxzZQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGV4cG9ydGVkRGF0YVVSTDogVVJMPwogICAgQFN0YXRlIHByaXZhdGUgdmFyIGlzU3luY2luZyA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2hvd0RlYnVnID0gZmFsc2UKCiAgICBwcml2YXRlIGxldCBhY2NlbnRDb2xvcnM6IFtTdHJpbmc6IENvbG9yXSA9IFsKICAgICAgICAiYmx1ZSI6IC5ibHVlLAogICAgICAgICJncmVlbiI6IC5ncmVlbiwKICAgICAgICAib3JhbmdlIjogLm9yYW5nZSwKICAgICAgICAicGluayI6IC5waW5rLAogICAgICAgICJwdXJwbGUiOiAucHVycGxlLAogICAgICAgICJyZWQiOiAucmVkLAogICAgICAgICJ0ZWFsIjogLnRlYWwsCiAgICAgICAgInllbGxvdyI6IC55ZWxsb3cKICAgIF0KCiAgICAvLyBVUkxzIGZvciBwcml2YWN5LCBUT1MsIGFuZCBzdXBwb3J0CiAgICBwcml2YXRlIGxldCBwcml2YWN5VVJMID0gVVJMKHN0cmluZzogImh0dHBzOi8veC5jb20vbWFjY2hhbmFwcCIpIQogICAgcHJpdmF0ZSBsZXQgdGVybXNVUkwgPSBVUkwoc3RyaW5nOiAiaHR0cHM6Ly94LmNvbS9tYWNjaGFuYXBwIikhCiAgICBwcml2YXRlIGxldCBzdXBwb3J0VVJMID0gVVJMKHN0cmluZzogImh0dHBzOi8veC5jb20vbWFjY2hhbmFwcCIpIQoKICAgIHByaXZhdGUgdmFyIGFwcFZlcnNpb246IFN0cmluZyB7CiAgICAgICAgbGV0IGRpY3QgPSBCdW5kbGUubWFpbi5pbmZvRGljdGlvbmFyeQogICAgICAgIGxldCB2ZXJzaW9uID0gZGljdD9bIkNGQnVuZGxlU2hvcnRWZXJzaW9uU3RyaW5nIl0gYXM/IFN0cmluZyA/PyAiMS4wIgogICAgICAgIGxldCBidWlsZCA9IGRpY3Q/WyJDRkJ1bmRsZVZlcnNpb24iXSBhcz8gU3RyaW5nID8/ICItIgogICAgICAgIHJldHVybiAiXCh2ZXJzaW9uKSAoXChidWlsZCkpIgogICAgfQoKICAgIC8vIEhvbWUgc2VjdGlvbiBwaWNrZXIgb3B0aW9ucwogICAgcHJpdmF0ZSBsZXQgaG9tZVNlY3Rpb25zID0gWwogICAgICAgICJGb3J1bXMiLCAiUmVjZW50IFBvc3RzIiwgIk1lc3NhZ2VzIiwgIlNlYXJjaCIsICJQcm9maWxlIiwgIlNldHRpbmdzIgogICAgXQoKICAgIHByaXZhdGUgdmFyIHN5c3RlbUJhY2tncm91bmRDb2xvcjogQ29sb3IgewojaWYgb3MoaU9TKQogICAgICAgIC8vIE5vdGU6IFVzZSBvbmx5IGNvZGUgY29tcGF0aWJsZSB3aXRoIGlPUwogICAgICAgIHJldHVybiBDb2xvcihVSUNvbG9yLnN5c3RlbUJhY2tncm91bmQpCiNlbHNlaWYgb3MobWFjT1MpCiAgICAgICAgLy8gTm90ZTogVXNlIG9ubHkgY29kZSBjb21wYXRpYmxlIHdpdGggbWFjT1MKICAgICAgICByZXR1cm4gQ29sb3IoTlNDb2xvci53aW5kb3dCYWNrZ3JvdW5kQ29sb3IpCiNlbmRpZgogICAgfQoKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIE5hdmlnYXRpb25WaWV3IHsKICAgICAgICAgICAgRm9ybSB7CiAgICAgICAgICAgICAgICBTZWN0aW9uKGhlYWRlcjogVGV4dCgiQXBwZWFyYW5jZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgUGlja2VyKCJDb2xvciBTY2hlbWUiLCBzZWxlY3Rpb246ICR0aGVtZSkgewogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KCJTeXN0ZW0iKS50YWcoInN5c3RlbSIpCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIkxpZ2h0IikudGFnKCJsaWdodCIpCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIkRhcmsiKS50YWcoImRhcmsiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAucGlja2VyU3R5bGUoU2VnbWVudGVkUGlja2VyU3R5bGUoKSkKCiAgICAgICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCgiQWNjZW50IENvbG9yIikKICAgICAgICAgICAgICAgICAgICAgICAgU3BhY2VyKCkKICAgICAgICAgICAgICAgICAgICAgICAgRm9yRWFjaChBcnJheShhY2NlbnRDb2xvcnMua2V5cyksIGlkOiBcLnNlbGYpIHsga2V5IGluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDaXJjbGUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWxsKGFjY2VudENvbG9yc1trZXksIGRlZmF1bHQ6IC5ibHVlXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZnJhbWUod2lkdGg6IDI4LCBoZWlnaHQ6IDI4KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vdmVybGF5KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDaXJjbGUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0cm9rZSh1c2VyU2V0dGluZ3MuYWNjZW50Q29sb3IgPT0ga2V5ID8gQ29sb3IucHJpbWFyeSA6IC5jbGVhciwgbGluZVdpZHRoOiAzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25UYXBHZXN0dXJlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlclNldHRpbmdzLmFjY2VudENvbG9yID0ga2V5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJTZXR0aW5ncy5zYXZlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoLmhvcml6b250YWwsIDIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoLnZlcnRpY2FsLCA0KQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIFNlY3Rpb24oaGVhZGVyOiBUZXh0KCJBY2NvdW50IE1hbmFnZW1lbnQiKSkgewogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiRGVsZXRlIEFjY291bnQiLCByb2xlOiAuZGVzdHJ1Y3RpdmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0RlbGV0ZUFsZXJ0ID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBCdXR0b24oIkxvZyBPdXQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhNYW5hZ2VyLnNpZ25PdXQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBTZWN0aW9uKGhlYWRlcjogVGV4dCgiUHJpdmFjeSAmIERhdGEiKSkgewogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiRXhwb3J0IFVzZXIgRGF0YSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0VXNlckRhdGEoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAuZGlzYWJsZWQoY2xvdWRLaXRNYW5hZ2VyLmN1cnJlbnRVc2VyID09IG5pbCkKICAgICAgICAgICAgICAgICAgICBMaW5rKCJQcml2YWN5IFBvbGljeSIsIGRlc3RpbmF0aW9uOiBwcml2YWN5VVJMKQogICAgICAgICAgICAgICAgICAgIExpbmsoIlRlcm1zIG9mIFNlcnZpY2UiLCBkZXN0aW5hdGlvbjogdGVybXNVUkwpCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgU2VjdGlvbihoZWFkZXI6IFRleHQoIk5vdGlmaWNhdGlvbnMiKSkgewogICAgICAgICAgICAgICAgICAgIC8vIFlvdSBjYW4gY29ubmVjdCB0aGlzIHRvIE5vdGlmaWNhdGlvbk1hbmFnZXIgYXMgbmVlZGVkCiAgICAgICAgICAgICAgICAgICAgVG9nZ2xlKCJQdXNoIE5vdGlmaWNhdGlvbnMiLCBpc09uOiAuY29uc3RhbnQodHJ1ZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5kaXNhYmxlZCh0cnVlKQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIFNlY3Rpb24oaGVhZGVyOiBUZXh0KCJGb3J1bSBQcmVmZXJlbmNlcyIpKSB7CiAgICAgICAgICAgICAgICAgICAgUGlja2VyKCJEZWZhdWx0IEhvbWUgU2VjdGlvbiIsIHNlbGVjdGlvbjogJHVzZXJTZXR0aW5ncy5kZWZhdWx0SG9tZVNlY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgRm9yRWFjaChob21lU2VjdGlvbnMsIGlkOiBcLnNlbGYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoJDApCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKG9mOiB1c2VyU2V0dGluZ3MuZGVmYXVsdEhvbWVTZWN0aW9uKSB7IF8gaW4gdXNlclNldHRpbmdzLnNhdmUoKSB9CgogICAgICAgICAgICAgICAgICAgIFRvZ2dsZSgiU2hvdyBOU0ZXIEZvcnVtcyIsIGlzT246ICR1c2VyU2V0dGluZ3Muc2hvd05TRlcpCiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShvZjogdXNlclNldHRpbmdzLnNob3dOU0ZXKSB7IF8gaW4gdXNlclNldHRpbmdzLnNhdmUoKSB9CgogICAgICAgICAgICAgICAgICAgIFRvZ2dsZSgiU2hvdyBBdmF0YXJzIiwgaXNPbjogLmNvbnN0YW50KHRydWUpKQogICAgICAgICAgICAgICAgICAgICAgICAuZGlzYWJsZWQodHJ1ZSkKICAgICAgICAgICAgICAgICAgICBUb2dnbGUoIlNob3cgU2lnbmF0dXJlcyIsIGlzT246IC5jb25zdGFudCh0cnVlKSkKICAgICAgICAgICAgICAgICAgICAgICAgLmRpc2FibGVkKHRydWUpCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgY2xvdWRLaXRNYW5hZ2VyLmN1cnJlbnRVc2VyPy5pc0FkbWluID09IHRydWUgewogICAgICAgICAgICAgICAgICAgIFNlY3Rpb24oaGVhZGVyOiBUZXh0KCJEZXZlbG9wZXIgLyBEZWJ1ZyIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiU2hvdyBEZWJ1ZyBWaWV3IikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0RlYnVnLnRvZ2dsZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJGb3JjZSBEYXRhIFN5bmMgLyBSZWZyZXNoIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VEYXRhU3luYygpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGV0IGlkID0gY2xvdWRLaXRNYW5hZ2VyLmN1cnJlbnRVc2VyPy5pZCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlNob3cgQ2xvdWRLaXQgSUQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2lmIG9zKGlPUykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVSVBhc3RlYm9hcmQuZ2VuZXJhbC5zdHJpbmcgPSBpZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNlbmRpZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCgiVXNlciBJRDogXChpZCkiKS5mb250KC5jYXB0aW9uKS5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBTZWN0aW9uKGhlYWRlcjogVGV4dCgiU3VwcG9ydCIpKSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDb250YWN0IFN1cHBvcnQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5TdXBwb3J0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCgiQXBwIFZlcnNpb24iKQogICAgICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KGFwcFZlcnNpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLm5hdmlnYXRpb25UaXRsZSgiU2V0dGluZ3MiKQogICAgICAgICAgICAucHJlZmVycmVkQ29sb3JTY2hlbWUodGhlbWUgPT0gInN5c3RlbSIgPyBuaWwgOiAodGhlbWUgPT0gImRhcmsiID8gLmRhcmsgOiAubGlnaHQpKQogICAgICAgICAgICAuYWNjZW50Q29sb3IoYWNjZW50Q29sb3JzW3VzZXJTZXR0aW5ncy5hY2NlbnRDb2xvciwgZGVmYXVsdDogLmJsdWVdKQogICAgICAgICAgICAuc2hlZXQoaXNQcmVzZW50ZWQ6ICRzaG93RXhwb3J0U2hlZXQsIG9uRGlzbWlzczogeyBleHBvcnRlZERhdGFVUkwgPSBuaWwgfSkgewogICAgICAgICAgICAgICAgaWYgbGV0IHVybCA9IGV4cG9ydGVkRGF0YVVSTCB7CiAgICAgICAgICAgICAgICAgICAgU2hhcmVTaGVldChhY3Rpdml0eUl0ZW1zOiBbdXJsXSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAuYWxlcnQoIkNvbmZpcm0gRGVsZXRlIEFjY291bnQiLCBpc1ByZXNlbnRlZDogJHNob3dEZWxldGVBbGVydCkgewogICAgICAgICAgICAgICAgQnV0dG9uKCJDYW5jZWwiLCByb2xlOiAuY2FuY2VsKSB7fQogICAgICAgICAgICAgICAgQnV0dG9uKCJEZWxldGUiLCByb2xlOiAuZGVzdHJ1Y3RpdmUpIHsgZGVsZXRlQWNjb3VudCgpIH0KICAgICAgICAgICAgfSBtZXNzYWdlOiB7CiAgICAgICAgICAgICAgICBUZXh0KCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHlvdXIgYWNjb3VudCBhbmQgYWxsIGZvcnVtIGRhdGE/IFRoaXMgY2Fubm90IGJlIHVuZG9uZS4iKQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5zaGVldChpc1ByZXNlbnRlZDogJHNob3dEZWJ1ZykgewogICAgICAgICAgICAgICAgRGVidWdWaWV3KCkKICAgICAgICAgICAgfQogICAgICAgICAgICAub3ZlcmxheSB7CiAgICAgICAgICAgICAgICBpZiBpc1N5bmNpbmcgewogICAgICAgICAgICAgICAgICAgIFByb2dyZXNzVmlldygiU3luY2luZy4uLiIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgICAgICAgICAgICAgLmJhY2tncm91bmQoc3lzdGVtQmFja2dyb3VuZENvbG9yLm9wYWNpdHkoMC45KSkKICAgICAgICAgICAgICAgICAgICAgICAgLmNvcm5lclJhZGl1cygxMikKICAgICAgICAgICAgICAgICAgICAgICAgLnNoYWRvdyhyYWRpdXM6IDgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gTUFSSzogLSBBY3Rpb25zCgogICAgcHJpdmF0ZSBmdW5jIGRlbGV0ZUFjY291bnQoKSB7CiAgICAgICAgVGFzayB7CiAgICAgICAgICAgIGF3YWl0IGNsb3VkS2l0TWFuYWdlci5jbGVhclVzZXJEYXRhKCkKICAgICAgICAgICAgYXV0aE1hbmFnZXIuc2lnbk91dCgpCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgZnVuYyBleHBvcnRVc2VyRGF0YSgpIHsKICAgICAgICBUYXNrIHsKICAgICAgICAgICAgZ3VhcmQgbGV0IGN1cnJlbnRVc2VyID0gY2xvdWRLaXRNYW5hZ2VyLmN1cnJlbnRVc2VyIGVsc2UgeyByZXR1cm4gfQogICAgICAgICAgICAvLyBGZXRjaCBhbGwgdXNlci1yZWxhdGVkIENsb3VkS2l0IGRhdGEuIEZvciBub3csIG1vY2sgdGhpcy4KICAgICAgICAgICAgbGV0IGV4cG9ydFN0cmluZyA9ICIiIgogICAgICAgICAgICBVc2VyIElEOiBcKGN1cnJlbnRVc2VyLmlkKQogICAgICAgICAgICBVc2VybmFtZTogXChjdXJyZW50VXNlci51c2VybmFtZSkKICAgICAgICAgICAgRGlzcGxheSBOYW1lOiBcKGN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lKQogICAgICAgICAgICBFbWFpbDogXChjdXJyZW50VXNlci5lbWFpbCA/PyAiIikKICAgICAgICAgICAgUG9zdHM6IFtNb2NrZWQgTGlzdF0KICAgICAgICAgICAgVGhyZWFkczogW01vY2tlZCBMaXN0XQogICAgICAgICAgICBNZXNzYWdlczogW01vY2tlZCBMaXN0XQogICAgICAgICAgICAiIiIKICAgICAgICAgICAgbGV0IHRlbXBVUkwgPSBGaWxlTWFuYWdlci5kZWZhdWx0LnRlbXBvcmFyeURpcmVjdG9yeS5hcHBlbmRpbmdQYXRoQ29tcG9uZW50KCJNYWNDaGFuVXNlckV4cG9ydC50eHQiKQogICAgICAgICAgICB0cnk/IGV4cG9ydFN0cmluZy53cml0ZSh0bzogdGVtcFVSTCwgYXRvbWljYWxseTogdHJ1ZSwgZW5jb2Rpbmc6IC51dGY4KQogICAgICAgICAgICBleHBvcnRlZERhdGFVUkwgPSB0ZW1wVVJMCiAgICAgICAgICAgIHNob3dFeHBvcnRTaGVldCA9IHRydWUKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBmdW5jIGZvcmNlRGF0YVN5bmMoKSB7CiAgICAgICAgaXNTeW5jaW5nID0gdHJ1ZQogICAgICAgIFRhc2sgewogICAgICAgICAgICBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuY2hlY2tBY2NvdW50U3RhdHVzKCkKICAgICAgICAgICAgaXNTeW5jaW5nID0gZmFsc2UKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBmdW5jIG9wZW5TdXBwb3J0KCkgewogICAgICAgICNpZiBvcyhpT1MpCiAgICAgICAgaWYgbGV0IHVybCA9IFVSTChzdHJpbmc6ICJodHRwczovL3guY29tL21hY2NoYW5hcHAiKSB7CiAgICAgICAgICAgIFVJQXBwbGljYXRpb24uc2hhcmVkLm9wZW4odXJsKQogICAgICAgIH0KICAgICAgICAjZWxzZQogICAgICAgIGlmIGxldCB1cmwgPSBVUkwoc3RyaW5nOiAiaHR0cHM6Ly94LmNvbS9tYWNjaGFuYXBwIikgewogICAgICAgICAgICBOU1dvcmtzcGFjZS5zaGFyZWQub3Blbih1cmwpCiAgICAgICAgfQogICAgICAgICNlbmRpZgogICAgfQp9CgovLyBEZWJ1Z1ZpZXcgaXMgYSBwbGFjZWhvbGRlcjogZXhwYW5kIHdpdGggcmVhbCBkaWFnbm9zdGljcyBhcyBuZWVkZWQhCnN0cnVjdCBEZWJ1Z1ZpZXc6IFZpZXcgewogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgVlN0YWNrKHNwYWNpbmc6IDI0KSB7CiAgICAgICAgICAgIFRleHQoIkRlYnVnIFZpZXciKQogICAgICAgICAgICAgICAgLmZvbnQoLnRpdGxlKQogICAgICAgICAgICBUZXh0KCJEaWFnbm9zdGljcyBjb21pbmcgc29vbi4iKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgIH0KICAgICAgICAucGFkZGluZygpCiAgICAgICAgLmZyYW1lKG1pbldpZHRoOiAzMjAsIG1pbkhlaWdodDogMzIwKQogICAgfQp9CgovLyBVbml2ZXJzYWwgU2hhcmVTaGVldCBmb3IgaU9TL21hY09TCiNpZiBvcyhpT1MpCi8vIE5vdGU6IFVzZSBvbmx5IGNvZGUgY29tcGF0aWJsZSB3aXRoIGlPUwpzdHJ1Y3QgU2hhcmVTaGVldDogVUlWaWV3Q29udHJvbGxlclJlcHJlc2VudGFibGUgewogICAgbGV0IGFjdGl2aXR5SXRlbXM6IFtBbnldCiAgICBmdW5jIG1ha2VVSVZpZXdDb250cm9sbGVyKGNvbnRleHQ6IENvbnRleHQpIC0+IFVJQWN0aXZpdHlWaWV3Q29udHJvbGxlciB7CiAgICAgICAgVUlBY3Rpdml0eVZpZXdDb250cm9sbGVyKGFjdGl2aXR5SXRlbXM6IGFjdGl2aXR5SXRlbXMsIGFwcGxpY2F0aW9uQWN0aXZpdGllczogbmlsKQogICAgfQogICAgZnVuYyB1cGRhdGVVSVZpZXdDb250cm9sbGVyKF8gdmM6IFVJQWN0aXZpdHlWaWV3Q29udHJvbGxlciwgY29udGV4dDogQ29udGV4dCkge30KfQojZW5kaWYKCiNpZiBvcyhtYWNPUykKaW1wb3J0IEFwcEtpdAovLyBOb3RlOiBVc2Ugb25seSBjb2RlIGNvbXBhdGlibGUgd2l0aCBtYWNPUwpzdHJ1Y3QgU2hhcmVTaGVldDogVmlldyB7CiAgICBsZXQgYWN0aXZpdHlJdGVtczogW0FueV0KICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIEJ1dHRvbigiT3BlbiBFeHBvcnRlZCBEYXRhIikgewogICAgICAgICAgICBpZiBsZXQgdXJsID0gYWN0aXZpdHlJdGVtcy5maXJzdCBhcz8gVVJMIHsKICAgICAgICAgICAgICAgIE5TV29ya3NwYWNlLnNoYXJlZC5vcGVuKHVybCkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQojZW5kaWYKCg==
--- END ---

--- FILE: MacChan/Views/MainForumView.swift ---
BASE64: aW1wb3J0IFN3aWZ0VUkKCnN0cnVjdCBNYWluRm9ydW1WaWV3OiBWaWV3IHsKICAgIEBFbnZpcm9ubWVudE9iamVjdCBwcml2YXRlIHZhciBhdXRoTWFuYWdlcjogQXV0aGVudGljYXRpb25NYW5hZ2VyCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRTZWN0aW9uOiBOYXZpZ2F0aW9uU2VjdGlvbiA9IC5mb3J1bXMKCiAgICBlbnVtIE5hdmlnYXRpb25TZWN0aW9uOiBTdHJpbmcsIENhc2VJdGVyYWJsZSB7CiAgICAgICAgY2FzZSBmb3J1bXMgPSAiRm9ydW1zIgogICAgICAgIGNhc2UgcmVjZW50ID0gIlJlY2VudCBQb3N0cyIKICAgICAgICBjYXNlIG1lc3NhZ2VzID0gIk1lc3NhZ2VzIgogICAgICAgIGNhc2Ugc2VhcmNoID0gIlNlYXJjaCIKICAgICAgICBjYXNlIHByb2ZpbGUgPSAiUHJvZmlsZSIKICAgICAgICBjYXNlIHNldHRpbmdzID0gIlNldHRpbmdzIgogICAgICAgIGNhc2UgYWRtaW4gPSAiQWRtaW4iCgogICAgICAgIHZhciBpY29uOiBTdHJpbmcgewogICAgICAgICAgICBzd2l0Y2ggc2VsZiB7CiAgICAgICAgICAgIGNhc2UgLmZvcnVtczogcmV0dXJuICJsaXN0LmJ1bGxldC5yZWN0YW5nbGUiCiAgICAgICAgICAgIGNhc2UgLnJlY2VudDogcmV0dXJuICJjbG9jayIKICAgICAgICAgICAgY2FzZSAubWVzc2FnZXM6IHJldHVybiAiZW52ZWxvcGUiCiAgICAgICAgICAgIGNhc2UgLnNlYXJjaDogcmV0dXJuICJtYWduaWZ5aW5nZ2xhc3MiCiAgICAgICAgICAgIGNhc2UgLnByb2ZpbGU6IHJldHVybiAicGVyc29uLmNpcmNsZSIKICAgICAgICAgICAgY2FzZSAuc2V0dGluZ3M6IHJldHVybiAiZ2VhciIKICAgICAgICAgICAgY2FzZSAuYWRtaW46IHJldHVybiAic2hpZWxkLmxlZnRoYWxmLmZpbGwiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgWlN0YWNrIHsKICAgICAgICAgICAgI2lmIG9zKGlPUykKICAgICAgICAgICAgLy8gaU9TOiBUYWItYmFzZWQgbmF2aWdhdGlvbgogICAgICAgICAgICBUYWJWaWV3KHNlbGVjdGlvbjogJHNlbGVjdGVkU2VjdGlvbikgewogICAgICAgICAgICAgICAgRm9ydW1Ccm93c2VyVmlldygpCiAgICAgICAgICAgICAgICAgICAgLnRhYkl0ZW0gewogICAgICAgICAgICAgICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiBOYXZpZ2F0aW9uU2VjdGlvbi5mb3J1bXMuaWNvbikKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dChOYXZpZ2F0aW9uU2VjdGlvbi5mb3J1bXMucmF3VmFsdWUpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC50YWcoTmF2aWdhdGlvblNlY3Rpb24uZm9ydW1zKQoKICAgICAgICAgICAgICAgIFRleHQoIlJlY2VudCBQb3N0cyBDb21pbmcgU29vbiIpCiAgICAgICAgICAgICAgICAgICAgLnRhYkl0ZW0gewogICAgICAgICAgICAgICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiBOYXZpZ2F0aW9uU2VjdGlvbi5yZWNlbnQuaWNvbikKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dChOYXZpZ2F0aW9uU2VjdGlvbi5yZWNlbnQucmF3VmFsdWUpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC50YWcoTmF2aWdhdGlvblNlY3Rpb24ucmVjZW50KQoKICAgICAgICAgICAgICAgIFRleHQoIk1lc3NhZ2VzIENvbWluZyBTb29uIikKICAgICAgICAgICAgICAgICAgICAudGFiSXRlbSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6IE5hdmlnYXRpb25TZWN0aW9uLm1lc3NhZ2VzLmljb24pCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoTmF2aWdhdGlvblNlY3Rpb24ubWVzc2FnZXMucmF3VmFsdWUpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC50YWcoTmF2aWdhdGlvblNlY3Rpb24ubWVzc2FnZXMpCgogICAgICAgICAgICAgICAgVGV4dCgiU2VhcmNoIENvbWluZyBTb29uIikKICAgICAgICAgICAgICAgICAgICAudGFiSXRlbSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6IE5hdmlnYXRpb25TZWN0aW9uLnNlYXJjaC5pY29uKQogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KE5hdmlnYXRpb25TZWN0aW9uLnNlYXJjaC5yYXdWYWx1ZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLnRhZyhOYXZpZ2F0aW9uU2VjdGlvbi5zZWFyY2gpCgogICAgICAgICAgICAgICAgVGV4dCgiUHJvZmlsZSBDb21pbmcgU29vbiIpCiAgICAgICAgICAgICAgICAgICAgLnRhYkl0ZW0gewogICAgICAgICAgICAgICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiBOYXZpZ2F0aW9uU2VjdGlvbi5wcm9maWxlLmljb24pCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoTmF2aWdhdGlvblNlY3Rpb24ucHJvZmlsZS5yYXdWYWx1ZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLnRhZyhOYXZpZ2F0aW9uU2VjdGlvbi5wcm9maWxlKQoKICAgICAgICAgICAgICAgIFRleHQoIlNldHRpbmdzIENvbWluZyBTb29uIikKICAgICAgICAgICAgICAgICAgICAudGFiSXRlbSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6IE5hdmlnYXRpb25TZWN0aW9uLnNldHRpbmdzLmljb24pCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoTmF2aWdhdGlvblNlY3Rpb24uc2V0dGluZ3MucmF3VmFsdWUpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC50YWcoTmF2aWdhdGlvblNlY3Rpb24uc2V0dGluZ3MpCgogICAgICAgICAgICAgICAgaWYgY2xvdWRLaXRNYW5hZ2VyLmN1cnJlbnRVc2VyPy5pc0FkbWluID09IHRydWUgewogICAgICAgICAgICAgICAgICAgIEFkbWluUGFuZWxWaWV3KCkKICAgICAgICAgICAgICAgICAgICAgICAgLnRhYkl0ZW0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW1hZ2Uoc3lzdGVtTmFtZTogTmF2aWdhdGlvblNlY3Rpb24uYWRtaW4uaWNvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoTmF2aWdhdGlvblNlY3Rpb24uYWRtaW4ucmF3VmFsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLnRhZyhOYXZpZ2F0aW9uU2VjdGlvbi5hZG1pbikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAjZWxzZQogICAgICAgICAgICAvLyBtYWNPUzogU3BsaXQgdmlldyBuYXZpZ2F0aW9uCiAgICAgICAgICAgIGxldCBhdmFpbGFibGVTZWN0aW9ucyA9IE5hdmlnYXRpb25TZWN0aW9uLmFsbENhc2VzLmZpbHRlciB7IHNlY3Rpb24gaW4KICAgICAgICAgICAgICAgIGlmIHNlY3Rpb24gPT0gLmFkbWluIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xvdWRLaXRNYW5hZ2VyLmN1cnJlbnRVc2VyPy5pc0FkbWluID09IHRydWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE5hdmlnYXRpb25TcGxpdFZpZXcgewogICAgICAgICAgICAgICAgTGlzdChhdmFpbGFibGVTZWN0aW9ucywgaWQ6IFwuc2VsZiwgc2VsZWN0aW9uOiAkc2VsZWN0ZWRTZWN0aW9uKSB7IHNlY3Rpb24gaW4KICAgICAgICAgICAgICAgICAgICBMYWJlbChzZWN0aW9uLnJhd1ZhbHVlLCBzeXN0ZW1JbWFnZTogc2VjdGlvbi5pY29uKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLm5hdmlnYXRpb25UaXRsZSgiTWFjQ2hhbiIpCiAgICAgICAgICAgIH0gZGV0YWlsOiB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggc2VsZWN0ZWRTZWN0aW9uIHsKICAgICAgICAgICAgICAgIGNhc2UgLmZvcnVtczoKICAgICAgICAgICAgICAgICAgICBGb3J1bUJyb3dzZXJWaWV3KCkKICAgICAgICAgICAgICAgIGNhc2UgLnJlY2VudDoKICAgICAgICAgICAgICAgICAgICBUZXh0KCJSZWNlbnQgUG9zdHMgQ29taW5nIFNvb24iKQogICAgICAgICAgICAgICAgY2FzZSAubWVzc2FnZXM6CiAgICAgICAgICAgICAgICAgICAgVGV4dCgiTWVzc2FnZXMgQ29taW5nIFNvb24iKQogICAgICAgICAgICAgICAgY2FzZSAuc2VhcmNoOgogICAgICAgICAgICAgICAgICAgIFRleHQoIlNlYXJjaCBDb21pbmcgU29vbiIpCiAgICAgICAgICAgICAgICBjYXNlIC5wcm9maWxlOgogICAgICAgICAgICAgICAgICAgIFRleHQoIlByb2ZpbGUgQ29taW5nIFNvb24iKQogICAgICAgICAgICAgICAgY2FzZSAuc2V0dGluZ3M6CiAgICAgICAgICAgICAgICAgICAgVGV4dCgiU2V0dGluZ3MgQ29taW5nIFNvb24iKQogICAgICAgICAgICAgICAgY2FzZSAuYWRtaW46CiAgICAgICAgICAgICAgICAgICAgQWRtaW5QYW5lbFZpZXcoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICNlbmRpZgogICAgICAgIH0KICAgIH0KfQoKI1ByZXZpZXcgewogICAgTWFpbkZvcnVtVmlldygpCiAgICAgICAgLmVudmlyb25tZW50T2JqZWN0KEF1dGhlbnRpY2F0aW9uTWFuYWdlci5zaGFyZWQpCiAgICAgICAgLmVudmlyb25tZW50T2JqZWN0KENsb3VkS2l0TWFuYWdlci5zaGFyZWQpCn0K
--- END ---

--- FILE: MacChan/Views/ProfileView.swift ---
BASE64: Ly8gLi4uIChyZXN0IG9mIGZpbGUgdW5jaGFuZ2VkKQppbXBvcnQgU3dpZnRVSQoKc3RydWN0IERlYnVnUGFuZWw6IFZpZXcgewogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaXNTZWVkaW5nID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc0NoZWNraW5nU2NoZW1hID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc0NsZWFyaW5nRGF0YSA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgbGFzdEFjdGlvbk1lc3NhZ2U6IFN0cmluZz8KCiAgICBARW52aXJvbm1lbnQoXC5kaXNtaXNzKSBwcml2YXRlIHZhciBkaXNtaXNzCgogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgVlN0YWNrIHsKICAgICAgICAgICAgU2Nyb2xsVmlldyB7CiAgICAgICAgICAgICAgICBMaXN0IHsKICAgICAgICAgICAgICAgICAgICBTZWN0aW9uKGhlYWRlcjogVGV4dCgiRGVidWcgQWN0aW9ucyIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiU2VlZCBGb3J1bXMiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYXNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1NlZWRpbmcgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmRlYnVnU2VlZEZvcnVtcygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTZWVkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0QWN0aW9uTWVzc2FnZSA9ICJTZWVkZWQgZm9ydW1zIHN1Y2Nlc3NmdWxseS4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLmRpc2FibGVkKGlzU2VlZGluZykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNTZWVkaW5nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFByb2dyZXNzVmlldygpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiQ2hlY2sgRm9ydW1zIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFzayB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmRlYnVnQ2hlY2tGb3J1bXMoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RBY3Rpb25NZXNzYWdlID0gIkNoZWNrZWQgZm9ydW1zLiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDaGVjayBDbG91ZEtpdCBTY2hlbWEiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYXNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0NoZWNraW5nU2NoZW1hID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsb3VkS2l0TWFuYWdlci5kZWJ1Z0NoZWNrQ2xvdWRLaXRTY2hlbWEoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ2hlY2tpbmdTY2hlbWEgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RBY3Rpb25NZXNzYWdlID0gIkNoZWNrZWQgQ2xvdWRLaXQgc2NoZW1hLiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAuZGlzYWJsZWQoaXNDaGVja2luZ1NjaGVtYSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNDaGVja2luZ1NjaGVtYSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQcm9ncmVzc1ZpZXcoKQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlByaW50IENsb3VkS2l0IENvbnNvbGUgRGF0YSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3VkS2l0TWFuYWdlci5kZWJ1Z1ByaW50Q2xvdWRLaXRDb25zb2xlRGF0YSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0QWN0aW9uTWVzc2FnZSA9ICJQcmludGVkIENsb3VkS2l0IGNvbnNvbGUgZGF0YS4iCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiQ2xlYXIgVXNlciBEYXRhIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGFzayB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNDbGVhcmluZ0RhdGEgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmRlYnVnQ2xlYXJVc2VyRGF0YSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNDbGVhcmluZ0RhdGEgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RBY3Rpb25NZXNzYWdlID0gIkNsZWFyZWQgdXNlciBkYXRhLiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5yZWQpCiAgICAgICAgICAgICAgICAgICAgICAgIC5kaXNhYmxlZChpc0NsZWFyaW5nRGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNDbGVhcmluZ0RhdGEgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJvZ3Jlc3NWaWV3KCkKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJGb3JjZSBEZWxldGUgUmVjb3JkcyIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRhc2sgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGNsb3VkS2l0TWFuYWdlci5kZWJ1Z0ZvcmNlRGVsZXRlUmVjb3JkcygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEFjdGlvbk1lc3NhZ2UgPSAiRm9yY2UgZGVsZXRlZCByZWNvcmRzLiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5yZWQpCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiBsZXQgbWVzc2FnZSA9IGxhc3RBY3Rpb25NZXNzYWdlIHsKICAgICAgICAgICAgICAgICAgICAgICAgU2VjdGlvbihoZWFkZXI6IFRleHQoIkxhc3QgQWN0aW9uIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQobWVzc2FnZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAubGlzdFN0eWxlKC5pbnNldCkgLy8gPC0tIEZJWEVEOiBpbnNldCB3b3JrcyBvbiBtYWNPUzsgaW5zZXRHcm91cGVkIGRvZXMgbm90CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEhTdGFjayB7CiAgICAgICAgICAgICAgICBTcGFjZXIoKQogICAgICAgICAgICAgICAgQnV0dG9uKCJDbG9zZSIpIHsKICAgICAgICAgICAgICAgICAgICBkaXNtaXNzKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5rZXlib2FyZFNob3J0Y3V0KC5jYW5jZWxBY3Rpb24pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnBhZGRpbmcoLmhvcml6b250YWwpCiAgICAgICAgICAgIC5wYWRkaW5nKC50b3AsIDgpCiAgICAgICAgfQogICAgICAgIC5mcmFtZShtaW5XaWR0aDogNDQwLCBtYXhXaWR0aDogNzAwLCBtaW5IZWlnaHQ6IDM0MCkKICAgIH0KfQo=
--- END ---

--- FILE: MacChan/Views/PostsListView.swift ---
BASE64: Ly8KLy8KLy8gIE5PVEUgVE8gREVWRUxPUEVSOiBUaGlzIGlzIHRoZSBtYWNPUy1zcGVjaWZpYyB2ZXJzaW9uIG9mIHRoaXMgdmlldy4KLy8gIE9ubHkgYWRkIG1hY09TL2Nyb3NzLXBsYXRmb3JtIGNvbXBhdGlibGUgY29kZSBoZXJlLiBEbyBub3QgYWRkIGlPUy1zcGVjaWZpYyBBUElzLgovLwoKLy8gIFBvc3RzTGlzdFZpZXcuc3dpZnQKLy8gIE1hY0NoYW4KLy8KLy8gIENyZWF0ZWQgYnkgSmFyZWQgTWF4d2VsbCBvbiA5LzMvMjUuCi8vCgppbXBvcnQgU3dpZnRVSQoKcHJpdmF0ZSBsZXQgZGF0ZUZvcm1hdHRlcjogRGF0ZUZvcm1hdHRlciA9IHsKICAgIGxldCBmb3JtYXR0ZXIgPSBEYXRlRm9ybWF0dGVyKCkKICAgIGZvcm1hdHRlci5kYXRlU3R5bGUgPSAubWVkaXVtCiAgICBmb3JtYXR0ZXIudGltZVN0eWxlID0gLm5vbmUKICAgIHJldHVybiBmb3JtYXR0ZXIKfSgpCgpzdHJ1Y3QgUG9zdHNMaXN0VmlldzogVmlldyB7CiAgICBsZXQgdGhyZWFkOiBGb3J1bVRocmVhZAogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgcG9zdHM6IFtGb3J1bVBvc3RdID0gW10KICAgIEBTdGF0ZSBwcml2YXRlIHZhciB1c2VyczogW1N0cmluZzogRm9ydW1Vc2VyXSA9IFs6XQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGlzTG9hZGluZyA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgZXJyb3JNZXNzYWdlOiBTdHJpbmc/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2hvd2luZ1JlcGx5ID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nUG9sbCA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgcG9sbDogRm9ydW1Qb2xsPwogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNlbGVjdGVkUG9zdDogRm9ydW1Qb3N0PwogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNob3dpbmdRdW90ZSA9IGZhbHNlCiAgICAKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIEdyb3VwIHsKICAgICAgICAgICAgaWYgaXNMb2FkaW5nIHsKICAgICAgICAgICAgICAgIFByb2dyZXNzVmlldygiTG9hZGluZyBwb3N0cy4uLiIpCiAgICAgICAgICAgICAgICAgICAgLmZyYW1lKG1heFdpZHRoOiAuaW5maW5pdHksIG1heEhlaWdodDogLmluZmluaXR5KQogICAgICAgICAgICB9IGVsc2UgaWYgcG9zdHMuaXNFbXB0eSB7CiAgICAgICAgICAgICAgICBWU3RhY2soc3BhY2luZzogMTYpIHsKICAgICAgICAgICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiAiYnViYmxlLmxlZnQuYW5kLmJ1YmJsZS5yaWdodCIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5zeXN0ZW0oc2l6ZTogNTApKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgVGV4dCgiTm8gcG9zdHMgeWV0IikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmhlYWRsaW5lKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgVGV4dCgiQmUgdGhlIGZpcnN0IHRvIHJlcGx5IikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIExpc3QgewogICAgICAgICAgICAgICAgICAgIC8vIFBvbGwgc2VjdGlvbgogICAgICAgICAgICAgICAgICAgIGlmIGxldCBwb2xsID0gcG9sbCB7CiAgICAgICAgICAgICAgICAgICAgICAgIFBvbGxWaWV3KHBvbGw6IHBvbGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubGlzdFJvd0luc2V0cyhFZGdlSW5zZXRzKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubGlzdFJvd1NlcGFyYXRvciguaGlkZGVuKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBQb3N0cwogICAgICAgICAgICAgICAgICAgIEZvckVhY2gocG9zdHMpIHsgcG9zdCBpbgogICAgICAgICAgICAgICAgICAgICAgICBQb3N0Um93VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3Q6IHBvc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB1c2Vyc1twb3N0LmF1dGhvcklEXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUXVvdGU6IHsgc2VsZWN0ZWRQb3N0ID0gcG9zdDsgc2hvd2luZ1F1b3RlID0gdHJ1ZSB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25MaWtlOiB7IGxpa2VQb3N0KHBvc3QpIH0KICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAubGlzdFJvd0luc2V0cyhFZGdlSW5zZXRzKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5saXN0Um93U2VwYXJhdG9yKC5oaWRkZW4pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC5uYXZpZ2F0aW9uVGl0bGUodGhyZWFkLnRpdGxlKQogICAgICAgIC50b29sYmFyIHsKICAgICAgICAgICAgVG9vbGJhckl0ZW0gewogICAgICAgICAgICAgICAgQnV0dG9uKCJSZXBseSIpIHsKICAgICAgICAgICAgICAgICAgICBzaG93aW5nUmVwbHkgPSB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAuZGlzYWJsZWQodGhyZWFkLmlzTG9ja2VkKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC5yZWZyZXNoYWJsZSB7CiAgICAgICAgICAgIGF3YWl0IGxvYWRQb3N0cygpCiAgICAgICAgfQogICAgICAgIC50YXNrIHsKICAgICAgICAgICAgYXdhaXQgbG9hZFBvc3RzKCkKICAgICAgICB9CiAgICAgICAgLnNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ1JlcGx5KSB7CiAgICAgICAgICAgIFJlcGx5Vmlldyh0aHJlYWQ6IHRocmVhZCkKICAgICAgICB9CiAgICAgICAgLnNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ1F1b3RlKSB7CiAgICAgICAgICAgIGlmIGxldCBzZWxlY3RlZFBvc3QgPSBzZWxlY3RlZFBvc3QgewogICAgICAgICAgICAgICAgUXVvdGVWaWV3KHRocmVhZDogdGhyZWFkLCBxdW90ZWRQb3N0OiBzZWxlY3RlZFBvc3QpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLmFsZXJ0KCJFcnJvciIsIGlzUHJlc2VudGVkOiAuY29uc3RhbnQoZXJyb3JNZXNzYWdlICE9IG5pbCkpIHsKICAgICAgICAgICAgQnV0dG9uKCJPSyIpIHsKICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IG5pbAogICAgICAgICAgICB9CiAgICAgICAgfSBtZXNzYWdlOiB7CiAgICAgICAgICAgIGlmIGxldCBlcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UgewogICAgICAgICAgICAgICAgVGV4dChlcnJvck1lc3NhZ2UpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBsb2FkUG9zdHMoKSBhc3luYyB7CiAgICAgICAgaXNMb2FkaW5nID0gdHJ1ZQogICAgICAgIGRvIHsKICAgICAgICAgICAgcG9zdHMgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmZldGNoUG9zdHMoZm9yOiB0aHJlYWQuaWQpCiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBMb2FkIHBvbGwgaWYgZXhpc3RzCiAgICAgICAgICAgIHBvbGwgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmZldGNoUG9sbChmb3I6IHRocmVhZC5pZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIExvYWQgdXNlcnMgZm9yIHBvc3RzCiAgICAgICAgICAgIGxldCB1c2VySWRzID0gU2V0KHBvc3RzLm1hcCB7ICQwLmF1dGhvcklEIH0pCiAgICAgICAgICAgIGZvciB1c2VySWQgaW4gdXNlcklkcyB7CiAgICAgICAgICAgICAgICBpZiBsZXQgdXNlciA9IHRyeT8gYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmZldGNoVXNlcih1c2VySWQpIHsKICAgICAgICAgICAgICAgICAgICB1c2Vyc1t1c2VySWRdID0gdXNlcgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICJGYWlsZWQgdG8gbG9hZCBwb3N0czogXChlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbikiCiAgICAgICAgfQogICAgICAgIGlzTG9hZGluZyA9IGZhbHNlCiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBsaWtlUG9zdChfIHBvc3Q6IEZvcnVtUG9zdCkgewogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGNsb3VkS2l0TWFuYWdlci5jdXJyZW50VXNlciBlbHNlIHsgcmV0dXJuIH0KICAgICAgICAKICAgICAgICBUYXNrIHsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci50b2dnbGVMaWtlKHBvc3RJRDogcG9zdC5pZCwgdXNlcklEOiBjdXJyZW50VXNlci5pZCwgaXNMaWtlOiB0cnVlKQogICAgICAgICAgICAgICAgYXdhaXQgbG9hZFBvc3RzKCkgLy8gUmVmcmVzaCB0byBzaG93IHVwZGF0ZWQgbGlrZSBjb3VudAogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICJGYWlsZWQgdG8gbGlrZSBwb3N0OiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKc3RydWN0IFBvc3RSb3dWaWV3OiBWaWV3IHsKICAgIGxldCBwb3N0OiBGb3J1bVBvc3QKICAgIGxldCB1c2VyOiBGb3J1bVVzZXI/CiAgICBsZXQgb25RdW90ZTogKCkgLT4gVm9pZAogICAgbGV0IG9uTGlrZTogKCkgLT4gVm9pZAogICAgCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2hvd2luZ0Z1bGxDb250ZW50ID0gZmFsc2UKICAgIAogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDEyKSB7CiAgICAgICAgICAgIC8vIFBvc3QgaGVhZGVyCiAgICAgICAgICAgIEhTdGFjayB7CiAgICAgICAgICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAubGVhZGluZywgc3BhY2luZzogNCkgewogICAgICAgICAgICAgICAgICAgIEhTdGFjayB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQodXNlcj8uZGlzcGxheU5hbWUgPz8gIlVua25vd24gVXNlciIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5wcmltYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGV0IHVzZXIgPSB1c2VyIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHVzZXIuaXNNb2RlcmF0b3IgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIk1PRCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnRXZWlnaHQoLmJvbGQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wYWRkaW5nKC5ob3Jpem9udGFsLCA0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucGFkZGluZygudmVydGljYWwsIDIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5iYWNrZ3JvdW5kKENvbG9yLmJsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLndoaXRlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHVzZXIuaXNBZG1pbiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCgiQURNSU4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250V2VpZ2h0KC5ib2xkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucGFkZGluZyguaG9yaXpvbnRhbCwgNCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoLnZlcnRpY2FsLCAyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5yZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLndoaXRlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgVGV4dCgiUG9zdCAjXChwb3N0LnBvc3ROdW1iZXIpIikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgU3BhY2VyKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLnRyYWlsaW5nLCBzcGFjaW5nOiA0KSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dChwb3N0LmNyZWF0ZWREYXRlLCBmb3JtYXR0ZXI6IGRhdGVGb3JtYXR0ZXIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgbGV0IGVkaXRlZERhdGUgPSBwb3N0LmVkaXRlZERhdGUgewogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KCJFZGl0ZWQgXChlZGl0ZWREYXRlLCBmb3JtYXR0ZXI6IGRhdGVGb3JtYXR0ZXIpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFBvc3QgY29udGVudAogICAgICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAubGVhZGluZywgc3BhY2luZzogOCkgewogICAgICAgICAgICAgICAgbGV0IHBhcnNlZENvbnRlbnQgPSBCQkNvZGVQYXJzZXIuc2hhcmVkLnBhcnNlKHBvc3QuY29udGVudCkKICAgICAgICAgICAgICAgIFRleHQocGFyc2VkQ29udGVudCkKICAgICAgICAgICAgICAgICAgICAuZm9udCguYm9keSkKICAgICAgICAgICAgICAgICAgICAubGluZUxpbWl0KHNob3dpbmdGdWxsQ29udGVudCA/IG5pbCA6IDEwKQogICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnByaW1hcnkpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHBvc3QuY29udGVudC5jb3VudCA+IDUwMCB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKHNob3dpbmdGdWxsQ29udGVudCA/ICJTaG93IExlc3MiIDogIlNob3cgTW9yZSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd2luZ0Z1bGxDb250ZW50LnRvZ2dsZSgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLmJsdWUpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFBvc3QgZm9vdGVyCiAgICAgICAgICAgIEhTdGFjayB7CiAgICAgICAgICAgICAgICBCdXR0b24oYWN0aW9uOiBvbkxpa2UpIHsKICAgICAgICAgICAgICAgICAgICBIU3RhY2soc3BhY2luZzogNCkgewogICAgICAgICAgICAgICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiAiaGVhcnQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIlwocG9zdC5saWtlQ291bnQpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgQnV0dG9uKCJRdW90ZSIpIHsKICAgICAgICAgICAgICAgICAgICBvblF1b3RlKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguYmx1ZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgU3BhY2VyKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgbGV0IHNpZ25hdHVyZSA9IHVzZXI/LnNpZ25hdHVyZSwgIXNpZ25hdHVyZS5pc0VtcHR5IHsKICAgICAgICAgICAgICAgICAgICBUZXh0KHNpZ25hdHVyZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICAgICAgLml0YWxpYygpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLnBhZGRpbmcoKQogICAgICAgIC5iYWNrZ3JvdW5kKENvbG9yLnByaW1hcnkub3BhY2l0eSgwLjA1KSkKICAgICAgICAuY29ybmVyUmFkaXVzKDgpCiAgICAgICAgLnNoYWRvdyhjb2xvcjogLmJsYWNrLm9wYWNpdHkoMC4xKSwgcmFkaXVzOiAyLCB4OiAwLCB5OiAxKQogICAgfQp9CgpzdHJ1Y3QgUG9sbFZpZXc6IFZpZXcgewogICAgbGV0IHBvbGw6IEZvcnVtUG9sbAogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaGFzVm90ZWQgPSBmYWxzZQogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNlbGVjdGVkT3B0aW9uczogU2V0PFN0cmluZz4gPSBbXQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGlzVm90aW5nID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBlcnJvck1lc3NhZ2U6IFN0cmluZz8KICAgIAogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDEyKSB7CiAgICAgICAgICAgIFRleHQocG9sbC5xdWVzdGlvbikKICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnByaW1hcnkpCiAgICAgICAgICAgIAogICAgICAgICAgICBGb3JFYWNoKHBvbGwub3B0aW9ucykgeyBvcHRpb24gaW4KICAgICAgICAgICAgICAgIFBvbGxPcHRpb25WaWV3KAogICAgICAgICAgICAgICAgICAgIG9wdGlvbjogb3B0aW9uLAogICAgICAgICAgICAgICAgICAgIHRvdGFsVm90ZXM6IHBvbGwudG90YWxWb3RlcywKICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkOiBzZWxlY3RlZE9wdGlvbnMuY29udGFpbnMob3B0aW9uLmlkKSwKICAgICAgICAgICAgICAgICAgICBpc1ZvdGVkOiBoYXNWb3RlZCwKICAgICAgICAgICAgICAgICAgICBvblNlbGVjdDogeyBzZWxlY3RPcHRpb24ob3B0aW9uLmlkKSB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICFoYXNWb3RlZCAmJiAhcG9sbC5vcHRpb25zLmlzRW1wdHkgewogICAgICAgICAgICAgICAgQnV0dG9uKCJWb3RlIikgewogICAgICAgICAgICAgICAgICAgIHN1Ym1pdFZvdGUoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLmJ1dHRvblN0eWxlKC5ib3JkZXJlZFByb21pbmVudCkKICAgICAgICAgICAgICAgIC5kaXNhYmxlZChzZWxlY3RlZE9wdGlvbnMuaXNFbXB0eSB8fCBpc1ZvdGluZykKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgaGFzVm90ZWQgewogICAgICAgICAgICAgICAgVGV4dCgiWW91IGhhdmUgdm90ZWQiKQogICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAucGFkZGluZygpCiAgICAgICAgLmJhY2tncm91bmQoQ29sb3IuZ3JheS5vcGFjaXR5KDAuMTUpKQogICAgICAgIC5jb3JuZXJSYWRpdXMoOCkKICAgICAgICAuYWxlcnQoIkVycm9yIiwgaXNQcmVzZW50ZWQ6IC5jb25zdGFudChlcnJvck1lc3NhZ2UgIT0gbmlsKSkgewogICAgICAgICAgICBCdXR0b24oIk9LIikgewogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gbmlsCiAgICAgICAgICAgIH0KICAgICAgICB9IG1lc3NhZ2U6IHsKICAgICAgICAgICAgaWYgbGV0IGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB7CiAgICAgICAgICAgICAgICBUZXh0KGVycm9yTWVzc2FnZSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIHNlbGVjdE9wdGlvbihfIG9wdGlvbklkOiBTdHJpbmcpIHsKICAgICAgICBpZiBwb2xsLmFsbG93TXVsdGlwbGVWb3RlcyB7CiAgICAgICAgICAgIGlmIHNlbGVjdGVkT3B0aW9ucy5jb250YWlucyhvcHRpb25JZCkgewogICAgICAgICAgICAgICAgc2VsZWN0ZWRPcHRpb25zLnJlbW92ZShvcHRpb25JZCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNlbGVjdGVkT3B0aW9ucy5pbnNlcnQob3B0aW9uSWQpCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZWxlY3RlZE9wdGlvbnMgPSBbb3B0aW9uSWRdCiAgICAgICAgfQogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgc3VibWl0Vm90ZSgpIHsKICAgICAgICBndWFyZCBjbG91ZEtpdE1hbmFnZXIuY3VycmVudFVzZXIgIT0gbmlsIGVsc2UgeyByZXR1cm4gfQogICAgICAgIAogICAgICAgIGlzVm90aW5nID0gdHJ1ZQogICAgICAgIAogICAgICAgIFRhc2sgewogICAgICAgICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHlvdSdkIGNyZWF0ZSBwb2xsIHZvdGVzCiAgICAgICAgICAgIC8vIEZvciBub3csIHdlJ2xsIGp1c3QgbWFyayBhcyB2b3RlZAogICAgICAgICAgICBhd2FpdCBNYWluQWN0b3IucnVuIHsKICAgICAgICAgICAgICAgIGhhc1ZvdGVkID0gdHJ1ZQogICAgICAgICAgICAgICAgaXNWb3RpbmcgPSBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgpzdHJ1Y3QgUG9sbE9wdGlvblZpZXc6IFZpZXcgewogICAgbGV0IG9wdGlvbjogUG9sbE9wdGlvbgogICAgbGV0IHRvdGFsVm90ZXM6IEludAogICAgbGV0IGlzU2VsZWN0ZWQ6IEJvb2wKICAgIGxldCBpc1ZvdGVkOiBCb29sCiAgICBsZXQgb25TZWxlY3Q6ICgpIC0+IFZvaWQKICAgIAogICAgcHJpdmF0ZSB2YXIgcGVyY2VudGFnZTogRG91YmxlIHsKICAgICAgICBndWFyZCB0b3RhbFZvdGVzID4gMCBlbHNlIHsgcmV0dXJuIDAgfQogICAgICAgIHJldHVybiBEb3VibGUob3B0aW9uLnZvdGVDb3VudCkgLyBEb3VibGUodG90YWxWb3RlcykgKiAxMDAKICAgIH0KICAgIAogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDQpIHsKICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgIEJ1dHRvbihhY3Rpb246IG9uU2VsZWN0KSB7CiAgICAgICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgSW1hZ2Uoc3lzdGVtTmFtZTogaXNTZWxlY3RlZCA/ICJjaGVja21hcmsuY2lyY2xlLmZpbGwiIDogImNpcmNsZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKGlzU2VsZWN0ZWQgPyAuYmx1ZSA6IC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KG9wdGlvbi50ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmJvZHkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5wcmltYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgU3BhY2VyKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAuZGlzYWJsZWQoaXNWb3RlZCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgaXNWb3RlZCB7CiAgICAgICAgICAgICAgICAgICAgVGV4dCgiXChvcHRpb24udm90ZUNvdW50KSB2b3RlcyAoXChTdHJpbmcoZm9ybWF0OiAiJS4xZiIsIHBlcmNlbnRhZ2UpKSUpIikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgaXNWb3RlZCB7CiAgICAgICAgICAgICAgICBHZW9tZXRyeVJlYWRlciB7IGdlb21ldHJ5IGluCiAgICAgICAgICAgICAgICAgICAgWlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgUmVjdGFuZ2xlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWxsKENvbG9yLmdyYXkub3BhY2l0eSgwLjMpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZyYW1lKGhlaWdodDogNCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb3JuZXJSYWRpdXMoMikKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIFJlY3RhbmdsZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsbChDb2xvci5ibHVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZyYW1lKHdpZHRoOiBnZW9tZXRyeS5zaXplLndpZHRoICogKHBlcmNlbnRhZ2UgLyAxMDApLCBoZWlnaHQ6IDQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLmZyYW1lKGhlaWdodDogNCkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKc3RydWN0IFJlcGx5VmlldzogVmlldyB7CiAgICBsZXQgdGhyZWFkOiBGb3J1bVRocmVhZAogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBARW52aXJvbm1lbnQoXC5kaXNtaXNzKSBwcml2YXRlIHZhciBkaXNtaXNzCiAgICAKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBjb250ZW50ID0gIiIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc1Bvc3RpbmcgPSBmYWxzZQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGVycm9yTWVzc2FnZTogU3RyaW5nPwogICAgCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBOYXZpZ2F0aW9uVmlldyB7CiAgICAgICAgICAgIFZTdGFjayB7CiAgICAgICAgICAgICAgICBUZXh0RWRpdG9yKHRleHQ6ICRjb250ZW50KQogICAgICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5wcmltYXJ5Lm9wYWNpdHkoMC4wNSkpCiAgICAgICAgICAgICAgICAgICAgLmNvcm5lclJhZGl1cyg4KQogICAgICAgICAgICAgICAgICAgIC5vdmVybGF5KAogICAgICAgICAgICAgICAgICAgICAgICBSb3VuZGVkUmVjdGFuZ2xlKGNvcm5lclJhZGl1czogOCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHJva2UoQ29sb3IuZ3JheS5vcGFjaXR5KDAuNCksIGxpbmVXaWR0aDogMSkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFNwYWNlcigpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJSZXBseSIpCiAgICAgICAgICAgIC50b29sYmFyIHsKICAgICAgICAgICAgICAgIFRvb2xiYXJJdGVtKHBsYWNlbWVudDogLmNhbmNlbGxhdGlvbkFjdGlvbikgewogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiQ2FuY2VsIikgewogICAgICAgICAgICAgICAgICAgICAgICBkaXNtaXNzKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgVG9vbGJhckl0ZW0ocGxhY2VtZW50OiAuY29uZmlybWF0aW9uQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJQb3N0IikgewogICAgICAgICAgICAgICAgICAgICAgICBwb3N0UmVwbHkoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAuZGlzYWJsZWQoY29udGVudC50cmltbWluZ0NoYXJhY3RlcnMoaW46IC53aGl0ZXNwYWNlc0FuZE5ld2xpbmVzKS5pc0VtcHR5IHx8IGlzUG9zdGluZykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAuYWxlcnQoIkVycm9yIiwgaXNQcmVzZW50ZWQ6IC5jb25zdGFudChlcnJvck1lc3NhZ2UgIT0gbmlsKSkgewogICAgICAgICAgICAgICAgQnV0dG9uKCJPSyIpIHsKICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBuaWwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBtZXNzYWdlOiB7CiAgICAgICAgICAgICAgICBpZiBsZXQgZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlIHsKICAgICAgICAgICAgICAgICAgICBUZXh0KGVycm9yTWVzc2FnZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIHBvc3RSZXBseSgpIHsKICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjbG91ZEtpdE1hbmFnZXIuY3VycmVudFVzZXIgZWxzZSB7IHJldHVybiB9CiAgICAgICAgCiAgICAgICAgaXNQb3N0aW5nID0gdHJ1ZQogICAgICAgIAogICAgICAgIFRhc2sgewogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICBsZXQgcG9zdCA9IEZvcnVtUG9zdCgKICAgICAgICAgICAgICAgICAgICB0aHJlYWRJRDogdGhyZWFkLmlkLAogICAgICAgICAgICAgICAgICAgIGF1dGhvcklEOiBjdXJyZW50VXNlci5pZCwKICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LAogICAgICAgICAgICAgICAgICAgIHBvc3ROdW1iZXI6IHRocmVhZC5wb3N0Q291bnQgKyAxCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIF8gPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNyZWF0ZVBvc3QocG9zdCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgZGlzbWlzcygpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkZhaWxlZCB0byBwb3N0IHJlcGx5OiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICAgICAgICAgICAgICBpc1Bvc3RpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CnN0cnVjdCBRdW90ZVZpZXc6IFZpZXcgewogICAgbGV0IHRocmVhZDogRm9ydW1UaHJlYWQKICAgIGxldCBxdW90ZWRQb3N0OiBGb3J1bVBvc3QKICAgIEBFbnZpcm9ubWVudE9iamVjdCBwcml2YXRlIHZhciBjbG91ZEtpdE1hbmFnZXI6IENsb3VkS2l0TWFuYWdlcgogICAgQEVudmlyb25tZW50KFwuZGlzbWlzcykgcHJpdmF0ZSB2YXIgZGlzbWlzcwogICAgCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgY29udGVudCA9ICIiCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaXNQb3N0aW5nID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBlcnJvck1lc3NhZ2U6IFN0cmluZz8KICAgIAogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgTmF2aWdhdGlvblZpZXcgewogICAgICAgICAgICBWU3RhY2sgewogICAgICAgICAgICAgICAgLy8gU2hvdyBxdW90ZWQgcG9zdAogICAgICAgICAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDgpIHsKICAgICAgICAgICAgICAgICAgICBUZXh0KCJRdW90aW5nOiIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgVGV4dChxdW90ZWRQb3N0LmNvbnRlbnQpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5ib2R5KQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgICAgICAgICAgICAgLmJhY2tncm91bmQoQ29sb3IuZ3JheS5vcGFjaXR5KDAuMTUpKQogICAgICAgICAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFJlcGx5IGNvbnRlbnQKICAgICAgICAgICAgICAgIFRleHRFZGl0b3IodGV4dDogJGNvbnRlbnQpCiAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAgICAgICAgIC5iYWNrZ3JvdW5kKENvbG9yLnByaW1hcnkub3BhY2l0eSgwLjA1KSkKICAgICAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDgpCiAgICAgICAgICAgICAgICAgICAgLm92ZXJsYXkoCiAgICAgICAgICAgICAgICAgICAgICAgIFJvdW5kZWRSZWN0YW5nbGUoY29ybmVyUmFkaXVzOiA4KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnN0cm9rZShDb2xvci5ncmF5Lm9wYWNpdHkoMC40KSwgbGluZVdpZHRoOiAxKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgU3BhY2VyKCkKICAgICAgICAgICAgfQogICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgIC5uYXZpZ2F0aW9uVGl0bGUoIlF1b3RlIFJlcGx5IikKICAgICAgICAgICAgLnRvb2xiYXIgewogICAgICAgICAgICAgICAgVG9vbGJhckl0ZW0ocGxhY2VtZW50OiAuY2FuY2VsbGF0aW9uQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDYW5jZWwiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc21pc3MoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBUb29sYmFySXRlbShwbGFjZW1lbnQ6IC5jb25maXJtYXRpb25BY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlBvc3QiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RRdW90ZVJlcGx5KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLmRpc2FibGVkKGNvbnRlbnQudHJpbW1pbmdDaGFyYWN0ZXJzKGluOiAud2hpdGVzcGFjZXNBbmROZXdsaW5lcykuaXNFbXB0eSB8fCBpc1Bvc3RpbmcpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLmFsZXJ0KCJFcnJvciIsIGlzUHJlc2VudGVkOiAuY29uc3RhbnQoZXJyb3JNZXNzYWdlICE9IG5pbCkpIHsKICAgICAgICAgICAgICAgIEJ1dHRvbigiT0siKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gbmlsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gbWVzc2FnZTogewogICAgICAgICAgICAgICAgaWYgbGV0IGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dChlcnJvck1lc3NhZ2UpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLm9uQXBwZWFyIHsKICAgICAgICAgICAgICAgIGNvbnRlbnQgPSAiW3F1b3RlXVwocXVvdGVkUG9zdC5jb250ZW50KVsvcXVvdGVdXG5cbiIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIHBvc3RRdW90ZVJlcGx5KCkgewogICAgICAgIGd1YXJkIGxldCBjdXJyZW50VXNlciA9IGNsb3VkS2l0TWFuYWdlci5jdXJyZW50VXNlciBlbHNlIHsgcmV0dXJuIH0KICAgICAgICAKICAgICAgICBpc1Bvc3RpbmcgPSB0cnVlCiAgICAgICAgCiAgICAgICAgVGFzayB7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIGxldCBwb3N0ID0gRm9ydW1Qb3N0KAogICAgICAgICAgICAgICAgICAgIHRocmVhZElEOiB0aHJlYWQuaWQsCiAgICAgICAgICAgICAgICAgICAgYXV0aG9ySUQ6IGN1cnJlbnRVc2VyLmlkLAogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsCiAgICAgICAgICAgICAgICAgICAgcXVvdGVkUG9zdElEczogW3F1b3RlZFBvc3QuaWRdLAogICAgICAgICAgICAgICAgICAgIHBvc3ROdW1iZXI6IHRocmVhZC5wb3N0Q291bnQgKyAxCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIF8gPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNyZWF0ZVBvc3QocG9zdCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgZGlzbWlzcygpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkZhaWxlZCB0byBwb3N0IHF1b3RlIHJlcGx5OiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICAgICAgICAgICAgICBpc1Bvc3RpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgojUHJldmlldyB7CiAgICBOYXZpZ2F0aW9uVmlldyB7CiAgICAgICAgUG9zdHNMaXN0Vmlldyh0aHJlYWQ6IEZvcnVtVGhyZWFkKHRpdGxlOiAiVGVzdCBUaHJlYWQiLCBmb3J1bUlEOiAiZm9ydW0xIiwgYXV0aG9ySUQ6ICJ1c2VyMSIsIGxhc3RQb3N0VXNlcklEOiAidXNlcjEiKSkKICAgICAgICAgICAgLmVudmlyb25tZW50T2JqZWN0KENsb3VkS2l0TWFuYWdlci5zaGFyZWQpCiAgICB9Cn0K
--- END ---

--- FILE: MacChan/Views/ForumBrowserView.swift ---
BASE64: aW1wb3J0IFN3aWZ0VUkKaW1wb3J0IENsb3VkS2l0CgpzdHJ1Y3QgRm9ydW1Ccm93c2VyVmlldzogVmlldyB7CiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBPYnNlcnZlZE9iamVjdCBwcml2YXRlIHZhciBzZXR0aW5ncyA9IFVzZXJTZXR0aW5nc1N0b3JlLnNoYXJlZAoKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBmb3J1bXM6IFtGb3J1bV0gPSBbXQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGlzTG9hZGluZyA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgZXJyb3JNZXNzYWdlOiBTdHJpbmc/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRGb3J1bTogRm9ydW0/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2hvd2luZ05ld1RocmVhZCA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2hvd2luZ05ld0ZvcnVtID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nRm9ydW1NYW5hZ2VtZW50ID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBuYXZpZ2F0aW9uUGF0aCA9IE5hdmlnYXRpb25QYXRoKCkKCiAgICBwcml2YXRlIHZhciBpc0N1cnJlbnRVc2VyQWRtaW46IEJvb2wgewogICAgICAgIGNsb3VkS2l0TWFuYWdlci5jdXJyZW50VXNlcj8uaXNBZG1pbiA/PyBmYWxzZQogICAgfQoKICAgIC8vIEZpbHRlciBmb3J1bXMsIGhpZGluZyBOU0ZXIGlmIHVzZXIgZG9lc24ndCB3YW50IHRvIHNlZSB0aGVtCiAgICBwcml2YXRlIHZhciBmaWx0ZXJlZEZvcnVtczogW0ZvcnVtXSB7CiAgICAgICAgZm9ydW1zLmZpbHRlciB7IGZvcnVtIGluCiAgICAgICAgICAgIHNldHRpbmdzLnNob3dOU0ZXIHx8ICFmb3J1bS5pc05TRlcKICAgICAgICB9CiAgICB9CgogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgTmF2aWdhdGlvblN0YWNrKHBhdGg6ICRuYXZpZ2F0aW9uUGF0aCkgewogICAgICAgICAgICBHcm91cCB7CiAgICAgICAgICAgICAgICBpZiBpc0xvYWRpbmcgewogICAgICAgICAgICAgICAgICAgIFByb2dyZXNzVmlldygiTG9hZGluZyBmb3J1bXMuLi4iKQogICAgICAgICAgICAgICAgICAgICAgICAuZnJhbWUobWF4V2lkdGg6IC5pbmZpbml0eSwgbWF4SGVpZ2h0OiAuaW5maW5pdHkpCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgZmlsdGVyZWRGb3J1bXMuaXNFbXB0eSB7CiAgICAgICAgICAgICAgICAgICAgVlN0YWNrKHNwYWNpbmc6IDE2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6ICJmb2xkZXIuZmlsbCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguc3lzdGVtKHNpemU6IDUwKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIk5vIGZvcnVtcyBhdmFpbGFibGUiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmhlYWRsaW5lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNDdXJyZW50VXNlckFkbWluIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZTdGFjayhzcGFjaW5nOiAxMikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIkFzIGFuIGFkbWluaXN0cmF0b3IsIHlvdSBjYW4gY3JlYXRlIHRoZSBmaXJzdCBmb3J1bToiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguc3ViaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm11bHRpbGluZVRleHRBbGlnbm1lbnQoLmNlbnRlcikKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVlN0YWNrKHNwYWNpbmc6IDgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDcmVhdGUgTmV3IEZvcnVtIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd2luZ05ld0ZvcnVtID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5idXR0b25TdHlsZSguYm9yZGVyZWRQcm9taW5lbnQpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlNlZWQgRGVmYXVsdCBGb3J1bXMiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUYXNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuZGVidWdTZWVkRm9ydW1zKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBsb2FkRm9ydW1zKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYnV0dG9uU3R5bGUoLmJvcmRlcmVkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIlBsZWFzZSBhc2sgYW4gYWRtaW5pc3RyYXRvciB0byBjcmVhdGUgZm9ydW1zIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguc3ViaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tdWx0aWxpbmVUZXh0QWxpZ25tZW50KC5jZW50ZXIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBTY3JvbGxWaWV3IHsKICAgICAgICAgICAgICAgICAgICAgICAgVlN0YWNrKHNwYWNpbmc6IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZvckVhY2goZ3JvdXBlZEZvcnVtcy5rZXlzLnNvcnRlZCgpLCBpZDogXC5zZWxmKSB7IHBhcmVudElkIGluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGV0IHBhcmVudEZvcnVtID0gZmlsdGVyZWRGb3J1bXMuZmlyc3Qod2hlcmU6IHsgJDAuaWQgPT0gcGFyZW50SWQgfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN1YmZvcnVtcyA9IGdyb3VwZWRGb3J1bXNbcGFyZW50SWRdIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRm9ydW1TZWN0aW9uVmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudEZvcnVtOiBwYXJlbnRGb3J1bSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmZvcnVtczogc3ViZm9ydW1zLmZpbHRlciB7IHNldHRpbmdzLnNob3dOU0ZXIHx8ICEkMC5pc05TRlcgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRm9ydW1TZWxlY3RlZDogeyBmb3J1bSBpbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRpb25QYXRoLmFwcGVuZChmb3J1bSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJGb3J1bXMiKQogICAgICAgICAgICAjaWYgb3MoaU9TKQogICAgICAgICAgICAubmF2aWdhdGlvbkJhclRpdGxlRGlzcGxheU1vZGUoLmlubGluZSkKICAgICAgICAgICAgI2VuZGlmCiAgICAgICAgICAgIC50b29sYmFyIHsKICAgICAgICAgICAgICAgIFRvb2xiYXJJdGVtIHsKICAgICAgICAgICAgICAgICAgICBCdXR0b24oIk5ldyBUaHJlYWQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dpbmdOZXdUaHJlYWQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC5kaXNhYmxlZChzZWxlY3RlZEZvcnVtID09IG5pbCkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBBZG1pbiB0b29sYmFyIGl0ZW1zCiAgICAgICAgICAgICAgICBpZiBpc0N1cnJlbnRVc2VyQWRtaW4gewogICAgICAgICAgICAgICAgICAgIFRvb2xiYXJJdGVtIHsKICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJOZXcgRm9ydW0iKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93aW5nTmV3Rm9ydW0gPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIFRvb2xiYXJJdGVtIHsKICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJNYW5hZ2UgRm9ydW1zIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd2luZ0ZvcnVtTWFuYWdlbWVudCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ05ld1RocmVhZCkgewogICAgICAgICAgICAgICAgaWYgbGV0IGZvcnVtID0gc2VsZWN0ZWRGb3J1bSB7CiAgICAgICAgICAgICAgICAgICAgTmV3VGhyZWFkVmlldyhmb3J1bTogZm9ydW0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ05ld0ZvcnVtKSB7CiAgICAgICAgICAgICAgICBOZXdGb3J1bVZpZXcob25Gb3J1bUNyZWF0ZWQ6IHsKICAgICAgICAgICAgICAgICAgICBUYXNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgbG9hZEZvcnVtcygpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICAuc2hlZXQoaXNQcmVzZW50ZWQ6ICRzaG93aW5nRm9ydW1NYW5hZ2VtZW50KSB7CiAgICAgICAgICAgICAgICBGb3J1bU1hbmFnZW1lbnRWaWV3KGZvcnVtczogZm9ydW1zLCBvbkZvcnVtc1VwZGF0ZWQ6IHsKICAgICAgICAgICAgICAgICAgICBUYXNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgbG9hZEZvcnVtcygpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICAuYWxlcnQoIkVycm9yIiwgaXNQcmVzZW50ZWQ6IC5jb25zdGFudChlcnJvck1lc3NhZ2UgIT0gbmlsKSkgewogICAgICAgICAgICAgICAgQnV0dG9uKCJPSyIpIHsKICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBuaWwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBtZXNzYWdlOiB7CiAgICAgICAgICAgICAgICBpZiBsZXQgZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlIHsKICAgICAgICAgICAgICAgICAgICBUZXh0KGVycm9yTWVzc2FnZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAubmF2aWdhdGlvbkRlc3RpbmF0aW9uKGZvcjogRm9ydW0uc2VsZikgeyBmb3J1bSBpbgogICAgICAgICAgICAgICAgVGhyZWFkQnJvd3NlclZpZXcoZm9ydW06IGZvcnVtKQogICAgICAgICAgICB9CiAgICAgICAgICAgIC50YXNrIHsKICAgICAgICAgICAgICAgIGF3YWl0IGxvYWRGb3J1bXMoKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdmFyIGdyb3VwZWRGb3J1bXM6IFtTdHJpbmc6IFtGb3J1bV1dIHsKICAgICAgICB2YXIgZ3JvdXBzOiBbU3RyaW5nOiBbRm9ydW1dXSA9IFs6XQogICAgICAgIGZvciBmb3J1bSBpbiBmaWx0ZXJlZEZvcnVtcyB7CiAgICAgICAgICAgIGlmIGxldCBwYXJlbnRJZCA9IGZvcnVtLnBhcmVudEZvcnVtSUQgewogICAgICAgICAgICAgICAgZ3JvdXBzW3BhcmVudElkLCBkZWZhdWx0OiBbXV0uYXBwZW5kKGZvcnVtKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgZ3JvdXBzW2ZvcnVtLmlkXSA9PSBuaWwgewogICAgICAgICAgICAgICAgICAgIGdyb3Vwc1tmb3J1bS5pZF0gPSBbXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBncm91cHMKICAgIH0KCiAgICBwcml2YXRlIGZ1bmMgbG9hZEZvcnVtcygpIGFzeW5jIHsKICAgICAgICBpc0xvYWRpbmcgPSB0cnVlCiAgICAgICAgZG8gewogICAgICAgICAgICBmb3J1bXMgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmZldGNoRm9ydW1zKCkKICAgICAgICB9IGNhdGNoIGxldCBlcnJvciBhcyBDS0Vycm9yIHsKICAgICAgICAgICAgaWYgZXJyb3IuY29kZSA9PSAudW5rbm93bkl0ZW0gfHwgZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24uY29udGFpbnMoIkRpZCBub3QgZmluZCByZWNvcmQgdHlwZSIpIHsKICAgICAgICAgICAgICAgIGZvcnVtcyA9IFtdCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAiRmFpbGVkIHRvIGxvYWQgZm9ydW1zOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAiRmFpbGVkIHRvIGxvYWQgZm9ydW1zOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICB9CiAgICAgICAgaXNMb2FkaW5nID0gZmFsc2UKICAgIH0KfQo=
--- END ---

--- FILE: MacChan/Views/ThreadsListView.swift ---
BASE64: Ly8KLy8KLy8gIE5PVEUgVE8gREVWRUxPUEVSOiBUaGlzIGlzIHRoZSBtYWNPUy1zcGVjaWZpYyB2ZXJzaW9uIG9mIHRoaXMgdmlldy4KLy8gIE9ubHkgYWRkIG1hY09TL2Nyb3NzLXBsYXRmb3JtIGNvbXBhdGlibGUgY29kZSBoZXJlLiBEbyBub3QgYWRkIGlPUy1zcGVjaWZpYyBBUElzLgovLwoKLy8gIFRocmVhZHNMaXN0Vmlldy5zd2lmdAovLyAgTWFjQ2hhbgovLwovLyAgQ3JlYXRlZCBieSBKYXJlZCBNYXh3ZWxsIG9uIDkvMy8yNS4KLy8KCmltcG9ydCBTd2lmdFVJCgpzdHJ1Y3QgVGhyZWFkc0xpc3RWaWV3OiBWaWV3IHsKICAgIGxldCBmb3J1bTogRm9ydW0KICAgIEBFbnZpcm9ubWVudE9iamVjdCBwcml2YXRlIHZhciBjbG91ZEtpdE1hbmFnZXI6IENsb3VkS2l0TWFuYWdlcgogICAgQFN0YXRlIHByaXZhdGUgdmFyIHRocmVhZHM6IFtGb3J1bVRocmVhZF0gPSBbXQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGlzTG9hZGluZyA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgZXJyb3JNZXNzYWdlOiBTdHJpbmc/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2hvd2luZ05ld1RocmVhZCA9IGZhbHNlCiAgICAKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIFpTdGFjayB7CiAgICAgICAgICAgIGlmIGlzTG9hZGluZyB7CiAgICAgICAgICAgICAgICBQcm9ncmVzc1ZpZXcoIkxvYWRpbmcgdGhyZWFkcy4uLiIpCiAgICAgICAgICAgICAgICAgICAgLmZyYW1lKG1heFdpZHRoOiAuaW5maW5pdHksIG1heEhlaWdodDogLmluZmluaXR5KQogICAgICAgICAgICB9IGVsc2UgaWYgdGhyZWFkcy5pc0VtcHR5IHsKICAgICAgICAgICAgICAgIFZTdGFjayhzcGFjaW5nOiAxNikgewogICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6ICJidWJibGUubGVmdC5hbmQuYnViYmxlLnJpZ2h0IikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLnN5c3RlbShzaXplOiA1MCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICBUZXh0KCJObyB0aHJlYWRzIHlldCIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIFRleHQoIkJlIHRoZSBmaXJzdCB0byBzdGFydCBhIGRpc2N1c3Npb24iKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiQ3JlYXRlIFRocmVhZCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd2luZ05ld1RocmVhZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLmJ1dHRvblN0eWxlKC5ib3JkZXJlZFByb21pbmVudCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIExpc3QgewogICAgICAgICAgICAgICAgICAgIEZvckVhY2godGhyZWFkcykgeyB0aHJlYWQgaW4KICAgICAgICAgICAgICAgICAgICAgICAgTmF2aWdhdGlvbkxpbmsoZGVzdGluYXRpb246IFBvc3RzTGlzdFZpZXcodGhyZWFkOiB0aHJlYWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaHJlYWRSb3dWaWV3KHRocmVhZDogdGhyZWFkLCBvblRhcDoge30pCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLm5hdmlnYXRpb25UaXRsZShmb3J1bS5uYW1lKQogICAgICAgIC50b29sYmFyIHsKICAgICAgICAgICAgVG9vbGJhckl0ZW0gewogICAgICAgICAgICAgICAgQnV0dG9uKCJOZXcgVGhyZWFkIikgewogICAgICAgICAgICAgICAgICAgIHNob3dpbmdOZXdUaHJlYWQgPSB0cnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAuZGlzYWJsZWQoZm9ydW0uaXNMb2NrZWQpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLnJlZnJlc2hhYmxlIHsKICAgICAgICAgICAgYXdhaXQgbG9hZFRocmVhZHMoKQogICAgICAgIH0KICAgICAgICAudGFzayB7CiAgICAgICAgICAgIGF3YWl0IGxvYWRUaHJlYWRzKCkKICAgICAgICB9CiAgICAgICAgLnNoZWV0KGlzUHJlc2VudGVkOiAkc2hvd2luZ05ld1RocmVhZCkgewogICAgICAgICAgICBDcmVhdGVUaHJlYWRWaWV3KGZvcnVtOiBmb3J1bSkKICAgICAgICB9CiAgICAgICAgLmFsZXJ0KCJFcnJvciIsIGlzUHJlc2VudGVkOiAuY29uc3RhbnQoZXJyb3JNZXNzYWdlICE9IG5pbCkpIHsKICAgICAgICAgICAgQnV0dG9uKCJPSyIpIHsKICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IG5pbAogICAgICAgICAgICB9CiAgICAgICAgfSBtZXNzYWdlOiB7CiAgICAgICAgICAgIGlmIGxldCBlcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UgewogICAgICAgICAgICAgICAgVGV4dChlcnJvck1lc3NhZ2UpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBsb2FkVGhyZWFkcygpIGFzeW5jIHsKICAgICAgICBpc0xvYWRpbmcgPSB0cnVlCiAgICAgICAgZG8gewogICAgICAgICAgICB0aHJlYWRzID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5mZXRjaFRocmVhZHMoZm9yOiBmb3J1bS5pZCkKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkZhaWxlZCB0byBsb2FkIHRocmVhZHM6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIgogICAgICAgIH0KICAgICAgICBpc0xvYWRpbmcgPSBmYWxzZQogICAgfQp9CgpzdHJ1Y3QgQ3JlYXRlVGhyZWFkVmlldzogVmlldyB7CiAgICBsZXQgZm9ydW06IEZvcnVtCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBFbnZpcm9ubWVudChcLmRpc21pc3MpIHByaXZhdGUgdmFyIGRpc21pc3MKICAgIAogICAgQFN0YXRlIHByaXZhdGUgdmFyIHRpdGxlID0gIiIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBjb250ZW50ID0gIiIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciB0YWdzOiBbU3RyaW5nXSA9IFtdCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgbmV3VGFnID0gIiIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc0NyZWF0aW5nID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBlcnJvck1lc3NhZ2U6IFN0cmluZz8KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nUG9sbCA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgcG9sbFF1ZXN0aW9uID0gIiIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBwb2xsT3B0aW9uczogW1N0cmluZ10gPSBbIiIsICIiXQogICAgCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBOYXZpZ2F0aW9uVmlldyB7CiAgICAgICAgICAgIEZvcm0gewogICAgICAgICAgICAgICAgU2VjdGlvbigiVGhyZWFkIERldGFpbHMiKSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dEZpZWxkKCJUaHJlYWQgVGl0bGUiLCB0ZXh0OiAkdGl0bGUpCiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0RmllbGRTdHlsZShSb3VuZGVkQm9yZGVyVGV4dEZpZWxkU3R5bGUoKSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBUZXh0RmllbGQoIkNvbnRlbnQiLCB0ZXh0OiAkY29udGVudCwgYXhpczogLnZlcnRpY2FsKQogICAgICAgICAgICAgICAgICAgICAgICAudGV4dEZpZWxkU3R5bGUoUm91bmRlZEJvcmRlclRleHRGaWVsZFN0eWxlKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5saW5lTGltaXQoNS4uLjEwKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBTZWN0aW9uKCJUYWdzIikgewogICAgICAgICAgICAgICAgICAgIEZvckVhY2godGFncywgaWQ6IFwuc2VsZikgeyB0YWcgaW4KICAgICAgICAgICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQodGFnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgU3BhY2VyKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiUmVtb3ZlIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3MucmVtb3ZlQWxsIHsgJDAgPT0gdGFnIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnJlZCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBIU3RhY2sgewogICAgICAgICAgICAgICAgICAgICAgICBUZXh0RmllbGQoIkFkZCB0YWciLCB0ZXh0OiAkbmV3VGFnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRGaWVsZFN0eWxlKFJvdW5kZWRCb3JkZXJUZXh0RmllbGRTdHlsZSgpKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJBZGQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAhbmV3VGFnLnRyaW1taW5nQ2hhcmFjdGVycyhpbjogLndoaXRlc3BhY2VzQW5kTmV3bGluZXMpLmlzRW1wdHkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3MuYXBwZW5kKG5ld1RhZy50cmltbWluZ0NoYXJhY3RlcnMoaW46IC53aGl0ZXNwYWNlc0FuZE5ld2xpbmVzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdUYWcgPSAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC5kaXNhYmxlZChuZXdUYWcudHJpbW1pbmdDaGFyYWN0ZXJzKGluOiAud2hpdGVzcGFjZXNBbmROZXdsaW5lcykuaXNFbXB0eSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFNlY3Rpb24oIlBvbGwgKE9wdGlvbmFsKSIpIHsKICAgICAgICAgICAgICAgICAgICBUb2dnbGUoIkluY2x1ZGUgUG9sbCIsIGlzT246ICRzaG93aW5nUG9sbCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBzaG93aW5nUG9sbCB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRGaWVsZCgiUG9sbCBRdWVzdGlvbiIsIHRleHQ6ICRwb2xsUXVlc3Rpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dEZpZWxkU3R5bGUoUm91bmRlZEJvcmRlclRleHRGaWVsZFN0eWxlKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBGb3JFYWNoKHBvbGxPcHRpb25zLmluZGljZXMsIGlkOiBcLnNlbGYpIHsgaW5kZXggaW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRGaWVsZCgiT3B0aW9uIFwoaW5kZXggKyAxKSIsIHRleHQ6ICRwb2xsT3B0aW9uc1tpbmRleF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRGaWVsZFN0eWxlKFJvdW5kZWRCb3JkZXJUZXh0RmllbGRTdHlsZSgpKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBCdXR0b24oIkFkZCBPcHRpb24iKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xsT3B0aW9ucy5hcHBlbmQoIiIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBvbGxPcHRpb25zLmNvdW50ID4gMiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlJlbW92ZSBMYXN0IE9wdGlvbiIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2xsT3B0aW9ucy5yZW1vdmVMYXN0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnJlZCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJOZXcgVGhyZWFkIikKICAgICAgICAgICAgLnRvb2xiYXIgewogICAgICAgICAgICAgICAgVG9vbGJhckl0ZW0gewogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiQ2FuY2VsIikgewogICAgICAgICAgICAgICAgICAgICAgICBkaXNtaXNzKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgVG9vbGJhckl0ZW0gewogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiQ3JlYXRlIikgewogICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVUaHJlYWQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAuZGlzYWJsZWQodGl0bGUuaXNFbXB0eSB8fCBjb250ZW50LmlzRW1wdHkgfHwgaXNDcmVhdGluZykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAuYWxlcnQoIkVycm9yIiwgaXNQcmVzZW50ZWQ6IC5jb25zdGFudChlcnJvck1lc3NhZ2UgIT0gbmlsKSkgewogICAgICAgICAgICAgICAgQnV0dG9uKCJPSyIpIHsKICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBuaWwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBtZXNzYWdlOiB7CiAgICAgICAgICAgICAgICBpZiBsZXQgZXJyb3JNZXNzYWdlID0gZXJyb3JNZXNzYWdlIHsKICAgICAgICAgICAgICAgICAgICBUZXh0KGVycm9yTWVzc2FnZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGNyZWF0ZVRocmVhZCgpIHsKICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjbG91ZEtpdE1hbmFnZXIuY3VycmVudFVzZXIgZWxzZSB7IHJldHVybiB9CiAgICAgICAgCiAgICAgICAgaXNDcmVhdGluZyA9IHRydWUKICAgICAgICAKICAgICAgICBUYXNrIHsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSB0aHJlYWQKICAgICAgICAgICAgICAgIGxldCB0aHJlYWQgPSBGb3J1bVRocmVhZCgKICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAgICAgICAgICAgICAgZm9ydW1JRDogZm9ydW0uaWQsCiAgICAgICAgICAgICAgICAgICAgYXV0aG9ySUQ6IGN1cnJlbnRVc2VyLmlkLAogICAgICAgICAgICAgICAgICAgIGxhc3RQb3N0VXNlcklEOiBjdXJyZW50VXNlci5pZCwKICAgICAgICAgICAgICAgICAgICB0YWdzOiB0YWdzCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxldCBjcmVhdGVkVGhyZWFkID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5jcmVhdGVUaHJlYWQodGhyZWFkKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGluaXRpYWwgcG9zdAogICAgICAgICAgICAgICAgbGV0IHBvc3QgPSBGb3J1bVBvc3QoCiAgICAgICAgICAgICAgICAgICAgdGhyZWFkSUQ6IGNyZWF0ZWRUaHJlYWQuaWQsCiAgICAgICAgICAgICAgICAgICAgYXV0aG9ySUQ6IGN1cnJlbnRVc2VyLmlkLAogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsCiAgICAgICAgICAgICAgICAgICAgcG9zdE51bWJlcjogMQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBfID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5jcmVhdGVQb3N0KHBvc3QpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBwb2xsIGlmIHJlcXVlc3RlZAogICAgICAgICAgICAgICAgaWYgc2hvd2luZ1BvbGwgJiYgIXBvbGxRdWVzdGlvbi5pc0VtcHR5IHsKICAgICAgICAgICAgICAgICAgICBsZXQgdmFsaWRPcHRpb25zID0gcG9sbE9wdGlvbnMuY29tcGFjdE1hcCB7IG9wdGlvbiBpbgogICAgICAgICAgICAgICAgICAgICAgICBsZXQgdHJpbW1lZCA9IG9wdGlvbi50cmltbWluZ0NoYXJhY3RlcnMoaW46IC53aGl0ZXNwYWNlc0FuZE5ld2xpbmVzKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJpbW1lZC5pc0VtcHR5ID8gbmlsIDogUG9sbE9wdGlvbih0ZXh0OiB0cmltbWVkKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAhdmFsaWRPcHRpb25zLmlzRW1wdHkgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgcG9sbCA9IEZvcnVtUG9sbCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhZElEOiBjcmVhdGVkVGhyZWFkLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb246IHBvbGxRdWVzdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHZhbGlkT3B0aW9ucywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRCeVVzZXJJRDogY3VycmVudFVzZXIuaWQKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgXyA9IHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIuY3JlYXRlUG9sbChwb2xsKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgZGlzbWlzcygpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkZhaWxlZCB0byBjcmVhdGUgdGhyZWFkOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICAgICAgICAgICAgICBpc0NyZWF0aW5nID0gZmFsc2UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLy8gTUFSSzogLSBEYXRlIEZvcm1hdHRlcnMKCnByaXZhdGUgbGV0IGRhdGVGb3JtYXR0ZXI6IERhdGVGb3JtYXR0ZXIgPSB7CiAgICBsZXQgZm9ybWF0dGVyID0gRGF0ZUZvcm1hdHRlcigpCiAgICBmb3JtYXR0ZXIuZGF0ZVN0eWxlID0gLm1lZGl1bQogICAgZm9ybWF0dGVyLnRpbWVTdHlsZSA9IC5zaG9ydAogICAgcmV0dXJuIGZvcm1hdHRlcgp9KCkKCiNQcmV2aWV3IHsKICAgIE5hdmlnYXRpb25WaWV3IHsKICAgICAgICBUaHJlYWRzTGlzdFZpZXcoZm9ydW06IEZvcnVtKG5hbWU6ICJHZW5lcmFsIERpc2N1c3Npb24iLCBkZXNjcmlwdGlvbjogIlRhbGsgYWJvdXQgYW55dGhpbmciLCBjcmVhdGVkQnlVc2VySUQ6ICJ1c2VyMSIpKQogICAgICAgICAgICAuZW52aXJvbm1lbnRPYmplY3QoQ2xvdWRLaXRNYW5hZ2VyLnNoYXJlZCkKICAgIH0KfQo=
--- END ---

--- FILE: MacChan/Views/ModerationViews.swift ---
BASE64: aW1wb3J0IFN3aWZ0VUkKCnN0cnVjdCBNb2RlcmF0aW9uUGFuZWxWaWV3OiBWaWV3IHsKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIE5hdmlnYXRpb25WaWV3IHsKICAgICAgICAgICAgRm9ybSB7CiAgICAgICAgICAgICAgICBTZWN0aW9uKCJVc2VyIE1hbmFnZW1lbnQiKSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dCgiQmFuIFVzZXJzIikKICAgICAgICAgICAgICAgICAgICBUZXh0KCJVbmJhbiBVc2VycyIpCiAgICAgICAgICAgICAgICAgICAgVGV4dCgiVXNlciBSZXBvcnRzIikKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBTZWN0aW9uKCJDb250ZW50IE1vZGVyYXRpb24iKSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dCgiUmVwb3J0ZWQgUG9zdHMiKQogICAgICAgICAgICAgICAgICAgIFRleHQoIlJlcG9ydGVkIFRocmVhZHMiKQogICAgICAgICAgICAgICAgICAgIFRleHQoIk1vZGVyYXRpb24gUXVldWUiKQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIFNlY3Rpb24oIkZvcnVtIE1hbmFnZW1lbnQiKSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dCgiQ3JlYXRlIENhdGVnb3JpZXMiKQogICAgICAgICAgICAgICAgICAgIFRleHQoIkVkaXQgQ2F0ZWdvcmllcyIpCiAgICAgICAgICAgICAgICAgICAgVGV4dCgiRm9ydW0gU3RhdGlzdGljcyIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLm5hdmlnYXRpb25UaXRsZSgiTW9kZXJhdGlvbiBQYW5lbCIpCiAgICAgICAgfQogICAgfQp9Cg==
--- END ---

--- FILE: MacChan/Views/ThreadBrowserView.swift ---
BASE64: Ly8KLy8gIFRocmVhZEJyb3dzZXJWaWV3LnN3aWZ0Ci8vICBNYWNDaGFuCi8vCi8vICBDcmVhdGVkIGJ5IEphcmVkIE1heHdlbGwgb24gOS8zLzI1LgovLwoKaW1wb3J0IFN3aWZ0VUkKCnN0cnVjdCBUaHJlYWRCcm93c2VyVmlldzogVmlldyB7CiAgICBsZXQgZm9ydW06IEZvcnVtCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciB0aHJlYWRzOiBbRm9ydW1UaHJlYWRdID0gW10KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc0xvYWRpbmcgPSBmYWxzZQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGVycm9yTWVzc2FnZTogU3RyaW5nPwogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNlbGVjdGVkVGhyZWFkOiBGb3J1bVRocmVhZD8KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nTmV3VGhyZWFkID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBuYXZpZ2F0aW9uUGF0aCA9IE5hdmlnYXRpb25QYXRoKCkKCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBOYXZpZ2F0aW9uU3RhY2socGF0aDogJG5hdmlnYXRpb25QYXRoKSB7CiAgICAgICAgICAgIExpc3QgewogICAgICAgICAgICBpZiBpc0xvYWRpbmcgewogICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQogICAgICAgICAgICAgICAgICAgIFByb2dyZXNzVmlldygiTG9hZGluZyB0aHJlYWRzLi4uIikKICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLmxpc3RSb3dJbnNldHMoRWRnZUluc2V0cygpKQogICAgICAgICAgICB9IGVsc2UgaWYgdGhyZWFkcy5pc0VtcHR5IHsKICAgICAgICAgICAgICAgIEhTdGFjayB7CiAgICAgICAgICAgICAgICAgICAgU3BhY2VyKCkKICAgICAgICAgICAgICAgICAgICBWU3RhY2soc3BhY2luZzogMTYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgSW1hZ2Uoc3lzdGVtTmFtZTogInRleHQuYnViYmxlIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5zeXN0ZW0oc2l6ZTogNTApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KCJObyB0aHJlYWRzIHlldCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIkJlIHRoZSBmaXJzdCB0byBzdGFydCBhIGRpc2N1c3Npb24hIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLmxpc3RSb3dJbnNldHMoRWRnZUluc2V0cygpKQogICAgICAgICAgICAgICAgLnBhZGRpbmcoLnZlcnRpY2FsLCA1MCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIEZvckVhY2godGhyZWFkcykgeyB0aHJlYWQgaW4KICAgICAgICAgICAgICAgICAgICBUaHJlYWRSb3dWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICB0aHJlYWQ6IHRocmVhZCwKICAgICAgICAgICAgICAgICAgICAgICAgb25UYXA6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRpb25QYXRoLmFwcGVuZCh0aHJlYWQpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgLmxpc3RSb3dJbnNldHMoRWRnZUluc2V0cygpKQogICAgICAgICAgICAgICAgICAgIC5saXN0Um93U2VwYXJhdG9yKC5oaWRkZW4pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLmxpc3RTdHlsZSgucGxhaW4pCiAgICAgICAgLm5hdmlnYXRpb25UaXRsZShmb3J1bS5uYW1lKQogICAgICAgICNpZiBvcyhpT1MpCiAgICAgICAgLm5hdmlnYXRpb25CYXJUaXRsZURpc3BsYXlNb2RlKC5pbmxpbmUpCiAgICAgICAgI2VuZGlmCiAgICAgICAgLnRvb2xiYXIgewogICAgICAgICAgICBUb29sYmFySXRlbSB7CiAgICAgICAgICAgICAgICBCdXR0b24oIk5ldyBUaHJlYWQiKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd2luZ05ld1RocmVhZCA9IHRydWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAuc2hlZXQoaXNQcmVzZW50ZWQ6ICRzaG93aW5nTmV3VGhyZWFkKSB7CiAgICAgICAgICAgIE5ld1RocmVhZFZpZXcoZm9ydW06IGZvcnVtKQogICAgICAgIH0KICAgICAgICAuYWxlcnQoIkVycm9yIiwgaXNQcmVzZW50ZWQ6IC5jb25zdGFudChlcnJvck1lc3NhZ2UgIT0gbmlsKSkgewogICAgICAgICAgICBCdXR0b24oIk9LIikgewogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gbmlsCiAgICAgICAgICAgIH0KICAgICAgICB9IG1lc3NhZ2U6IHsKICAgICAgICAgICAgaWYgbGV0IGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB7CiAgICAgICAgICAgICAgICBUZXh0KGVycm9yTWVzc2FnZSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAubmF2aWdhdGlvbkRlc3RpbmF0aW9uKGZvcjogRm9ydW1UaHJlYWQuc2VsZikgeyB0aHJlYWQgaW4KICAgICAgICAgICAgUG9zdHNMaXN0Vmlldyh0aHJlYWQ6IHRocmVhZCkKICAgICAgICB9CiAgICAgICAgLnRhc2sgewogICAgICAgICAgICBhd2FpdCBsb2FkVGhyZWFkcygpCiAgICAgICAgfQogICAgfQogICAgfQoKICAgIHByaXZhdGUgZnVuYyBsb2FkVGhyZWFkcygpIGFzeW5jIHsKICAgICAgICBpc0xvYWRpbmcgPSB0cnVlCiAgICAgICAgZG8gewogICAgICAgICAgICB0aHJlYWRzID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5mZXRjaFRocmVhZHMoZm9yOiBmb3J1bS5pZCkKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkZhaWxlZCB0byBsb2FkIHRocmVhZHM6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIgogICAgICAgIH0KICAgICAgICBpc0xvYWRpbmcgPSBmYWxzZQogICAgfQp9CgpzdHJ1Y3QgVGhyZWFkUm93VmlldzogVmlldyB7CiAgICBsZXQgdGhyZWFkOiBGb3J1bVRocmVhZAogICAgbGV0IG9uVGFwOiAoKSAtPiBWb2lkCgogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgQnV0dG9uKGFjdGlvbjogb25UYXApIHsKICAgICAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDgpIHsKICAgICAgICAgICAgICAgIC8vIFRocmVhZCB0aXRsZSBhbmQgc3RhdHVzCiAgICAgICAgICAgICAgICBIU3RhY2soc3BhY2luZzogOCkgewogICAgICAgICAgICAgICAgICAgIGlmIHRocmVhZC5pc1N0aWNreSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6ICJwaW4uZmlsbCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5vcmFuZ2UpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIHRocmVhZC5pc0Fubm91bmNlbWVudCB7CiAgICAgICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6ICJtZWdhcGhvbmUuZmlsbCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5yZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIHRocmVhZC5pc0xvY2tlZCB7CiAgICAgICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6ICJsb2NrLmZpbGwiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguZ3JheSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgVGV4dCh0aHJlYWQudGl0bGUpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigucHJpbWFyeSkKICAgICAgICAgICAgICAgICAgICAgICAgLmxpbmVMaW1pdCgyKQoKICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQoKICAgICAgICAgICAgICAgICAgICAvLyBUaHJlYWQgc3RhdHMKICAgICAgICAgICAgICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAudHJhaWxpbmcsIHNwYWNpbmc6IDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCgiXCh0aHJlYWQucG9zdENvdW50KSBwb3N0cyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbjIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCgogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KCJcKHRocmVhZC52aWV3Q291bnQpIHZpZXdzIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gVGhyZWFkIGluZm8KICAgICAgICAgICAgICAgIEhTdGFjayhzcGFjaW5nOiAxMikgewogICAgICAgICAgICAgICAgICAgIFRleHQoIlN0YXJ0ZWQgYnkgVXNlciIpIC8vIFRPRE86IEZldGNoIGFjdHVhbCB1c2VybmFtZQogICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQoKICAgICAgICAgICAgICAgICAgICBUZXh0KCJMYXN0IHBvc3Q6IFwodGhyZWFkLmxhc3RQb3N0RGF0ZSwgc3R5bGU6IC5yZWxhdGl2ZSkiKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQoKICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQoKICAgICAgICAgICAgICAgICAgICAvLyBMYXN0IHBvc3RlcgogICAgICAgICAgICAgICAgICAgIFRleHQoImJ5IFVzZXIiKSAvLyBUT0RPOiBGZXRjaCBhY3R1YWwgdXNlcm5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBUYWdzCiAgICAgICAgICAgICAgICBpZiAhdGhyZWFkLnRhZ3MuaXNFbXB0eSB7CiAgICAgICAgICAgICAgICAgICAgU2Nyb2xsVmlldyguaG9yaXpvbnRhbCwgc2hvd3NJbmRpY2F0b3JzOiBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICBIU3RhY2soc3BhY2luZzogNikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgRm9yRWFjaCh0aHJlYWQudGFncywgaWQ6IFwuc2VsZikgeyB0YWcgaW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0KHRhZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24yKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucGFkZGluZyguaG9yaXpvbnRhbCwgNikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoLnZlcnRpY2FsLCAyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5ibHVlLm9wYWNpdHkoMC4xKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguYmx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvcm5lclJhZGl1cyg0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5wYWRkaW5nKDE2KQogICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5wcmltYXJ5Lm9wYWNpdHkoMC4wMikpCiAgICAgICAgICAgIC5jb3JuZXJSYWRpdXMoOCkKICAgICAgICAgICAgLm92ZXJsYXkoCiAgICAgICAgICAgICAgICBSb3VuZGVkUmVjdGFuZ2xlKGNvcm5lclJhZGl1czogOCkKICAgICAgICAgICAgICAgICAgICAuc3Ryb2tlKENvbG9yLmdyYXkub3BhY2l0eSgwLjEpLCBsaW5lV2lkdGg6IDEpCiAgICAgICAgICAgICkKICAgICAgICAgICAgLmNvbnRlbnRTaGFwZShSZWN0YW5nbGUoKSkKICAgICAgICB9CiAgICAgICAgLmJ1dHRvblN0eWxlKC5wbGFpbikKICAgIH0KfQoKI1ByZXZpZXcgewogICAgTmF2aWdhdGlvblZpZXcgewogICAgICAgIFRocmVhZEJyb3dzZXJWaWV3KGZvcnVtOiBGb3J1bSgKICAgICAgICAgICAgaWQ6ICJnZW5lcmFsLWRpc2N1c3Npb24iLAogICAgICAgICAgICBuYW1lOiAiR2VuZXJhbCBEaXNjdXNzaW9uIiwKICAgICAgICAgICAgZGVzY3JpcHRpb246ICJUYWxrIGFib3V0IGFueXRoaW5nIiwKICAgICAgICAgICAgZGlzcGxheU9yZGVyOiAxLAogICAgICAgICAgICBjcmVhdGVkQnlVc2VySUQ6ICJ1c2VyMSIKICAgICAgICApKQogICAgICAgIC5lbnZpcm9ubWVudE9iamVjdChDbG91ZEtpdE1hbmFnZXIuc2hhcmVkKQogICAgfQp9Cg==
--- END ---

--- FILE: MacChan/Views/ForumExtensionsView.swift ---
BASE64: Ly8KLy8gIEZvcnVtRXh0ZW5zaW9uc1ZpZXcuc3dpZnQKLy8gIE1hY0NoYW4KLy8KLy8gIENyZWF0ZWQgYnkgSmFyZWQgTWF4d2VsbCBvbiA5LzMvMjUuCi8vCgppbXBvcnQgU3dpZnRVSQoKc3RydWN0IEZvcnVtRXh0ZW5zaW9uc1ZpZXc6IFZpZXcgewogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRFeHRlbnNpb24gPSAwCgogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgTmF2aWdhdGlvblZpZXcgewogICAgICAgICAgICBWU3RhY2sgewogICAgICAgICAgICAgICAgUGlja2VyKCJFeHRlbnNpb25zIiwgc2VsZWN0aW9uOiAkc2VsZWN0ZWRFeHRlbnNpb24pIHsKICAgICAgICAgICAgICAgICAgICBUZXh0KCJXaG8ncyBPbmxpbmUiKS50YWcoMCkKICAgICAgICAgICAgICAgICAgICBUZXh0KCJTdGF0aXN0aWNzIikudGFnKDEpCiAgICAgICAgICAgICAgICAgICAgVGV4dCgiQW5ub3VuY2VtZW50cyIpLnRhZygyKQogICAgICAgICAgICAgICAgICAgIFRleHQoIlJ1bGVzIikudGFnKDMpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGlja2VyU3R5bGUoU2VnbWVudGVkUGlja2VyU3R5bGUoKSkKICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKCiAgICAgICAgICAgICAgICBUYWJWaWV3KHNlbGVjdGlvbjogJHNlbGVjdGVkRXh0ZW5zaW9uKSB7CiAgICAgICAgICAgICAgICAgICAgV2hvc09ubGluZVZpZXcoKQogICAgICAgICAgICAgICAgICAgICAgICAudGFnKDApCgogICAgICAgICAgICAgICAgICAgIFN0YXRpc3RpY3NWaWV3KCkKICAgICAgICAgICAgICAgICAgICAgICAgLnRhZygxKQoKICAgICAgICAgICAgICAgICAgICBBbm5vdW5jZW1lbnRzVmlldygpCiAgICAgICAgICAgICAgICAgICAgICAgIC50YWcoMikKCiAgICAgICAgICAgICAgICAgICAgRm9ydW1SdWxlc1ZpZXcoKQogICAgICAgICAgICAgICAgICAgICAgICAudGFnKDMpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAjaWYgb3MoaU9TKQogICAgICAgICAgICAgICAgLnRhYlZpZXdTdHlsZShQYWdlVGFiVmlld1N0eWxlKGluZGV4RGlzcGxheU1vZGU6IC5uZXZlcikpCiAgICAgICAgICAgICAgICAjZW5kaWYKICAgICAgICAgICAgfQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJGb3J1bSBFeHRlbnNpb25zIikKICAgICAgICB9CiAgICB9Cn0KCnN0cnVjdCBXaG9zT25saW5lVmlldzogVmlldyB7CiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBvbmxpbmVVc2VyczogW0ZvcnVtVXNlcl0gPSBbXQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGlzTG9hZGluZyA9IGZhbHNlCgogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgR3JvdXAgewogICAgICAgICAgICBpZiBpc0xvYWRpbmcgewogICAgICAgICAgICAgICAgUHJvZ3Jlc3NWaWV3KCJMb2FkaW5nIG9ubGluZSB1c2Vycy4uLiIpCiAgICAgICAgICAgICAgICAgICAgLmZyYW1lKG1heFdpZHRoOiAuaW5maW5pdHksIG1heEhlaWdodDogLmluZmluaXR5KQogICAgICAgICAgICB9IGVsc2UgaWYgb25saW5lVXNlcnMuaXNFbXB0eSB7CiAgICAgICAgICAgICAgICBWU3RhY2soc3BhY2luZzogMTYpIHsKICAgICAgICAgICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiAicGVyc29uLjIiKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguc3lzdGVtKHNpemU6IDUwKSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIFRleHQoIk5vIHVzZXJzIG9ubGluZSIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIFRleHQoIk9ubGluZSB1c2VycyB3aWxsIGFwcGVhciBoZXJlIikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIExpc3QgewogICAgICAgICAgICAgICAgICAgIEZvckVhY2gob25saW5lVXNlcnMpIHsgdXNlciBpbgogICAgICAgICAgICAgICAgICAgICAgICBPbmxpbmVVc2VyUm93Vmlldyh1c2VyOiB1c2VyKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAudGFzayB7CiAgICAgICAgICAgIGF3YWl0IGxvYWRPbmxpbmVVc2VycygpCiAgICAgICAgfQogICAgICAgIC5yZWZyZXNoYWJsZSB7CiAgICAgICAgICAgIGF3YWl0IGxvYWRPbmxpbmVVc2VycygpCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgZnVuYyBsb2FkT25saW5lVXNlcnMoKSBhc3luYyB7CiAgICAgICAgaXNMb2FkaW5nID0gdHJ1ZQogICAgICAgIC8vIEluIGEgcmVhbCBpbXBsZW1lbnRhdGlvbiwgeW91J2QgcXVlcnkgZm9yIHVzZXJzIGFjdGl2ZSBpbiB0aGUgbGFzdCA1IG1pbnV0ZXMKICAgICAgICAvLyBGb3Igbm93LCB3ZSdsbCBjcmVhdGUgbW9jayBkYXRhCiAgICAgICAgb25saW5lVXNlcnMgPSBbXQogICAgICAgIGlzTG9hZGluZyA9IGZhbHNlCiAgICB9Cn0KCnN0cnVjdCBPbmxpbmVVc2VyUm93VmlldzogVmlldyB7CiAgICBsZXQgdXNlcjogRm9ydW1Vc2VyCgogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgLy8gQXZhdGFyIHBsYWNlaG9sZGVyCiAgICAgICAgICAgIENpcmNsZSgpCiAgICAgICAgICAgICAgICAuZmlsbChDb2xvci5ibHVlLm9wYWNpdHkoMC4zKSkKICAgICAgICAgICAgICAgIC5mcmFtZSh3aWR0aDogNDAsIGhlaWdodDogNDApCiAgICAgICAgICAgICAgICAub3ZlcmxheSgKICAgICAgICAgICAgICAgICAgICBUZXh0KFN0cmluZyh1c2VyLmRpc3BsYXlOYW1lLnByZWZpeCgxKSkudXBwZXJjYXNlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLmJsdWUpCiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAubGVhZGluZywgc3BhY2luZzogNCkgewogICAgICAgICAgICAgICAgVGV4dCh1c2VyLmRpc3BsYXlOYW1lKQogICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5wcmltYXJ5KQoKICAgICAgICAgICAgICAgIFRleHQoIkBcKHVzZXIudXNlcm5hbWUpIikKICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFNwYWNlcigpCgogICAgICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAudHJhaWxpbmcsIHNwYWNpbmc6IDQpIHsKICAgICAgICAgICAgICAgIFRleHQoIk9ubGluZSIpCiAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgLmZvbnRXZWlnaHQoLnNlbWlib2xkKQogICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLmdyZWVuKQoKICAgICAgICAgICAgICAgIFRleHQoIlwodXNlci5wb3N0Q291bnQpIHBvc3RzIikKICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbjIpCiAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC5wYWRkaW5nKC52ZXJ0aWNhbCwgNCkKICAgIH0KfQoKc3RydWN0IFN0YXRpc3RpY3NWaWV3OiBWaWV3IHsKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzdGF0aXN0aWNzOiBGb3J1bVN0YXRpc3RpY3M/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaXNMb2FkaW5nID0gZmFsc2UKCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBHcm91cCB7CiAgICAgICAgICAgIGlmIGlzTG9hZGluZyB7CiAgICAgICAgICAgICAgICBQcm9ncmVzc1ZpZXcoIkxvYWRpbmcgc3RhdGlzdGljcy4uLiIpCiAgICAgICAgICAgICAgICAgICAgLmZyYW1lKG1heFdpZHRoOiAuaW5maW5pdHksIG1heEhlaWdodDogLmluZmluaXR5KQogICAgICAgICAgICB9IGVsc2UgaWYgbGV0IHN0YXRzID0gc3RhdGlzdGljcyB7CiAgICAgICAgICAgICAgICBTY3JvbGxWaWV3IHsKICAgICAgICAgICAgICAgICAgICBWU3RhY2soc3BhY2luZzogMjApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3ZlcnZpZXcgc3RhdHMKICAgICAgICAgICAgICAgICAgICAgICAgT3ZlcnZpZXdTdGF0c0NhcmQoc3RhdHM6IHN0YXRzKQoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWN0aXZpdHkgc3RhdHMKICAgICAgICAgICAgICAgICAgICAgICAgQWN0aXZpdHlTdGF0c0NhcmQoc3RhdHM6IHN0YXRzKQoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29udGVudCBzdGF0cwogICAgICAgICAgICAgICAgICAgICAgICBDb250ZW50U3RhdHNDYXJkKHN0YXRzOiBzdGF0cykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgVlN0YWNrKHNwYWNpbmc6IDE2KSB7CiAgICAgICAgICAgICAgICAgICAgSW1hZ2Uoc3lzdGVtTmFtZTogImNoYXJ0LmJhci5maWxsIikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLnN5c3RlbShzaXplOiA1MCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICBUZXh0KCJObyBzdGF0aXN0aWNzIGF2YWlsYWJsZSIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIFRleHQoIlN0YXRpc3RpY3Mgd2lsbCBhcHBlYXIgaGVyZSIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLnRhc2sgewogICAgICAgICAgICBhd2FpdCBsb2FkU3RhdGlzdGljcygpCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgZnVuYyBsb2FkU3RhdGlzdGljcygpIGFzeW5jIHsKICAgICAgICBpc0xvYWRpbmcgPSB0cnVlCiAgICAgICAgLy8gTW9jayBzdGF0aXN0aWNzIGRhdGEKICAgICAgICBzdGF0aXN0aWNzID0gRm9ydW1TdGF0aXN0aWNzLm1vY2tEYXRhKCkKICAgICAgICBpc0xvYWRpbmcgPSBmYWxzZQogICAgfQp9CgpzdHJ1Y3QgT3ZlcnZpZXdTdGF0c0NhcmQ6IFZpZXcgewogICAgbGV0IHN0YXRzOiBGb3J1bVN0YXRpc3RpY3MKCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAubGVhZGluZywgc3BhY2luZzogMTIpIHsKICAgICAgICAgICAgVGV4dCgiT3ZlcnZpZXciKQogICAgICAgICAgICAgICAgLmZvbnQoLmhlYWRsaW5lKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigucHJpbWFyeSkKCiAgICAgICAgICAgIExhenlWR3JpZChjb2x1bW5zOiBbCiAgICAgICAgICAgICAgICBHcmlkSXRlbSguZmxleGlibGUoKSksCiAgICAgICAgICAgICAgICBHcmlkSXRlbSguZmxleGlibGUoKSkKICAgICAgICAgICAgXSwgc3BhY2luZzogMTYpIHsKICAgICAgICAgICAgICAgIFN0YXRJdGVtKHRpdGxlOiAiVG90YWwgUG9zdHMiLCB2YWx1ZTogIlwoc3RhdHMudG90YWxQb3N0cykiKQogICAgICAgICAgICAgICAgU3RhdEl0ZW0odGl0bGU6ICJUb3RhbCBUaHJlYWRzIiwgdmFsdWU6ICJcKHN0YXRzLnRvdGFsVGhyZWFkcykiKQogICAgICAgICAgICAgICAgU3RhdEl0ZW0odGl0bGU6ICJSZWdpc3RlcmVkIFVzZXJzIiwgdmFsdWU6ICJcKHN0YXRzLnJlZ2lzdGVyZWRVc2VycykiKQogICAgICAgICAgICAgICAgU3RhdEl0ZW0odGl0bGU6ICJGb3J1bXMiLCB2YWx1ZTogIlwoc3RhdHMudG90YWxGb3J1bXMpIikKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAucGFkZGluZygpCiAgICAgICAgLmJhY2tncm91bmQoQ29sb3IuZ3JheS5vcGFjaXR5KDAuMTUpKQogICAgICAgIC5jb3JuZXJSYWRpdXMoMTIpCiAgICB9Cn0KCnN0cnVjdCBBY3Rpdml0eVN0YXRzQ2FyZDogVmlldyB7CiAgICBsZXQgc3RhdHM6IEZvcnVtU3RhdGlzdGljcwoKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIFZTdGFjayhhbGlnbm1lbnQ6IC5sZWFkaW5nLCBzcGFjaW5nOiAxMikgewogICAgICAgICAgICBUZXh0KCJBY3Rpdml0eSIpCiAgICAgICAgICAgICAgICAuZm9udCguaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5wcmltYXJ5KQoKICAgICAgICAgICAgVlN0YWNrKHNwYWNpbmc6IDgpIHsKICAgICAgICAgICAgICAgIFN0YXRSb3codGl0bGU6ICJQb3N0cyBUb2RheSIsIHZhbHVlOiAiXChzdGF0cy5wb3N0c1RvZGF5KSIpCiAgICAgICAgICAgICAgICBTdGF0Um93KHRpdGxlOiAiUG9zdHMgVGhpcyBXZWVrIiwgdmFsdWU6ICJcKHN0YXRzLnBvc3RzVGhpc1dlZWspIikKICAgICAgICAgICAgICAgIFN0YXRSb3codGl0bGU6ICJQb3N0cyBUaGlzIE1vbnRoIiwgdmFsdWU6ICJcKHN0YXRzLnBvc3RzVGhpc01vbnRoKSIpCiAgICAgICAgICAgICAgICBTdGF0Um93KHRpdGxlOiAiTmV3IFVzZXJzIFRvZGF5IiwgdmFsdWU6ICJcKHN0YXRzLm5ld1VzZXJzVG9kYXkpIikKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAucGFkZGluZygpCiAgICAgICAgLmJhY2tncm91bmQoQ29sb3IuZ3JheS5vcGFjaXR5KDAuMTUpKQogICAgICAgIC5jb3JuZXJSYWRpdXMoMTIpCiAgICB9Cn0KCnN0cnVjdCBDb250ZW50U3RhdHNDYXJkOiBWaWV3IHsKICAgIGxldCBzdGF0czogRm9ydW1TdGF0aXN0aWNzCgogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDEyKSB7CiAgICAgICAgICAgIFRleHQoIkNvbnRlbnQiKQogICAgICAgICAgICAgICAgLmZvbnQoLmhlYWRsaW5lKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigucHJpbWFyeSkKCiAgICAgICAgICAgIFZTdGFjayhzcGFjaW5nOiA4KSB7CiAgICAgICAgICAgICAgICBTdGF0Um93KHRpdGxlOiAiTW9zdCBBY3RpdmUgRm9ydW0iLCB2YWx1ZTogc3RhdHMubW9zdEFjdGl2ZUZvcnVtKQogICAgICAgICAgICAgICAgU3RhdFJvdyh0aXRsZTogIkJ1c2llc3QgRGF5IiwgdmFsdWU6IHN0YXRzLmJ1c2llc3REYXkpCiAgICAgICAgICAgICAgICBTdGF0Um93KHRpdGxlOiAiQXZlcmFnZSBQb3N0cy9EYXkiLCB2YWx1ZTogIlwoc3RhdHMuYXZlcmFnZVBvc3RzUGVyRGF5KSIpCiAgICAgICAgICAgICAgICBTdGF0Um93KHRpdGxlOiAiVG90YWwgQXR0YWNobWVudHMiLCB2YWx1ZTogIlwoc3RhdHMudG90YWxBdHRhY2htZW50cykiKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAuYmFja2dyb3VuZChDb2xvci5ncmF5Lm9wYWNpdHkoMC4xNSkpCiAgICAgICAgLmNvcm5lclJhZGl1cygxMikKICAgIH0KfQoKc3RydWN0IFN0YXRJdGVtOiBWaWV3IHsKICAgIGxldCB0aXRsZTogU3RyaW5nCiAgICBsZXQgdmFsdWU6IFN0cmluZwoKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIFZTdGFjayhzcGFjaW5nOiA0KSB7CiAgICAgICAgICAgIFRleHQodmFsdWUpCiAgICAgICAgICAgICAgICAuZm9udCgudGl0bGUyKQogICAgICAgICAgICAgICAgLmZvbnRXZWlnaHQoLmJvbGQpCiAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5wcmltYXJ5KQoKICAgICAgICAgICAgVGV4dCh0aXRsZSkKICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgIH0KICAgICAgICAuZnJhbWUobWF4V2lkdGg6IC5pbmZpbml0eSkKICAgICAgICAucGFkZGluZygpCiAgICAgICAgLmJhY2tncm91bmQoQ29sb3IuYmx1ZS5vcGFjaXR5KDAuMSkpCiAgICAgICAgLmNvcm5lclJhZGl1cyg4KQogICAgfQp9CgpzdHJ1Y3QgU3RhdFJvdzogVmlldyB7CiAgICBsZXQgdGl0bGU6IFN0cmluZwogICAgbGV0IHZhbHVlOiBTdHJpbmcKCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBIU3RhY2sgewogICAgICAgICAgICBUZXh0KHRpdGxlKQogICAgICAgICAgICAgICAgLmZvbnQoLnN1YmhlYWRsaW5lKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigucHJpbWFyeSkKCiAgICAgICAgICAgIFNwYWNlcigpCgogICAgICAgICAgICBUZXh0KHZhbHVlKQogICAgICAgICAgICAgICAgLmZvbnQoLnN1YmhlYWRsaW5lKQogICAgICAgICAgICAgICAgLmZvbnRXZWlnaHQoLnNlbWlib2xkKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgIH0KICAgIH0KfQoKc3RydWN0IEFubm91bmNlbWVudHNWaWV3OiBWaWV3IHsKICAgIEBFbnZpcm9ubWVudE9iamVjdCBwcml2YXRlIHZhciBjbG91ZEtpdE1hbmFnZXI6IENsb3VkS2l0TWFuYWdlcgogICAgQFN0YXRlIHByaXZhdGUgdmFyIGFubm91bmNlbWVudHM6IFtBbm5vdW5jZW1lbnRdID0gW10KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc0xvYWRpbmcgPSBmYWxzZQoKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIEdyb3VwIHsKICAgICAgICAgICAgaWYgaXNMb2FkaW5nIHsKICAgICAgICAgICAgICAgIFByb2dyZXNzVmlldygiTG9hZGluZyBhbm5vdW5jZW1lbnRzLi4uIikKICAgICAgICAgICAgICAgICAgICAuZnJhbWUobWF4V2lkdGg6IC5pbmZpbml0eSwgbWF4SGVpZ2h0OiAuaW5maW5pdHkpCiAgICAgICAgICAgIH0gZWxzZSBpZiBhbm5vdW5jZW1lbnRzLmlzRW1wdHkgewogICAgICAgICAgICAgICAgVlN0YWNrKHNwYWNpbmc6IDE2KSB7CiAgICAgICAgICAgICAgICAgICAgSW1hZ2Uoc3lzdGVtTmFtZTogIm1lZ2FwaG9uZSIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5zeXN0ZW0oc2l6ZTogNTApKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgVGV4dCgiTm8gYW5ub3VuY2VtZW50cyIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIFRleHQoIkltcG9ydGFudCBhbm5vdW5jZW1lbnRzIHdpbGwgYXBwZWFyIGhlcmUiKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgTGlzdCB7CiAgICAgICAgICAgICAgICAgICAgRm9yRWFjaChhbm5vdW5jZW1lbnRzKSB7IGFubm91bmNlbWVudCBpbgogICAgICAgICAgICAgICAgICAgICAgICBBbm5vdW5jZW1lbnRSb3dWaWV3KGFubm91bmNlbWVudDogYW5ub3VuY2VtZW50KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAudGFzayB7CiAgICAgICAgICAgIGF3YWl0IGxvYWRBbm5vdW5jZW1lbnRzKCkKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBmdW5jIGxvYWRBbm5vdW5jZW1lbnRzKCkgYXN5bmMgewogICAgICAgIGlzTG9hZGluZyA9IHRydWUKICAgICAgICAvLyBNb2NrIGFubm91bmNlbWVudHMKICAgICAgICBhbm5vdW5jZW1lbnRzID0gWwogICAgICAgICAgICBBbm5vdW5jZW1lbnQoCiAgICAgICAgICAgICAgICB0aXRsZTogIldlbGNvbWUgdG8gTWFjQ2hhbiEiLAogICAgICAgICAgICAgICAgY29udGVudDogIldlbGNvbWUgdG8gb3VyIG5ldyBmb3J1bSEgV2UncmUgZXhjaXRlZCB0byBoYXZlIHlvdSBoZXJlLiBQbGVhc2UgdGFrZSBhIG1vbWVudCB0byByZWFkIHRoZSBmb3J1bSBydWxlcyBhbmQgaW50cm9kdWNlIHlvdXJzZWxmLiIsCiAgICAgICAgICAgICAgICBjcmVhdGVkRGF0ZTogRGF0ZSgpLmFkZGluZ1RpbWVJbnRlcnZhbCgtODY0MDApLAogICAgICAgICAgICAgICAgaXNJbXBvcnRhbnQ6IHRydWUKICAgICAgICAgICAgKSwKICAgICAgICAgICAgQW5ub3VuY2VtZW50KAogICAgICAgICAgICAgICAgdGl0bGU6ICJGb3J1bSBHdWlkZWxpbmVzIiwKICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICJQbGVhc2UgcmVtZW1iZXIgdG8gYmUgcmVzcGVjdGZ1bCBhbmQgZm9sbG93IG91ciBjb21tdW5pdHkgZ3VpZGVsaW5lcy4gV2Ugd2FudCB0byBtYWludGFpbiBhIHBvc2l0aXZlIGVudmlyb25tZW50IGZvciBldmVyeW9uZS4iLAogICAgICAgICAgICAgICAgY3JlYXRlZERhdGU6IERhdGUoKS5hZGRpbmdUaW1lSW50ZXJ2YWwoLTE3MjgwMCksCiAgICAgICAgICAgICAgICBpc0ltcG9ydGFudDogZmFsc2UKICAgICAgICAgICAgKQogICAgICAgIF0KICAgICAgICBpc0xvYWRpbmcgPSBmYWxzZQogICAgfQp9CgpzdHJ1Y3QgQW5ub3VuY2VtZW50Um93VmlldzogVmlldyB7CiAgICBsZXQgYW5ub3VuY2VtZW50OiBBbm5vdW5jZW1lbnQKCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAubGVhZGluZywgc3BhY2luZzogOCkgewogICAgICAgICAgICBIU3RhY2sgewogICAgICAgICAgICAgICAgVGV4dChhbm5vdW5jZW1lbnQudGl0bGUpCiAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmhlYWRsaW5lKQogICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnByaW1hcnkpCgogICAgICAgICAgICAgICAgU3BhY2VyKCkKCiAgICAgICAgICAgICAgICBpZiBhbm5vdW5jZW1lbnQuaXNJbXBvcnRhbnQgewogICAgICAgICAgICAgICAgICAgIEltYWdlKHN5c3RlbU5hbWU6ICJleGNsYW1hdGlvbm1hcmsudHJpYW5nbGUuZmlsbCIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLm9yYW5nZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgVGV4dChhbm5vdW5jZW1lbnQuY29udGVudCkKICAgICAgICAgICAgICAgIC5mb250KC5ib2R5KQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgLmxpbmVMaW1pdCgzKQoKICAgICAgICAgICAgVGV4dChhbm5vdW5jZW1lbnQuY3JlYXRlZERhdGUsIGZvcm1hdHRlcjogcmVsYXRpdmVEYXRlRm9ybWF0dGVyKQogICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgfQogICAgICAgIC5wYWRkaW5nKC52ZXJ0aWNhbCwgNCkKICAgIH0KfQoKc3RydWN0IEZvcnVtUnVsZXNWaWV3OiBWaWV3IHsKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIFNjcm9sbFZpZXcgewogICAgICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAubGVhZGluZywgc3BhY2luZzogMjApIHsKICAgICAgICAgICAgICAgIFRleHQoIkZvcnVtIFJ1bGVzIikKICAgICAgICAgICAgICAgICAgICAuZm9udCgubGFyZ2VUaXRsZSkKICAgICAgICAgICAgICAgICAgICAuZm9udFdlaWdodCguYm9sZCkKCiAgICAgICAgICAgICAgICBUZXh0KCJMYXN0IHVwZGF0ZWQ6IEphbnVhcnkgMSwgMjAyNSIpCiAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQoKICAgICAgICAgICAgICAgIEdyb3VwIHsKICAgICAgICAgICAgICAgICAgICBSdWxlU2VjdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICIxLiBSZXNwZWN0IGFuZCBDb3VydGVzeSIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICJUcmVhdCBhbGwgbWVtYmVycyB3aXRoIHJlc3BlY3QgYW5kIGNvdXJ0ZXN5LiBQZXJzb25hbCBhdHRhY2tzLCBoYXJhc3NtZW50LCBvciBpbmZsYW1tYXRvcnkgYmVoYXZpb3Igd2lsbCBub3QgYmUgdG9sZXJhdGVkLiIKICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgICAgIFJ1bGVTZWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIjIuIEFwcHJvcHJpYXRlIENvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAiS2VlcCBhbGwgY29udGVudCBhcHByb3ByaWF0ZSBmb3IgYSBnZW5lcmFsIGF1ZGllbmNlLiBObyBleHBsaWNpdCwgb2ZmZW5zaXZlLCBvciBpbGxlZ2FsIGNvbnRlbnQgaXMgYWxsb3dlZC4iCiAgICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgICAgICBSdWxlU2VjdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICIzLiBObyBTcGFtIiwKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogIkRvIG5vdCBwb3N0IHNwYW0sIGFkdmVydGlzZW1lbnRzLCBvciBvZmYtdG9waWMgY29udGVudC4gS2VlcCBkaXNjdXNzaW9ucyByZWxldmFudCB0byB0aGUgZm9ydW0gdG9waWMuIgogICAgICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgICAgICAgICAgUnVsZVNlY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAiNC4gUHJpdmFjeSIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICJSZXNwZWN0IG90aGVycycgcHJpdmFjeS4gRG8gbm90IHNoYXJlIHBlcnNvbmFsIGluZm9ybWF0aW9uIHdpdGhvdXQgcGVybWlzc2lvbi4iCiAgICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgICAgICBSdWxlU2VjdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICI1LiBJbnRlbGxlY3R1YWwgUHJvcGVydHkiLAogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAiRG8gbm90IHBvc3QgY29weXJpZ2h0ZWQgbWF0ZXJpYWwgd2l0aG91dCBwZXJtaXNzaW9uLiBHaXZlIGNyZWRpdCB3aGVyZSBjcmVkaXQgaXMgZHVlLiIKICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgICAgIFJ1bGVTZWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIjYuIE1vZGVyYXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAiTW9kZXJhdG9ycyBoYXZlIHRoZSBmaW5hbCBzYXkgaW4gZGlzcHV0ZXMuIEZvbGxvdyB0aGVpciBpbnN0cnVjdGlvbnMgYW5kIHJlc3BlY3QgdGhlaXIgZGVjaXNpb25zLiIKICAgICAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgICAgIFJ1bGVTZWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogIjcuIEFjY291bnQgUmVzcG9uc2liaWxpdHkiLAogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiAiWW91IGFyZSByZXNwb25zaWJsZSBmb3IgeW91ciBhY2NvdW50IGFuZCBhbGwgY29udGVudCBwb3N0ZWQgdW5kZXIgaXQuIEtlZXAgeW91ciBhY2NvdW50IHNlY3VyZS4iCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIFRleHQoIlZpb2xhdGlvbiBvZiB0aGVzZSBydWxlcyBtYXkgcmVzdWx0IGluIHdhcm5pbmdzLCB0ZW1wb3Jhcnkgc3VzcGVuc2lvbiwgb3IgcGVybWFuZW50IGJhbiBmcm9tIHRoZSBmb3J1bS4iKQogICAgICAgICAgICAgICAgICAgIC5mb250KC5zdWJoZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgLnBhZGRpbmcoLnRvcCkKICAgICAgICAgICAgfQogICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgfQogICAgfQp9CgpzdHJ1Y3QgUnVsZVNlY3Rpb246IFZpZXcgewogICAgbGV0IHRpdGxlOiBTdHJpbmcKICAgIGxldCBjb250ZW50OiBTdHJpbmcKCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAubGVhZGluZywgc3BhY2luZzogOCkgewogICAgICAgICAgICBUZXh0KHRpdGxlKQogICAgICAgICAgICAgICAgLmZvbnQoLmhlYWRsaW5lKQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigucHJpbWFyeSkKCiAgICAgICAgICAgIFRleHQoY29udGVudCkKICAgICAgICAgICAgICAgIC5mb250KC5ib2R5KQogICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgIH0KICAgIH0KfQoKI1ByZXZpZXcgewogICAgRm9ydW1FeHRlbnNpb25zVmlldygpCiAgICAgICAgLmVudmlyb25tZW50T2JqZWN0KENsb3VkS2l0TWFuYWdlci5zaGFyZWQpCn0K
--- END ---

--- FILE: MacChan/Views/NewThreadView.swift ---
BASE64: aW1wb3J0IFN3aWZ0VUkKaW1wb3J0IFVuaWZvcm1UeXBlSWRlbnRpZmllcnMKaW1wb3J0IENsb3VkS2l0ICAvLyBGb3IgQ0tFcnJvciBpZiBuZWVkZWQKCnN0cnVjdCBOZXdUaHJlYWRWaWV3OiBWaWV3IHsKICAgIGxldCBmb3J1bTogRm9ydW0KICAgIAogICAgQEVudmlyb25tZW50KFwuZGlzbWlzcykgcHJpdmF0ZSB2YXIgZGlzbWlzcwogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgYXR0YWNobWVudE1hbmFnZXI6IEF0dGFjaG1lbnRNYW5hZ2VyCiAgICAKICAgIEBTdGF0ZSBwcml2YXRlIHZhciB0aXRsZTogU3RyaW5nID0gIiIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBjb250ZW50OiBTdHJpbmcgPSAiIgogICAgQFN0YXRlIHByaXZhdGUgdmFyIHRhZ3NTdHJpbmc6IFN0cmluZyA9ICIiCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgYXR0YWNobWVudHM6IFtBdHRhY2htZW50XSA9IFtdCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaXNQcmV2aWV3aW5nOiBCb29sID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBpc1Bvc3Rpbmc6IEJvb2wgPSBmYWxzZQogICAgQFN0YXRlIHByaXZhdGUgdmFyIGVycm9yTWVzc2FnZTogU3RyaW5nPyA9IG5pbAogICAgQFN0YXRlIHByaXZhdGUgdmFyIHNob3dGaWxlUGlja2VyOiBCb29sID0gZmFsc2UKICAgIAogICAgcHJpdmF0ZSB2YXIgcGFyc2VkQ29udGVudDogQXR0cmlidXRlZFN0cmluZyB7CiAgICAgICAgLy8gQXNzdW1pbmcgQkJDb2RlUGFyc2VyLnBhcnNlIHJldHVybnMgQXR0cmlidXRlZFN0cmluZwogICAgICAgIEJCQ29kZVBhcnNlci5wYXJzZShjb250ZW50KQogICAgfQogICAgCiAgICBwcml2YXRlIHZhciB0YWdzOiBbU3RyaW5nXSB7CiAgICAgICAgdGFnc1N0cmluZy5zcGxpdChzZXBhcmF0b3I6ICIsIikubWFwIHsgJDAudHJpbW1pbmdDaGFyYWN0ZXJzKGluOiAud2hpdGVzcGFjZXMpIH0KICAgIH0KICAgIAogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgTmF2aWdhdGlvblN0YWNrIHsKICAgICAgICAgICAgRm9ybSB7CiAgICAgICAgICAgICAgICBTZWN0aW9uKCJUaXRsZSIpIHsKICAgICAgICAgICAgICAgICAgICBUZXh0RmllbGQoIkVudGVyIHRocmVhZCB0aXRsZSIsIHRleHQ6ICR0aXRsZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgU2VjdGlvbigiVGFncyAoY29tbWEtc2VwYXJhdGVkKSIpIHsKICAgICAgICAgICAgICAgICAgICBUZXh0RmllbGQoImUuZy4sIHN3aWZ0LCBpb3MsIG1hY29zIiwgdGV4dDogJHRhZ3NTdHJpbmcpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFNlY3Rpb24oIkNvbnRlbnQiKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgaXNQcmV2aWV3aW5nIHsKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dChwYXJzZWRDb250ZW50KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZyYW1lKG1pbkhlaWdodDogMjAwKQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRFZGl0b3IodGV4dDogJGNvbnRlbnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZnJhbWUobWluSGVpZ2h0OiAyMDApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBTZWN0aW9uKCJBdHRhY2htZW50cyIpIHsKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoKGF0dGFjaG1lbnRzKSB7IGF0dGFjaG1lbnQgaW4KICAgICAgICAgICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoYXR0YWNobWVudC5maWxlbmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNwYWNlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0KGF0dGFjaG1lbnRNYW5hZ2VyLmZvcm1hdEZpbGVTaXplKGF0dGFjaG1lbnQuZmlsZVNpemUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAub25EZWxldGUocGVyZm9ybTogcmVtb3ZlQXR0YWNobWVudCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBCdXR0b24oIkFkZCBBdHRhY2htZW50IikgewogICAgICAgICAgICAgICAgICAgICAgICBzaG93RmlsZVBpY2tlciA9IHRydWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLm5hdmlnYXRpb25UaXRsZSgiTmV3IFRocmVhZCBpbiBcKGZvcnVtLm5hbWUpIikKICAgICAgICAgICAgLnRvb2xiYXIgewogICAgICAgICAgICAgICAgVG9vbGJhckl0ZW0ocGxhY2VtZW50OiAuY2FuY2VsbGF0aW9uQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDYW5jZWwiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc21pc3MoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFRvb2xiYXJJdGVtKHBsYWNlbWVudDogLmNvbmZpcm1hdGlvbkFjdGlvbikgewogICAgICAgICAgICAgICAgICAgIEJ1dHRvbigiUG9zdCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zdFRocmVhZCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC5kaXNhYmxlZChpc1Bvc3RpbmcgfHwgdGl0bGUuaXNFbXB0eSB8fCBjb250ZW50LmlzRW1wdHkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBUb29sYmFySXRlbSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKGlzUHJldmlld2luZyA/ICJFZGl0IiA6ICJQcmV2aWV3IikgewogICAgICAgICAgICAgICAgICAgICAgICBpc1ByZXZpZXdpbmcudG9nZ2xlKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLmZpbGVJbXBvcnRlcigKICAgICAgICAgICAgICAgIGlzUHJlc2VudGVkOiAkc2hvd0ZpbGVQaWNrZXIsCiAgICAgICAgICAgICAgICBhbGxvd2VkQ29udGVudFR5cGVzOiBbLmltYWdlLCAucGRmLCAudGV4dF0sICAvLyBBZGQgbW9yZSBhcyBuZWVkZWQKICAgICAgICAgICAgICAgIGFsbG93c011bHRpcGxlU2VsZWN0aW9uOiBmYWxzZQogICAgICAgICAgICApIHsgcmVzdWx0IGluCiAgICAgICAgICAgICAgICBoYW5kbGVGaWxlSW1wb3J0KHJlc3VsdCkKICAgICAgICAgICAgfQogICAgICAgICAgICAuYWxlcnQoIkVycm9yIiwgaXNQcmVzZW50ZWQ6IEJpbmRpbmcoZ2V0OiB7IGVycm9yTWVzc2FnZSAhPSBuaWwgfSwgc2V0OiB7IF8gaW4gZXJyb3JNZXNzYWdlID0gbmlsIH0pKSB7CiAgICAgICAgICAgICAgICBCdXR0b24oIk9LIikge30KICAgICAgICAgICAgfSBtZXNzYWdlOiB7CiAgICAgICAgICAgICAgICBUZXh0KGVycm9yTWVzc2FnZSA/PyAiQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCIpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyByZW1vdmVBdHRhY2htZW50KGF0IG9mZnNldHM6IEluZGV4U2V0KSB7CiAgICAgICAgYXR0YWNobWVudHMucmVtb3ZlKGF0T2Zmc2V0czogb2Zmc2V0cykKICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGhhbmRsZUZpbGVJbXBvcnQoXyByZXN1bHQ6IFJlc3VsdDxbVVJMXSwgRXJyb3I+KSB7CiAgICAgICAgc3dpdGNoIHJlc3VsdCB7CiAgICAgICAgY2FzZSAuc3VjY2VzcyhsZXQgdXJscyk6CiAgICAgICAgICAgIGd1YXJkIGxldCB1cmwgPSB1cmxzLmZpcnN0IGVsc2UgeyByZXR1cm4gfQogICAgICAgICAgICBUYXNrIHsKICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHRyeSBEYXRhKGNvbnRlbnRzT2Y6IHVybCkKICAgICAgICAgICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSB1cmwubGFzdFBhdGhDb21wb25lbnQKICAgICAgICAgICAgICAgICAgICBsZXQgbWltZVR5cGUgPSB1cmwudHlwZUlkZW50aWZpZXIgPz8gImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSIKICAgICAgICAgICAgICAgICAgICBsZXQgYXR0YWNobWVudCA9IHRyeSBhd2FpdCBhdHRhY2htZW50TWFuYWdlci51cGxvYWRGaWxlKGRhdGE6IGRhdGEsIGZpbGVuYW1lOiBmaWxlbmFtZSwgbWltZVR5cGU6IG1pbWVUeXBlKQogICAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnRzLmFwcGVuZChhdHRhY2htZW50KQogICAgICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIGNhc2UgLmZhaWx1cmUobGV0IGVycm9yKToKICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24KICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBwb3N0VGhyZWFkKCkgewogICAgICAgIGlzUG9zdGluZyA9IHRydWUKICAgICAgICBUYXNrIHsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgZ3VhcmQgbGV0IHVzZXIgPSBjbG91ZEtpdE1hbmFnZXIuY3VycmVudFVzZXIgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgIllvdSBtdXN0IGJlIGxvZ2dlZCBpbiB0byBjcmVhdGUgYSB0aHJlYWQuIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgbmV3VGhyZWFkID0gRm9ydW1UaHJlYWQoCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLAogICAgICAgICAgICAgICAgICAgIGZvcnVtSUQ6IGZvcnVtLmlkLAogICAgICAgICAgICAgICAgICAgIGF1dGhvcklEOiB1c2VyLmlkLAogICAgICAgICAgICAgICAgICAgIGNyZWF0ZWREYXRlOiBEYXRlKCksCiAgICAgICAgICAgICAgICAgICAgbGFzdFBvc3REYXRlOiBEYXRlKCksCiAgICAgICAgICAgICAgICAgICAgbGFzdFBvc3RVc2VySUQ6IHVzZXIuaWQsCiAgICAgICAgICAgICAgICAgICAgcG9zdENvdW50OiAxLAogICAgICAgICAgICAgICAgICAgIHZpZXdDb3VudDogMCwKICAgICAgICAgICAgICAgICAgICBpc1N0aWNreTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgaXNMb2NrZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGlzQW5ub3VuY2VtZW50OiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBpc0hpZGRlbjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdGFnczogdGFncywKICAgICAgICAgICAgICAgICAgICBwb2xsSUQ6IG5pbAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBuZXdUaHJlYWQgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNyZWF0ZVRocmVhZChuZXdUaHJlYWQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxldCBhdHRhY2htZW50SURzID0gYXR0YWNobWVudHMubWFwIHsgJDAuaWQgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaW5pdGlhbFBvc3QgPSBGb3J1bVBvc3QoCiAgICAgICAgICAgICAgICAgICAgdGhyZWFkSUQ6IG5ld1RocmVhZC5pZCwKICAgICAgICAgICAgICAgICAgICBhdXRob3JJRDogdXNlci5pZCwKICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LAogICAgICAgICAgICAgICAgICAgIGNyZWF0ZWREYXRlOiBEYXRlKCksCiAgICAgICAgICAgICAgICAgICAgZWRpdGVkRGF0ZTogbmlsLAogICAgICAgICAgICAgICAgICAgIGVkaXRlZEJ5VXNlcklEOiBuaWwsCiAgICAgICAgICAgICAgICAgICAgZWRpdFJlYXNvbjogbmlsLAogICAgICAgICAgICAgICAgICAgIGlzSGlkZGVuOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBsaWtlQ291bnQ6IDAsCiAgICAgICAgICAgICAgICAgICAgcXVvdGVDb3VudDogMCwKICAgICAgICAgICAgICAgICAgICBhdHRhY2htZW50SURzOiBhdHRhY2htZW50SURzLAogICAgICAgICAgICAgICAgICAgIHF1b3RlZFBvc3RJRHM6IFtdLAogICAgICAgICAgICAgICAgICAgIHBhcmVudFBvc3RJRDogbmlsLAogICAgICAgICAgICAgICAgICAgIHBvc3ROdW1iZXI6IDEKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaW5pdGlhbFBvc3QgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNyZWF0ZVBvc3QoaW5pdGlhbFBvc3QpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG5ld1RocmVhZC5sYXN0UG9zdERhdGUgPSBpbml0aWFsUG9zdC5jcmVhdGVkRGF0ZQogICAgICAgICAgICAgICAgbmV3VGhyZWFkLmxhc3RQb3N0VXNlcklEID0gaW5pdGlhbFBvc3QuYXV0aG9ySUQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgXyA9IHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIudXBkYXRlVGhyZWFkKG5ld1RocmVhZCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZGlzbWlzcygpCiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24KICAgICAgICAgICAgfQogICAgICAgICAgICBpc1Bvc3RpbmcgPSBmYWxzZQogICAgICAgIH0KICAgIH0KfQoKI1ByZXZpZXcgewogICAgTmV3VGhyZWFkVmlldyhmb3J1bTogRm9ydW0oCiAgICAgICAgaWQ6ICJnZW5lcmFsIiwKICAgICAgICBuYW1lOiAiR2VuZXJhbCBEaXNjdXNzaW9uIiwKICAgICAgICBkZXNjcmlwdGlvbjogIlRhbGsgYWJvdXQgYW55dGhpbmciLAogICAgICAgIHBhcmVudEZvcnVtSUQ6IG5pbCwKICAgICAgICBkaXNwbGF5T3JkZXI6IDEsCiAgICAgICAgaXNMb2NrZWQ6IGZhbHNlLAogICAgICAgIGlzSGlkZGVuOiBmYWxzZSwKICAgICAgICByZXF1aXJlZFBlcm1pc3Npb25zOiBbXSwKICAgICAgICB0aHJlYWRDb3VudDogMCwKICAgICAgICBwb3N0Q291bnQ6IDAsCiAgICAgICAgbGFzdFBvc3RJRDogbmlsLAogICAgICAgIGxhc3RQb3N0RGF0ZTogbmlsLAogICAgICAgIGxhc3RQb3N0VXNlcklEOiBuaWwsCiAgICAgICAgY3JlYXRlZERhdGU6IERhdGUoKSwKICAgICAgICBjcmVhdGVkQnlVc2VySUQ6ICJhZG1pbiIKICAgICkpCiAgICAuZW52aXJvbm1lbnRPYmplY3QoQ2xvdWRLaXRNYW5hZ2VyLnNoYXJlZCkKICAgIC5lbnZpcm9ubWVudE9iamVjdChBdHRhY2htZW50TWFuYWdlci5zaGFyZWQpCn0K
--- END ---

--- FILE: MacChan/Views/Forum+NSFW.swift ---
BASE64: aW1wb3J0IEZvdW5kYXRpb24KCmV4dGVuc2lvbiBGb3J1bSB7CiAgICAvLy8gU3R1YiBwcm9wZXJ0eTogcmV0dXJucyB0cnVlIGZvciBmb3J1bXMgd2l0aCAibnNmdyIgaW4gdGhlaXIgaWQgb3IgbmFtZSAoZm9yIGRlbW8pLgogICAgdmFyIGlzTlNGVzogQm9vbCB7CiAgICAgICAgaWQubG93ZXJjYXNlZCgpLmNvbnRhaW5zKCJuc2Z3IikgfHwKICAgICAgICBuYW1lLmxvd2VyY2FzZWQoKS5jb250YWlucygibnNmdyIpCiAgICB9Cn0K
--- END ---

--- FILE: MacChan/Views/MessageViews.swift ---
BASE64: Ly8KLy8gIE5PVEUgVE8gREVWRUxPUEVSOiBUaGlzIGlzIHRoZSBtYWNPUy1zcGVjaWZpYyB2ZXJzaW9uIG9mIHRoaXMgdmlldy4KLy8gIE9ubHkgYWRkIG1hY09TL2Nyb3NzLXBsYXRmb3JtIGNvbXBhdGlibGUgY29kZSBoZXJlLiBEbyBub3QgYWRkIGlPUy1zcGVjaWZpYyBBUElzLgovLwppbXBvcnQgU3dpZnRVSQoKcHJpdmF0ZSBsZXQgZGF0ZUZvcm1hdHRlcjogRGF0ZUZvcm1hdHRlciA9IHsKICAgIGxldCBmb3JtYXR0ZXIgPSBEYXRlRm9ybWF0dGVyKCkKICAgIGZvcm1hdHRlci5kYXRlU3R5bGUgPSAubWVkaXVtCiAgICBmb3JtYXR0ZXIudGltZVN0eWxlID0gLm5vbmUKICAgIHJldHVybiBmb3JtYXR0ZXIKfSgpCgpzdHJ1Y3QgTWVzc2FnZURldGFpbFZpZXc6IFZpZXcgewogICAgbGV0IG1lc3NhZ2U6IFByaXZhdGVNZXNzYWdlCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzZW5kZXI6IEZvcnVtVXNlcj8KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nUmVwbHkgPSBmYWxzZQogICAgCiAgICB2YXIgYm9keTogc29tZSBWaWV3IHsKICAgICAgICBTY3JvbGxWaWV3IHsKICAgICAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDE2KSB7CiAgICAgICAgICAgICAgICAvLyBNZXNzYWdlIGhlYWRlcgogICAgICAgICAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDgpIHsKICAgICAgICAgICAgICAgICAgICBUZXh0KG1lc3NhZ2Uuc3ViamVjdCkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLnRpdGxlMikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnRXZWlnaHQoLmJvbGQpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCgiRnJvbTogXChzZW5kZXI/LmRpc3BsYXlOYW1lID8/ICJVbmtub3duIFVzZXIiKSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguc3ViaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dChtZXNzYWdlLnNlbnREYXRlLCBmb3JtYXR0ZXI6IGRhdGVGb3JtYXR0ZXIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5ncmF5Lm9wYWNpdHkoMC4xNSkpCiAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDgpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIE1lc3NhZ2UgY29udGVudAogICAgICAgICAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDEyKSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dCgiTWVzc2FnZSIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBsZXQgcGFyc2VkQ29udGVudCA9IEJCQ29kZVBhcnNlci5zaGFyZWQucGFyc2UobWVzc2FnZS5jb250ZW50KQogICAgICAgICAgICAgICAgICAgIFRleHQocGFyc2VkQ29udGVudCkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmJvZHkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnByaW1hcnkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5wcmltYXJ5Lm9wYWNpdHkoMC4wNSkpCiAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDgpCiAgICAgICAgICAgICAgICAub3ZlcmxheSgKICAgICAgICAgICAgICAgICAgICBSb3VuZGVkUmVjdGFuZ2xlKGNvcm5lclJhZGl1czogOCkKICAgICAgICAgICAgICAgICAgICAgICAgLnN0cm9rZShDb2xvci5ncmF5Lm9wYWNpdHkoMC40KSwgbGluZVdpZHRoOiAxKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBSZXBseSBidXR0b24KICAgICAgICAgICAgICAgIEJ1dHRvbigiUmVwbHkiKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd2luZ1JlcGx5ID0gdHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLmJ1dHRvblN0eWxlKC5ib3JkZXJlZFByb21pbmVudCkKICAgICAgICAgICAgICAgIC5mcmFtZShtYXhXaWR0aDogLmluZmluaXR5KQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICB9CiAgICAgICAgLm5hdmlnYXRpb25UaXRsZSgiTWVzc2FnZSIpCiAgICAgICAgLnRhc2sgewogICAgICAgICAgICBhd2FpdCBsb2FkU2VuZGVyKCkKICAgICAgICAgICAgYXdhaXQgbWFya0FzUmVhZCgpCiAgICAgICAgfQogICAgICAgIC5zaGVldChpc1ByZXNlbnRlZDogJHNob3dpbmdSZXBseSkgewogICAgICAgICAgICBSZXBseVRvTWVzc2FnZVZpZXcob3JpZ2luYWxNZXNzYWdlOiBtZXNzYWdlKQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGxvYWRTZW5kZXIoKSBhc3luYyB7CiAgICAgICAgZG8gewogICAgICAgICAgICBzZW5kZXIgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmZldGNoVXNlcihtZXNzYWdlLnNlbmRlcklEKQogICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIGxvYWQgc2VuZGVyOiBcKGVycm9yKSIpCiAgICAgICAgfQogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgbWFya0FzUmVhZCgpIGFzeW5jIHsKICAgICAgICBkbyB7CiAgICAgICAgICAgIHRyeSBhd2FpdCBjbG91ZEtpdE1hbmFnZXIubWFya01lc3NhZ2VBc1JlYWQobWVzc2FnZS5pZCkKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBtYXJrIG1lc3NhZ2UgYXMgcmVhZDogXChlcnJvcikiKQogICAgICAgIH0KICAgIH0KfQoKc3RydWN0IENvbXBvc2VNZXNzYWdlVmlldzogVmlldyB7CiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBFbnZpcm9ubWVudChcLmRpc21pc3MpIHByaXZhdGUgdmFyIGRpc21pc3MKICAgIAogICAgQFN0YXRlIHByaXZhdGUgdmFyIHJlY2lwaWVudCA9ICIiCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc3ViamVjdCA9ICIiCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgY29udGVudCA9ICIiCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgaXNTZW5kaW5nID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBlcnJvck1lc3NhZ2U6IFN0cmluZz8KICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzaG93aW5nUmVjaXBpZW50U2VhcmNoID0gZmFsc2UKICAgIEBTdGF0ZSBwcml2YXRlIHZhciBzZWFyY2hSZXN1bHRzOiBbRm9ydW1Vc2VyXSA9IFtdCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgc2VsZWN0ZWRSZWNpcGllbnQ6IEZvcnVtVXNlcj8KICAgIAogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgTmF2aWdhdGlvblZpZXcgewogICAgICAgICAgICBGb3JtIHsKICAgICAgICAgICAgICAgIFNlY3Rpb24oIlJlY2lwaWVudCIpIHsKICAgICAgICAgICAgICAgICAgICBIU3RhY2sgewogICAgICAgICAgICAgICAgICAgICAgICBUZXh0RmllbGQoIlVzZXJuYW1lIG9yIGVtYWlsIiwgdGV4dDogJHJlY2lwaWVudCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0RmllbGRTdHlsZShSb3VuZGVkQm9yZGVyVGV4dEZpZWxkU3R5bGUoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vblN1Ym1pdCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoUmVjaXBpZW50cygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlNlYXJjaCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFJlY2lwaWVudHMoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC5kaXNhYmxlZChyZWNpcGllbnQudHJpbW1pbmdDaGFyYWN0ZXJzKGluOiAud2hpdGVzcGFjZXNBbmROZXdsaW5lcykuaXNFbXB0eSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgbGV0IHNlbGVjdGVkUmVjaXBpZW50ID0gc2VsZWN0ZWRSZWNpcGllbnQgewogICAgICAgICAgICAgICAgICAgICAgICBIU3RhY2sgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCgiVG86IFwoc2VsZWN0ZWRSZWNpcGllbnQuZGlzcGxheU5hbWUpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguc3ViaGVhZGxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlJlbW92ZSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkUmVjaXBpZW50ID0gbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50ID0gIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigucmVkKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBTZWN0aW9uKCJNZXNzYWdlIikgewogICAgICAgICAgICAgICAgICAgIFRleHRGaWVsZCgiU3ViamVjdCIsIHRleHQ6ICRzdWJqZWN0KQogICAgICAgICAgICAgICAgICAgICAgICAudGV4dEZpZWxkU3R5bGUoUm91bmRlZEJvcmRlclRleHRGaWVsZFN0eWxlKCkpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgVGV4dEZpZWxkKCJNZXNzYWdlIGNvbnRlbnQiLCB0ZXh0OiAkY29udGVudCwgYXhpczogLnZlcnRpY2FsKQogICAgICAgICAgICAgICAgICAgICAgICAudGV4dEZpZWxkU3R5bGUoUm91bmRlZEJvcmRlclRleHRGaWVsZFN0eWxlKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5saW5lTGltaXQoNS4uLjE1KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAhc2VhcmNoUmVzdWx0cy5pc0VtcHR5IHsKICAgICAgICAgICAgICAgICAgICBTZWN0aW9uKCJTZWFyY2ggUmVzdWx0cyIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgRm9yRWFjaChzZWFyY2hSZXN1bHRzKSB7IHVzZXIgaW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ1dHRvbihhY3Rpb246IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RSZWNpcGllbnQodXNlcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIU3RhY2sgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWU3RhY2soYWxpZ25tZW50OiAubGVhZGluZykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCh1c2VyLmRpc3BsYXlOYW1lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5wcmltYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0KCJAXCh1c2VyLnVzZXJuYW1lKSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmNhcHRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTcGFjZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2VsZWN0ZWRSZWNpcGllbnQ/LmlkID09IHVzZXIuaWQgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW1hZ2Uoc3lzdGVtTmFtZTogImNoZWNrbWFyayIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguYmx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJDb21wb3NlIE1lc3NhZ2UiKQogICAgICAgICAgICAudG9vbGJhciB7CiAgICAgICAgICAgICAgICBUb29sYmFySXRlbSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJDYW5jZWwiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc21pc3MoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBUb29sYmFySXRlbSB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKCJTZW5kIikgewogICAgICAgICAgICAgICAgICAgICAgICBzZW5kTWVzc2FnZSgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC5kaXNhYmxlZChzZWxlY3RlZFJlY2lwaWVudCA9PSBuaWwgfHwgc3ViamVjdC5pc0VtcHR5IHx8IGNvbnRlbnQuaXNFbXB0eSB8fCBpc1NlbmRpbmcpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLmFsZXJ0KCJFcnJvciIsIGlzUHJlc2VudGVkOiAuY29uc3RhbnQoZXJyb3JNZXNzYWdlICE9IG5pbCkpIHsKICAgICAgICAgICAgICAgIEJ1dHRvbigiT0siKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gbmlsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gbWVzc2FnZTogewogICAgICAgICAgICAgICAgaWYgbGV0IGVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZSB7CiAgICAgICAgICAgICAgICAgICAgVGV4dChlcnJvck1lc3NhZ2UpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBzZWFyY2hSZWNpcGllbnRzKCkgewogICAgICAgIGxldCBxdWVyeSA9IHJlY2lwaWVudC50cmltbWluZ0NoYXJhY3RlcnMoaW46IC53aGl0ZXNwYWNlc0FuZE5ld2xpbmVzKQogICAgICAgIGd1YXJkICFxdWVyeS5pc0VtcHR5IGVsc2UgeyByZXR1cm4gfQogICAgICAgIAogICAgICAgIFRhc2sgewogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICBzZWFyY2hSZXN1bHRzID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5zZWFyY2hVc2VycyhxdWVyeTogcXVlcnkpCiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkZhaWxlZCB0byBzZWFyY2ggdXNlcnM6IFwoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgc2VsZWN0UmVjaXBpZW50KF8gdXNlcjogRm9ydW1Vc2VyKSB7CiAgICAgICAgc2VsZWN0ZWRSZWNpcGllbnQgPSB1c2VyCiAgICAgICAgcmVjaXBpZW50ID0gdXNlci51c2VybmFtZQogICAgICAgIHNlYXJjaFJlc3VsdHMgPSBbXQogICAgfQogICAgCiAgICBwcml2YXRlIGZ1bmMgc2VuZE1lc3NhZ2UoKSB7CiAgICAgICAgZ3VhcmQgbGV0IGN1cnJlbnRVc2VyID0gY2xvdWRLaXRNYW5hZ2VyLmN1cnJlbnRVc2VyLAogICAgICAgICAgICAgIGxldCByZWNpcGllbnQgPSBzZWxlY3RlZFJlY2lwaWVudCBlbHNlIHsgcmV0dXJuIH0KICAgICAgICAKICAgICAgICBpc1NlbmRpbmcgPSB0cnVlCiAgICAgICAgCiAgICAgICAgVGFzayB7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIGxldCBtZXNzYWdlID0gUHJpdmF0ZU1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgc3ViamVjdDogc3ViamVjdCwKICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LAogICAgICAgICAgICAgICAgICAgIHNlbmRlcklEOiBjdXJyZW50VXNlci5pZCwKICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRJRDogcmVjaXBpZW50LmlkCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIF8gPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmNyZWF0ZVByaXZhdGVNZXNzYWdlKG1lc3NhZ2UpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGF3YWl0IE1haW5BY3Rvci5ydW4gewogICAgICAgICAgICAgICAgICAgIGRpc21pc3MoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIGF3YWl0IE1haW5BY3Rvci5ydW4gewogICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9ICJGYWlsZWQgdG8gc2VuZCBtZXNzYWdlOiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICAgICAgICAgICAgICBpc1NlbmRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgpzdHJ1Y3QgUmVwbHlUb01lc3NhZ2VWaWV3OiBWaWV3IHsKICAgIGxldCBvcmlnaW5hbE1lc3NhZ2U6IFByaXZhdGVNZXNzYWdlCiAgICBARW52aXJvbm1lbnRPYmplY3QgcHJpdmF0ZSB2YXIgY2xvdWRLaXRNYW5hZ2VyOiBDbG91ZEtpdE1hbmFnZXIKICAgIEBFbnZpcm9ubWVudChcLmRpc21pc3MpIHByaXZhdGUgdmFyIGRpc21pc3MKICAgIAogICAgQFN0YXRlIHByaXZhdGUgdmFyIGNvbnRlbnQgPSAiIgogICAgQFN0YXRlIHByaXZhdGUgdmFyIGlzU2VuZGluZyA9IGZhbHNlCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgZXJyb3JNZXNzYWdlOiBTdHJpbmc/CiAgICAKICAgIHZhciBib2R5OiBzb21lIFZpZXcgewogICAgICAgIE5hdmlnYXRpb25WaWV3IHsKICAgICAgICAgICAgVlN0YWNrIHsKICAgICAgICAgICAgICAgIC8vIFNob3cgb3JpZ2luYWwgbWVzc2FnZQogICAgICAgICAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDgpIHsKICAgICAgICAgICAgICAgICAgICBUZXh0KCJSZXBseWluZyB0bzoiKQogICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIFRleHQob3JpZ2luYWxNZXNzYWdlLnN1YmplY3QpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5oZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigucHJpbWFyeSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBUZXh0KG9yaWdpbmFsTWVzc2FnZS5jb250ZW50KQogICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguYm9keSkKICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgICAgICAgICAgICAgIC5iYWNrZ3JvdW5kKENvbG9yLmdyYXkub3BhY2l0eSgwLjE1KSkKICAgICAgICAgICAgICAgICAgICAgICAgLmNvcm5lclJhZGl1cyg4KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBSZXBseSBjb250ZW50CiAgICAgICAgICAgICAgICBUZXh0RWRpdG9yKHRleHQ6ICRjb250ZW50KQogICAgICAgICAgICAgICAgICAgIC5wYWRkaW5nKCkKICAgICAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5wcmltYXJ5Lm9wYWNpdHkoMC4wNSkpCiAgICAgICAgICAgICAgICAgICAgLmNvcm5lclJhZGl1cyg4KQogICAgICAgICAgICAgICAgICAgIC5vdmVybGF5KAogICAgICAgICAgICAgICAgICAgICAgICBSb3VuZGVkUmVjdGFuZ2xlKGNvcm5lclJhZGl1czogOCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHJva2UoQ29sb3IuZ3JheS5vcGFjaXR5KDAuNCksIGxpbmVXaWR0aDogMSkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFNwYWNlcigpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJSZXBseSIpCiAgICAgICAgICAgIC50b29sYmFyIHsKICAgICAgICAgICAgICAgIFRvb2xiYXJJdGVtIHsKICAgICAgICAgICAgICAgICAgICBCdXR0b24oIkNhbmNlbCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGlzbWlzcygpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIFRvb2xiYXJJdGVtIHsKICAgICAgICAgICAgICAgICAgICBCdXR0b24oIlNlbmQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRSZXBseSgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC5kaXNhYmxlZChjb250ZW50LnRyaW1taW5nQ2hhcmFjdGVycyhpbjogLndoaXRlc3BhY2VzQW5kTmV3bGluZXMpLmlzRW1wdHkgfHwgaXNTZW5kaW5nKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5hbGVydCgiRXJyb3IiLCBpc1ByZXNlbnRlZDogLmNvbnN0YW50KGVycm9yTWVzc2FnZSAhPSBuaWwpKSB7CiAgICAgICAgICAgICAgICBCdXR0b24oIk9LIikgewogICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IG5pbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IG1lc3NhZ2U6IHsKICAgICAgICAgICAgICAgIGlmIGxldCBlcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UgewogICAgICAgICAgICAgICAgICAgIFRleHQoZXJyb3JNZXNzYWdlKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC5vbkFwcGVhciB7CiAgICAgICAgICAgICAgICBjb250ZW50ID0gIlxuXG4tLS0gT3JpZ2luYWwgTWVzc2FnZSAtLS1cblwob3JpZ2luYWxNZXNzYWdlLmNvbnRlbnQpXG4tLS0gRW5kIE9yaWdpbmFsIE1lc3NhZ2UgLS0tXG5cbiIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIHNlbmRSZXBseSgpIHsKICAgICAgICBndWFyZCBsZXQgY3VycmVudFVzZXIgPSBjbG91ZEtpdE1hbmFnZXIuY3VycmVudFVzZXIgZWxzZSB7IHJldHVybiB9CiAgICAgICAgCiAgICAgICAgaXNTZW5kaW5nID0gdHJ1ZQogICAgICAgIAogICAgICAgIFRhc2sgewogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICBsZXQgcmVwbHkgPSBQcml2YXRlTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICBzdWJqZWN0OiAiUmU6IFwob3JpZ2luYWxNZXNzYWdlLnN1YmplY3QpIiwKICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LAogICAgICAgICAgICAgICAgICAgIHNlbmRlcklEOiBjdXJyZW50VXNlci5pZCwKICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRJRDogb3JpZ2luYWxNZXNzYWdlLnNlbmRlcklELAogICAgICAgICAgICAgICAgICAgIHJlcGx5VG9NZXNzYWdlSUQ6IG9yaWdpbmFsTWVzc2FnZS5pZAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBfID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5jcmVhdGVQcml2YXRlTWVzc2FnZShyZXBseSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgZGlzbWlzcygpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggewogICAgICAgICAgICAgICAgYXdhaXQgTWFpbkFjdG9yLnJ1biB7CiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkZhaWxlZCB0byBzZW5kIHJlcGx5OiBcKGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKSIKICAgICAgICAgICAgICAgICAgICBpc1NlbmRpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgpzdHJ1Y3QgUG9zdERldGFpbFZpZXc6IFZpZXcgewogICAgbGV0IHBvc3Q6IEZvcnVtUG9zdAogICAgQEVudmlyb25tZW50T2JqZWN0IHByaXZhdGUgdmFyIGNsb3VkS2l0TWFuYWdlcjogQ2xvdWRLaXRNYW5hZ2VyCiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgYXV0aG9yOiBGb3J1bVVzZXI/CiAgICBAU3RhdGUgcHJpdmF0ZSB2YXIgdGhyZWFkOiBGb3J1bVRocmVhZD8KICAgIAogICAgdmFyIGJvZHk6IHNvbWUgVmlldyB7CiAgICAgICAgU2Nyb2xsVmlldyB7CiAgICAgICAgICAgIFZTdGFjayhhbGlnbm1lbnQ6IC5sZWFkaW5nLCBzcGFjaW5nOiAxNikgewogICAgICAgICAgICAgICAgLy8gUG9zdCBoZWFkZXIKICAgICAgICAgICAgICAgIFZTdGFjayhhbGlnbm1lbnQ6IC5sZWFkaW5nLCBzcGFjaW5nOiA4KSB7CiAgICAgICAgICAgICAgICAgICAgSFN0YWNrIHsKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dChhdXRob3I/LmRpc3BsYXlOYW1lID8/ICJVbmtub3duIFVzZXIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvbnQoLmhlYWRsaW5lKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvcigucHJpbWFyeSkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIFNwYWNlcigpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0KHBvc3QuY3JlYXRlZERhdGUsIGZvcm1hdHRlcjogZGF0ZUZvcm1hdHRlcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmVncm91bmRDb2xvciguc2Vjb25kYXJ5KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBsZXQgdGhyZWFkID0gdGhyZWFkIHsKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dCgiaW4gXCh0aHJlYWQudGl0bGUpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5zdWJoZWFkbGluZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgICAgICAuYmFja2dyb3VuZChDb2xvci5ncmF5Lm9wYWNpdHkoMC4xNSkpCiAgICAgICAgICAgICAgICAuY29ybmVyUmFkaXVzKDgpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFBvc3QgY29udGVudAogICAgICAgICAgICAgICAgVlN0YWNrKGFsaWdubWVudDogLmxlYWRpbmcsIHNwYWNpbmc6IDEyKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcnNlZENvbnRlbnQgPSBCQkNvZGVQYXJzZXIuc2hhcmVkLnBhcnNlKHBvc3QuY29udGVudCkKICAgICAgICAgICAgICAgICAgICBUZXh0KHBhcnNlZENvbnRlbnQpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5ib2R5KQogICAgICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5wcmltYXJ5KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgICAgICAgICAgLmJhY2tncm91bmQoQ29sb3IucHJpbWFyeS5vcGFjaXR5KDAuMDUpKQogICAgICAgICAgICAgICAgLmNvcm5lclJhZGl1cyg4KQogICAgICAgICAgICAgICAgLm92ZXJsYXkoCiAgICAgICAgICAgICAgICAgICAgUm91bmRlZFJlY3RhbmdsZShjb3JuZXJSYWRpdXM6IDgpCiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHJva2UoQ29sb3IuZ3JheS5vcGFjaXR5KDAuNCksIGxpbmVXaWR0aDogMSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gUG9zdCBmb290ZXIKICAgICAgICAgICAgICAgIEhTdGFjayB7CiAgICAgICAgICAgICAgICAgICAgQnV0dG9uKGFjdGlvbjogewogICAgICAgICAgICAgICAgICAgICAgICAvLyBMaWtlIHBvc3QKICAgICAgICAgICAgICAgICAgICB9KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEhTdGFjayhzcGFjaW5nOiA0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbWFnZShzeXN0ZW1OYW1lOiAiaGVhcnQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb250KC5jYXB0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnJlZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIlwocG9zdC5saWtlQ291bnQpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAuZm9yZWdyb3VuZENvbG9yKC5zZWNvbmRhcnkpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgU3BhY2VyKCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBsZXQgZWRpdGVkRGF0ZSA9IHBvc3QuZWRpdGVkRGF0ZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRleHQoIkVkaXRlZCBcKGVkaXRlZERhdGUsIGZvcm1hdHRlcjogcmVsYXRpdmVEYXRlRm9ybWF0dGVyKSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9udCguY2FwdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JlZ3JvdW5kQ29sb3IoLnNlY29uZGFyeSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAucGFkZGluZygpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLnBhZGRpbmcoKQogICAgICAgIH0KICAgICAgICAubmF2aWdhdGlvblRpdGxlKCJQb3N0IikKICAgICAgICAudGFzayB7CiAgICAgICAgICAgIGF3YWl0IGxvYWRBdXRob3IoKQogICAgICAgICAgICBhd2FpdCBsb2FkVGhyZWFkKCkKICAgICAgICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgZnVuYyBsb2FkQXV0aG9yKCkgYXN5bmMgewogICAgICAgIGRvIHsKICAgICAgICAgICAgYXV0aG9yID0gdHJ5IGF3YWl0IGNsb3VkS2l0TWFuYWdlci5mZXRjaFVzZXIocG9zdC5hdXRob3JJRCkKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBsb2FkIGF1dGhvcjogXChlcnJvcikiKQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSBmdW5jIGxvYWRUaHJlYWQoKSBhc3luYyB7CiAgICAgICAgZG8gewogICAgICAgICAgICB0aHJlYWQgPSB0cnkgYXdhaXQgY2xvdWRLaXRNYW5hZ2VyLmZldGNoVGhyZWFkcyhmb3I6IHBvc3QudGhyZWFkSUQpLmZpcnN0CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHByaW50KCJGYWlsZWQgdG8gbG9hZCB0aHJlYWQ6IFwoZXJyb3IpIikKICAgICAgICB9CiAgICB9CgoKfQoKI1ByZXZpZXcgewogICAgTmF2aWdhdGlvblZpZXcgewogICAgICAgIE1lc3NhZ2VEZXRhaWxWaWV3KG1lc3NhZ2U6IFByaXZhdGVNZXNzYWdlKHN1YmplY3Q6ICJUZXN0IE1lc3NhZ2UiLCBjb250ZW50OiAiVGhpcyBpcyBhIHRlc3QgbWVzc2FnZSIsIHNlbmRlcklEOiAidXNlcjEiLCByZWNpcGllbnRJRDogInVzZXIyIikpCiAgICAgICAgICAgIC5lbnZpcm9ubWVudE9iamVjdChDbG91ZEtpdE1hbmFnZXIuc2hhcmVkKQogICAgfQp9Cg==
--- END ---

--- FILE: MacChanUITests/MacChanUITestsLaunchTests.swift ---
BASE64: Ly8KLy8gIE1hY0NoYW5VSVRlc3RzTGF1bmNoVGVzdHMuc3dpZnQKLy8gIE1hY0NoYW5VSVRlc3RzCi8vCi8vICBDcmVhdGVkIGJ5IEphcmVkIE1heHdlbGwgb24gOS8zLzI1LgovLwoKaW1wb3J0IFhDVGVzdAoKZmluYWwgY2xhc3MgTWFjQ2hhblVJVGVzdHNMYXVuY2hUZXN0czogWENUZXN0Q2FzZSB7CgogICAgb3ZlcnJpZGUgY2xhc3MgdmFyIHJ1bnNGb3JFYWNoVGFyZ2V0QXBwbGljYXRpb25VSUNvbmZpZ3VyYXRpb246IEJvb2wgewogICAgICAgIHRydWUKICAgIH0KCiAgICBvdmVycmlkZSBmdW5jIHNldFVwV2l0aEVycm9yKCkgdGhyb3dzIHsKICAgICAgICBjb250aW51ZUFmdGVyRmFpbHVyZSA9IGZhbHNlCiAgICB9CgogICAgQE1haW5BY3RvcgogICAgZnVuYyB0ZXN0TGF1bmNoKCkgdGhyb3dzIHsKICAgICAgICBsZXQgYXBwID0gWENVSUFwcGxpY2F0aW9uKCkKICAgICAgICBhcHAubGF1bmNoKCkKCiAgICAgICAgLy8gSW5zZXJ0IHN0ZXBzIGhlcmUgdG8gcGVyZm9ybSBhZnRlciBhcHAgbGF1bmNoIGJ1dCBiZWZvcmUgdGFraW5nIGEgc2NyZWVuc2hvdCwKICAgICAgICAvLyBzdWNoIGFzIGxvZ2dpbmcgaW50byBhIHRlc3QgYWNjb3VudCBvciBuYXZpZ2F0aW5nIHNvbWV3aGVyZSBpbiB0aGUgYXBwCgogICAgICAgIGxldCBhdHRhY2htZW50ID0gWENUQXR0YWNobWVudChzY3JlZW5zaG90OiBhcHAuc2NyZWVuc2hvdCgpKQogICAgICAgIGF0dGFjaG1lbnQubmFtZSA9ICJMYXVuY2ggU2NyZWVuIgogICAgICAgIGF0dGFjaG1lbnQubGlmZXRpbWUgPSAua2VlcEFsd2F5cwogICAgICAgIGFkZChhdHRhY2htZW50KQogICAgfQp9Cg==
--- END ---

--- FILE: MacChanUITests/MacChanUITests.swift ---
BASE64: Ly8KLy8gIE1hY0NoYW5VSVRlc3RzLnN3aWZ0Ci8vICBNYWNDaGFuVUlUZXN0cwovLwovLyAgQ3JlYXRlZCBieSBKYXJlZCBNYXh3ZWxsIG9uIDkvMy8yNS4KLy8KCmltcG9ydCBYQ1Rlc3QKCmZpbmFsIGNsYXNzIE1hY0NoYW5VSVRlc3RzOiBYQ1Rlc3RDYXNlIHsKCiAgICBvdmVycmlkZSBmdW5jIHNldFVwV2l0aEVycm9yKCkgdGhyb3dzIHsKICAgICAgICAvLyBQdXQgc2V0dXAgY29kZSBoZXJlLiBUaGlzIG1ldGhvZCBpcyBjYWxsZWQgYmVmb3JlIHRoZSBpbnZvY2F0aW9uIG9mIGVhY2ggdGVzdCBtZXRob2QgaW4gdGhlIGNsYXNzLgoKICAgICAgICAvLyBJbiBVSSB0ZXN0cyBpdCBpcyB1c3VhbGx5IGJlc3QgdG8gc3RvcCBpbW1lZGlhdGVseSB3aGVuIGEgZmFpbHVyZSBvY2N1cnMuCiAgICAgICAgY29udGludWVBZnRlckZhaWx1cmUgPSBmYWxzZQoKICAgICAgICAvLyBJbiBVSSB0ZXN0cyBpdOKAmXMgaW1wb3J0YW50IHRvIHNldCB0aGUgaW5pdGlhbCBzdGF0ZSAtIHN1Y2ggYXMgaW50ZXJmYWNlIG9yaWVudGF0aW9uIC0gcmVxdWlyZWQgZm9yIHlvdXIgdGVzdHMgYmVmb3JlIHRoZXkgcnVuLiBUaGUgc2V0VXAgbWV0aG9kIGlzIGEgZ29vZCBwbGFjZSB0byBkbyB0aGlzLgogICAgfQoKICAgIG92ZXJyaWRlIGZ1bmMgdGVhckRvd25XaXRoRXJyb3IoKSB0aHJvd3MgewogICAgICAgIC8vIFB1dCB0ZWFyZG93biBjb2RlIGhlcmUuIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCBhZnRlciB0aGUgaW52b2NhdGlvbiBvZiBlYWNoIHRlc3QgbWV0aG9kIGluIHRoZSBjbGFzcy4KICAgIH0KCiAgICBATWFpbkFjdG9yCiAgICBmdW5jIHRlc3RFeGFtcGxlKCkgdGhyb3dzIHsKICAgICAgICAvLyBVSSB0ZXN0cyBtdXN0IGxhdW5jaCB0aGUgYXBwbGljYXRpb24gdGhhdCB0aGV5IHRlc3QuCiAgICAgICAgbGV0IGFwcCA9IFhDVUlBcHBsaWNhdGlvbigpCiAgICAgICAgYXBwLmxhdW5jaCgpCgogICAgICAgIC8vIFVzZSBYQ1RBc3NlcnQgYW5kIHJlbGF0ZWQgZnVuY3Rpb25zIHRvIHZlcmlmeSB5b3VyIHRlc3RzIHByb2R1Y2UgdGhlIGNvcnJlY3QgcmVzdWx0cy4KICAgIH0KCiAgICBATWFpbkFjdG9yCiAgICBmdW5jIHRlc3RMYXVuY2hQZXJmb3JtYW5jZSgpIHRocm93cyB7CiAgICAgICAgLy8gVGhpcyBtZWFzdXJlcyBob3cgbG9uZyBpdCB0YWtlcyB0byBsYXVuY2ggeW91ciBhcHBsaWNhdGlvbi4KICAgICAgICBtZWFzdXJlKG1ldHJpY3M6IFtYQ1RBcHBsaWNhdGlvbkxhdW5jaE1ldHJpYygpXSkgewogICAgICAgICAgICBYQ1VJQXBwbGljYXRpb24oKS5sYXVuY2goKQogICAgICAgIH0KICAgIH0KfQo=
--- END ---

--- FILE: MacChanTests/MacChanTests.swift ---
BASE64: Ly8KLy8gIE1hY0NoYW5UZXN0cy5zd2lmdAovLyAgTWFjQ2hhblRlc3RzCi8vCi8vICBDcmVhdGVkIGJ5IEphcmVkIE1heHdlbGwgb24gOS8zLzI1LgovLwoKaW1wb3J0IFhDVGVzdAoKZmluYWwgY2xhc3MgTWFjQ2hhblRlc3RzOiBYQ1Rlc3RDYXNlIHsKCiAgICBvdmVycmlkZSBmdW5jIHNldFVwV2l0aEVycm9yKCkgdGhyb3dzIHsKICAgICAgICAvLyBQdXQgc2V0dXAgY29kZSBoZXJlLiBUaGlzIG1ldGhvZCBpcyBjYWxsZWQgYmVmb3JlIHRoZSBpbnZvY2F0aW9uIG9mIGVhY2ggdGVzdCBtZXRob2QgaW4gdGhlIGNsYXNzLgogICAgfQoKICAgIG92ZXJyaWRlIGZ1bmMgdGVhckRvd25XaXRoRXJyb3IoKSB0aHJvd3MgewogICAgICAgIC8vIFB1dCB0ZWFyZG93biBjb2RlIGhlcmUuIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCBhZnRlciB0aGUgaW52b2NhdGlvbiBvZiBlYWNoIHRlc3QgbWV0aG9kIGluIHRoZSBjbGFzcy4KICAgIH0KCiAgICBmdW5jIHRlc3RFeGFtcGxlKCkgdGhyb3dzIHsKICAgICAgICAvLyBUaGlzIGlzIGFuIGV4YW1wbGUgb2YgYSBmdW5jdGlvbmFsIHRlc3QgY2FzZS4KICAgICAgICAvLyBVc2UgWENUQXNzZXJ0IGFuZCByZWxhdGVkIGZ1bmN0aW9ucyB0byB2ZXJpZnkgeW91ciB0ZXN0cyBwcm9kdWNlIHRoZSBjb3JyZWN0IHJlc3VsdHMuCiAgICAgICAgLy8gQW55IHRlc3QgeW91IHdyaXRlIGZvciBYQ1Rlc3QgY2FuIGJlIGFubm90YXRlZCBhcyB0aHJvd3MgYW5kIGFzeW5jLgogICAgICAgIC8vIE1hcmsgeW91ciB0ZXN0IHRocm93cyB0byBwcm9kdWNlIGFuIHVuZXhwZWN0ZWQgZmFpbHVyZSB3aGVuIHlvdXIgdGVzdCBlbmNvdW50ZXJzIGFuIHVuY2F1Z2h0IGVycm9yLgogICAgICAgIC8vIE1hcmsgeW91ciB0ZXN0IGFzeW5jIHRvIGFsbG93IGF3YWl0aW5nIGZvciBhc3luY2hyb25vdXMgY29kZSB0byBjb21wbGV0ZS4gQ2hlY2sgdGhlIHJlc3VsdHMgd2l0aCBhc3NlcnRpb25zIGFmdGVyd2FyZHMuCiAgICB9CgogICAgZnVuYyB0ZXN0UGVyZm9ybWFuY2VFeGFtcGxlKCkgdGhyb3dzIHsKICAgICAgICAvLyBUaGlzIGlzIGFuIGV4YW1wbGUgb2YgYSBwZXJmb3JtYW5jZSB0ZXN0IGNhc2UuCiAgICAgICAgbWVhc3VyZSB7CiAgICAgICAgICAgIC8vIFB1dCB0aGUgY29kZSB5b3Ugd2FudCB0byBtZWFzdXJlIHRoZSB0aW1lIG9mIGhlcmUuCiAgICAgICAgfQogICAgfQoKfQo=
--- END ---

